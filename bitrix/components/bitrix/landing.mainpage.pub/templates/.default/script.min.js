this.BX=this.BX||{};this.BX.Landing=this.BX.Landing||{};(function(e,t,a){"use strict";var i=function(){function e(){babelHelpers.classCallCheck(this,e);document.addEventListener("click",this.onClick.bind(this))}babelHelpers.createClass(e,[{key:"onClick",value:function e(t){var a=t.target;var i=a.getAttribute("href")||a.getAttribute("data-pseudo-url")&&JSON.parse(a.getAttribute("data-pseudo-url")).href;if(!i){var n=a.parentNode;if(n.nodeName==="A"){i=n.getAttribute("href");a=n}else{var r=n.parentNode;if(r.nodeName==="A"){i=r.getAttribute("href");a=r}}}if(a.getAttribute("data-viewer-type")){return}if(i&&i.indexOf("/bitrix/services/main/ajax.php?action=landing.api.diskFile.download")===0){BX.ajax.get(i.replace("landing.api.diskFile.download","landing.api.diskFile.view"),(function(e){if(typeof e==="string"){e=JSON.parse(e)}if(!e.data){return}Object.keys(e.data).map((function(t){a.setAttribute(t,e.data[t])}));a.click()}));t.preventDefault();t.stopPropagation();return false}}}]);return e}();var n=function(){function e(a){var i=this;babelHelpers.classCallCheck(this,e);this.isPublished=a.isPublished;var n=[].slice.call(document.getElementsByClassName("block-wrapper"));if(t.Type.isArray(n)&&n.length>0){n.forEach((function(e){e.addEventListener("click",i.onClick.bind(i))}))}}babelHelpers.createClass(e,[{key:"onClick",value:function e(t){var i=t.target;if(!(i.tagName.toLowerCase()==="a"||i.parentNode&&i.parentNode.tagName.toLowerCase()==="a"||i.firstElementChild&&i.firstElementChild.tagName.toLowerCase()==="a"||i.tagName.toLowerCase()==="button"||i.hasAttribute("data-pseudo-url"))){return}var n="";var r=t.currentTarget;r.classList.forEach((function(e){if(e!=="block-wrapper"){n+=e}}));n=n.replace("block-","");var s=new a.Metrika(true);s.sendData({category:"vibe",event:"click_on_button",c_section:this.isPublished?"active_page":"preview_page",params:{"widget-id":n}})}}]);return e}();var r=function(){function e(){var t=this;babelHelpers.classCallCheck(this,e);var a=setInterval((function(){if(document.readyState==="complete"){t.initPseudoLinks();clearInterval(a)}}),500)}babelHelpers.createClass(e,[{key:"initPseudoLinks",value:function e(){var t=this;var a=[].slice.call(document.querySelectorAll('[data-pseudo-url*="{"]'));if(a.length>0){a.forEach((function(e){var a=e.getAttribute("data-pseudo-url");var i=JSON.parse(a);if(i.href&&i.enabled&&i.href.indexOf("/bitrix/services/main/ajax.php?action=landing.api.diskFile.download")!==0){if(i.target==="_self"||i.target==="_blank"){e.addEventListener("click",(function(e){e.preventDefault();var a=null;try{a=new URL(i.href)}catch(e){console.error(e)}if(a){var n=a.hostname===window.location.hostname;var r=a.searchParams.get("IFRAME")==="Y";if(n&&!r){var s=a.pathname!==window.location.pathname;if(s){BX.addClass(document.body,"landing-page-transition");i.href=a.href;setTimeout((function(){t.openPseudoLinks(i,e)}),400);setTimeout((function(){BX.removeClass(document.body,"landing-page-transition")}),3e3)}}else{t.openPseudoLinks(i,e)}}}))}}}))}}},{key:"openPseudoLinks",value:function e(t,a){if(t.href.indexOf("/bitrix/services/main/ajax.php?action=landing.api.diskFile.download")===0){return}if(t.query){t.href+=t.href.indexOf("?")===-1?"?":"&";t.href+=t.query}if(this.isValidURL(t.href)){top.open(t.href,t.target)}}},{key:"isValidURL",value:function e(t){try{new URL(t);return true}catch(e){return false}}}]);return e}();e.DiskFile=i;e.Analytics=n;e.Pseudolinks=r})(this.BX.Landing.Pub=this.BX.Landing.Pub||{},BX,BX.Landing);
//# sourceMappingURL=script.map.js