{"version":3,"file":"script.js","sources":["src/validate-helper.js","src/actions.js","src/index.js"],"sourcesContent":["import { Type, Loc } from 'main.core';\nimport { TaskField, TaskFieldError } from './types';\n\nexport class ValidateHelper\n{\n\tstatic #NEED_PATTERN = new Set([\n\t\t'S:HTML',\n\t\t'email',\n\t\t'phone',\n\t\t'web',\n\t\t'im',\n\t\t'E:EList',\n\t]);\n\n\tstatic #MULTIPLE_WITH_NO_BRACKETS = new Set([\n\t\t...ValidateHelper.#NEED_PATTERN,\n\t\t'user',\n\t\t'S:employee',\n\t\t'sms_sender',\n\t\t'mail_sender',\n\t]);\n\n\tstatic checkRequiredFieldsFilled(formData: FormData, requiredFields: Array<TaskField>): Array<TaskFieldError>\n\t{\n\t\tconst errors = [];\n\n\t\tfor (const requiredField of requiredFields)\n\t\t{\n\t\t\tconst fieldId = this.#getFieldId(requiredField);\n\t\t\tconst values = this.#getFieldValues(formData, requiredField, fieldId);\n\n\t\t\tif (!Type.isArrayFilled(values))\n\t\t\t{\n\t\t\t\tconst originalFieldId = requiredField.FieldId ?? requiredField.Id;\n\t\t\t\tif (!formData.keys().every((key) => !key.includes(originalFieldId)))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.#isFieldEmpty(requiredField, values))\n\t\t\t{\n\t\t\t\terrors.push({\n\t\t\t\t\tmessage: Loc.getMessage('BPWFI_SLIDER_ARGUMENT_NULL', { '#PARAM#': requiredField.Name }),\n\t\t\t\t\tfieldId: requiredField.Id,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn errors;\n\t}\n\n\tstatic #getFieldId(field: TaskField): string\n\t{\n\t\tlet fieldId = Type.isNil(field.FieldId) ? field.Id : field.FieldId;\n\t\tif (field.Multiple || field.Type === 'S:DiskFile')\n\t\t{\n\t\t\tfieldId = ValidateHelper.#MULTIPLE_WITH_NO_BRACKETS.has(field.Type)\n\t\t\t\t? fieldId\n\t\t\t\t: `${fieldId}[]`;\n\t\t}\n\n\t\treturn fieldId;\n\t}\n\n\tstatic #getFieldValues(formData: FormData, field: TaskField, fieldId: string): Array\n\t{\n\t\treturn ValidateHelper.#NEED_PATTERN.has(field.Type)\n\t\t\t? this.#getPatternValues(formData, this.#getPattern(field, fieldId))\n\t\t\t: formData.getAll(fieldId);\n\t}\n\n\tstatic #isFieldEmpty(field: TaskField, values: any): boolean\n\t{\n\t\tif (field.Multiple || field.Type === 'S:DiskFile' || ValidateHelper.#NEED_PATTERN.has(field.Type))\n\t\t{\n\t\t\treturn !Type.isArrayFilled(values) || values.every((value) => this.#isValueEmpty(field, value));\n\t\t}\n\n\t\treturn this.#isValueEmpty(field, values[0]);\n\t}\n\n\tstatic #isValueEmpty(field: TaskField, value: any): boolean\n\t{\n\t\tif (field.Type === 'file')\n\t\t{\n\t\t\treturn Type.isFile(value) && value.name === '';\n\t\t}\n\n\t\treturn !Type.isStringFilled(value);\n\t}\n\n\tstatic #getPattern(field: TaskField, fieldId: string): string\n\t{\n\t\tif (field.Type === 'S:HTML')\n\t\t{\n\t\t\treturn field.Multiple ? `${fieldId}\\\\[n\\\\d+\\\\]\\\\[TEXT\\\\]` : `${fieldId}\\\\[TEXT\\\\]`;\n\t\t}\n\n\t\tif (field.Type === 'E:EList')\n\t\t{\n\t\t\treturn field.Multiple ? `${fieldId}\\\\[[n]?\\\\d+\\\\]\\\\[VALUE\\\\]` : `^${fieldId}$`;\n\t\t}\n\n\t\tif (field.Type === 'email' || field.Type === 'phone' || field.Type === 'web' || field.Type === 'im')\n\t\t{\n\t\t\treturn `${fieldId}\\\\[${field.Type.toUpperCase()}\\\\]\\\\[n\\\\d+\\\\]\\\\[VALUE\\\\]`;\n\t\t}\n\n\t\treturn '';\n\t}\n\n\tstatic #getPatternValues(formData: FormData, pattern: string): []\n\t{\n\t\tconst values = [];\n\t\tfor (const [key, value] of formData.entries())\n\t\t{\n\t\t\tif (new RegExp(pattern).test(key))\n\t\t\t{\n\t\t\t\tvalues.push(value);\n\t\t\t}\n\t\t}\n\n\t\treturn values;\n\t}\n}\n","import { ajax } from 'main.core';\n\nexport function doTaskAction(data: FormData | {}, slider: BX.SidePanel, isLast: boolean): Promise\n{\n\tBX.SidePanel.Instance.postMessage(window, 'try-do-bp-task-event', { workflowId: data.get('workflowId') });\n\n\treturn new Promise((resolve, reject) => {\n\t\tajax.runAction('bizproc.task.do', { data })\n\t\t\t.then((response) => {\n\t\t\t\tif (isLast)\n\t\t\t\t{\n\t\t\t\t\tBX.SidePanel.Instance.postMessage(slider, 'success-do-bp-task-event', { taskName: data.get('taskName') });\n\t\t\t\t}\n\n\t\t\t\tresolve(response);\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tBX.SidePanel.Instance.postMessage(slider, 'error-do-bp-task-event', { workflowId: data.get('workflowId') });\n\t\t\t\treject(response);\n\t\t\t});\n\t});\n}\n","import { Event, Dom, ajax, Loc, Runtime, Tag, Text, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Button, ButtonSize, ButtonColor } from 'ui.buttons';\nimport { UserStatus } from 'bizproc.task';\nimport { MessageBox } from 'ui.dialogs.messagebox';\nimport { TaskField, TaskFieldError } from './types';\nimport { ValidateHelper } from './validate-helper';\nimport { doTaskAction } from './actions';\n\nimport './style.css';\nimport 'sidepanel';\n\ntype TaskButton = {\n\tTARGET_USER_STATUS: number,\n\tNAME: string,\n\tVALUE: string,\n\tTEXT: string,\n};\n\nexport class WorkflowInfo\n{\n\tcurrentUserId: number;\n\tworkflowId: string;\n\ttaskId: number;\n\ttaskUserId: number;\n\ttaskButtons: ?Array<TaskButton>;\n\ttaskForm: ?HTMLFormElement;\n\ttaskFields: ?Array<TaskField>;\n\ttaskName: string;\n\tbuttonsPanel: ?HTMLElement;\n\tworkflowContent: HTMLElement;\n\tcanDelegateTask: boolean;\n\t#isChanged: boolean = false;\n\t#messageBox: MessageBox;\n\t#canClose: boolean = false;\n\t#workflowResult: ?{} = null;\n\t#canUseHumanResources: boolean;\n\n\tconstructor(options: {\n\t\tcurrentUserId: number,\n\t\tworkflowId: string,\n\t\ttaskId: number,\n\t\ttaskUserId: number,\n\t\ttaskButtons?: Array<TaskButton>,\n\t\ttaskForm?: HTMLFormElement,\n\t\ttaskFields: ?Array<TaskField>;\n\t\ttaskName: string;\n\t\tbuttonsPanel: HTMLElement,\n\t\tworkflowContent: HTMLElement,\n\t\tcanDelegateTask: boolean,\n\t\tworkflowResult: ?{},\n\t\tfastClose: boolean,\n\t\tsaveVariables: boolean,\n\t\tcanUseHumanResources: boolean,\n\t})\n\t{\n\t\tthis.currentUserId = options.currentUserId;\n\t\tthis.workflowId = options.workflowId;\n\t\tthis.taskId = options.taskId;\n\t\tthis.taskUserId = options.taskUserId;\n\t\tthis.taskButtons = options.taskButtons;\n\t\tthis.taskForm = options.taskForm;\n\t\tthis.taskFields = options.taskFields;\n\t\tthis.taskName = options.taskName;\n\t\tthis.buttonsPanel = options.buttonsPanel;\n\t\tthis.workflowContent = options.workflowContent;\n\t\tthis.canDelegateTask = options.canDelegateTask;\n\t\tthis.fastClose = options.fastClose;\n\t\tthis.saveVariables = options.saveVariables;\n\t\tthis.#canUseHumanResources = Text.toBoolean(options.canUseHumanResources);\n\n\t\tthis.handleMarkAsRead = Runtime.debounce(this.#sendMarkAsRead, 100, this);\n\t\tthis.#workflowResult = Type.isNil(options.workflowResult) ? null : options.workflowResult;\n\t}\n\n\tinit(): void\n\t{\n\t\tif (this.buttonsPanel)\n\t\t{\n\t\t\tthis.#renderButtons();\n\t\t}\n\n\t\tthis.handleMarkAsRead();\n\n\t\tEventEmitter.subscribe('OnUCCommentWasRead', (event) => {\n\t\t\tconst [xmlId] = event.getData();\n\t\t\tif (xmlId === `WF_${this.workflowId}`)\n\t\t\t{\n\t\t\t\tthis.handleMarkAsRead();\n\t\t\t}\n\t\t});\n\t\tif (this.taskForm)\n\t\t{\n\t\t\tEvent.bind(this.taskForm, 'change', () => {\n\t\t\t\tthis.#isChanged = true;\n\t\t\t});\n\t\t\tEvent.bind(this.taskForm, 'input', (event) => {\n\t\t\t\tconst target = event.target;\n\t\t\t\tif (target.matches('input, textarea, select'))\n\t\t\t\t{\n\t\t\t\t\tconst formRow = target.closest('.ui-form-content');\n\t\t\t\t\tif (formRow)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#clearError(formRow);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.#isChanged = true;\n\t\t\t});\n\n\t\t\tthis.taskForm.querySelectorAll('.ui-form-content').forEach((row) => {\n\t\t\t\tEvent.bind(row, 'click', (event) => {\n\t\t\t\t\tconst target = event.currentTarget;\n\t\t\t\t\tthis.#clearError(target);\n\t\t\t\t});\n\t\t\t});\n\t\t\tEventEmitter.subscribe('BX.UI.Selector:onChange', (event) => {\n\t\t\t\tconst box = BX(`crm-${event.data[0].selectorId}-box`);\n\t\t\t\tconst formRow = box.closest('.ui-form-content');\n\t\t\t\tif (formRow)\n\t\t\t\t{\n\t\t\t\t\tthis.#clearError(formRow);\n\t\t\t\t\tthis.#isChanged = true;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tEventEmitter.subscribe('BX.UI.EntitySelector.Dialog:Item:onSelect', (event) => {\n\t\t\t\tif (event.target.context === 'BIZPROC')\n\t\t\t\t{\n\t\t\t\t\tthis.#isChanged = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tEventEmitter.subscribe('BX.UI.EntitySelector.Dialog:Item:onDeselect', (event) => {\n\t\t\t\tif (event.target.context === 'BIZPROC')\n\t\t\t\t{\n\t\t\t\t\tthis.#isChanged = true;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tEventEmitter.subscribe('OnIframeKeyup', (event) => {\n\t\t\t\tconst box = event.target.dom.cont;\n\t\t\t\tconst formRow = box.closest('.ui-form-content');\n\t\t\t\tif (formRow)\n\t\t\t\t{\n\t\t\t\t\tthis.#clearError(formRow);\n\t\t\t\t}\n\t\t\t});\n\t\t\tEventEmitter.subscribe('OnContentChanged', (event) => {\n\t\t\t\tif (event.target.dom.cont.closest('.ui-form-content'))\n\t\t\t\t{\n\t\t\t\t\tthis.#isChanged = true;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tEventEmitter.subscribe('BX.Disk.Uploader.Integration:Item:onAdd', (event) => {\n\t\t\t\tif ((event.target.getUploader().getHiddenFieldsContainer().closest('.ui-form-content')))\n\t\t\t\t{\n\t\t\t\t\tthis.#isChanged = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tEventEmitter.subscribe('BX.Disk.Uploader.Integration:Item:onRemove', (event) => {\n\t\t\t\tif ((event.target.getUploader().getHiddenFieldsContainer().closest('.ui-form-content')))\n\t\t\t\t{\n\t\t\t\t\tthis.#isChanged = true;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tEventEmitter.subscribe('SidePanel.Slider:onClose', (event) => {\n\t\t\t\tif (event.getTarget().getWindow() === window && this.#isChanged && !this.#canClose)\n\t\t\t\t{\n\t\t\t\t\tevent.getCompatData()[0].denyAction();\n\t\t\t\t\tif (!this.#messageBox?.getPopupWindow().isShown())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#showConfirmDialog();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tconst desc = this.workflowContent.querySelector('.bp-workflow-info__desc-inner');\n\t\tif (desc)\n\t\t{\n\t\t\tBX.UI.Hint.init(desc);\n\t\t}\n\n\t\tconst resultNode = this.workflowContent.querySelector('[data-role=\"bp-workflow-result\"]');\n\t\tif (resultNode && this.#workflowResult)\n\t\t{\n\t\t\tRuntime.loadExtension('bizproc.workflow.result')\n\t\t\t\t.then((exports) => {\n\t\t\t\t\tif (exports?.WorkflowResult)\n\t\t\t\t\t{\n\t\t\t\t\t\tnew exports.WorkflowResult(this.#workflowResult).renderTo(resultNode);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(() => {})\n\t\t\t;\n\t\t}\n\t}\n\n\t#renderButtons(): void\n\t{\n\t\tif (this.taskButtons)\n\t\t{\n\t\t\tDom.clean(this.buttonsPanel);\n\t\t\tthis.taskButtons.forEach((taskButton: TaskButton) => {\n\t\t\t\tconst targetStatus = new UserStatus(taskButton.TARGET_USER_STATUS);\n\t\t\t\tconst isDecline = targetStatus.isNo() || targetStatus.isCancel();\n\n\t\t\t\tconst button = new Button({\n\t\t\t\t\tcolor: isDecline ? ButtonColor.LIGHT_BORDER : ButtonColor.SUCCESS,\n\t\t\t\t\t// icon: isDecline ? ButtonIcon.CANCEL : ButtonIcon.DONE,\n\t\t\t\t\tround: true,\n\t\t\t\t\tsize: ButtonSize.MEDIUM,\n\t\t\t\t\t// noCaps: true,\n\t\t\t\t\ttext: taskButton.TEXT,\n\t\t\t\t\tonclick: (btn) => this.#handleTaskButtonClick(taskButton, btn),\n\t\t\t\t});\n\n\t\t\t\tDom.style(button.getContainer(), 'minWidth', '160px');\n\t\t\t\tDom.style(button.getContainer(), 'maxWidth', '200px');\n\t\t\t\tDom.attr(button.getContainer(), 'title', taskButton.TEXT);\n\t\t\t\tDom.append(button.getContainer(), this.buttonsPanel);\n\t\t\t});\n\t\t}\n\n\t\tif (this.canDelegateTask)\n\t\t{\n\t\t\tconst button = new Button({\n\t\t\t\tcolor: ButtonColor.LINK,\n\t\t\t\tsize: ButtonSize.MEDIUM,\n\t\t\t\t// noCaps: true,\n\t\t\t\ttext: Loc.getMessage('BPWFI_SLIDER_BUTTON_DELEGATE'),\n\t\t\t\tonclick: (btn) => this.#handleDelegateButtonClick(btn),\n\t\t\t});\n\n\t\t\tDom.style(button.getContainer(), 'minWidth', '160px');\n\t\t\tDom.style(button.getContainer(), 'maxWidth', '200px');\n\t\t\tDom.append(button.getContainer(), this.buttonsPanel);\n\t\t}\n\t}\n\n\t#handleTaskButtonClick(taskButton: TaskButton, uiButton: Button): void\n\t{\n\t\tconst formData = new FormData(this.taskForm);\n\t\tconst errors =\n\t\t\tthis.#isNeedValidate(taskButton.NAME)\n\t\t\t\t? ValidateHelper.checkRequiredFieldsFilled(formData, this.#getRequiredFields())\n\t\t\t\t: []\n\t\t;\n\t\tif (Type.isArrayFilled(errors))\n\t\t{\n\t\t\tthis.#showErrors(errors);\n\n\t\t\treturn;\n\t\t}\n\n\t\tformData.append('taskId', this.taskId);\n\t\tformData.append('workflowId', this.workflowId);\n\t\tformData.append('taskName', this.taskName);\n\t\tformData.append(taskButton.NAME, taskButton.VALUE);\n\t\tconst slider = BX.SidePanel.Instance.getSliderByWindow(window);\n\n\t\tuiButton.setDisabled(true);\n\t\tif (this.fastClose)\n\t\t{\n\t\t\tthis.#canClose = true;\n\t\t\tslider?.close();\n\t\t\tslider.setCacheable(true);\n\t\t}\n\n\t\tdoTaskAction(formData, slider, this.fastClose)\n\t\t\t.then(() => {\n\t\t\t\tslider?.setCacheable(false);\n\t\t\t\tDom.addClass(this.workflowContent, 'fade-out');\n\t\t\t\tthis.#getNextTaskOrClose(formData);\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.#showErrors(this.#prepareErrors(response.errors));\n\t\t\t})\n\t\t\t.finally(() => uiButton.setDisabled(false))\n\t\t;\n\t}\n\n\t#isNeedValidate(buttonName: string): boolean\n\t{\n\t\treturn !(buttonName === 'cancel' && !this.saveVariables);\n\t}\n\n\t#getRequiredFields(): Array<TaskField>\n\t{\n\t\tif (Type.isNil(this.taskFields))\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\treturn this.taskFields.filter((field) => field.Required);\n\t}\n\n\t#getNextTaskOrClose(formData: FormData): void\n\t{\n\t\tajax.runAction('bizproc.task.getUserTaskByWorkflowId', {\n\t\t\tdata: formData,\n\t\t}).then((res) => {\n\t\t\tif (BX.type.isArray(res.data.additionalParams) && res.data.additionalParams.length === 0)\n\t\t\t{\n\t\t\t\tthis.#canClose = true;\n\t\t\t\tBX.SidePanel.Instance.getSliderByWindow(window)?.close();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#renderNextTask(res.data);\n\t\t\t}\n\t\t}).catch((response) => {\n\t\t\tDom.toggleClass(this.workflowContent, 'fade-out fade-in');\n\t\t\tMessageBox.alert(response.errors.pop().message);\n\t\t});\n\t}\n\n\t#prepareErrors(responseErrors: Array): Array<TaskFieldError>\n\t{\n\t\tconst errors = [];\n\t\tfor (const error of responseErrors)\n\t\t{\n\t\t\terrors.push({\n\t\t\t\tfieldId: error.customData ?? null,\n\t\t\t\tmessage: error.message,\n\t\t\t});\n\t\t}\n\n\t\treturn errors;\n\t}\n\n\t#handleDelegateButtonClick(uiButton: Button): void\n\t{\n\t\tuiButton.setDisabled(true);\n\n\t\tRuntime.loadExtension('ui.entity-selector').then((exports) => {\n\t\t\tconst { Dialog } = exports;\n\t\t\tuiButton.setDisabled(false);\n\n\t\t\tconst dialog = new Dialog({\n\t\t\t\ttargetNode: uiButton.getContainer(),\n\t\t\t\tcontext: 'bp-task-delegation',\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tintranetUsersOnly: true,\n\t\t\t\t\t\t\temailUsers: false,\n\t\t\t\t\t\t\tinviteEmployeeLink: false,\n\t\t\t\t\t\t\tinviteGuestLink: false,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: this.#canUseHumanResources ? 'structure-node' : 'department',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tselectMode: 'usersOnly',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tbindOptions: { forceBindPosition: true },\n\t\t\t\t},\n\t\t\t\tenableSearch: true,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\tconst item = event.getData().item;\n\t\t\t\t\t\tthis.#delegateTask(item.getId());\n\t\t\t\t\t},\n\t\t\t\t\tonHide: (event) => {\n\t\t\t\t\t\tevent.getTarget().destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\thideOnSelect: true,\n\t\t\t\toffsetTop: 3,\n\t\t\t\tclearUnavailableItems: true,\n\t\t\t\tmultiple: false,\n\t\t\t});\n\n\t\t\tdialog.show();\n\t\t})\n\t\t\t.catch((e) => {\n\t\t\t\tconsole.error(e);\n\t\t\t\tuiButton.setDisabled(false);\n\t\t\t});\n\t}\n\n\t#delegateTask(toUserId: number): void\n\t{\n\t\tconst actionData = {\n\t\t\ttaskIds: [this.taskId],\n\t\t\tfromUserId: this.taskUserId || this.currentUserId,\n\t\t\ttoUserId,\n\t\t};\n\n\t\tajax.runAction('bizproc.task.delegate', { data: actionData })\n\t\t\t.then((response) => {\n\t\t\t\tthis.#canClose = true;\n\t\t\t\tBX.SidePanel.Instance.getSliderByWindow(window)?.close();\n\t\t\t}).catch((response) => {\n\t\t\t\tMessageBox.alert(response.errors.pop().message);\n\t\t\t});\n\t}\n\n\t#sendMarkAsRead(): void\n\t{\n\t\tajax.runAction('bizproc.workflow.comment.markAsRead', {\n\t\t\tdata: {\n\t\t\t\tworkflowId: this.workflowId,\n\t\t\t\tuserId: this.currentUserId,\n\t\t\t},\n\t\t});\n\t}\n\n\t#clearError(target: HTMLElement): void\n\t{\n\t\tconst errorContainer = target.querySelector('.ui-form-notice');\n\t\tif (errorContainer)\n\t\t{\n\t\t\tBX.Dom.remove(errorContainer);\n\t\t}\n\t}\n\n\t#showErrors(errors: Array<TaskFieldError>)\n\t{\n\t\tif (BX.type.isArray(errors))\n\t\t{\n\t\t\tconst popupErrors = [];\n\t\t\terrors.forEach((error) => {\n\t\t\t\tconst fieldName = error.fieldId;\n\t\t\t\tif (this.taskForm && fieldName)\n\t\t\t\t{\n\t\t\t\t\tthis.#showError(error.message, fieldName);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tpopupErrors.push(error.message);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (popupErrors.length > 0)\n\t\t\t{\n\t\t\t\tMessageBox.alert(popupErrors.join(', '));\n\t\t\t}\n\t\t}\n\t}\n\n\t#showError(message: string, id: string): void\n\t{\n\t\tconst field = this.taskForm.querySelector(`[data-cid=\"${id}\"]`);\n\t\tif (!field)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst parentContainer = field.querySelector('.ui-form-content');\n\t\tlet errorContainer = field.querySelector('.ui-form-notice');\n\t\tif (!errorContainer)\n\t\t{\n\t\t\terrorContainer = BX.Dom.create(\n\t\t\t\t'div',\n\t\t\t\t{ attrs: { className: 'ui-form-notice' } },\n\t\t\t);\n\n\t\t\terrorContainer.innerText = message;\n\t\t\tif (parentContainer)\n\t\t\t{\n\t\t\t\tBX.Dom.append(errorContainer, parentContainer);\n\t\t\t}\n\t\t}\n\t}\n\n\t#renderNextTask(data)\n\t{\n\t\tthis.#isChanged = false;\n\t\tthis.#renderTaskFields(data);\n\n\t\tif (data.additionalParams)\n\t\t{\n\t\t\tthis.taskId = data.additionalParams.ID;\n\t\t\tthis.fastClose = data.additionalParams.IS_LAST_TASK_FOR_USER;\n\t\t\tthis.saveVariables = data.additionalParams.saveVariables;\n\t\t\tthis.taskFields = data.additionalParams.FIELDS;\n\t\t\tconst subject = this.workflowContent.querySelector('.bp-workflow-info__subject');\n\t\t\tif (subject)\n\t\t\t{\n\t\t\t\tsubject.innerText = data.additionalParams.NAME;\n\t\t\t}\n\t\t\tconst desc = this.workflowContent.querySelector('.bp-workflow-info__desc-inner');\n\t\t\tif (desc)\n\t\t\t{\n\t\t\t\tconst descWrap = desc.closest('.bp-workflow-info__tabs-block');\n\t\t\t\tif (data.additionalParams.DESCRIPTION.length > 0)\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(descWrap, 'block-hidden');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(descWrap, 'block-hidden');\n\t\t\t\t}\n\n\t\t\t\tdesc.innerHTML = data.additionalParams.DESCRIPTION;\n\t\t\t\tBX.UI.Hint.init(desc);\n\t\t\t}\n\n\t\t\tconst slider = BX.SidePanel.Instance.getSliderByWindow(window);\n\t\t\tif (slider)\n\t\t\t{\n\t\t\t\tconst currentUrl = slider.getUrl();\n\t\t\t\tconst newUrl = currentUrl.replace(/\\/bizproc\\/\\d+\\//, `/bizproc/${this.taskId}/`);\n\t\t\t\tslider.setUrl(newUrl);\n\t\t\t\ttop.history.replaceState({}, '', newUrl);\n\t\t\t}\n\t\t}\n\n\t\tif (data.additionalParams && data.additionalParams.BUTTONS)\n\t\t{\n\t\t\tthis.taskButtons = data.additionalParams.BUTTONS;\n\t\t}\n\n\t\tthis.init();\n\t\tDom.removeClass(this.workflowContent, 'fade-out');\n\t\tDom.addClass(this.workflowContent, 'fade-in');\n\n\t\tEvent.bindOnce(this.workflowContent, 'animationend', () => {\n\t\t\tDom.removeClass(this.workflowContent, 'fade-in');\n\t\t});\n\t}\n\n\t#renderTaskFields(data)\n\t{\n\t\tconst taskFields = this.workflowContent.querySelector('.bp-workflow-info__editor');\n\t\tif (BX.type.isArray(data.html) && data.html.length > 0)\n\t\t{\n\t\t\tDom.removeClass(taskFields, 'block-hidden');\n\t\t\tDom.clean(this.taskForm);\n\t\t\tdata.html.forEach((renderedControl, controlId) => {\n\t\t\t\tconst fieldData = data.additionalParams?.FIELDS?.[controlId];\n\t\t\t\tif (fieldData)\n\t\t\t\t{\n\t\t\t\t\tconst labelClass = fieldData.Required ? 'ui-form-label --required' : 'ui-form-label';\n\t\t\t\t\tconst node = Tag.render`\n\t\t\t\t\t\t<div class=\"ui-form-row\" data-cid=\"${Text.encode(fieldData.Id)}\">\n\t\t\t\t\t\t\t<div class=\"${labelClass}\">\n\t\t\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">${Text.encode(fieldData.Name)}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"ui-form-content\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`;\n\n\t\t\t\t\tBX.Runtime.html(node.querySelector('.ui-form-content'), renderedControl);\n\t\t\t\t\tthis.taskForm.append(node);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(taskFields, 'block-hidden');\n\t\t}\n\t}\n\n\t#showConfirmDialog()\n\t{\n\t\tthis.#messageBox = MessageBox.confirm(\n\t\t\tLoc.getMessage('BPWFI_SLIDER_CONFIRM_DESCRIPTION'),\n\t\t\tLoc.getMessage('BPWFI_SLIDER_CONFIRM_TITLE'),\n\t\t\t() => {\n\t\t\t\tthis.#canClose = true;\n\t\t\t\tBX.SidePanel.Instance.getSliderByWindow(window)?.close();\n\t\t\t},\n\t\t\tLoc.getMessage('BPWFI_SLIDER_CONFIRM_ACCEPT'),\n\t\t\t() => {\n\t\t\t\tthis.#messageBox.close();\n\t\t\t\tthis.#messageBox = null;\n\t\t\t},\n\t\t\tLoc.getMessage('BPWFI_SLIDER_CONFIRM_CANCEL'),\n\t\t);\n\t}\n}\n"],"names":["ValidateHelper","checkRequiredFieldsFilled","formData","requiredFields","errors","requiredField","fieldId","values","Type","isArrayFilled","originalFieldId","FieldId","Id","keys","every","key","includes","push","message","Loc","getMessage","Name","field","isNil","Multiple","has","getAll","value","isFile","name","isStringFilled","toUpperCase","pattern","entries","RegExp","test","Set","doTaskAction","data","slider","isLast","BX","SidePanel","Instance","postMessage","window","workflowId","get","Promise","resolve","reject","ajax","runAction","then","response","taskName","catch","WorkflowInfo","constructor","options","currentUserId","taskId","taskUserId","taskButtons","taskForm","taskFields","buttonsPanel","workflowContent","canDelegateTask","fastClose","saveVariables","Text","toBoolean","canUseHumanResources","handleMarkAsRead","Runtime","debounce","workflowResult","init","EventEmitter","subscribe","event","xmlId","getData","Event","bind","target","matches","formRow","closest","querySelectorAll","forEach","row","currentTarget","box","selectorId","context","dom","cont","getUploader","getHiddenFieldsContainer","getTarget","getWindow","getCompatData","denyAction","getPopupWindow","isShown","desc","querySelector","UI","Hint","resultNode","loadExtension","exports","WorkflowResult","renderTo","Dom","clean","taskButton","targetStatus","UserStatus","TARGET_USER_STATUS","isDecline","isNo","isCancel","button","Button","color","ButtonColor","LIGHT_BORDER","SUCCESS","round","size","ButtonSize","MEDIUM","text","TEXT","onclick","btn","style","getContainer","attr","append","LINK","uiButton","FormData","NAME","VALUE","getSliderByWindow","setDisabled","close","setCacheable","addClass","finally","buttonName","filter","Required","res","type","isArray","additionalParams","length","toggleClass","MessageBox","alert","pop","responseErrors","error","customData","Dialog","dialog","targetNode","entities","id","intranetUsersOnly","emailUsers","inviteEmployeeLink","inviteGuestLink","selectMode","popupOptions","bindOptions","forceBindPosition","enableSearch","events","item","getId","onHide","destroy","hideOnSelect","offsetTop","clearUnavailableItems","multiple","show","e","console","toUserId","actionData","taskIds","fromUserId","userId","errorContainer","remove","popupErrors","fieldName","join","parentContainer","create","attrs","className","innerText","ID","IS_LAST_TASK_FOR_USER","FIELDS","subject","descWrap","DESCRIPTION","removeClass","innerHTML","currentUrl","getUrl","newUrl","replace","setUrl","top","history","replaceState","BUTTONS","bindOnce","html","renderedControl","controlId","fieldData","labelClass","node","Tag","render","encode","confirm"],"mappings":"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"}