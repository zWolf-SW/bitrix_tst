{"version":3,"file":"ui.toolbar.bundle.js","sources":["../src/title-editor.js","../src/toolbar-star.js","../src/toolbar.js","../src/toolbar-manager.js"],"sourcesContent":["import { bind, Dom, Event } from 'main.core';\n\nexport type TitleEditorOptions = {\n\tactive: boolean;\n\tselector: HTMLElement;\n\tdisabled?: boolean;\n\tdefaultTitle?: string;\n}\n\nexport const TitleEditorEvents = {\n\tbeforeStartEditing: 'beforeStartEditing',\n\tstartEditing: 'startEditing',\n\tfinishEditing: 'finishEditing',\n};\n\nexport class TitleEditor extends Event.EventEmitter\n{\n\t// #dataContainer: ?HTMLElement;\n\t#initialTitle: string;\n\t#defaultTitle: string;\n\t#toolbarNode: ?HTMLElement;\n\t#titleNode: ?HTMLElement;\n\t#inputNode: ?HTMLInputElement;\n\t// #dataNode: ?HTMLElement;\n\t#editTitleButtonNode: ?HTMLElement;\n\t#editTitleResultButtonsContainer: ?HTMLElement;\n\t#titleIconButtonsContainer: ?HTMLElement;\n\t#saveTitleButton: ?HTMLElement;\n\t#cancelTitleEditButton: ?HTMLElement;\n\t#isInit: boolean = false;\n\n\tconstructor(options: TitleEditorOptions)\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('UI.Toolbar.TitleEditor');\n\t\tthis.#init(options);\n\t}\n\n\t#init(params: TitleEditorOptions)\n\t{\n\t\t// if (!params.selector)\n\t\t// {\n\t\t// \treturn;\n\t\t// }\n\t\t//\n\t\t// this.dataContainer = document.querySelector(params.selector);\n\t\t// if (!this.dataContainer)\n\t\t// {\n\t\t// \treturn;\n\t\t// }\n\t\t//\n\t\t// Dom.style(this.dataContainer, 'display', 'none');\n\n\t\tthis.#toolbarNode = document.getElementById('uiToolbarContainer');\n\t\tthis.#titleNode = document.querySelector('.ui-wrap-title-name');\n\t\tthis.#inputNode = document.querySelector('.ui-toolbar-edit-title-input');\n\t\tthis.#editTitleButtonNode = document.querySelector('.ui-toolbar-edit-title-button');\n\t\tthis.#editTitleResultButtonsContainer = document.getElementById('ui-toolbar-title-edit-result-buttons');\n\t\tthis.#saveTitleButton = document.getElementById('ui-toolbar-save-title-button');\n\t\tthis.#cancelTitleEditButton = document.getElementById('ui-toolbar-cancel-title-edit-button');\n\t\tthis.#titleIconButtonsContainer = document.getElementById('ui-toolbar-title-item-box-buttons');\n\t\tthis.#initialTitle = this.#titleNode.textContent;\n\t\tthis.#defaultTitle = params.defaultTitle;\n\n\t\t// bind(this.dataNode, 'bxchange', this.onDataNodeChange.bind(this));\n\t\tbind(this.#editTitleButtonNode, 'click', this.startEdit.bind(this));\n\t\tbind(this.#inputNode, 'keyup', this.onKeyUp.bind(this));\n\t\tbind(this.#inputNode, 'blur', (event) => {\n\t\t\tif (event.relatedTarget === this.#cancelTitleEditButton)\n\t\t\t{\n\t\t\t\tthis.cancelEdit();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.finishEdit();\n\t\t});\n\t\tbind(this.#saveTitleButton, 'click', this.finishEdit.bind(this));\n\t\tbind(this.#cancelTitleEditButton, 'click', this.cancelEdit.bind(this));\n\n\t\tthis.#isInit = true;\n\n\t\tif (!params.disabled)\n\t\t{\n\t\t\tthis.enable();\n\t\t}\n\t}\n\n\tenable(isDisable: boolean = false)\n\t{\n\t\tif (!this.#isInit)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.changeDisplay(this.#editTitleButtonNode, isDisable === false);\n\t\t// this.titleNode.textContent = isDisable === false\n\t\t// \t? (this.dataNode.value ?? this.defaultTitle)\n\t\t// \t: this.initialTitle\n\t\t// ;\n\n\t\tthis.#titleNode.textContent = this.#initialTitle;\n\t}\n\n\tdisable(): void\n\t{\n\t\tthis.enable(true);\n\t}\n\n\t// onDataNodeChange()\n\t// {\n\t// \tthis.#titleNode.textContent = this.#dataNode.value;\n\t// }\n\n\tonKeyUp(event: KeyboardEvent): boolean\n\t{\n\t\tif (event.key === 'Enter')\n\t\t{\n\t\t\tthis.finishEdit();\n\t\t\tevent.preventDefault();\n\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tstartEdit(): void\n\t{\n\t\t// this.inputNode.value = this.dataNode.value || this.titleNode.textContent;\n\n\t\tconst event = new Event.BaseEvent();\n\t\tthis.emit(TitleEditorEvents.beforeStartEditing, event);\n\t\tif (event.isDefaultPrevented())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#inputNode.value = this.#titleNode.textContent;\n\t\tthis.changeDisplay(this.#titleNode, false);\n\t\tthis.changeDisplay(this.#editTitleButtonNode, false);\n\t\tthis.changeDisplay(this.#inputNode, true);\n\t\tthis.changeDisplay(this.#titleIconButtonsContainer, false);\n\t\tDom.addClass(this.#editTitleResultButtonsContainer, '--show');\n\t\tDom.addClass(this.#toolbarNode, '--title-editing');\n\n\t\tthis.#inputNode.focus();\n\n\t\tthis.emit(TitleEditorEvents.startEditing);\n\t}\n\n\tfinishEdit()\n\t{\n\t\t// this.dataNode.value = this.inputNode.value;\n\t\tthis.#titleNode.textContent = this.#inputNode.value;\n\t\tthis.changeDisplay(this.#inputNode, false);\n\t\tthis.changeDisplay(this.#editTitleButtonNode, true);\n\t\tthis.changeDisplay(this.#titleNode, true);\n\t\tthis.changeDisplay(this.#titleIconButtonsContainer, true);\n\t\tDom.removeClass(this.#editTitleResultButtonsContainer, '--show');\n\t\tDom.removeClass(this.#toolbarNode, '--title-editing');\n\n\t\tthis.emit(TitleEditorEvents.finishEditing, {\n\t\t\tupdatedTitle: this.#inputNode.value,\n\t\t});\n\t}\n\n\tcancelEdit(): void\n\t{\n\t\tthis.changeDisplay(this.#inputNode, false);\n\t\tthis.changeDisplay(this.#editTitleButtonNode, true);\n\t\tthis.changeDisplay(this.#titleNode, true);\n\t\tthis.changeDisplay(this.#titleIconButtonsContainer, true);\n\t\tDom.removeClass(this.#editTitleResultButtonsContainer, '--show');\n\t\tDom.removeClass(this.#toolbarNode, '--title-editing');\n\t}\n\n\tchangeDisplay(node: HTMLElement, isShow: boolean): string\n\t{\n\t\tconst displayValue = isShow ? '' : 'none';\n\n\t\tDom.style(node, 'display', displayValue);\n\n\t\treturn displayValue;\n\t}\n}\n","import { ready, Event, Type, Uri, Dom, Loc, bind } from 'main.core';\nimport { PopupWindowManager } from 'main.popup';\n\nexport class ToolbarStar\n{\n\tinitialized: boolean;\n\tcurrentPageInMenu: false;\n\tstarContNode: HTMLElement;\n\n\tconstructor()\n\t{\n\t\tthis.initialized = false;\n\t\tthis.currentPageInMenu = false;\n\t\tthis.starContNode = null;\n\n\t\tready(() => this.init());\n\n\t\tEvent.EventEmitter.subscribe('onFrameDataProcessed', () => {\n\t\t\tthis.init();\n\t\t});\n\t\t// BX.addCustomEvent('onFrameDataProcessed', () => this.init());\n\t}\n\n\tinit(): boolean\n\t{\n\t\tthis.starContNode = document.getElementById('uiToolbarStar');\n\t\tif (!this.starContNode || this.initialized)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.initialized = true;\n\n\t\tlet currentFullPath = Dom.attr(this.starContNode, 'data-bx-url');\n\t\tif (!Type.isStringFilled(currentFullPath))\n\t\t{\n\t\t\tcurrentFullPath = document.location.pathname + document.location.search;\n\t\t}\n\t\tcurrentFullPath = Uri.removeParam(currentFullPath, ['IFRAME', 'IFRAME_TYPE']);\n\n\t\ttop.BX.addCustomEvent('BX.Bitrix24.LeftMenuClass:onSendMenuItemData', (params) => {\n\t\t\tthis.processMenuItemData(params);\n\t\t});\n\t\ttop.BX.addCustomEvent('BX.Bitrix24.LeftMenuClass:onStandardItemChangedSuccess', (params) => {\n\t\t\tthis.onStandardItemChangedSuccess(params);\n\t\t});\n\n\t\ttop.BX.onCustomEvent('UI.Toolbar:onRequestMenuItemData', [\n\t\t\t{\n\t\t\t\tcurrentFullPath,\n\t\t\t\tcontext: window,\n\t\t\t},\n\t\t]);\n\n\t\treturn true;\n\t}\n\n\tprocessMenuItemData(params): void | boolean\n\t{\n\t\tif (params.context && params.context !== window)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.currentPageInMenu = params.currentPageInMenu;\n\n\t\tif (Type.isObjectLike(params.currentPageInMenu))\n\t\t{\n\t\t\tDom.addClass(this.starContNode, 'ui-toolbar-star-active');\n\t\t}\n\n\t\tthis.starContNode.title = Loc.getMessage(\n\t\t\tDom.hasClass(this.starContNode, 'ui-toolbar-star-active')\n\t\t\t\t? 'UI_TOOLBAR_DELETE_PAGE_FROM_LEFT_MENU'\n\t\t\t\t: 'UI_TOOLBAR_ADD_PAGE_TO_LEFT_MENU',\n\t\t);\n\n\t\t// default page\n\t\tif (Type.isDomNode(this.currentPageInMenu)\n\t\t\t&& Dom.attr(this.currentPageInMenu, 'data-type') !== 'standard'\n\t\t)\n\t\t{\n\t\t\tthis.starContNode.title = Loc.getMessage('UI_TOOLBAR_STAR_TITLE_DEFAULT_PAGE');\n\t\t\tbind(this.starContNode, 'click', () => {\n\t\t\t\tthis.showMessage(Loc.getMessage('UI_TOOLBAR_STAR_TITLE_DEFAULT_PAGE_DELETE_ERROR'));\n\t\t\t});\n\n\t\t\treturn true;\n\t\t}\n\n\t\t// any page\n\t\tbind(this.starContNode, 'click', () => {\n\t\t\tlet pageTitle = document.getElementById('pagetitle')?.innerText || '';\n\t\t\tconst titleTemplate = this.starContNode.getAttribute('data-bx-title-template');\n\t\t\tif (Type.isStringFilled(titleTemplate))\n\t\t\t{\n\t\t\t\tpageTitle = titleTemplate.replace(/#page_title#/i, pageTitle);\n\t\t\t}\n\n\t\t\tlet pageLink = this.starContNode.getAttribute('data-bx-url');\n\t\t\tif (!Type.isStringFilled(pageLink))\n\t\t\t{\n\t\t\t\tpageLink = document.location.pathname + document.location.search;\n\t\t\t}\n\t\t\tpageLink = Uri.removeParam(pageLink, ['IFRAME', 'IFRAME_TYPE']);\n\n\t\t\ttop.BX.onCustomEvent('UI.Toolbar:onStarClick', [\n\t\t\t\t{\n\t\t\t\t\tisActive: Dom.hasClass(this.starContNode, 'ui-toolbar-star-active'),\n\t\t\t\t\tcontext: window,\n\t\t\t\t\tpageTitle,\n\t\t\t\t\tpageLink,\n\t\t\t\t},\n\t\t\t]);\n\t\t});\n\t}\n\n\tonStandardItemChangedSuccess(params): void\n\t{\n\t\tif (!Type.isBoolean(params.isActive) || !this.starContNode || (params.context && params.context !== window))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (params.isActive)\n\t\t{\n\t\t\tthis.showMessage(Loc.getMessage('UI_TOOLBAR_ITEM_WAS_ADDED_TO_LEFT'));\n\t\t\tthis.starContNode.title = Loc.getMessage('UI_TOOLBAR_DELETE_PAGE_FROM_LEFT_MENU');\n\t\t\tDom.addClass(this.starContNode, 'ui-toolbar-star-active');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showMessage(Loc.getMessage('UI_TOOLBAR_ITEM_WAS_DELETED_FROM_LEFT'));\n\t\t\tthis.starContNode.title = Loc.getMessage('UI_TOOLBAR_ADD_PAGE_TO_LEFT_MENU');\n\t\t\tDom.removeClass(this.starContNode, 'ui-toolbar-star-active');\n\t\t}\n\t}\n\n\tshowMessage(message) {\n\t\tlet popup = PopupWindowManager.create('left-menu-message', this.starContNode, {\n\t\t\tcontent: message,\n\t\t\tdarkMode: true,\n\t\t\toffsetTop: 2,\n\t\t\toffsetLeft: 0,\n\t\t\tangle: true,\n\t\t\tautoHide: true,\n\t\t\tevents: {\n\t\t\t\tonPopupClose: () => {\n\t\t\t\t\tif (popup)\n\t\t\t\t\t{\n\t\t\t\t\t\tpopup.destroy();\n\t\t\t\t\t\tpopup = null;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tpopup.show();\n\n\t\tsetTimeout(() => {\n\t\t\tif (popup)\n\t\t\t{\n\t\t\t\tpopup.destroy();\n\t\t\t\tpopup = null;\n\t\t\t}\n\t\t}, 3000);\n\t}\n}\n","import { bind, Dom, Event, Text, Type, Uri } from 'main.core';\nimport { type BaseEvent } from 'main.core.events';\nimport { Popup } from 'main.popup';\nimport { ButtonColor, ButtonIcon, ButtonManager } from 'ui.buttons';\n\nimport { TitleEditor, TitleEditorEvents, type TitleEditorOptions } from './title-editor';\nimport { ToolbarStar } from './toolbar-star';\n\nexport type ToolbarOptions = {\n\ttitleMinWidth?: number;\n\ttitleMaxWidth?: number;\n\tfilterMinWidth?: number;\n\tfilterMaxWidth?: number;\n\tid?: string;\n\ttarget: HTMLElement;\n\tbuttonIds?: string[];\n\ttitleEditor: TitleEditorOptions;\n};\n\nexport const ToolbarEvents = {\n\tbeforeStartEditing: 'beforeStartEditing',\n\tstartEditing: 'startEditing',\n\tfinishEditing: 'finishEditing',\n};\n\nexport class Toolbar extends Event.EventEmitter\n{\n\ttitleMinWidth: number;\n\ttitleMaxWidth: number;\n\tfilterMinWidth: number;\n\tfilterMaxWidth: number;\n\tid: string;\n\ttoolbarContainer: HTMLElement;\n\tbuttons: Object;\n\tbuttonIds: string[];\n\twindowWidth: number;\n\t#copyLinkButton: HTMLElement;\n\t#titleEditor: ?TitleEditor;\n\n\tstatic TitleEditor = TitleEditor;\n\tstatic Star = ToolbarStar;\n\n\t// eslint-disable-next-line sonarjs/cognitive-complexity\n\tconstructor(options: ToolbarOptions = {})\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.UI.Toolbar');\n\t\tthis.titleMinWidth = Type.isNumber(options.titleMinWidth) ? options.titleMinWidth : 158;\n\t\tthis.titleMaxWidth = Type.isNumber(options.titleMaxWidth) ? options.titleMaxWidth : '';\n\n\t\tthis.filterMinWidth = Type.isNumber(options.filterMinWidth) ? options.filterMinWidth : 300;\n\t\tthis.filterMaxWidth = Type.isNumber(options.filterMaxWidth) ? options.filterMaxWidth : 748;\n\n\t\tthis.id = Type.isStringFilled(options.id) ? options.id : Text.getRandom();\n\t\tthis.toolbarContainer = options.target;\n\n\t\tif (!Type.isDomNode(this.toolbarContainer))\n\t\t{\n\t\t\tthrow new Error('BX.UI.Toolbar: \"target\" parameter is required.');\n\t\t}\n\n\t\tthis.titleContainer = this.toolbarContainer.querySelector('.ui-toolbar-title-box');\n\t\tthis.filterContainer = this.toolbarContainer.querySelector('.ui-toolbar-filter-box');\n\t\tthis.filterButtons = this.toolbarContainer.querySelector('.ui-toolbar-filter-buttons');\n\t\tthis.rightButtons = this.toolbarContainer.querySelector('.ui-toolbar-right-buttons');\n\t\tthis.afterTitleButtons = this.toolbarContainer.querySelector('.ui-toolbar-after-title-buttons');\n\t\tthis.#copyLinkButton = this.toolbarContainer.querySelector('#ui-toolbar-copy-link-button');\n\n\t\tif (this.#copyLinkButton)\n\t\t{\n\t\t\tEvent.bind(this.#copyLinkButton, 'click', this.#getClickOnCopyLinkButtonHandler());\n\t\t}\n\n\t\tif (!this.filterContainer)\n\t\t{\n\t\t\tthis.filterMinWidth = 0;\n\t\t\tthis.filterMaxWidth = 0;\n\t\t}\n\n\t\tthis.buttons = Object.create(null);\n\t\tthis.buttonIds = Type.isArray(options.buttonIds) ? options.buttonIds : [];\n\n\t\tif (this.buttonIds.length > 0)\n\t\t{\n\t\t\tthis.buttonIds.forEach((buttonId) => {\n\t\t\t\tconst button = ButtonManager.createByUniqId(buttonId);\n\t\t\t\tif (button)\n\t\t\t\t{\n\t\t\t\t\tconst container = button.getContainer();\n\t\t\t\t\tcontainer.originalWidth = container.offsetWidth;\n\n\t\t\t\t\tif (!button.getIcon() && !Type.isStringFilled(button.getDataSet().toolbarCollapsedIcon))\n\t\t\t\t\t{\n\t\t\t\t\t\tif (button.getColor() === ButtonColor.PRIMARY)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tbutton.setDataSet({\n\t\t\t\t\t\t\t\ttoolbarCollapsedIcon: ButtonIcon.ADD,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconsole.warn(\n\t\t\t\t\t\t\t\t`BX.UI.Toolbar: the button \"${button.getText()}\" doesn't have an icon for collapsed mode. `\n\t\t\t\t\t\t\t\t+ 'Use the \"data-toolbar-collapsed-icon\" attribute.',\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.buttons[buttonId] = button;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconsole.warn(`BX.UI.Toolbar: the button \"${buttonId}\" wasn't initialized.`);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.windowWidth = document.body.offsetWidth;\n\t\tthis.reduceItemsWidth();\n\n\t\tbind(window, 'resize', () => {\n\t\t\tif (this.isWindowIncreased())\n\t\t\t{\n\t\t\t\tthis.increaseItemsWidth();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.reduceItemsWidth();\n\t\t\t}\n\t\t});\n\n\t\tif (options.titleEditor?.active === true)\n\t\t{\n\t\t\tthis.#titleEditor = this.#initTitleEditor(options.titleEditor);\n\t\t}\n\t}\n\n\tgetButtons(): Object\n\t{\n\t\treturn this.buttons;\n\t}\n\n\tgetButton(id): any | null\n\t{\n\t\treturn id in this.buttons ? this.buttons[id] : null;\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\tisWindowIncreased(): boolean\n\t{\n\t\tconst previous = this.windowWidth;\n\t\tconst current = document.body.offsetWidth;\n\t\tthis.windowWidth = current;\n\n\t\treturn current > previous;\n\t}\n\n\tgetContainerSize(): number\n\t{\n\t\treturn this.toolbarContainer.offsetWidth;\n\t}\n\n\tgetInnerTotalWidth(): number\n\t{\n\t\treturn this.toolbarContainer.scrollWidth;\n\t}\n\n\treduceItemsWidth(): void\n\t{\n\t\tif (this.getInnerTotalWidth() <= this.getContainerSize())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst buttons = Object.values(this.getButtons()).reverse();\n\t\tfor (const button of buttons)\n\t\t{\n\t\t\tif (!button.getIcon() && !Type.isStringFilled(button.getDataSet()?.toolbarCollapsedIcon))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (button.isCollapsed())\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tbutton.setCollapsed(true);\n\n\t\t\tif (!button.getIcon())\n\t\t\t{\n\t\t\t\tbutton.setIcon(button.getDataSet().toolbarCollapsedIcon);\n\t\t\t}\n\n\t\t\tif (this.getInnerTotalWidth() <= this.getContainerSize())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tincreaseItemsWidth()\n\t{\n\t\tconst buttons = Object.values(this.getButtons());\n\t\tfor (const button of buttons)\n\t\t{\n\t\t\tconst item = button.getContainer();\n\t\t\tif (!button.isCollapsed())\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst newInnerWidth = this.titleMinWidth\n\t\t\t\t+ this.filterMinWidth\n\t\t\t\t+ (this.afterTitleButtons?.offsetWidth || 0)\n\t\t\t\t+ (this.filterButtons?.offsetWidth || 0)\n\t\t\t\t+ (this.rightButtons?.offsetWidth || 0)\n\t\t\t\t+ (item.originalWidth - item.offsetWidth);\n\n\t\t\tif (newInnerWidth > this.getContainerSize())\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tbutton.setCollapsed(false);\n\t\t\tif (button.getIcon() === button.getDataSet().toolbarCollapsedIcon)\n\t\t\t{\n\t\t\t\tconst icon = Type.isStringFilled(button.options.icon) ? button.options.icon : null;\n\t\t\t\tbutton.setIcon(icon);\n\t\t\t}\n\t\t}\n\t}\n\n\tsetTitle(title: string): void\n\t{\n\t\tif (!this.titleContainer)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst pagetitle = this.titleContainer.querySelector('#pagetitle');\n\t\tif (pagetitle)\n\t\t{\n\t\t\tpagetitle.textContent = title;\n\t\t}\n\t}\n\n\tgetContainer(): ?HTMLElement\n\t{\n\t\treturn this.toolbarContainer;\n\t}\n\n\tgetRightButtonsContainer(): ?HTMLElement\n\t{\n\t\treturn this.rightButtons;\n\t}\n\n\tgetTitleEditor(): ?TitleEditor\n\t{\n\t\treturn this.#titleEditor;\n\t}\n\n\t#getClickOnCopyLinkButtonHandler(): Function\n\t{\n\t\tlet popup: ?Popup = null;\n\n\t\treturn () => {\n\t\t\tif (popup !== null)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst dataLink = Dom.attr(this.#copyLinkButton, 'data-link');\n\t\t\tconst currentPageLink = window.location.href;\n\t\t\tlet linkToCopy = Type.isStringFilled(dataLink) ? dataLink : currentPageLink;\n\t\t\tlinkToCopy = Uri.removeParam(linkToCopy, ['IFRAME', 'IFRAME_TYPE']);\n\n\t\t\tconst message = Dom.attr(this.#copyLinkButton, 'data-message');\n\n\t\t\tpopup = new Popup({\n\t\t\t\tbindElement: this.#copyLinkButton,\n\t\t\t\tangle: true,\n\t\t\t\tdarkMode: true,\n\t\t\t\tcontent: message,\n\t\t\t\tautoHide: true,\n\t\t\t\tcacheable: false,\n\t\t\t});\n\n\t\t\tpopup.setOffset({\n\t\t\t\toffsetLeft: Dom.getPosition(this.#copyLinkButton).width / 2,\n\t\t\t});\n\n\t\t\tpopup.show();\n\n\t\t\tBX.clipboard.copy(linkToCopy);\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tpopup = null;\n\t\t\t}, 1000);\n\t\t};\n\t}\n\n\t#initTitleEditor(options: ?TitleEditorOptions): TitleEditor\n\t{\n\t\tconst titleEditorOptions = Type.isPlainObject(options) ? options : {};\n\t\tconst titleEditor = new TitleEditor({ ...titleEditorOptions });\n\n\t\ttitleEditor.subscribe(TitleEditorEvents.beforeStartEditing, (editorEvent: BaseEvent) => {\n\t\t\tconst toolbarEvent: BaseEvent = new Event.BaseEvent();\n\n\t\t\tthis.emit(TitleEditorEvents.beforeStartEditing, toolbarEvent);\n\t\t\tif (toolbarEvent.isDefaultPrevented())\n\t\t\t{\n\t\t\t\teditorEvent.preventDefault();\n\t\t\t}\n\t\t});\n\n\t\ttitleEditor.subscribe(TitleEditorEvents.startEditing, () => {\n\t\t\tthis.emit(TitleEditorEvents.startEditing);\n\t\t});\n\n\t\ttitleEditor.subscribe(TitleEditorEvents.finishEditing, (event: BaseEvent) => {\n\t\t\tconst updatedTitle = event.getData().updatedTitle;\n\n\t\t\tthis.emit(TitleEditorEvents.finishEditing, {\n\t\t\t\tupdatedTitle,\n\t\t\t});\n\t\t});\n\n\t\treturn titleEditor;\n\t}\n}\n","import { Toolbar, type ToolbarOptions } from './toolbar';\n\nclass Manager\n{\n\ttoolbars: {[id: string]: Toolbar };\n\n\tconstructor()\n\t{\n\t\tthis.toolbars = {};\n\t}\n\n\tcreate(options: ToolbarOptions): Toolbar\n\t{\n\t\tconst toolbar = new Toolbar(options);\n\n\t\tif (this.get(toolbar.getId()))\n\t\t{\n\t\t\tthrow new Error(\"The toolbar instance with the same 'id' already exists.\");\n\t\t}\n\n\t\tthis.toolbars[toolbar.getId()] = toolbar;\n\n\t\treturn toolbar;\n\t}\n\n\tgetDefaultToolbar(): Toolbar | null\n\t{\n\t\treturn this.get('default-toolbar');\n\t}\n\n\tget(id: string): Toolbar | null\n\t{\n\t\treturn id in this.toolbars ? this.toolbars[id] : null;\n\t}\n}\n\nexport const ToolbarManager = new Manager();\n"],"names":["TitleEditorEvents","beforeStartEditing","startEditing","finishEditing","TitleEditor","Event","EventEmitter","constructor","options","setEventNamespace","enable","isDisable","changeDisplay","textContent","disable","onKeyUp","event","key","finishEdit","preventDefault","startEdit","BaseEvent","emit","isDefaultPrevented","value","Dom","addClass","focus","removeClass","updatedTitle","cancelEdit","node","isShow","displayValue","style","params","document","getElementById","querySelector","defaultTitle","bind","relatedTarget","disabled","ToolbarStar","initialized","currentPageInMenu","starContNode","ready","init","subscribe","currentFullPath","attr","Type","isStringFilled","location","pathname","search","Uri","removeParam","top","BX","addCustomEvent","processMenuItemData","onStandardItemChangedSuccess","onCustomEvent","context","window","isObjectLike","title","Loc","getMessage","hasClass","isDomNode","showMessage","pageTitle","innerText","titleTemplate","getAttribute","replace","pageLink","isActive","isBoolean","message","popup","PopupWindowManager","create","content","darkMode","offsetTop","offsetLeft","angle","autoHide","events","onPopupClose","destroy","show","setTimeout","ToolbarEvents","Toolbar","titleMinWidth","isNumber","titleMaxWidth","filterMinWidth","filterMaxWidth","id","Text","getRandom","toolbarContainer","target","Error","titleContainer","filterContainer","filterButtons","rightButtons","afterTitleButtons","buttons","Object","buttonIds","isArray","length","forEach","buttonId","button","ButtonManager","createByUniqId","container","getContainer","originalWidth","offsetWidth","getIcon","getDataSet","toolbarCollapsedIcon","getColor","ButtonColor","PRIMARY","setDataSet","ButtonIcon","ADD","console","warn","getText","windowWidth","body","reduceItemsWidth","isWindowIncreased","increaseItemsWidth","titleEditor","active","getButtons","getButton","getId","previous","current","getContainerSize","getInnerTotalWidth","scrollWidth","values","reverse","isCollapsed","setCollapsed","setIcon","item","newInnerWidth","icon","setTitle","pagetitle","getRightButtonsContainer","getTitleEditor","dataLink","currentPageLink","href","linkToCopy","Popup","bindElement","cacheable","setOffset","getPosition","width","clipboard","copy","titleEditorOptions","isPlainObject","editorEvent","toolbarEvent","getData","Star","Manager","toolbars","toolbar","get","getDefaultToolbar","ToolbarManager"],"mappings":";;;;;CASO,MAAMA,iBAAiB,GAAG;GAChCC,kBAAkB,EAAE,oBAAoB;GACxCC,YAAY,EAAE,cAAc;GAC5BC,aAAa,EAAE;CAChB,CAAC;CAAC;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;AAEF,CAAO,MAAMC,WAAW,SAASC,eAAK,CAACC,YAAY,CACnD;;;;;GAeCC,WAAW,CAACC,OAA2B,EACvC;KACC,KAAK,CAACA,OAAO,CAAC;KAAC;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA,OAJG;;KAKlB,IAAI,CAACC,iBAAiB,CAAC,wBAAwB,CAAC;KAChD,4CAAI,gBAAOD,OAAO;;GAqDnBE,MAAM,CAACC,SAAkB,GAAG,KAAK,EACjC;KACC,IAAI,yCAAC,IAAI,mBAAQ,EACjB;OACC;;KAGD,IAAI,CAACC,aAAa,yCAAC,IAAI,+CAAuBD,SAAS,KAAK,KAAK,CAAC;;;;;;KAMlE,4CAAI,0BAAYE,WAAW,2CAAG,IAAI,+BAAc;;GAGjDC,OAAO,GACP;KACC,IAAI,CAACJ,MAAM,CAAC,IAAI,CAAC;;;;;;;;GAQlBK,OAAO,CAACC,KAAoB,EAC5B;KACC,IAAIA,KAAK,CAACC,GAAG,KAAK,OAAO,EACzB;OACC,IAAI,CAACC,UAAU,EAAE;OACjBF,KAAK,CAACG,cAAc,EAAE;OAEtB,OAAO,KAAK;;KAGb,OAAO,IAAI;;GAGZC,SAAS,GACT;;;KAGC,MAAMJ,KAAK,GAAG,IAAIX,eAAK,CAACgB,SAAS,EAAE;KACnC,IAAI,CAACC,IAAI,CAACtB,iBAAiB,CAACC,kBAAkB,EAAEe,KAAK,CAAC;KACtD,IAAIA,KAAK,CAACO,kBAAkB,EAAE,EAC9B;OACC;;KAGD,4CAAI,0BAAYC,KAAK,GAAG,4CAAI,0BAAYX,WAAW;KACnD,IAAI,CAACD,aAAa,yCAAC,IAAI,2BAAa,KAAK,CAAC;KAC1C,IAAI,CAACA,aAAa,yCAAC,IAAI,+CAAuB,KAAK,CAAC;KACpD,IAAI,CAACA,aAAa,yCAAC,IAAI,2BAAa,IAAI,CAAC;KACzC,IAAI,CAACA,aAAa,yCAAC,IAAI,2DAA6B,KAAK,CAAC;KAC1Da,aAAG,CAACC,QAAQ,yCAAC,IAAI,uEAAmC,QAAQ,CAAC;KAC7DD,aAAG,CAACC,QAAQ,yCAAC,IAAI,+BAAe,iBAAiB,CAAC;KAElD,4CAAI,0BAAYC,KAAK,EAAE;KAEvB,IAAI,CAACL,IAAI,CAACtB,iBAAiB,CAACE,YAAY,CAAC;;GAG1CgB,UAAU,GACV;;KAEC,4CAAI,0BAAYL,WAAW,GAAG,4CAAI,0BAAYW,KAAK;KACnD,IAAI,CAACZ,aAAa,yCAAC,IAAI,2BAAa,KAAK,CAAC;KAC1C,IAAI,CAACA,aAAa,yCAAC,IAAI,+CAAuB,IAAI,CAAC;KACnD,IAAI,CAACA,aAAa,yCAAC,IAAI,2BAAa,IAAI,CAAC;KACzC,IAAI,CAACA,aAAa,yCAAC,IAAI,2DAA6B,IAAI,CAAC;KACzDa,aAAG,CAACG,WAAW,yCAAC,IAAI,uEAAmC,QAAQ,CAAC;KAChEH,aAAG,CAACG,WAAW,yCAAC,IAAI,+BAAe,iBAAiB,CAAC;KAErD,IAAI,CAACN,IAAI,CAACtB,iBAAiB,CAACG,aAAa,EAAE;OAC1C0B,YAAY,EAAE,4CAAI,0BAAYL;MAC9B,CAAC;;GAGHM,UAAU,GACV;KACC,IAAI,CAAClB,aAAa,yCAAC,IAAI,2BAAa,KAAK,CAAC;KAC1C,IAAI,CAACA,aAAa,yCAAC,IAAI,+CAAuB,IAAI,CAAC;KACnD,IAAI,CAACA,aAAa,yCAAC,IAAI,2BAAa,IAAI,CAAC;KACzC,IAAI,CAACA,aAAa,yCAAC,IAAI,2DAA6B,IAAI,CAAC;KACzDa,aAAG,CAACG,WAAW,yCAAC,IAAI,uEAAmC,QAAQ,CAAC;KAChEH,aAAG,CAACG,WAAW,yCAAC,IAAI,+BAAe,iBAAiB,CAAC;;GAGtDhB,aAAa,CAACmB,IAAiB,EAAEC,MAAe,EAChD;KACC,MAAMC,YAAY,GAAGD,MAAM,GAAG,EAAE,GAAG,MAAM;KAEzCP,aAAG,CAACS,KAAK,CAACH,IAAI,EAAE,SAAS,EAAEE,YAAY,CAAC;KAExC,OAAOA,YAAY;;CAErB;CAAC,gBAnJME,MAA0B,EAChC;;;;;;;;;;;;;;GAcC,4CAAI,gCAAgBC,QAAQ,CAACC,cAAc,CAAC,oBAAoB,CAAC;GACjE,4CAAI,4BAAcD,QAAQ,CAACE,aAAa,CAAC,qBAAqB,CAAC;GAC/D,4CAAI,4BAAcF,QAAQ,CAACE,aAAa,CAAC,8BAA8B,CAAC;GACxE,4CAAI,gDAAwBF,QAAQ,CAACE,aAAa,CAAC,+BAA+B,CAAC;GACnF,4CAAI,wEAAoCF,QAAQ,CAACC,cAAc,CAAC,sCAAsC,CAAC;GACvG,4CAAI,wCAAoBD,QAAQ,CAACC,cAAc,CAAC,8BAA8B,CAAC;GAC/E,4CAAI,oDAA0BD,QAAQ,CAACC,cAAc,CAAC,qCAAqC,CAAC;GAC5F,4CAAI,4DAA8BD,QAAQ,CAACC,cAAc,CAAC,mCAAmC,CAAC;GAC9F,4CAAI,kCAAiB,4CAAI,0BAAYxB,WAAW;GAChD,4CAAI,kCAAiBsB,MAAM,CAACI,YAAY;;;GAGxCC,cAAI,yCAAC,IAAI,+CAAuB,OAAO,EAAE,IAAI,CAACpB,SAAS,CAACoB,IAAI,CAAC,IAAI,CAAC,CAAC;GACnEA,cAAI,yCAAC,IAAI,2BAAa,OAAO,EAAE,IAAI,CAACzB,OAAO,CAACyB,IAAI,CAAC,IAAI,CAAC,CAAC;GACvDA,cAAI,yCAAC,IAAI,2BAAa,MAAM,EAAGxB,KAAK,IAAK;KACxC,IAAIA,KAAK,CAACyB,aAAa,6CAAK,IAAI,iDAAuB,EACvD;OACC,IAAI,CAACX,UAAU,EAAE;OAEjB;;KAGD,IAAI,CAACZ,UAAU,EAAE;IACjB,CAAC;GACFsB,cAAI,yCAAC,IAAI,uCAAmB,OAAO,EAAE,IAAI,CAACtB,UAAU,CAACsB,IAAI,CAAC,IAAI,CAAC,CAAC;GAChEA,cAAI,yCAAC,IAAI,mDAAyB,OAAO,EAAE,IAAI,CAACV,UAAU,CAACU,IAAI,CAAC,IAAI,CAAC,CAAC;GAEtE,4CAAI,sBAAW,IAAI;GAEnB,IAAI,CAACL,MAAM,CAACO,QAAQ,EACpB;KACC,IAAI,CAAChC,MAAM,EAAE;;CAEf;;CCnFM,MAAMiC,WAAW,CACxB;GAKCpC,WAAW,GACX;KACC,IAAI,CAACqC,WAAW,GAAG,KAAK;KACxB,IAAI,CAACC,iBAAiB,GAAG,KAAK;KAC9B,IAAI,CAACC,YAAY,GAAG,IAAI;KAExBC,eAAK,CAAC,MAAM,IAAI,CAACC,IAAI,EAAE,CAAC;KAExB3C,eAAK,CAACC,YAAY,CAAC2C,SAAS,CAAC,sBAAsB,EAAE,MAAM;OAC1D,IAAI,CAACD,IAAI,EAAE;MACX,CAAC;;;;GAIHA,IAAI,GACJ;KACC,IAAI,CAACF,YAAY,GAAGV,QAAQ,CAACC,cAAc,CAAC,eAAe,CAAC;KAC5D,IAAI,CAAC,IAAI,CAACS,YAAY,IAAI,IAAI,CAACF,WAAW,EAC1C;OACC,OAAO,KAAK;;KAGb,IAAI,CAACA,WAAW,GAAG,IAAI;KAEvB,IAAIM,eAAe,GAAGzB,aAAG,CAAC0B,IAAI,CAAC,IAAI,CAACL,YAAY,EAAE,aAAa,CAAC;KAChE,IAAI,CAACM,cAAI,CAACC,cAAc,CAACH,eAAe,CAAC,EACzC;OACCA,eAAe,GAAGd,QAAQ,CAACkB,QAAQ,CAACC,QAAQ,GAAGnB,QAAQ,CAACkB,QAAQ,CAACE,MAAM;;KAExEN,eAAe,GAAGO,aAAG,CAACC,WAAW,CAACR,eAAe,EAAE,CAAC,QAAQ,EAAE,aAAa,CAAC,CAAC;KAE7ES,GAAG,CAACC,EAAE,CAACC,cAAc,CAAC,8CAA8C,EAAG1B,MAAM,IAAK;OACjF,IAAI,CAAC2B,mBAAmB,CAAC3B,MAAM,CAAC;MAChC,CAAC;KACFwB,GAAG,CAACC,EAAE,CAACC,cAAc,CAAC,wDAAwD,EAAG1B,MAAM,IAAK;OAC3F,IAAI,CAAC4B,4BAA4B,CAAC5B,MAAM,CAAC;MACzC,CAAC;KAEFwB,GAAG,CAACC,EAAE,CAACI,aAAa,CAAC,kCAAkC,EAAE,CACxD;OACCd,eAAe;OACfe,OAAO,EAAEC;MACT,CACD,CAAC;KAEF,OAAO,IAAI;;GAGZJ,mBAAmB,CAAC3B,MAAM,EAC1B;KACC,IAAIA,MAAM,CAAC8B,OAAO,IAAI9B,MAAM,CAAC8B,OAAO,KAAKC,MAAM,EAC/C;OACC;;KAGD,IAAI,CAACrB,iBAAiB,GAAGV,MAAM,CAACU,iBAAiB;KAEjD,IAAIO,cAAI,CAACe,YAAY,CAAChC,MAAM,CAACU,iBAAiB,CAAC,EAC/C;OACCpB,aAAG,CAACC,QAAQ,CAAC,IAAI,CAACoB,YAAY,EAAE,wBAAwB,CAAC;;KAG1D,IAAI,CAACA,YAAY,CAACsB,KAAK,GAAGC,aAAG,CAACC,UAAU,CACvC7C,aAAG,CAAC8C,QAAQ,CAAC,IAAI,CAACzB,YAAY,EAAE,wBAAwB,CAAC,GACtD,uCAAuC,GACvC,kCAAkC,CACrC;;;KAGD,IAAIM,cAAI,CAACoB,SAAS,CAAC,IAAI,CAAC3B,iBAAiB,CAAC,IACtCpB,aAAG,CAAC0B,IAAI,CAAC,IAAI,CAACN,iBAAiB,EAAE,WAAW,CAAC,KAAK,UAAU,EAEhE;OACC,IAAI,CAACC,YAAY,CAACsB,KAAK,GAAGC,aAAG,CAACC,UAAU,CAAC,oCAAoC,CAAC;OAC9E9B,cAAI,CAAC,IAAI,CAACM,YAAY,EAAE,OAAO,EAAE,MAAM;SACtC,IAAI,CAAC2B,WAAW,CAACJ,aAAG,CAACC,UAAU,CAAC,iDAAiD,CAAC,CAAC;QACnF,CAAC;OAEF,OAAO,IAAI;;;;KAIZ9B,cAAI,CAAC,IAAI,CAACM,YAAY,EAAE,OAAO,EAAE,MAAM;OAAA;OACtC,IAAI4B,SAAS,GAAG,0BAAAtC,QAAQ,CAACC,cAAc,CAAC,WAAW,CAAC,qBAApC,sBAAsCsC,SAAS,KAAI,EAAE;OACrE,MAAMC,aAAa,GAAG,IAAI,CAAC9B,YAAY,CAAC+B,YAAY,CAAC,wBAAwB,CAAC;OAC9E,IAAIzB,cAAI,CAACC,cAAc,CAACuB,aAAa,CAAC,EACtC;SACCF,SAAS,GAAGE,aAAa,CAACE,OAAO,CAAC,eAAe,EAAEJ,SAAS,CAAC;;OAG9D,IAAIK,QAAQ,GAAG,IAAI,CAACjC,YAAY,CAAC+B,YAAY,CAAC,aAAa,CAAC;OAC5D,IAAI,CAACzB,cAAI,CAACC,cAAc,CAAC0B,QAAQ,CAAC,EAClC;SACCA,QAAQ,GAAG3C,QAAQ,CAACkB,QAAQ,CAACC,QAAQ,GAAGnB,QAAQ,CAACkB,QAAQ,CAACE,MAAM;;OAEjEuB,QAAQ,GAAGtB,aAAG,CAACC,WAAW,CAACqB,QAAQ,EAAE,CAAC,QAAQ,EAAE,aAAa,CAAC,CAAC;OAE/DpB,GAAG,CAACC,EAAE,CAACI,aAAa,CAAC,wBAAwB,EAAE,CAC9C;SACCgB,QAAQ,EAAEvD,aAAG,CAAC8C,QAAQ,CAAC,IAAI,CAACzB,YAAY,EAAE,wBAAwB,CAAC;SACnEmB,OAAO,EAAEC,MAAM;SACfQ,SAAS;SACTK;QACA,CACD,CAAC;MACF,CAAC;;GAGHhB,4BAA4B,CAAC5B,MAAM,EACnC;KACC,IAAI,CAACiB,cAAI,CAAC6B,SAAS,CAAC9C,MAAM,CAAC6C,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAClC,YAAY,IAAKX,MAAM,CAAC8B,OAAO,IAAI9B,MAAM,CAAC8B,OAAO,KAAKC,MAAO,EAC3G;OACC;;KAGD,IAAI/B,MAAM,CAAC6C,QAAQ,EACnB;OACC,IAAI,CAACP,WAAW,CAACJ,aAAG,CAACC,UAAU,CAAC,mCAAmC,CAAC,CAAC;OACrE,IAAI,CAACxB,YAAY,CAACsB,KAAK,GAAGC,aAAG,CAACC,UAAU,CAAC,uCAAuC,CAAC;OACjF7C,aAAG,CAACC,QAAQ,CAAC,IAAI,CAACoB,YAAY,EAAE,wBAAwB,CAAC;MACzD,MAED;OACC,IAAI,CAAC2B,WAAW,CAACJ,aAAG,CAACC,UAAU,CAAC,uCAAuC,CAAC,CAAC;OACzE,IAAI,CAACxB,YAAY,CAACsB,KAAK,GAAGC,aAAG,CAACC,UAAU,CAAC,kCAAkC,CAAC;OAC5E7C,aAAG,CAACG,WAAW,CAAC,IAAI,CAACkB,YAAY,EAAE,wBAAwB,CAAC;;;GAI9D2B,WAAW,CAACS,OAAO,EAAE;KACpB,IAAIC,KAAK,GAAGC,6BAAkB,CAACC,MAAM,CAAC,mBAAmB,EAAE,IAAI,CAACvC,YAAY,EAAE;OAC7EwC,OAAO,EAAEJ,OAAO;OAChBK,QAAQ,EAAE,IAAI;OACdC,SAAS,EAAE,CAAC;OACZC,UAAU,EAAE,CAAC;OACbC,KAAK,EAAE,IAAI;OACXC,QAAQ,EAAE,IAAI;OACdC,MAAM,EAAE;SACPC,YAAY,EAAE,MAAM;WACnB,IAAIV,KAAK,EACT;aACCA,KAAK,CAACW,OAAO,EAAE;aACfX,KAAK,GAAG,IAAI;;;;MAIf,CAAC;KAEFA,KAAK,CAACY,IAAI,EAAE;KAEZC,UAAU,CAAC,MAAM;OAChB,IAAIb,KAAK,EACT;SACCA,KAAK,CAACW,OAAO,EAAE;SACfX,KAAK,GAAG,IAAI;;MAEb,EAAE,IAAI,CAAC;;CAEV;;OCpJac,aAAa,GAAG;GAC5BhG,kBAAkB,EAAE,oBAAoB;GACxCC,YAAY,EAAE,cAAc;GAC5BC,aAAa,EAAE;CAChB,CAAC;CAAC;CAAA;CAAA;CAAA;AAEF,CAAO,MAAM+F,OAAO,SAAS7F,eAAK,CAACC,YAAY,CAC/C;;GAiBCC,WAAW,CAACC,QAAuB,GAAG,EAAE,EACxC;KAAA;KACC,KAAK,CAACA,QAAO,CAAC;KAAC;OAAA;;KAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KACf,IAAI,CAACC,iBAAiB,CAAC,eAAe,CAAC;KACvC,IAAI,CAAC0F,aAAa,GAAG/C,cAAI,CAACgD,QAAQ,CAAC5F,QAAO,CAAC2F,aAAa,CAAC,GAAG3F,QAAO,CAAC2F,aAAa,GAAG,GAAG;KACvF,IAAI,CAACE,aAAa,GAAGjD,cAAI,CAACgD,QAAQ,CAAC5F,QAAO,CAAC6F,aAAa,CAAC,GAAG7F,QAAO,CAAC6F,aAAa,GAAG,EAAE;KAEtF,IAAI,CAACC,cAAc,GAAGlD,cAAI,CAACgD,QAAQ,CAAC5F,QAAO,CAAC8F,cAAc,CAAC,GAAG9F,QAAO,CAAC8F,cAAc,GAAG,GAAG;KAC1F,IAAI,CAACC,cAAc,GAAGnD,cAAI,CAACgD,QAAQ,CAAC5F,QAAO,CAAC+F,cAAc,CAAC,GAAG/F,QAAO,CAAC+F,cAAc,GAAG,GAAG;KAE1F,IAAI,CAACC,EAAE,GAAGpD,cAAI,CAACC,cAAc,CAAC7C,QAAO,CAACgG,EAAE,CAAC,GAAGhG,QAAO,CAACgG,EAAE,GAAGC,cAAI,CAACC,SAAS,EAAE;KACzE,IAAI,CAACC,gBAAgB,GAAGnG,QAAO,CAACoG,MAAM;KAEtC,IAAI,CAACxD,cAAI,CAACoB,SAAS,CAAC,IAAI,CAACmC,gBAAgB,CAAC,EAC1C;OACC,MAAM,IAAIE,KAAK,CAAC,gDAAgD,CAAC;;KAGlE,IAAI,CAACC,cAAc,GAAG,IAAI,CAACH,gBAAgB,CAACrE,aAAa,CAAC,uBAAuB,CAAC;KAClF,IAAI,CAACyE,eAAe,GAAG,IAAI,CAACJ,gBAAgB,CAACrE,aAAa,CAAC,wBAAwB,CAAC;KACpF,IAAI,CAAC0E,aAAa,GAAG,IAAI,CAACL,gBAAgB,CAACrE,aAAa,CAAC,4BAA4B,CAAC;KACtF,IAAI,CAAC2E,YAAY,GAAG,IAAI,CAACN,gBAAgB,CAACrE,aAAa,CAAC,2BAA2B,CAAC;KACpF,IAAI,CAAC4E,iBAAiB,GAAG,IAAI,CAACP,gBAAgB,CAACrE,aAAa,CAAC,iCAAiC,CAAC;KAC/F,4CAAI,sCAAmB,IAAI,CAACqE,gBAAgB,CAACrE,aAAa,CAAC,8BAA8B,CAAC;KAE1F,4CAAI,IAAI,qCACR;OACCjC,eAAK,CAACmC,IAAI,yCAAC,IAAI,qCAAkB,OAAO,0CAAE,IAAI,wEAAoC;;KAGnF,IAAI,CAAC,IAAI,CAACuE,eAAe,EACzB;OACC,IAAI,CAACT,cAAc,GAAG,CAAC;OACvB,IAAI,CAACC,cAAc,GAAG,CAAC;;KAGxB,IAAI,CAACY,OAAO,GAAGC,MAAM,CAAC/B,MAAM,CAAC,IAAI,CAAC;KAClC,IAAI,CAACgC,SAAS,GAAGjE,cAAI,CAACkE,OAAO,CAAC9G,QAAO,CAAC6G,SAAS,CAAC,GAAG7G,QAAO,CAAC6G,SAAS,GAAG,EAAE;KAEzE,IAAI,IAAI,CAACA,SAAS,CAACE,MAAM,GAAG,CAAC,EAC7B;OACC,IAAI,CAACF,SAAS,CAACG,OAAO,CAAEC,QAAQ,IAAK;SACpC,MAAMC,MAAM,GAAGC,wBAAa,CAACC,cAAc,CAACH,QAAQ,CAAC;SACrD,IAAIC,MAAM,EACV;WACC,MAAMG,SAAS,GAAGH,MAAM,CAACI,YAAY,EAAE;WACvCD,SAAS,CAACE,aAAa,GAAGF,SAAS,CAACG,WAAW;WAE/C,IAAI,CAACN,MAAM,CAACO,OAAO,EAAE,IAAI,CAAC7E,cAAI,CAACC,cAAc,CAACqE,MAAM,CAACQ,UAAU,EAAE,CAACC,oBAAoB,CAAC,EACvF;aACC,IAAIT,MAAM,CAACU,QAAQ,EAAE,KAAKC,sBAAW,CAACC,OAAO,EAC7C;eACCZ,MAAM,CAACa,UAAU,CAAC;iBACjBJ,oBAAoB,EAAEK,qBAAU,CAACC;gBACjC,CAAC;cACF,MAED;eACCC,OAAO,CAACC,IAAI,CACV,8BAA6BjB,MAAM,CAACkB,OAAO,EAAG,6CAA4C,GACzF,kDAAkD,CACpD;;;WAIH,IAAI,CAACzB,OAAO,CAACM,QAAQ,CAAC,GAAGC,MAAM;UAC/B,MAED;WACCgB,OAAO,CAACC,IAAI,CAAE,8BAA6BlB,QAAS,uBAAsB,CAAC;;QAE5E,CAAC;;KAGH,IAAI,CAACoB,WAAW,GAAGzG,QAAQ,CAAC0G,IAAI,CAACd,WAAW;KAC5C,IAAI,CAACe,gBAAgB,EAAE;KAEvBvG,cAAI,CAAC0B,MAAM,EAAE,QAAQ,EAAE,MAAM;OAC5B,IAAI,IAAI,CAAC8E,iBAAiB,EAAE,EAC5B;SACC,IAAI,CAACC,kBAAkB,EAAE;QACzB,MAED;SACC,IAAI,CAACF,gBAAgB,EAAE;;MAExB,CAAC;KAEF,IAAI,yBAAAvI,QAAO,CAAC0I,WAAW,qBAAnB,qBAAqBC,MAAM,MAAK,IAAI,EACxC;OACC,4CAAI,wEAAgB,IAAI,sCAAkB3I,QAAO,CAAC0I,WAAW,CAAC;;;GAIhEE,UAAU,GACV;KACC,OAAO,IAAI,CAACjC,OAAO;;GAGpBkC,SAAS,CAAC7C,EAAE,EACZ;KACC,OAAOA,EAAE,IAAI,IAAI,CAACW,OAAO,GAAG,IAAI,CAACA,OAAO,CAACX,EAAE,CAAC,GAAG,IAAI;;GAGpD8C,KAAK,GACL;KACC,OAAO,IAAI,CAAC9C,EAAE;;GAGfwC,iBAAiB,GACjB;KACC,MAAMO,QAAQ,GAAG,IAAI,CAACV,WAAW;KACjC,MAAMW,OAAO,GAAGpH,QAAQ,CAAC0G,IAAI,CAACd,WAAW;KACzC,IAAI,CAACa,WAAW,GAAGW,OAAO;KAE1B,OAAOA,OAAO,GAAGD,QAAQ;;GAG1BE,gBAAgB,GAChB;KACC,OAAO,IAAI,CAAC9C,gBAAgB,CAACqB,WAAW;;GAGzC0B,kBAAkB,GAClB;KACC,OAAO,IAAI,CAAC/C,gBAAgB,CAACgD,WAAW;;GAGzCZ,gBAAgB,GAChB;KACC,IAAI,IAAI,CAACW,kBAAkB,EAAE,IAAI,IAAI,CAACD,gBAAgB,EAAE,EACxD;OACC;;KAGD,MAAMtC,OAAO,GAAGC,MAAM,CAACwC,MAAM,CAAC,IAAI,CAACR,UAAU,EAAE,CAAC,CAACS,OAAO,EAAE;KAC1D,KAAK,MAAMnC,MAAM,IAAIP,OAAO,EAC5B;OAAA;OACC,IAAI,CAACO,MAAM,CAACO,OAAO,EAAE,IAAI,CAAC7E,cAAI,CAACC,cAAc,uBAACqE,MAAM,CAACQ,UAAU,EAAE,qBAAnB,mBAAqBC,oBAAoB,CAAC,EACxF;SACC;;OAGD,IAAIT,MAAM,CAACoC,WAAW,EAAE,EACxB;SACC;;OAGDpC,MAAM,CAACqC,YAAY,CAAC,IAAI,CAAC;OAEzB,IAAI,CAACrC,MAAM,CAACO,OAAO,EAAE,EACrB;SACCP,MAAM,CAACsC,OAAO,CAACtC,MAAM,CAACQ,UAAU,EAAE,CAACC,oBAAoB,CAAC;;OAGzD,IAAI,IAAI,CAACuB,kBAAkB,EAAE,IAAI,IAAI,CAACD,gBAAgB,EAAE,EACxD;SACC;;;;GAKHR,kBAAkB,GAClB;KACC,MAAM9B,OAAO,GAAGC,MAAM,CAACwC,MAAM,CAAC,IAAI,CAACR,UAAU,EAAE,CAAC;KAChD,KAAK,MAAM1B,MAAM,IAAIP,OAAO,EAC5B;OAAA;OACC,MAAM8C,IAAI,GAAGvC,MAAM,CAACI,YAAY,EAAE;OAClC,IAAI,CAACJ,MAAM,CAACoC,WAAW,EAAE,EACzB;SACC;;OAGD,MAAMI,aAAa,GAAG,IAAI,CAAC/D,aAAa,GACrC,IAAI,CAACG,cAAc,IAClB,8BAAI,CAACY,iBAAiB,qBAAtB,sBAAwBc,WAAW,KAAI,CAAC,CAAC,IACzC,4BAAI,CAAChB,aAAa,qBAAlB,oBAAoBgB,WAAW,KAAI,CAAC,CAAC,IACrC,2BAAI,CAACf,YAAY,qBAAjB,mBAAmBe,WAAW,KAAI,CAAC,CAAC,IACpCiC,IAAI,CAAClC,aAAa,GAAGkC,IAAI,CAACjC,WAAW,CAAC;OAE1C,IAAIkC,aAAa,GAAG,IAAI,CAACT,gBAAgB,EAAE,EAC3C;SACC;;OAGD/B,MAAM,CAACqC,YAAY,CAAC,KAAK,CAAC;OAC1B,IAAIrC,MAAM,CAACO,OAAO,EAAE,KAAKP,MAAM,CAACQ,UAAU,EAAE,CAACC,oBAAoB,EACjE;SACC,MAAMgC,IAAI,GAAG/G,cAAI,CAACC,cAAc,CAACqE,MAAM,CAAClH,OAAO,CAAC2J,IAAI,CAAC,GAAGzC,MAAM,CAAClH,OAAO,CAAC2J,IAAI,GAAG,IAAI;SAClFzC,MAAM,CAACsC,OAAO,CAACG,IAAI,CAAC;;;;GAKvBC,QAAQ,CAAChG,KAAa,EACtB;KACC,IAAI,CAAC,IAAI,CAAC0C,cAAc,EACxB;OACC;;KAGD,MAAMuD,SAAS,GAAG,IAAI,CAACvD,cAAc,CAACxE,aAAa,CAAC,YAAY,CAAC;KACjE,IAAI+H,SAAS,EACb;OACCA,SAAS,CAACxJ,WAAW,GAAGuD,KAAK;;;GAI/B0D,YAAY,GACZ;KACC,OAAO,IAAI,CAACnB,gBAAgB;;GAG7B2D,wBAAwB,GACxB;KACC,OAAO,IAAI,CAACrD,YAAY;;GAGzBsD,cAAc,GACd;KACC,+CAAO,IAAI;;CAwEb;CAAC,6CApEA;GACC,IAAIpF,KAAa,GAAG,IAAI;GAExB,OAAO,MAAM;KACZ,IAAIA,KAAK,KAAK,IAAI,EAClB;OACC;;KAGD,MAAMqF,QAAQ,GAAG/I,aAAG,CAAC0B,IAAI,yCAAC,IAAI,qCAAkB,WAAW,CAAC;KAC5D,MAAMsH,eAAe,GAAGvG,MAAM,CAACZ,QAAQ,CAACoH,IAAI;KAC5C,IAAIC,UAAU,GAAGvH,cAAI,CAACC,cAAc,CAACmH,QAAQ,CAAC,GAAGA,QAAQ,GAAGC,eAAe;KAC3EE,UAAU,GAAGlH,aAAG,CAACC,WAAW,CAACiH,UAAU,EAAE,CAAC,QAAQ,EAAE,aAAa,CAAC,CAAC;KAEnE,MAAMzF,OAAO,GAAGzD,aAAG,CAAC0B,IAAI,yCAAC,IAAI,qCAAkB,cAAc,CAAC;KAE9DgC,KAAK,GAAG,IAAIyF,gBAAK,CAAC;OACjBC,WAAW,0CAAE,IAAI,mCAAgB;OACjCnF,KAAK,EAAE,IAAI;OACXH,QAAQ,EAAE,IAAI;OACdD,OAAO,EAAEJ,OAAO;OAChBS,QAAQ,EAAE,IAAI;OACdmF,SAAS,EAAE;MACX,CAAC;KAEF3F,KAAK,CAAC4F,SAAS,CAAC;OACftF,UAAU,EAAEhE,aAAG,CAACuJ,WAAW,yCAAC,IAAI,oCAAiB,CAACC,KAAK,GAAG;MAC1D,CAAC;KAEF9F,KAAK,CAACY,IAAI,EAAE;KAEZnC,EAAE,CAACsH,SAAS,CAACC,IAAI,CAACR,UAAU,CAAC;KAE7B3E,UAAU,CAAC,MAAM;OAChBb,KAAK,GAAG,IAAI;MACZ,EAAE,IAAI,CAAC;IACR;CACF;CAAC,2BAEgB3E,OAA4B,EAC7C;GACC,MAAM4K,kBAAkB,GAAGhI,cAAI,CAACiI,aAAa,CAAC7K,OAAO,CAAC,GAAGA,OAAO,GAAG,EAAE;GACrE,MAAM0I,WAAW,GAAG,IAAI9I,WAAW,CAAC;KAAE,GAAGgL;IAAoB,CAAC;GAE9DlC,WAAW,CAACjG,SAAS,CAACjD,iBAAiB,CAACC,kBAAkB,EAAGqL,WAAsB,IAAK;KACvF,MAAMC,YAAuB,GAAG,IAAIlL,eAAK,CAACgB,SAAS,EAAE;KAErD,IAAI,CAACC,IAAI,CAACtB,iBAAiB,CAACC,kBAAkB,EAAEsL,YAAY,CAAC;KAC7D,IAAIA,YAAY,CAAChK,kBAAkB,EAAE,EACrC;OACC+J,WAAW,CAACnK,cAAc,EAAE;;IAE7B,CAAC;GAEF+H,WAAW,CAACjG,SAAS,CAACjD,iBAAiB,CAACE,YAAY,EAAE,MAAM;KAC3D,IAAI,CAACoB,IAAI,CAACtB,iBAAiB,CAACE,YAAY,CAAC;IACzC,CAAC;GAEFgJ,WAAW,CAACjG,SAAS,CAACjD,iBAAiB,CAACG,aAAa,EAAGa,KAAgB,IAAK;KAC5E,MAAMa,YAAY,GAAGb,KAAK,CAACwK,OAAO,EAAE,CAAC3J,YAAY;KAEjD,IAAI,CAACP,IAAI,CAACtB,iBAAiB,CAACG,aAAa,EAAE;OAC1C0B;MACA,CAAC;IACF,CAAC;GAEF,OAAOqH,WAAW;CACnB;CArTYhD,OAAO,CAcZ9F,WAAW,GAAGA,WAAW;CAdpB8F,OAAO,CAeZuF,IAAI,GAAG9I,WAAW;;CCtC1B,MAAM+I,OAAO,CACb;GAGCnL,WAAW,GACX;KACC,IAAI,CAACoL,QAAQ,GAAG,EAAE;;GAGnBtG,MAAM,CAAC7E,OAAuB,EAC9B;KACC,MAAMoL,OAAO,GAAG,IAAI1F,OAAO,CAAC1F,OAAO,CAAC;KAEpC,IAAI,IAAI,CAACqL,GAAG,CAACD,OAAO,CAACtC,KAAK,EAAE,CAAC,EAC7B;OACC,MAAM,IAAIzC,KAAK,CAAC,yDAAyD,CAAC;;KAG3E,IAAI,CAAC8E,QAAQ,CAACC,OAAO,CAACtC,KAAK,EAAE,CAAC,GAAGsC,OAAO;KAExC,OAAOA,OAAO;;GAGfE,iBAAiB,GACjB;KACC,OAAO,IAAI,CAACD,GAAG,CAAC,iBAAiB,CAAC;;GAGnCA,GAAG,CAACrF,EAAU,EACd;KACC,OAAOA,EAAE,IAAI,IAAI,CAACmF,QAAQ,GAAG,IAAI,CAACA,QAAQ,CAACnF,EAAE,CAAC,GAAG,IAAI;;CAEvD;AAEA,OAAauF,cAAc,GAAG,IAAIL,OAAO,EAAE;;;;;;;;;;;"}