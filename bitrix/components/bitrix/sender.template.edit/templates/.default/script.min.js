(function(){BX.namespace("BX.Sender.Message");if(BX.Sender.Message.Editor){return}const e=BX.Sender.Page;const t=BX.Sender.Helper;function i(){this.context=null;this.editor=null}i.prototype.init=function(i){this.toolbarId=i.toolbarId;this.isFrame=i.isFrame||false;this.isSaved=i.isSaved||false;this.prettyDateFormat=i.prettyDateFormat;this.mess=i.mess||{};this.context=BX(i.containerId);this.selectorNode=this.context.querySelector("[data-bx-selector]");this.editorNode=this.context.querySelector("[data-bx-editor]");this.currTemplateNode=this.editorNode.querySelector("[data-bx-curr-templ]");this.changeTemplateBtnNode=this.editorNode.querySelector("[data-bx-change-btn]");this.titleNode=t.getNode("templates-title",this.context);this.uiToolbar=BX.UI.ToolbarManager.get(this.toolbarId);this.initUi();this.bindNodes();e.initButtons()};i.prototype.initUi=function(){this.ui={title:this.titleNode}};i.prototype.setAdaptedInstance=function(e){this.editor=e};i.prototype.bindNodes=function(){if(this.uiToolbar&&this.isFrame){this.uiToolbar.subscribe(BX.UI.ToolbarEvents.finishEditing,(e=>{const t=e.getData().updatedTitle;if(t&&this.titleNode){this.titleNode.value=t}}))}if(BX.Sender.Template&&BX.Sender.Template.Selector){const e=BX.Sender.Template.Selector;BX.addCustomEvent(e,e.events.templateSelect,this.onTemplateSelect.bind(this));BX.addCustomEvent(e,e.events.selectorClose,this.closeTemplateSelector.bind(this))}BX.bind(this.changeTemplateBtnNode,"click",this.showTemplateSelector.bind(this));if(!this.ui.title.value.trim()){this.ui.title.value=t.replace(this.mess.patternTitle,{name:this.mess.newTitle,date:BX.date.format(this.prettyDateFormat)})}if(this.isFrame&&this.isSaved){e.slider.close()}};i.prototype.onTemplateSelect=function(e){this.closeTemplateSelector();if(this.currTemplateNode){this.currTemplateNode.innerText=e.name}};i.prototype.closeTemplateSelector=function(){t.changeDisplay(this.selectorNode,false);t.changeDisplay(this.editorNode,true)};i.prototype.showTemplateSelector=function(){t.changeDisplay(this.selectorNode,true);t.changeDisplay(this.editorNode,false)};i.prototype.setTemplate=function(e){if(!this.editor){return}if(this.editor.isSupportedTemplateUri&&this.editor.isSupportedTemplateUri()){const t=BX.Sender.Template.Selector.getTemplateRequestingUri(e);this.editor.setTemplateUri(t)}else{BX.Sender.Template.Selector.getTemplate(e,this.editor.setContent.bind(this.editor))}};BX.Sender.Message.Editor=new i})(window);
//# sourceMappingURL=script.map.js