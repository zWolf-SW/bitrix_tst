{"version":3,"file":"script.js","sources":["src/page.js"],"sourcesContent":["import { Dom, Event, Runtime, Type } from 'main.core';\nimport { type BaseEvent, EventEmitter } from 'main.core.events';\nimport { Loader } from 'main.loader';\n\n/**\n * @memberOf BX.Report.Analytics\n */\nexport class Page\n{\n\tscope: HTMLElement;\n\tmenuScope: HTMLElement;\n\tchangeBoardButtons: NodeList;\n\tcontentContainer: HTMLElement;\n\tcurrentItem: HTMLElement;\n\tpageControlsContainer: HTMLElement;\n\n\t#toolbar: ?BX.UI.Toolbar;\n\n\tdefaultBoardKey: string;\n\tdefaultBoardTitle: string;\n\n\tcurrentPageTitle: string;\n\n\tconstructor(options: Object)\n\t{\n\t\tthis.#toolbar = BX.UI?.ToolbarManager?.getDefaultToolbar();\n\n\t\tthis.scope = options.scope;\n\t\tthis.menuScope = options.menuScope;\n\t\tthis.changeBoardButtons = this.menuScope.querySelectorAll('[data-role=\"report-analytics-menu-item\"]');\n\t\tthis.contentContainer = this.scope.querySelector('.report-analytics-content');\n\t\tthis.currentItem = this.menuScope.querySelector(\n\t\t\t'.report-analytics-sidebar-submenu-item.report-analytics-sidebar-submenu-item-active',\n\t\t);\n\t\tthis.pageControlsContainer = this.#getToolbarRightButtonsContainer();\n\n\t\tthis.defaultBoardKey = options.defaultBoardKey;\n\t\tthis.defaultBoardTitle = options.defaultBoardTitle;\n\n\t\tthis.currentPageTitle = top.document.title;\n\n\t\tthis.init();\n\t}\n\n\tinit(): void\n\t{\n\t\tEventEmitter.subscribe('SidePanel.Slider:onClose', () => {\n\t\t\tthis.sliderCloseHandler();\n\t\t});\n\t\ttop.document.title = this.defaultBoardTitle;\n\t\tthis.changeBoardButtons.forEach((button) => {\n\t\t\tEvent.bind(button, 'click', this.handleItemClick.bind(this));\n\t\t});\n\t\tthis.loader = new Loader({ size: 80 });\n\t\ttop.onpopstate = this.handlerOnPopState.bind(this);\n\t\tthis.openBoardWithKey(this.defaultBoardKey);\n\n\t\tconst activeButton = [...this.changeBoardButtons].find((button) => {\n\t\t\treturn button.dataset.reportBoardKey === this.defaultBoardKey;\n\t\t});\n\n\t\tthis.tryOpenExternalUrl(activeButton);\n\t}\n\n\ttryOpenExternalUrl(button: HTMLElement): boolean\n\t{\n\t\tif (Type.isElementNode(button) && button.dataset.isExternal === 'Y')\n\t\t{\n\t\t\tif (button.dataset.isSliderSupport === 'N')\n\t\t\t{\n\t\t\t\tthis.openExternalUrlInNewTab(button.dataset.externalUrl);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.openExternalUrl(button.dataset.externalUrl, button.dataset.sliderLoader);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\thandleItemClick(event: PointerEvent): void\n\t{\n\t\tevent.preventDefault();\n\t\tconst button = event.currentTarget;\n\n\t\tthis.activateButton(event);\n\t\tif (!this.tryOpenExternalUrl(button))\n\t\t{\n\t\t\tthis.openBoardWithKey(button.dataset.reportBoardKey, button.href);\n\t\t}\n\t}\n\n\topenExternalUrl(url: string, loader: string = 'report:analytics'): void\n\t{\n\t\tBX.SidePanel.Instance.open(url, {\n\t\t\tcacheable: false,\n\t\t\tloader,\n\t\t});\n\t}\n\n\topenExternalUrlInNewTab(url: string): void\n\t{\n\t\twindow.open(url, '_blank');\n\t}\n\n\topenBoardWithKey(boardKey: string, urlForHistory: string): void\n\t{\n\t\tthis.cleanPageContent();\n\t\tthis.showLoader();\n\t\tBX.Report.VC.Core.abortAllRunningRequests();\n\n\t\tBX.Report.VC.Core.ajaxPost('analytics.getBoardComponentByKey', {\n\t\t\tdata: {\n\t\t\t\tIFRAME: 'Y',\n\t\t\t\tboardKey,\n\t\t\t},\n\t\t\tanalyticsLabel: {\n\t\t\t\tboardKey,\n\t\t\t},\n\t\t\tonFullSuccess: function(result)\n\t\t\t{\n\t\t\t\tthis.hideLoader();\n\t\t\t\tif (String(urlForHistory) !== '')\n\t\t\t\t{\n\t\t\t\t\ttop.history.pushState(null, result.additionalParams.pageTitle, urlForHistory);\n\t\t\t\t\ttop.history.replaceState({\n\t\t\t\t\t\treportBoardKey: boardKey,\n\t\t\t\t\t\thref: urlForHistory,\n\t\t\t\t\t}, result.additionalParams.pageTitle, urlForHistory);\n\t\t\t\t}\n\n\t\t\t\tthis.changePageTitle(result.additionalParams.pageTitle);\n\t\t\t\tthis.changePageControls(result.additionalParams.pageControlsParams);\n\n\t\t\t\tRuntime.html(this.contentContainer, result.data);\n\t\t\t}.bind(this),\n\t\t});\n\t}\n\n\tcleanPageContent(): void\n\t{\n\t\tthis.#setToolbarTitle('');\n\t\tDom.clean(this.pageControlsContainer);\n\t\tDom.clean(this.contentContainer);\n\t\tBX.Report?.Dashboard?.BoardRepository?.destroyBoards();\n\n\t\tBX.VisualConstructor?.BoardRepository?.destroyBoards();\n\t}\n\n\tchangePageControls(controlsContent): void\n\t{\n\t\tconst config = {};\n\t\tconfig.onFullSuccess = function(result) {\n\t\t\tRuntime.html(this.pageControlsContainer, result.html);\n\t\t}.bind(this);\n\t\tBX.Report.VC.Core._successHandler(controlsContent, config);\n\t}\n\n\tchangePageTitle(title: string): void\n\t{\n\t\tthis.#setToolbarTitle(title);\n\t\ttop.document.title = title;\n\t}\n\n\tshowLoader(): void\n\t{\n\t\tconst preview = Dom.create('img', {\n\t\t\tattrs: {\n\t\t\t\tsrc: '/bitrix/images/report/visualconstructor/preview/view-without-menu.svg',\n\t\t\t\theight: '1200px',\n\t\t\t\twidth: '100%',\n\t\t\t},\n\t\t\tstyle: {\n\t\t\t\t'margin-top': `-${this.#getToolbarContainer()?.offsetHeight}px`,\n\t\t\t},\n\t\t});\n\n\t\tDom.append(preview, this.contentContainer);\n\t}\n\n\thideLoader(): void\n\t{\n\t\tthis.loader.hide();\n\t}\n\n\tactivateButton(event: BaseEvent): void\n\t{\n\t\tconst item = event.currentTarget;\n\n\t\tif (!this.currentItem)\n\t\t{\n\t\t\tthis.currentItem = item;\n\t\t}\n\n\t\tDom.removeClass(this.currentItem, 'report-analytics-sidebar-submenu-item-active');\n\t\tthis.currentItem = item;\n\t\tDom.addClass(this.currentItem, 'report-analytics-sidebar-submenu-item-active');\n\t}\n\n\thandlerOnPopState(event: BaseEvent): void\n\t{\n\t\tlet boardKey = this.defaultBoardKey;\n\t\tif (!Type.isUndefined(event.state.reportBoardKey))\n\t\t{\n\t\t\tboardKey = event.state.reportBoardKey;\n\t\t}\n\n\t\tthis.cleanPageContent();\n\t\tthis.showLoader();\n\t\tBX.Report.VC.Core.ajaxPost('analytics.getBoardComponentByKey', {\n\t\t\tdata: {\n\t\t\t\tIFRAME: 'Y',\n\t\t\t\tboardKey,\n\t\t\t},\n\t\t\tanalyticsLabel: {\n\t\t\t\tboardKey,\n\t\t\t},\n\t\t\tonFullSuccess: function(result)\n\t\t\t{\n\t\t\t\tthis.hideLoader();\n\t\t\t\tthis.cleanPageContent();\n\t\t\t\tthis.changePageTitle(result.additionalParams.pageTitle);\n\t\t\t\tthis.changePageControls(result.additionalParams.pageControlsParams);\n\t\t\t\tRuntime.html(this.contentContainer, result.data);\n\t\t\t}.bind(this),\n\t\t});\n\t}\n\n\tsliderCloseHandler(): void\n\t{\n\t\ttop.document.title = this.currentPageTitle;\n\t}\n\n\t// region fallback for 'ui' without recent changes\n\t#setToolbarTitle(title: string): void\n\t{\n\t\tif (!this.#toolbar)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isFunction(this.#toolbar.setTitle))\n\t\t{\n\t\t\tthis.#toolbar.setTitle(title);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst pagetitle = this.#toolbar.titleContainer.querySelector('#pagetitle');\n\t\t\tif (pagetitle)\n\t\t\t{\n\t\t\t\tpagetitle.textContent = title;\n\t\t\t}\n\t\t}\n\t}\n\n\t#getToolbarContainer(): ?HTMLElement\n\t{\n\t\tif (!this.#toolbar)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (Type.isFunction(this.#toolbar.getContainer))\n\t\t{\n\t\t\treturn this.#toolbar.getContainer();\n\t\t}\n\n\t\treturn this.#toolbar.toolbarContainer;\n\t}\n\n\t#getToolbarRightButtonsContainer(): ?HTMLElement\n\t{\n\t\tif (!this.#toolbar)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (Type.isFunction(this.#toolbar.getRightButtonsContainer))\n\t\t{\n\t\t\tthis.#toolbar.getRightButtonsContainer();\n\t\t}\n\n\t\treturn this.#toolbar.rightButtons;\n\t}\n\t// endregion\n}\n"],"names":["Page","constructor","options","BX","UI","ToolbarManager","getDefaultToolbar","scope","menuScope","changeBoardButtons","querySelectorAll","contentContainer","querySelector","currentItem","pageControlsContainer","defaultBoardKey","defaultBoardTitle","currentPageTitle","top","document","title","init","EventEmitter","subscribe","sliderCloseHandler","forEach","button","Event","bind","handleItemClick","loader","Loader","size","onpopstate","handlerOnPopState","openBoardWithKey","activeButton","find","dataset","reportBoardKey","tryOpenExternalUrl","Type","isElementNode","isExternal","isSliderSupport","openExternalUrlInNewTab","externalUrl","openExternalUrl","sliderLoader","event","preventDefault","currentTarget","activateButton","href","url","SidePanel","Instance","open","cacheable","window","boardKey","urlForHistory","cleanPageContent","showLoader","Report","VC","Core","abortAllRunningRequests","ajaxPost","data","IFRAME","analyticsLabel","onFullSuccess","result","hideLoader","String","history","pushState","additionalParams","pageTitle","replaceState","changePageTitle","changePageControls","pageControlsParams","Runtime","html","Dom","clean","Dashboard","BoardRepository","destroyBoards","VisualConstructor","controlsContent","config","_successHandler","preview","create","attrs","src","height","width","style","offsetHeight","append","hide","item","removeClass","addClass","isUndefined","state","isFunction","setTitle","pagetitle","titleContainer","textContent","getContainer","toolbarContainer","getRightButtonsContainer","rightButtons"],"mappings":"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"}