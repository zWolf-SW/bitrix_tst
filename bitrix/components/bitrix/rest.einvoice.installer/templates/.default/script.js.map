{"version":3,"file":"script.js","sources":["src/pages/base-page.js","src/pages/error-page.js","src/pages/install-page.js","src/buttons/einvoice-app-button.js","src/pages/selection-page.js","src/providers/page-provider.js","src/envoice-installer.js"],"sourcesContent":["import { Tag } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\nexport class BasePage extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Rest.EInvoiceInstaller.Page');\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\tthrow new Error('Must be implemented in a child class');\n\t}\n\n\tgetIcon(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"bitrix-einvoice-installer-main-icon-wrapper\">\n\t\t\t\t<div class=\"bitrix-einvoice-installer-main-icon\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tstatic getType(): string\n\t{\n\t\tthrow new Error('Must be implemented in a child class');\n\t}\n}\n","import { Tag, Loc } from 'main.core';\nimport { Button } from 'ui.buttons';\nimport { BasePage } from './base-page';\n\nexport class ErrorPage extends BasePage\n{\n\t#content: HTMLElement;\n\t#button: HTMLElement;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Rest.EInvoiceInstaller.ErrorPage');\n\t}\n\n\tstatic getType(): string\n\t{\n\t\treturn 'error';\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\tif (!this.#content)\n\t\t{\n\t\t\tthis.#content = Tag.render`\n\t\t\t\t<div class=\"bitrix-einvoice-installer-content --error-content\">\n\t\t\t\t\t<div class=\"bitrix-einvoice-installer-error-icon\"></div>\n\t\t\t\t\t<div class=\"bitrix-einvoice-installer-title-install\">${Loc.getMessage('REST_EINVOICE_INSTALLER_ERROR_TITLE')}</div>\n\t\t\t\t\t${this.#getButton()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#content;\n\t}\n\n\t#getButton(): HTMLElement\n\t{\n\t\tif (!this.#button)\n\t\t{\n\t\t\tthis.#button = (new Button({\n\t\t\t\ttext: Loc.getMessage('REST_EINVOICE_INSTALLER_ERROR_BUTTON'),\n\t\t\t\tsize: Button.Size.LARGE,\n\t\t\t\tcolor: Button.Color.SUCCESS,\n\t\t\t\tclassName: 'bitrix-einvoice-installer-button-try-again',\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.emit('go-back');\n\t\t\t\t},\n\t\t\t})).getContainer();\n\t\t}\n\n\t\treturn this.#button;\n\t}\n}","import { Tag, Loc } from 'main.core';\nimport { Loader } from 'main.loader';\nimport { BasePage } from './base-page';\nimport { AppForm, EventType } from 'rest.app-form';\n\nexport class InstallPage extends BasePage\n{\n\t#content: ?HTMLElement;\n\t#title: ?HTMLElement;\n\t#loader: ?HTMLElement;\n\n\tstatic getType(): string\n\t{\n\t\treturn 'install';\n\t}\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Rest.EInvoiceInstaller.InstallPage');\n\t\tthis.subscribe('install-app', (event) => {\n\t\t\tthis.#getLoader().show();\n\t\t\tconst installer = event.data.source;\n\t\t\tevent.data.install\n\t\t\t\t.then((response) => {\n\t\t\t\t\tif (!response.status)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn Promise.reject();\n\t\t\t\t\t}\n\n\t\t\t\t\treturn AppForm.buildByApp(response.data.id, EventType.INSTALL);\n\t\t\t\t})\n\t\t\t\t.then((appForm) => {\n\t\t\t\t\tthis.#getLoader().hide();\n\t\t\t\t\tappForm.show();\n\t\t\t\t\tinstaller.render('selection');\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\tthis.#getLoader().hide();\n\t\t\t\tthis.#onAfterUnsuccessfulInstallApplication();\n\t\t\t});\n\t\t});\n\t}\n\n\t#onAfterUnsuccessfulInstallApplication(): void\n\t{\n\t\tthis.emit('install-error');\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\tif (!this.#content)\n\t\t{\n\t\t\tthis.#content = Tag.render`\n\t\t\t\t<div class=\"bitrix-einvoice-installer-content\">\n\t\t\t\t\t${this.#getTitle()}\n\t\t\t\t\t<div class=\"bitrix-einvoice-installer-loader-wrapper-install\"/>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#content;\n\t}\n\n\t#getTitle(): HTMLElement\n\t{\n\t\tif (!this.#title)\n\t\t{\n\t\t\tthis.#title = Tag.render`\n\t\t\t\t<div class=\"bitrix-einvoice-installer-title-install\">\n\t\t\t\t\t${Loc.getMessage('REST_EINVOICE_INSTALLER_INSTALL_TITLE')}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#title;\n\t}\n\n\t#getLoader(): Loader\n\t{\n\t\tif (!this.#loader)\n\t\t{\n\t\t\tthis.#loader = new Loader({\n\t\t\t\ttarget: this.getContent().querySelector('.bitrix-einvoice-installer-loader-wrapper-install'),\n\t\t\t\tsize: 90,\n\t\t\t\tcolor: '#2FC6F6',\n\t\t\t\tmode: 'inline',\n\t\t\t});\n\t\t}\n\n\t\treturn this.#loader;\n\t}\n}\n","import { Tag, Loc, Text } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { PopupComponentsMaker } from 'ui.popupcomponentsmaker';\nimport { Button } from 'ui.buttons';\nimport type { FormConfiguration } from '../types';\nimport { AppConfig } from '../types';\n\nexport class EInvoiceAppButton extends EventEmitter\n{\n\t#popup: ?PopupComponentsMaker;\n\t#apps: Array<AppConfig>;\n\t#popupContent: ?Array;\n\t#formConfiguration: FormConfiguration;\n\n\tconstructor(apps: Array<AppConfig>, formConfiguration: FormConfiguration)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Rest.EInvoiceAppButton');\n\t\tthis.#apps = apps;\n\t\tthis.#formConfiguration = formConfiguration;\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\tconst button = new Button({\n\t\t\ttext: Loc.getMessage('REST_EINVOICE_INSTALLER_SELECTION_BUTTON'),\n\t\t\tsize: Button.Size.LARGE,\n\t\t\tcolor: Button.Color.SUCCESS,\n\t\t\tdropdown: true,\n\t\t\tclassName: 'bitrix-einvoice-installer-button-select',\n\t\t\tonclick: (event) => {\n\t\t\t\tconst popup = this.#getPopup(event.button);\n\t\t\t\tpopup.getPopup().setMaxWidth(event.button.offsetWidth);\n\t\t\t\tpopup.getPopup().toggle();\n\t\t\t},\n\t\t});\n\n\t\treturn button.getContainer();\n\t}\n\n\t#getPopup(bindElement: HTMLElement): PopupComponentsMaker\n\t{\n\t\tif (this.#popup)\n\t\t{\n\t\t\treturn this.#popup;\n\t\t}\n\n\t\tthis.#popup = new PopupComponentsMaker({\n\t\t\ttarget: bindElement,\n\t\t\tcontent: this.#getPopupContent(),\n\t\t\tuseAngle: false,\n\t\t});\n\t\tthis.#popup.getPopup().setOffset({\n\t\t\toffsetLeft: 0,\n\t\t\toffsetTop: 0,\n\t\t});\n\t\tthis.subscribe('popup-close', () => {\n\t\t\tthis.#popup.close();\n\t\t});\n\n\t\treturn this.#popup;\n\t}\n\n\t#getPopupContent(): Array\n\t{\n\t\tif (this.#popupContent)\n\t\t{\n\t\t\treturn this.#popupContent;\n\t\t}\n\n\t\tthis.#popupContent = [];\n\t\tthis.#apps.forEach((app) => {\n\t\t\tconst onclick = () => {\n\t\t\t\tthis.emit('popup-close');\n\t\t\t\tthis.emit('click-app', new BaseEvent({\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tcode: app.code,\n\t\t\t\t\t\tname: app.name,\n\t\t\t\t\t},\n\t\t\t\t}));\n\t\t\t};\n\t\t\tthis.#popupContent.push({\n\t\t\t\thtml: Tag.render`\n\t\t\t\t\t<div onclick=\"${onclick}\" class=\"bitrix-einvoice-installer-app-wrapper\">\n\t\t\t\t\t\t<div class=\"bitrix-einvoice-installer-app-name\">\n\t\t\t\t\t\t\t${Text.encode(app.name)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t});\n\t\t});\n\n\t\tconst showForm = () => {\n\t\t\tthis.#showFormForOffer();\n\t\t\tthis.emit('popup-close');\n\t\t};\n\t\tthis.#popupContent.push({\n\t\t\thtml: Tag.render`\n\t\t\t\t<div onclick=\"${showForm}\" class=\"bitrix-einvoice-installer-app-wrapper --form\">\n\t\t\t\t\t${Loc.getMessage('REST_EINVOICE_INSTALLER_SELECTION_BUTTON_OFFER')}\n\t\t\t\t</div>\n\t\t\t`,\n\t\t});\n\n\t\treturn this.#popupContent;\n\t}\n\n\t#showFormForOffer(): void\n\t{\n\t\tBX.UI.Feedback.Form.open({\n\t\t\tid: 'b5309667',\n\t\t\tforms: [\n\t\t\t\t{ zones: ['es'], id: 676, lang: 'es', sec: 'uthphh' },\n\t\t\t\t{ zones: ['de'], id: 670, lang: 'de', sec: 'gk89kt' },\n\t\t\t\t{ zones: ['com.br'], id: 668, lang: 'br', sec: 'kuelnm' },\n\t\t\t],\n\t\t\tdefaultForm: { id: 674, lang: 'en', sec: '5iorws' },\n\t\t\tpresets: {\n\t\t\t\t...this.#formConfiguration,\n\t\t\t\tsender_page: document.location.href,\n\t\t\t},\n\t\t});\n\t}\n}\n","import { Tag, Loc } from 'main.core';\nimport { EInvoiceAppButton } from '../buttons/einvoice-app-button';\nimport type { FormConfiguration } from '../types';\nimport { BasePage } from './base-page';\nimport { AppConfig } from '../types';\n\nexport class SelectionPage extends BasePage\n{\n\t#content: ?HTMLElement;\n\t#title: ?HTMLElement;\n\t#description: ?HTMLElement;\n\t#button: ?HTMLElement;\n\t#apps: Array<AppConfig>;\n\t#formConfiguration: FormConfiguration;\n\t#moreInformation: ?HTMLElement;\n\n\tconstructor(apps: Array<AppConfig>, formConfiguration: FormConfiguration)\n\t{\n\t\tsuper();\n\t\tthis.#apps = apps;\n\t\tthis.#formConfiguration = formConfiguration;\n\t\tthis.setEventNamespace('BX.Rest.EInvoiceInstaller.SelectionPage');\n\t}\n\n\tstatic getType(): string\n\t{\n\t\treturn 'selection';\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\tif (!this.#content)\n\t\t{\n\t\t\tthis.#content = Tag.render`\n\t\t\t\t<div class=\"bitrix-einvoice-installer-content\">\n\t\t\t\t\t${this.#getTitle()}\n\t\t\t\t\t${this.#getDescription()}\n\t\t\t\t\t${this.#getButton()}\n\t\t\t\t\t${this.#getMoreInformation()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#content;\n\t}\n\n\t#getTitle(): HTMLElement\n\t{\n\t\tif (!this.#title)\n\t\t{\n\t\t\tthis.#title = Tag.render`\n\t\t\t\t<div class=\"bitrix-einvoice-installer-title__wrapper\">\n\t\t\t\t\t<div class=\"bitrix-einvoice-installer-title__main-text\">\n\t\t\t\t\t\t${Loc.getMessage('REST_EINVOICE_INSTALLER_SELECTION_TITLE')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#title;\n\t}\n\n\t#getDescription(): HTMLElement\n\t{\n\t\tif (!this.#description)\n\t\t{\n\t\t\tthis.#description = Tag.render`\n\t\t\t\t<div class=\"bitrix-einvoice-installer-description\">\n\t\t\t\t\t${Loc.getMessage('REST_EINVOICE_INSTALLER_SELECTION_DESCRIPTION')}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#description;\n\t}\n\n\t#getButton(): HTMLElement\n\t{\n\t\tif (this.#button)\n\t\t{\n\t\t\treturn this.#button;\n\t\t}\n\n\t\tconst buttonConstructor = new EInvoiceAppButton(this.#apps, this.#formConfiguration);\n\t\tthis.#button = buttonConstructor.getContent();\n\t\tbuttonConstructor.subscribe('click-app', (event) => {\n\t\t\tthis.emit('start-install-app', event);\n\t\t});\n\n\t\treturn this.#button;\n\t}\n\n\t#getMoreInformation(): HTMLElement\n\t{\n\t\tif (this.#moreInformation)\n\t\t{\n\t\t\treturn this.#moreInformation;\n\t\t}\n\n\t\tconst onclick = () => {\n\t\t\ttop.BX.Helper.show('redirect=detail&code=19312840');\n\t\t};\n\n\t\tthis.#moreInformation = Tag.render`\n\t\t\t<div class=\"bitrix-einvoice-installer-more-information-wrapper\">\n\t\t\t\t<div onclick=\"${onclick}\" class=\"bitrix-einvoice-installer-more-information-link\">\n\t\t\t\t\t${Loc.getMessage('REST_EINVOICE_INSTALLER_MORE')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.#moreInformation;\n\t}\n}","import type { EInvoiceInstallerOptions } from '../types';\nimport { BasePage } from '../pages/base-page';\nimport { ErrorPage } from '../pages/error-page';\nimport { InstallPage } from '../pages/install-page';\nimport { SelectionPage } from '../pages/selection-page';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\n\nexport class PageProvider extends EventEmitter\n{\n\t#selectionPage: SelectionPage;\n\t#installPage: InstallPage;\n\t#errorPage: ErrorPage;\n\t#options: EInvoiceInstallerOptions;\n\t#types: string[];\n\n\tconstructor(options: EInvoiceInstallerOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Rest.EInvoiceInstaller.PageProvider');\n\t\tthis.#options = options;\n\t\tthis.#types = [\n\t\t\tSelectionPage.getType(),\n\t\t\tInstallPage.getType(),\n\t\t\tErrorPage.getType(),\n\t\t];\n\t}\n\n\texist(type: string): boolean\n\t{\n\t\treturn this.#types.includes(type);\n\t}\n\n\tgetPageByType(type: string): BasePage\n\t{\n\t\tswitch (type)\n\t\t{\n\t\t\tcase SelectionPage.getType():\n\t\t\t\treturn this.#getSelectionPage();\n\t\t\tcase InstallPage.getType():\n\t\t\t\treturn this.#getInstallPage();\n\t\t\tcase ErrorPage.getType():\n\t\t\t\treturn this.#getErrorPage();\n\t\t\tdefault:\n\t\t\t\tthrow new Error('Incorrect page type');\n\t\t}\n\t}\n\n\t#getSelectionPage(): SelectionPage\n\t{\n\t\tif (!this.#selectionPage)\n\t\t{\n\t\t\tthis.#selectionPage = new SelectionPage(this.#options.apps, this.#options.formConfiguration);\n\t\t\tthis.#registerPageHandlers(this.#selectionPage);\n\t\t\tthis.#selectionPage.subscribe('start-install-app', () => {\n\t\t\t\tthis.emit('render', new BaseEvent({\n\t\t\t\t\tdata: {\n\t\t\t\t\t\ttype: InstallPage.getType(),\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t})\n\t\t}\n\n\t\treturn this.#selectionPage;\n\t}\n\n\t#getInstallPage(): InstallPage\n\t{\n\t\tif (!this.#installPage)\n\t\t{\n\t\t\tthis.#installPage = new InstallPage();\n\t\t\tthis.#registerPageHandlers(this.#installPage);\n\t\t}\n\n\t\treturn this.#installPage;\n\t}\n\n\t#getErrorPage(): ErrorPage\n\t{\n\t\tif (!this.#errorPage)\n\t\t{\n\t\t\tthis.#errorPage = new ErrorPage();\n\t\t\tthis.#registerPageHandlers(this.#errorPage);\n\t\t}\n\n\t\treturn this.#errorPage;\n\t}\n\n\t#registerPageHandlers(page: BasePage): void\n\t{\n\t\tpage.subscribe('go-back', () => {\n\t\t\tthis.emit('render', new BaseEvent({\n\t\t\t\tdata: {\n\t\t\t\t\ttype: SelectionPage.getType(),\n\t\t\t\t},\n\t\t\t}));\n\t\t});\n\t\tpage.subscribe('install-error', () => {\n\t\t\tthis.emit('render', new BaseEvent({\n\t\t\t\tdata: {\n\t\t\t\t\ttype: ErrorPage.getType(),\n\t\t\t\t},\n\t\t\t}));\n\t\t});\n\t}\n}\n","import { ajax, Dom } from 'main.core';\nimport { PageProvider } from './providers/page-provider';\nimport type { EInvoiceInstallerOptions } from './types';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { Listener } from 'rest.listener';\nimport { AppForm } from 'rest.app-form';\n\nexport class EInvoiceInstaller extends EventEmitter\n{\n\t#options: EInvoiceInstallerOptions;\n\t#pageProvider: PageProvider;\n\t#formListener: Listener;\n\n\tconstructor(options: EInvoiceInstallerOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Rest.EInvoiceInstaller');\n\t\tthis.#options = options;\n\t\tthis.render('selection');\n\t\tthis.#getPageProvider().getPageByType('selection').subscribe('start-install-app', this.#onStartInstall.bind(this));\n\t}\n\n\trender(pageType: string): void\n\t{\n\t\tif (this.#getPageProvider().exist(pageType))\n\t\t{\n\t\t\tDom.clean(this.#options.wrapper);\n\t\t\tconst page = this.#getPageProvider().getPageByType(pageType);\n\t\t\tDom.append(page.getContent(), this.#options.wrapper);\n\n\t\t\tif (pageType !== 'error')\n\t\t\t{\n\t\t\t\tDom.append(page.getIcon(), this.#options.wrapper);\n\t\t\t}\n\t\t}\n\t}\n\n\t#installApplicationByCode(code: string): Promise\n\t{\n\t\treturn ajax.runComponentAction('bitrix:rest.einvoice.installer', 'installApplicationByCode', {\n\t\t\tmode: 'class',\n\t\t\tdata: {\n\t\t\t\tcode: code,\n\t\t\t},\n\t\t});\n\t}\n\n\t#onStartInstall(event: BaseEvent): void\n\t{\n\t\tthis.#getPageProvider().getPageByType('install').emit('install-app', new BaseEvent({\n\t\t\tdata: {\n\t\t\t\tsource: this,\n\t\t\t\tcode: event.data.code,\n\t\t\t\tname: event.data.name,\n\t\t\t\tinstall: this.#installApplicationByCode(event.data.code),\n\t\t\t},\n\t\t}));\n\t}\n\n\t#getPageProvider(): PageProvider\n\t{\n\t\tif (!this.#pageProvider)\n\t\t{\n\t\t\tthis.#pageProvider = new PageProvider(this.#options);\n\t\t\tthis.#pageProvider.subscribe('render', (event) => {\n\t\t\t\tthis.render(event.data.type);\n\t\t\t});\n\t\t}\n\n\t\treturn this.#pageProvider;\n\t}\n}"],"names":["BasePage","EventEmitter","constructor","setEventNamespace","getContent","Error","getIcon","Tag","render","getType","ErrorPage","Loc","getMessage","Button","text","size","Size","LARGE","color","Color","SUCCESS","className","onclick","emit","getContainer","InstallPage","subscribe","event","show","installer","data","source","install","then","response","status","Promise","reject","AppForm","buildByApp","id","EventType","INSTALL","appForm","hide","catch","Loader","target","querySelector","mode","EInvoiceAppButton","apps","formConfiguration","button","dropdown","popup","getPopup","setMaxWidth","offsetWidth","toggle","bindElement","PopupComponentsMaker","content","useAngle","setOffset","offsetLeft","offsetTop","close","forEach","app","BaseEvent","code","name","push","html","Text","encode","showForm","BX","UI","Feedback","Form","open","forms","zones","lang","sec","defaultForm","presets","sender_page","document","location","href","SelectionPage","buttonConstructor","top","Helper","PageProvider","options","exist","type","includes","getPageByType","page","EInvoiceInstaller","bind","pageType","Dom","clean","wrapper","append","ajax","runComponentAction"],"mappings":"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"}