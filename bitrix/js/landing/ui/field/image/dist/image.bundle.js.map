{"version":3,"file":"image.bundle.js","sources":["../src/image.js"],"sourcesContent":["import { Dom, Type, Runtime, Event, Text } from 'main.core';\nimport { Loc } from 'landing.loc';\nimport { Main } from 'landing.main';\nimport { Metrika } from 'landing.metrika';\nimport { StylePanel } from 'landing.ui.panel.stylepanel';\nimport { TextField } from 'landing.ui.field.textfield';\nimport { ImageUploader } from 'landing.imageuploader';\nimport { BaseButton } from 'landing.ui.button.basebutton';\nimport { AiImageButton } from 'landing.ui.button.aiimagebutton';\nimport { Env } from 'landing.env';\nimport type { Copilot as CopilotType } from 'ai.copilot';\n\nimport 'ui.fonts.opensans';\n// todo: remove most likely\nimport 'ui.forms';\nimport './css/style.css';\n\nexport class Image extends TextField\n{\n\timageCopilot: CopilotType;\n\tcopilotBindElement: ?HTMLElement = null;\n\taiButton = null;\n\tcopilotContext = null;\n\tcopilotCategory = null;\n\tuseCopilotInIframe = false;\n\tcopilotFinishInitPromise = new Promise(() => {});\n\tisEditorSaved = false;\n\n\tstatic CONTEXT_TYPE_CONTENT = 'content';\n\tstatic CONTEXT_TYPE_STYLE = 'style';\n\tstatic CONTEXT_TYPE_SETTINGS = 'settings';\n\n\tconstructor(data)\n\t{\n\t\tsuper(data);\n\n\t\tthis.dimensions = typeof data.dimensions === 'object' ? data.dimensions : null;\n\t\tthis.create2xByDefault = data.create2xByDefault !== false;\n\t\tthis.uploadParams = typeof data.uploadParams === 'object' ? data.uploadParams : {};\n\t\tthis.onValueChangeHandler = data.onValueChange ? data.onValueChange : (() => {});\n\t\tthis.type = this.content.type || 'image';\n\t\tthis.contextType = data.contextType || Image.CONTEXT_TYPE_CONTENT;\n\t\tthis.allowClear = data.allowClear;\n\t\tthis.isAiImageAvailable = Type.isBoolean(data.isAiImageAvailable) ? data.isAiImageAvailable : false;\n\t\tthis.isAiImageActive = Type.isBoolean(data.isAiImageActive) ? data.isAiImageActive : false;\n\t\tthis.aiUnactiveInfoCode = Type.isString(data.aiUnactiveInfoCode) ? data.aiUnactiveInfoCode : null;\n\n\t\tthis.input.innerText = this.content.src;\n\t\tthis.input.hidden = true;\n\t\tthis.input2x = this.createInput();\n\t\tthis.input2x.innerText = this.content.src2x || '';\n\t\tthis.input2x.hidden = true;\n\n\t\tthis.layout.classList.add(\"landing-ui-field-image\");\n\t\tthis.compactMode = data.compactMode === true;\n\t\tif (this.compactMode)\n\t\t{\n\t\t\tthis.layout.classList.add(\"landing-ui-field-image--compact\");\n\t\t}\n\n\t\tthis.disableAltField = typeof data.disableAltField === \"boolean\" ? data.disableAltField : false;\n\n\t\tthis.fileInput = Image.createFileInput(this.selector);\n\t\tthis.fileInput.addEventListener(\"change\", this.onFileInputChange.bind(this));\n\t\t// Do not append input to layout! Ticket 172032\n\n\t\tthis.linkInput = Image.createLinkInput();\n\t\tthis.linkInput.onInputHandler = Runtime.debounce(this.onLinkInput.bind(this), 777);\n\n\t\tthis.dropzone = Image.createDropzone(this.selector);\n\t\tthis.dropzone.hidden = true;\n\n\t\tthis.onDragOver = this.onDragOver.bind(this);\n\t\tthis.onDragLeave = this.onDragLeave.bind(this);\n\t\tthis.onDrop = this.onDrop.bind(this);\n\n\t\tthis.dropzone.addEventListener(\"dragover\", this.onDragOver);\n\t\tthis.dropzone.addEventListener(\"dragleave\", this.onDragLeave);\n\t\tthis.dropzone.addEventListener(\"drop\", this.onDrop);\n\n\t\tthis.clearButton = Image.createClearButton();\n\t\tthis.clearButton.on(\"click\", this.onClearClick.bind(this));\n\n\t\tthis.preview = Image.createImagePreview();\n\t\tthis.preview.appendChild(this.clearButton.layout);\n\t\tthis.preview.style.backgroundImage = \"url(\" + this.input.innerText.trim() + \")\";\n\n\t\tthis.onImageDragEnter = this.onImageDragEnter.bind(this);\n\t\tthis.preview.addEventListener(\"dragenter\", this.onImageDragEnter);\n\n\t\tthis.loader = new BX.Loader({target: this.preview});\n\n\t\tthis.icon = Image.createIcon();\n\n\t\tthis.image = Image.createImageLayout();\n\t\tthis.image.appendChild(this.preview);\n\t\tthis.image.appendChild(this.icon);\n\t\tthis.image.dataset.fileid = this.content.id;\n\t\tthis.image.dataset.fileid2x = this.content.id2x;\n\n\t\tthis.hiddenImage = Dom.create(\"img\", {\n\t\t\tprops: {className: \"landing-ui-field-image-hidden\"},\n\t\t});\n\n\t\tif (Type.isPlainObject(this.content) && \"src\" in this.content)\n\t\t{\n\t\t\tthis.hiddenImage.src = this.content.src;\n\t\t}\n\n\t\tthis.altField = Image.createAltField();\n\t\tthis.altField.setValue(this.content.alt);\n\n\t\tthis.left = Image.createLeftLayout();\n\t\tthis.left.appendChild(this.dropzone);\n\t\tthis.left.appendChild(this.image);\n\t\tthis.left.appendChild(this.hiddenImage);\n\n\t\tif (this.description)\n\t\t{\n\t\t\tthis.left.appendChild(this.description);\n\t\t}\n\n\t\tthis.left.appendChild(this.altField.layout);\n\t\tthis.left.appendChild(this.linkInput.layout);\n\n\t\tthis.uploadButton = Image.createUploadButton(this.compactMode);\n\t\tthis.uploadButton.on('click', this.onUploadClick.bind(this));\n\n\t\tthis.editButton = Image.createEditButton();\n\t\tthis.editButton.on('click', this.onEditClick.bind(this));\n\t\tthis.onEditorClose = Runtime.debounce(this.onEditorClose, 1000, this);\n\n\t\tthis.right = Image.createRightLayout();\n\n\t\t// ai images\n\t\tif (\n\t\t\tthis.isAiImageAvailable\n\t\t\t&& (this.type === \"background\" || this.type === \"image\")\n\t\t)\n\t\t{\n\t\t\tthis.useCopilotInIframe = this.uploadParams.action === 'Landing::uploadFile';\n\t\t\tthis.defineCopilotCategory();\n\t\t\tconst copilotOptions = {\n\t\t\t\tmoduleId: 'landing',\n\t\t\t\tcontextId: this.getAiContext(),\n\t\t\t\tcategory: this.copilotCategory,\n\t\t\t\tuseText: false,\n\t\t\t\tuseImage: true,\n\t\t\t\tautoHide: true,\n\t\t\t};\n\n\t\t\tthis.copilotContext = this.useCopilotInIframe ? BX : top.BX;\n\t\t\tthis.stylePanel = StylePanel.getInstance().layout;\n\t\t\tthis.stylePanelContent = StylePanel.getInstance().content;\n\t\t\tthis.copilotContext.Runtime.loadExtension('ai.copilot').then(({ Copilot, CopilotEvents}) => {\n\t\t\t\tthis.imageCopilot = new Copilot(copilotOptions);\n\n\t\t\t\tthis.imageCopilot.subscribe(CopilotEvents.FINISH_INIT, this.imageCopilotFinishInitHandler.bind(this));\n\t\t\t\tthis.imageCopilot.subscribe(CopilotEvents.IMAGE_COMPLETION_RESULT, this.imageCopilotImageResultHandler.bind(this));\n\t\t\t\tthis.imageCopilot.subscribe(CopilotEvents.IMAGE_SAVE, this.imageCopilotSaveImageHandler.bind(this));\n\t\t\t\tthis.imageCopilot.subscribe(CopilotEvents.IMAGE_CANCEL, this.imageCopilotCancelImageHandler.bind(this));\n\n\t\t\t\tEvent.bind(this.stylePanelContent, 'scroll', this.onScrollContentPanel.bind(this));\n\t\t\t\tEvent.bind(this.stylePanel, 'click', this.onClickStylePanel.bind(this));\n\t\t\t\tEvent.EventEmitter.subscribe('BX.Landing.UI.Panel.ContentEdit:onClick', this.onClickContentPanel.bind(this));\n\t\t\t\tEvent.EventEmitter.subscribe('BX.Landing.UI.Panel.BasePanel:onHide', this.closeCopilot.bind(this));\n\t\t\t\tEvent.EventEmitter.subscribe('BX.Landing.UI.Panel.BasePanel:onClick', this.onClickContentPanel.bind(this));\n\t\t\t\tEvent.EventEmitter.subscribe('BX.Landing.UI.Panel.BasePanel:onScroll', this.onScrollContentPanel.bind(this));\n\t\t\t\tthis.imageCopilot.init();\n\t\t\t});\n\n\t\t\tthis.aiButton = Image.createAiButton(this.compactMode);\n\t\t\tBX.bind(this.aiButton.layout, 'click', () => {\n\t\t\t\tif (this.isAiImageActive)\n\t\t\t\t{\n\t\t\t\t\tthis.onAiClick();\n\t\t\t\t}\n\t\t\t\telse if (this.aiUnactiveInfoCode && this.aiUnactiveInfoCode.length > 0)\n\t\t\t\t{\n\t\t\t\t\tBX.UI.InfoHelper.show(this.aiUnactiveInfoCode);\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.right.appendChild(this.aiButton.layout);\n\t\t}\n\n\t\tthis.right.appendChild(this.uploadButton.layout);\n\t\tthis.right.appendChild(this.editButton.layout);\n\t\tthis.form = Image.createForm();\n\t\tthis.form.appendChild(this.left);\n\t\tthis.form.appendChild(this.right);\n\n\t\tthis.layout.appendChild(this.form);\n\n\t\tthis.enableTextOnly();\n\n\t\tif (!this.input.innerText.trim() || this.input.innerText.trim() === window.location.toString())\n\t\t{\n\t\t\tthis.showDropzone();\n\t\t}\n\n\t\tif (this.disableAltField)\n\t\t{\n\t\t\tthis.altField.layout.hidden = true;\n\t\t\tthis.altField.layout.style.display = \"none\";\n\t\t\tthis.altField.layout.classList.add(\"landing-ui-hide\");\n\t\t}\n\n\t\tif (this.content.type === \"icon\")\n\t\t{\n\t\t\tthis.type = \"icon\";\n\t\t\tthis.classList = this.content.classList;\n\t\t\tthis.showPreview();\n\t\t\tthis.altField.layout.hidden = true;\n\t\t\tDom.addClass(this.layout, 'landing-ui-field-image-icon');\n\t\t}\n\n\t\tthis.makeAsLinkWrapper = Dom.create(\"div\", {\n\t\t\tprops: {className: \"landing-ui-field-image-make-as-link-wrapper\"},\n\t\t\tchildren: [\n\t\t\t\tDom.create('div', {\n\t\t\t\t\tprops: {className: \"landing-ui-field-image-make-as-link-button\"},\n\t\t\t\t\tchildren: [],\n\t\t\t\t}),\n\t\t\t],\n\t\t});\n\n\t\tthis.url = new BX.Landing.UI.Field.Link({\n\t\t\tcontent: this.content.url || {\n\t\t\t\ttext: '',\n\t\t\t\thref: '',\n\t\t\t},\n\t\t\toptions: {\n\t\t\t\tsiteId: Main.getInstance().options.site_id,\n\t\t\t\tlandingId: Main.getInstance().id,\n\t\t\t},\n\t\t\tcontentRoot: this.contentRoot,\n\t\t});\n\n\t\tthis.isDisabledUrl = this.content.url && this.content.url.enabled === false;\n\t\tif (this.isDisabledUrl)\n\t\t{\n\t\t\tthis.content.url.href = '';\n\t\t}\n\n\t\tthis.url.left.hidden = true;\n\n\t\tthis.makeAsLinkWrapper.appendChild(this.url.layout);\n\n\t\tif (!data.disableLink)\n\t\t{\n\t\t\tthis.layout.appendChild(this.makeAsLinkWrapper);\n\t\t}\n\n\t\tthis.content = this.getValue();\n\t\tBX.DOM.write(function ()\n\t\t{\n\t\t\tthis.adjustPreviewBackgroundSize();\n\t\t}.bind(this));\n\n\t\tif (this.getValue().type === \"background\" || this.allowClear)\n\t\t{\n\t\t\tthis.clearButton.layout.classList.add(\"landing-ui-show\");\n\t\t}\n\n\t\tthis.uploader = new ImageUploader({\n\t\t\tuploadParams: this.uploadParams,\n\t\t\tadditionalParams: {context: 'imageeditor'},\n\t\t\tdimensions: this.dimensions,\n\t\t\tsizes: ['1x', '2x'],\n\t\t\tallowSvg: Main.getInstance().options.allow_svg === true,\n\t\t});\n\n\t\tthis.adjustEditButtonState();\n\n\t\tthis.metrika = new Metrika(true);\n\t}\n\n\t/**\n\t * Creates file input\n\t * @return {Element}\n\t */\n\tstatic createFileInput(id)\n\t{\n\t\treturn Dom.create('input', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'landing-ui-field-image-dropzone-input',\n\t\t\t},\n\t\t\tattrs: {\n\t\t\t\taccept: 'image/*', type: 'file', id: `file_${id}`, name: 'picture',\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Creates link input field\n\t * @return {TextField}\n\t */\n\tstatic createLinkInput(): TextField\n\t{\n\t\tvar field = new TextField({\n\t\t\tid: \"path_to_image\",\n\t\t\tplaceholder: Loc.getMessage(\"LANDING_IMAGE_UPLOAD_MENU_LINK_LABEL\"),\n\t\t});\n\t\tfield.enableTextOnly();\n\t\tfield.layout.hidden = true;\n\t\treturn field;\n\t}\n\n\t/**\n\t * Creates dropzone\n\t * @param {string} id\n\t * @return {Element}\n\t */\n\tstatic createDropzone(id)\n\t{\n\t\treturn Dom.create(\"label\", {\n\t\t\tprops: {className: \"landing-ui-field-image-dropzone\"},\n\t\t\tchildren: [\n\t\t\t\tDom.create(\"div\", {\n\t\t\t\t\tprops: {className: \"landing-ui-field-image-dropzone-text\"},\n\t\t\t\t\thtml: (\n\t\t\t\t\t\t\"<div class=\\\"landing-ui-field-image-dropzone-title\\\">\" + Loc.getMessage(\n\t\t\t\t\t\t\t\"LANDING_IMAGE_DROPZONE_TITLE\") + \"</div>\" +\n\t\t\t\t\t\t\"<div class=\\\"landing-ui-field-image-dropzone-subtitle\\\">\" + Loc.getMessage(\n\t\t\t\t\t\t\t\"LANDING_IMAGE_DROPZONE_SUBTITLE\") + \"</div>\"\n\t\t\t\t\t),\n\t\t\t\t}),\n\t\t\t],\n\t\t\tattrs: {\"for\": \"file_\" + id},\n\t\t});\n\t}\n\n\t/**\n\t * Creates clear button\n\t * @return {BaseButton}\n\t */\n\tstatic createClearButton()\n\t{\n\t\treturn new BaseButton(\"clear\", {\n\t\t\tclassName: \"landing-ui-field-image-action-button-clear\",\n\t\t});\n\t}\n\n\t/**\n\t * Creates image preview\n\t * @return {Element}\n\t */\n\tstatic createImagePreview()\n\t{\n\t\treturn Dom.create(\"div\", {\n\t\t\tprops: {className: \"landing-ui-field-image-preview-inner\"},\n\t\t});\n\t}\n\n\t/**\n\t * Creates icon layout\n\t * @return {Element}\n\t */\n\tstatic createIcon()\n\t{\n\t\treturn Dom.create(\"span\", {\n\t\t\tprops: {className: \"landing-ui-field-image-preview-icon\"},\n\t\t});\n\t}\n\n\t/**\n\t * Creates image layout\n\t * @return {Element}\n\t */\n\tstatic createImageLayout()\n\t{\n\t\treturn Dom.create(\"div\", {\n\t\t\tprops: {className: \"landing-ui-field-image-preview\"},\n\t\t});\n\t}\n\n\t/**\n\t * Creates alt field\n\t * @return {TextField}\n\t */\n\tstatic createAltField()\n\t{\n\t\tvar field = new TextField({\n\t\t\tplaceholder: Loc.getMessage(\"LANDING_FIELD_IMAGE_ALT_PLACEHOLDER\"),\n\t\t\tclassName: \"landing-ui-field-image-alt\",\n\t\t\ttextOnly: true,\n\t\t});\n\t\treturn field;\n\t}\n\n\t/**\n\t * Creates left layout\n\t * @return {Element}\n\t */\n\tstatic createLeftLayout()\n\t{\n\t\treturn Dom.create(\"div\", {\n\t\t\tprops: {className: \"landing-ui-field-image-left\"},\n\t\t});\n\t}\n\n\t/**\n\t * Creates upload button\n\t * @return {BaseButton}\n\t */\n\tstatic createAiButton(compactMode: boolean = false)\n\t{\n\t\treturn new AiImageButton(\"ai\", {\n\t\t\ttext: 'CoPilot',\n\t\t\tclassName: \"landing-ui-field-image-ai-button\" + (compactMode ? ' --compact' : ''),\n\t\t});\n\t}\n\n\t/**\n\t * Creates ia create button\n\t * @return {BaseButton}\n\t */\n\tstatic createUploadButton()\n\t{\n\t\treturn new BaseButton(\"upload\", {\n\t\t\ttext: Loc.getMessage(\"LANDING_FIELD_IMAGE_UPLOAD_BUTTON\"),\n\t\t\tclassName: \"landing-ui-field-image-action-button\",\n\t\t});\n\t}\n\n\t/**\n\t * Creates edit button\n\t * @return {BaseButton}\n\t */\n\tstatic createEditButton()\n\t{\n\t\tvar field = new BaseButton(\"edit\", {\n\t\t\ttext: Loc.getMessage(\"LANDING_FIELD_IMAGE_EDIT_BUTTON\"),\n\t\t\tclassName: \"landing-ui-field-image-action-button\",\n\t\t});\n\n\t\treturn field;\n\t}\n\n\t/**\n\t * Creates right layout\n\t * @return {Element}\n\t */\n\tstatic createRightLayout()\n\t{\n\t\treturn Dom.create(\"div\", {\n\t\t\tprops: {className: \"landing-ui-field-image-right\"},\n\t\t});\n\t}\n\n\t/**\n\t * Creates form\n\t * @return {Element}\n\t */\n\tstatic createForm()\n\t{\n\t\treturn Dom.create(\"form\", {\n\t\t\tprops: {className: \"landing-ui-field-image-container\"},\n\t\t\tattrs: {method: \"post\", enctype: \"multipart/form-data\"},\n\t\t\tevents: {\n\t\t\t\tsubmit: function (event)\n\t\t\t\t{\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\tonInputInput()\n\t{\n\t\tthis.preview.src = this.input.innerText.trim();\n\t}\n\n\tonImageDragEnter(event)\n\t{\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tif (!this.imageHidden)\n\t\t{\n\t\t\tthis.showDropzone();\n\t\t\tthis.imageHidden = true;\n\t\t}\n\t}\n\n\tonDragOver(event)\n\t{\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t\tthis.dropzone.classList.add(\"landing-ui-active\");\n\t}\n\n\tonDragLeave(event)\n\t{\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t\tthis.dropzone.classList.remove(\"landing-ui-active\");\n\n\t\tif (this.imageHidden)\n\t\t{\n\t\t\tthis.imageHidden = false;\n\t\t\tthis.showPreview();\n\t\t}\n\t}\n\n\tonDrop(event)\n\t{\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t\tthis.dropzone.classList.remove(\"landing-ui-active\");\n\t\tthis.onFileChange(event.dataTransfer.files[0]);\n\t\tthis.imageHidden = false;\n\t}\n\n\tonFileChange(file)\n\t{\n\t\tthis.showLoader();\n\n\t\tthis.upload(file)\n\t\t\t.then(this.setValue.bind(this))\n\t\t\t.then(this.hideLoader.bind(this))\n\t\t\t.catch(function (err)\n\t\t\t{\n\t\t\t\tconsole.error(err);\n\t\t\t\tthis.hideLoader();\n\t\t\t}.bind(this));\n\t}\n\n\tonFileInputChange(event)\n\t{\n\t\tthis.onFileChange(event.currentTarget.files[0]);\n\t}\n\n\tasync onAiClick()\n\t{\n\t\tawait this.copilotFinishInitPromise;\n\t\tthis.showCopilot();\n\t}\n\n\t/**\n\t * Return AI image button, if exists (if allow)\n\t */\n\tgetAiButton(): ?BaseButton\n\t{\n\t\treturn this.aiButton;\n\t}\n\n\tshowCopilot()\n\t{\n\t\tthis.copilotBindElement = this.aiButton.layout;\n\t\tconst offsetY = 3;\n\t\tconst copilotBindElementPosition = this.copilotBindElement.getBoundingClientRect();\n\n\t\tthis.imageCopilot.show({\n\t\t\twidth: 500,\n\t\t\tbindElement: {\n\t\t\t\ttop: copilotBindElementPosition.bottom + offsetY,\n\t\t\t\tleft: copilotBindElementPosition.left,\n\t\t\t},\n\t\t});\n\t\tthis.imageCopilot.adjustPosition({});\n\t}\n\n\timageCopilotFinishInitHandler()\n\t{\n\t\tthis.copilotFinishInitPromise = Promise.resolve();\n\t}\n\n\timageCopilotImageResultHandler(e)\n\t{\n\t\tconst data = e.getData();\n\t\tthis.imageCopilotUrl = encodeURI(data.imageUrl);\n\t\tif (this.copilotBindElement === this.dropzone)\n\t\t{\n\t\t\tthis.showPreview();\n\t\t}\n\t\tDom.addClass(this.preview, '--shown');\n\t\tDom.style(this.preview, 'background-image', `url(\"${this.imageCopilotUrl}\")`);\n\t\tDom.style(this.preview, 'background-size', 'contain');\n\n\t\tthis.showPreview();\n\t}\n\n\timageCopilotSaveImageHandler()\n\t{\n\t\tconst url = new URL(this.imageCopilotUrl);\n\t\tconst name = url.searchParams.get('hashId') ?? Text.getRandom(8);\n\n\t\tBX.Landing.Utils.urlToBlob(url.href)\n\t\t\t.then(blob => {\n\n\t\t\t\tconst ext = blob.type === 'image/png' ? '.png' : '.jpg';\n\t\t\t\tblob.lastModifiedDate = new Date();\n\t\t\t\tblob.name = `${name}.${ext}`;\n\n\t\t\t\treturn blob;\n\t\t\t})\n\t\t\t.then(this.upload.bind(this))\n\t\t\t.then(this.setValue.bind(this))\n\t\t\t.then(this.hideLoader.bind(this))\n\t\t\t.then(() => {\n\t\t\t\tDom.removeClass(this.preview, '--shown');\n\t\t\t});\n\n\t\tthis.closeCopilot();\n\t}\n\n\timageCopilotCancelImageHandler()\n\t{\n\t\tif (this.copilotBindElement === this.dropzone)\n\t\t{\n\t\t\tthis.showDropzone();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.preview, '--shown');\n\t\t\tDom.style(this.preview, 'background-image', `url(\"${this.input.innerText.trim()}\")`);\n\t\t}\n\t}\n\n\tcloseCopilot()\n\t{\n\t\tif (this.imageCopilot.isShown())\n\t\t{\n\t\t\tthis.imageCopilot.hide();\n\t\t\tEvent.EventEmitter.unsubscribe('BX.Landing.UI.Panel.BasePanel:onHide', this.closeCopilot.bind(this));\n\t\t\tEvent.unbind(this.stylePanel, 'click', this.onClickStylePanel.bind(this));\n\t\t}\n\t}\n\n\tonClickStylePanel(event)\n\t{\n\t\tif (!this.aiButton.layout.contains(event.target))\n\t\t{\n\t\t\tthis.closeCopilot();\n\t\t}\n\t}\n\n\tonClickContentPanel(event)\n\t{\n\t\tconst target = event.getData().event.target;\n\t\tif (!this.aiButton.layout.contains(target))\n\t\t{\n\t\t\tthis.closeCopilot();\n\t\t}\n\t}\n\n\tonScrollContentPanel()\n\t{\n\t\tif (Boolean(this.imageCopilot?.isShown()) === false)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.copilotBindElement = this.aiButton.layout;\n\t\tconst offsetY = 3;\n\t\tconst copilotBindElementPosition = this.copilotBindElement.getBoundingClientRect();\n\t\tconst imageCopilotPosition = {\n\t\t\ttop: copilotBindElementPosition.bottom + offsetY,\n\t\t\tleft: copilotBindElementPosition.left,\n\t\t};\n\n\t\tif (this.imageCopilot.getPosition().inputField.top < 133)\n\t\t{\n\t\t\tthis.imageCopilot.adjust({\n\t\t\t\thide: true,\n\t\t\t\tposition: imageCopilotPosition,\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.imageCopilot.adjust({\n\t\t\t\thide: false,\n\t\t\t\tposition: imageCopilotPosition,\n\t\t\t});\n\t\t}\n\t}\n\n\tdefineCopilotCategory()\n\t{\n\t\tthis.copilotCategory = this.contextType === 'style' ? 'landing_designer'\n\t\t\t: (this.useCopilotInIframe ? 'landing_setting'\n\t\t\t\t: 'landing_editor');\n\t}\n\n\tgetAiContext(): string\n\t{\n\t\treturn 'image_site_' + Env.getInstance().getSiteId();\n\t}\n\n\tonUploadClick(event)\n\t{\n\t\tthis.bindElement = event.currentTarget;\n\n\t\tevent.preventDefault();\n\n\t\tif (!this.uploadMenu)\n\t\t{\n\t\t\tthis.uploadMenu = BX.Main.MenuManager.create({\n\t\t\t\tid: \"upload_\" + this.selector + (+new Date()),\n\t\t\t\tbindElement: this.bindElement,\n\t\t\t\tbindOptions: {\n\t\t\t\t\tforceBindPosition: true,\n\t\t\t\t},\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: Loc.getMessage(\"LANDING_IMAGE_UPLOAD_MENU_UNSPLASH\"),\n\t\t\t\t\t\tonclick: this.onUnsplashShow.bind(this),\n\t\t\t\t\t},\n\t\t\t\t\t...(\n\t\t\t\t\t\tEnv.getInstance().getOptions()['google_images_available']\n\t\t\t\t\t\t\t? [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttext: Loc.getMessage(\"LANDING_IMAGE_UPLOAD_MENU_GOOGLE\"),\n\t\t\t\t\t\t\t\t\tonclick: this.onGoogleShow.bind(this),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t: []\n\t\t\t\t\t),\n\t\t\t\t\t// {\n\t\t\t\t\t// \ttext: Loc.getMessage(\"LANDING_IMAGE_UPLOAD_MENU_PARTNER\"),\n\t\t\t\t\t// \tclassName: \"landing-ui-disabled\"\n\t\t\t\t\t// },\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: Loc.getMessage(\"LANDING_IMAGE_UPLOAD_MENU_UPLOAD\"),\n\t\t\t\t\t\tonclick: this.onUploadShow.bind(this),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: Loc.getMessage(\"LANDING_IMAGE_UPLOAD_MENU_LINK\"),\n\t\t\t\t\t\tonclick: this.onLinkShow.bind(this),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: function ()\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.bindElement.classList.remove(\"landing-ui-active\");\n\n\t\t\t\t\t\tif (this.uploadMenu)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.uploadMenu.destroy();\n\t\t\t\t\t\t\tthis.uploadMenu = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}.bind(this),\n\t\t\t\t},\n\t\t\t\ttargetContainer: this.contentRoot,\n\t\t\t});\n\t\t\tif (!this.contentRoot)\n\t\t\t{\n\t\t\t\tthis.bindElement.parentNode.appendChild(this.uploadMenu.popupWindow.popupContainer);\n\t\t\t}\n\t\t}\n\n\t\tthis.bindElement.classList.add(\"landing-ui-active\");\n\t\tthis.uploadMenu.toggle();\n\n\t\tif (!this.contentRoot && this.uploadMenu)\n\t\t{\n\t\t\tvar rect = BX.pos(this.bindElement, this.bindElement.parentNode);\n\t\t\tthis.uploadMenu.popupWindow.popupContainer.style.top = rect.bottom + \"px\";\n\t\t\tthis.uploadMenu.popupWindow.popupContainer.style.left = \"auto\";\n\t\t\tthis.uploadMenu.popupWindow.popupContainer.style.right = \"5px\";\n\t\t}\n\t}\n\n\tonUnsplashShow()\n\t{\n\t\tthis.uploadMenu.close();\n\n\t\tBX.Landing.UI.Panel.Image.getInstance()\n\t\t\t.show(\"unsplash\", this.dimensions, this.loader, this.uploadParams)\n\t\t\t.then(this.upload.bind(this))\n\t\t\t.then(this.setValue.bind(this))\n\t\t\t.then(this.hideLoader.bind(this))\n\t\t\t.catch(function (err)\n\t\t\t{\n\t\t\t\tconsole.error(err);\n\t\t\t\tthis.hideLoader();\n\t\t\t}.bind(this));\n\t}\n\n\tonGoogleShow()\n\t{\n\t\tthis.uploadMenu.close();\n\n\t\tBX.Landing.UI.Panel.Image.getInstance()\n\t\t\t.show(\"google\", this.dimensions, this.loader, this.uploadParams)\n\t\t\t.then(this.upload.bind(this))\n\t\t\t.then(this.setValue.bind(this))\n\t\t\t.then(this.hideLoader.bind(this))\n\t\t\t.catch(function (err)\n\t\t\t{\n\t\t\t\tBX.Landing.ErrorManager.getInstance().add({\n\t\t\t\t\ttype: 'error',\n\t\t\t\t\taction: 'BAD_IMAGE',\n\t\t\t\t\thideSupportLink: true,\n\t\t\t\t});\n\t\t\t\tconsole.error(err);\n\t\t\t\tthis.hideLoader();\n\t\t\t}.bind(this));\n\t}\n\n\tonUploadShow()\n\t{\n\t\tthis.uploadMenu.close();\n\t\tthis.fileInput.click();\n\t}\n\n\tonLinkShow()\n\t{\n\t\tthis.uploadMenu.close();\n\t\tthis.showLinkField();\n\t\tthis.linkInput.setValue(\"\");\n\t}\n\n\tonEditClick(event)\n\t{\n\t\tthis.sendAnalytic('open');\n\t\tparent.BX.addCustomEvent('BX.Main.ImageEditor:close', this.onEditorClose);\n\n\t\tevent.preventDefault();\n\t\tthis.edit({src: this.hiddenImage.src});\n\t}\n\n\tonEditorClose()\n\t{\n\t\tthis.sendAnalytic(this.isEditorSaved ? 'save' : 'close');\n\t\tparent.BX.removeCustomEvent('BX.Main.ImageEditor:close', this.onEditorClose);\n\t}\n\n\tonClearClick(event)\n\t{\n\t\tevent.preventDefault();\n\t\tthis.setValue({src: \"\"});\n\t\tthis.fileInput.value = \"\";\n\t\tthis.showDropzone();\n\t}\n\n\t/**\n\t * @param {string} event - name of event (not event-object)\n\t */\n\tsendAnalytic(event: string)\n\t{\n\t\tconst contexts = {\n\t\t\t[Image.CONTEXT_TYPE_CONTENT]: 'sites_editor',\n\t\t\t[Image.CONTEXT_TYPE_STYLE]: 'sites_designer',\n\t\t\t[Image.CONTEXT_TYPE_SETTINGS]: 'sites_settings',\n\t\t};\n\t\tconst contextSection = contexts[this.contextType] || 'sites_editor';\n\n\t\tthis.metrika.sendData({\n\t\t\tcategory: 'external_picture_editor',\n\t\t\tevent,\n\t\t\tc_section: contextSection,\n\t\t});\n\t}\n\n\tshowDropzone()\n\t{\n\t\tthis.dropzone.hidden = false;\n\t\tthis.image.hidden = true;\n\t\tthis.altField.layout.hidden = true;\n\t\tthis.linkInput.layout.hidden = true;\n\t}\n\n\tshowPreview()\n\t{\n\t\tthis.dropzone.hidden = true;\n\t\tthis.image.hidden = false;\n\t\tthis.altField.layout.hidden = false;\n\t\tthis.linkInput.layout.hidden = true;\n\t}\n\n\tshowLinkField()\n\t{\n\t\tthis.dropzone.hidden = true;\n\t\tthis.image.hidden = true;\n\t\tthis.altField.layout.hidden = true;\n\t\tthis.linkInput.layout.hidden = false;\n\t}\n\n\tonLinkInput(value)\n\t{\n\t\tconst tmpImage = Dom.create(\"img\");\n\t\ttmpImage.src = value;\n\t\ttmpImage.onload = () => {\n\t\t\tthis.showPreview();\n\t\t\tthis.setValue({src: value, src2x: value});\n\t\t};\n\t}\n\n\tshowLoader()\n\t{\n\t\tif (this.dropzone && !this.dropzone.hidden)\n\t\t{\n\t\t\tthis.loader.show(this.dropzone);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.loader.show(this.preview);\n\t}\n\n\thideLoader()\n\t{\n\t\tthis.loader.hide();\n\t}\n\n\t/**\n\t * Handles click event on input field\n\t * @param {MouseEvent} event\n\t */\n\tonInputClick(event)\n\t{\n\t\tevent.preventDefault();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t * @return {boolean}\n\t */\n\tisChanged()\n\t{\n\t\tvar lastValue = BX.Landing.Utils.clone(this.content);\n\t\tvar currentValue = BX.Landing.Utils.clone(this.getValue());\n\n\t\tif (lastValue.url && Type.isString(lastValue.url))\n\t\t{\n\t\t\tlastValue.url = BX.Landing.Utils.decodeDataValue(lastValue.url);\n\t\t}\n\n\t\tif (currentValue.url && Type.isString(currentValue.url))\n\t\t{\n\t\t\tcurrentValue.url = BX.Landing.Utils.decodeDataValue(currentValue.url);\n\t\t}\n\n\t\treturn JSON.stringify(lastValue) !== JSON.stringify(currentValue);\n\t}\n\n\t/**\n\t * Adjusts preview background image size\n\t */\n\tadjustPreviewBackgroundSize()\n\t{\n\t\tvar img = Dom.create(\"img\", {attrs: {src: this.getValue().src}});\n\n\t\timg.onload = function ()\n\t\t{\n\t\t\tvar preview = this.preview.getBoundingClientRect();\n\t\t\tvar position = \"cover\";\n\n\t\t\tif (img.width > preview.width || img.height > preview.height)\n\t\t\t{\n\t\t\t\tposition = \"contain\";\n\t\t\t}\n\n\t\t\tif (img.width < preview.width && img.height < preview.height)\n\t\t\t{\n\t\t\t\tposition = \"auto\";\n\t\t\t}\n\n\t\t\tBX.DOM.write(function ()\n\t\t\t{\n\t\t\t\tthis.preview.style.backgroundSize = position;\n\t\t\t}.bind(this));\n\t\t}.bind(this);\n\t}\n\n\t/**\n\t * @param {object} value\n\t * @param {boolean} [preventEvent = false]\n\t */\n\tsetValue(value, preventEvent)\n\t{\n\t\tif (value.type !== \"icon\")\n\t\t{\n\t\t\tif (!value || !value.src)\n\t\t\t{\n\t\t\t\tthis.input.innerText = \"\";\n\t\t\t\tthis.input2x.innerText = \"\";\n\t\t\t\tthis.preview.removeAttribute(\"style\");\n\t\t\t\tthis.input.dataset.ext = \"\";\n\t\t\t\tthis.showDropzone();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.input.innerText = value.src;\n\t\t\t\tthis.input2x.innerText = value.src2x || '';\n\t\t\t\tthis.preview.style.backgroundImage = \"url(\\\"\" + (value.src2x || value.src) + \"\\\")\";\n\t\t\t\tthis.preview.id = BX.util.getRandomString();\n\t\t\t\tthis.hiddenImage.src = value.src2x || value.src;\n\t\t\t\tthis.showPreview();\n\t\t\t}\n\n\t\t\tthis.image.dataset.fileid = value && value.id ? value.id : -1;\n\t\t\tthis.image.dataset.fileid2x = value && value.id2x ? value.id2x : -1;\n\n\t\t\tif (value.type === 'image')\n\t\t\t{\n\t\t\t\tthis.altField.layout.hidden = false;\n\t\t\t\tthis.altField.setValue(value.alt);\n\t\t\t}\n\n\t\t\tthis.classList = [];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.preview.style.backgroundImage = null;\n\t\t\tthis.classList = value.classList;\n\t\t\tthis.icon.innerHTML = \"<span class=\\\"\" + value.classList.join(\" \") + \"\\\"></span>\";\n\t\t\tthis.showPreview();\n\t\t\tthis.type = \"icon\";\n\t\t\tthis.altField.layout.hidden = true;\n\t\t\tthis.altField.setValue(\"\");\n\t\t\tthis.input.innerText = \"\";\n\t\t}\n\n\t\tif (value.url)\n\t\t{\n\t\t\tthis.url.setValue(value.url);\n\t\t}\n\n\t\tthis.adjustPreviewBackgroundSize();\n\t\tthis.adjustEditButtonState();\n\t\tthis.hideLoader();\n\n\t\tthis.onValueChangeHandler(this);\n\t\tBX.fireEvent(this.layout, \"input\");\n\n\t\tvar event = new BX.Event.BaseEvent({\n\t\t\tdata: {value: this.getValue()},\n\t\t\tcompatData: [this.getValue()],\n\t\t});\n\t\tif (!preventEvent)\n\t\t{\n\t\t\tthis.emit('change', event);\n\t\t}\n\t}\n\n\tadjustEditButtonState()\n\t{\n\t\tvar value = this.getValue();\n\t\tif (BX.Type.isStringFilled(value.src))\n\t\t{\n\t\t\tthis.editButton.enable();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.editButton.disable();\n\t\t}\n\t}\n\n\treset()\n\t{\n\t\tthis.setValue({\n\t\t\ttype: this.getValue().type,\n\t\t\tid: -1,\n\t\t\tsrc: \"\",\n\t\t\talt: \"\",\n\t\t});\n\t}\n\n\t/**\n\t * Gets field value\n\t * @return {{src, [alt]: string, [title]: string, [url]: string, [type]: string}}\n\t */\n\tgetValue()\n\t{\n\t\tconst value = {type: \"\", src: \"\", alt: \"\", url: \"\"};\n\n\t\tconst fileId = parseInt(this.image.dataset.fileid);\n\t\tif (Type.isNumber(fileId) && fileId > 0)\n\t\t{\n\t\t\tvalue.id = fileId;\n\t\t}\n\n\t\tconst fileId2x = parseInt(this.image.dataset.fileid2x);\n\t\tif (Type.isNumber(fileId2x) && fileId2x > 0)\n\t\t{\n\t\t\tvalue.id2x = fileId2x;\n\t\t}\n\n\t\tconst src2x = this.input2x.innerText.trim();\n\t\tif (Type.isString(src2x) && src2x)\n\t\t{\n\t\t\tvalue.src2x = src2x;\n\t\t}\n\n\t\tif (this.type === \"background\" || this.type === \"image\")\n\t\t{\n\t\t\tvalue.src = this.input.innerText.trim();\n\t\t}\n\n\t\tif (this.type === \"background\")\n\t\t{\n\t\t\tvalue.type = \"background\";\n\t\t}\n\n\t\tif (this.type === \"image\")\n\t\t{\n\t\t\tvalue.type = \"image\";\n\t\t\tvalue.alt = this.altField.getValue();\n\t\t}\n\n\t\tif (this.type === \"icon\")\n\t\t{\n\t\t\tvalue.type = \"icon\";\n\t\t\tvalue.classList = this.classList;\n\t\t}\n\n\t\tvalue.url = Object.assign({}, this.url.getValue(), {enabled: true});\n\n\t\treturn value;\n\t}\n\n\tedit(data)\n\t{\n\t\tthis.isEditorSaved = false;\n\t\tparent.BX.Landing.ImageEditor\n\t\t\t.edit({\n\t\t\t\timage: data.src,\n\t\t\t\tdimensions: this.dimensions,\n\t\t\t})\n\t\t\t.then((file) => {\n\t\t\t\tlet ext = file.name.split('.').pop();\n\t\t\t\tif (!file.name.includes('.') || ext.length > 4)\n\t\t\t\t{\n\t\t\t\t\text = `.${file.name.split('_').pop()}`;\n\t\t\t\t\tfile.name = file.name + ext;\n\t\t\t\t}\n\n\t\t\t\treturn this.upload(file, {context: \"imageEditor\"});\n\t\t\t})\n\t\t\t.then((result) => {\n\t\t\t\tthis.isEditorSaved = true;\n\t\t\t\tthis.onEditorClose();\n\n\t\t\t\tthis.setValue(result);\n\t\t\t});\n\n\t\t// Analytics hack\n\t\tconst tmpImage = document.createElement('img');\n\t\tlet imageSrc = \"/bitrix/images/landing/close.svg\";\n\n\t\timageSrc = BX.util.add_url_param(imageSrc, {\n\t\t\taction: \"openImageEditor\",\n\t\t});\n\n\t\ttmpImage.src = imageSrc + \"?\" + (+new Date());\n\t}\n\n\t/**\n\t * @param {File|Blob} file\n\t * @param {object} [additionalParams]\n\t */\n\tupload(file, additionalParams)\n\t{\n\t\tif (file.type && (file.type.includes('text') || file.type.includes('html')))\n\t\t{\n\t\t\tBX.Landing.ErrorManager.getInstance().add({\n\t\t\t\ttype: \"error\",\n\t\t\t\taction: \"BAD_IMAGE\",\n\t\t\t});\n\n\t\t\treturn Promise.reject({\n\t\t\t\ttype: \"error\",\n\t\t\t\taction: \"BAD_IMAGE\",\n\t\t\t});\n\t\t}\n\n\t\tthis.showLoader();\n\n\t\tconst isPng = (\n\t\t\tType.isStringFilled(file.type)\n\t\t\t&& file.type.includes('png')\n\t\t);\n\n\t\tconst isSvg = (\n\t\t\tType.isStringFilled(file.type)\n\t\t\t&& file.type.includes('svg')\n\t\t);\n\n\t\tconst checkSize = new Promise(function (resolve)\n\t\t{\n\t\t\tlet sizes = (isPng || isSvg) ? ['2x'] : ['1x', '2x'];\n\n\t\t\tif (this.create2xByDefault === false)\n\t\t\t{\n\t\t\t\tconst image = document.createElement('img');\n\t\t\t\tconst objectUrl = URL.createObjectURL(file);\n\t\t\t\tconst dimensions = this.dimensions;\n\t\t\t\timage.onload = function ()\n\t\t\t\t{\n\t\t\t\t\tURL.revokeObjectURL(objectUrl);\n\t\t\t\t\tif (\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\tthis.width >= dimensions.width\n\t\t\t\t\t\t\t|| this.height >= dimensions.height\n\t\t\t\t\t\t\t|| this.width >= dimensions.maxWidth\n\t\t\t\t\t\t\t|| this.height >= dimensions.maxHeight\n\t\t\t\t\t\t) === false\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tsizes = (isPng || isSvg) ? ['2x'] : ['1x'];\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve(sizes);\n\t\t\t\t};\n\t\t\t\timage.src = objectUrl;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresolve(sizes);\n\t\t\t}\n\t\t}.bind(this));\n\n\t\treturn checkSize\n\t\t\t.then(function (allowedSizes)\n\t\t\t{\n\t\t\t\tvar sizes = (function ()\n\t\t\t\t{\n\t\t\t\t\tif (\n\t\t\t\t\t\tthis.create2xByDefault === false\n\t\t\t\t\t\t&& BX.Type.isArrayFilled(allowedSizes)\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn allowedSizes;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn (isPng || isSvg) ? ['2x'] : ['1x', '2x'];\n\t\t\t\t}.bind(this))();\n\n\t\t\t\treturn this.uploader\n\t\t\t\t\t.setSizes(sizes)\n\t\t\t\t\t.upload(file, additionalParams)\n\t\t\t\t\t.then(function (result)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.hideLoader();\n\n\t\t\t\t\t\tif (sizes.length === 1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn result[0];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn Object.assign({}, result[0], {\n\t\t\t\t\t\t\tsrc2x: result[1].src,\n\t\t\t\t\t\t\tid2x: result[1].id,\n\t\t\t\t\t\t});\n\t\t\t\t\t}.bind(this));\n\t\t\t}.bind(this));\n\t}\n}\n"],"names":["Image","data","Promise","dimensions","create2xByDefault","uploadParams","onValueChangeHandler","onValueChange","type","content","contextType","CONTEXT_TYPE_CONTENT","allowClear","isAiImageAvailable","Type","isBoolean","isAiImageActive","aiUnactiveInfoCode","isString","input","innerText","src","hidden","input2x","createInput","src2x","layout","classList","add","compactMode","disableAltField","fileInput","createFileInput","selector","addEventListener","onFileInputChange","bind","linkInput","createLinkInput","onInputHandler","Runtime","debounce","onLinkInput","dropzone","createDropzone","onDragOver","onDragLeave","onDrop","clearButton","createClearButton","on","onClearClick","preview","createImagePreview","appendChild","style","backgroundImage","trim","onImageDragEnter","loader","BX","Loader","target","icon","createIcon","image","createImageLayout","dataset","fileid","id","fileid2x","id2x","hiddenImage","Dom","create","props","className","isPlainObject","altField","createAltField","setValue","alt","left","createLeftLayout","description","uploadButton","createUploadButton","onUploadClick","editButton","createEditButton","onEditClick","onEditorClose","right","createRightLayout","useCopilotInIframe","action","defineCopilotCategory","copilotOptions","moduleId","contextId","getAiContext","category","copilotCategory","useText","useImage","autoHide","copilotContext","top","stylePanel","StylePanel","getInstance","stylePanelContent","loadExtension","then","Copilot","CopilotEvents","imageCopilot","subscribe","FINISH_INIT","imageCopilotFinishInitHandler","IMAGE_COMPLETION_RESULT","imageCopilotImageResultHandler","IMAGE_SAVE","imageCopilotSaveImageHandler","IMAGE_CANCEL","imageCopilotCancelImageHandler","Event","onScrollContentPanel","onClickStylePanel","EventEmitter","onClickContentPanel","closeCopilot","init","aiButton","createAiButton","onAiClick","length","UI","InfoHelper","show","form","createForm","enableTextOnly","window","location","toString","showDropzone","display","showPreview","addClass","makeAsLinkWrapper","children","url","Landing","Field","Link","text","href","options","siteId","Main","site_id","landingId","contentRoot","isDisabledUrl","enabled","disableLink","getValue","DOM","write","adjustPreviewBackgroundSize","uploader","ImageUploader","additionalParams","context","sizes","allowSvg","allow_svg","adjustEditButtonState","metrika","Metrika","event","preventDefault","stopPropagation","imageHidden","remove","onFileChange","dataTransfer","files","file","showLoader","upload","hideLoader","err","console","error","currentTarget","copilotFinishInitPromise","showCopilot","copilotBindElement","offsetY","copilotBindElementPosition","getBoundingClientRect","width","bindElement","bottom","adjustPosition","resolve","e","getData","imageCopilotUrl","encodeURI","imageUrl","URL","name","searchParams","get","Text","getRandom","Utils","urlToBlob","blob","ext","lastModifiedDate","Date","removeClass","isShown","hide","unsubscribe","unbind","contains","Boolean","imageCopilotPosition","getPosition","inputField","adjust","position","Env","getSiteId","uploadMenu","MenuManager","bindOptions","forceBindPosition","items","Loc","getMessage","onclick","onUnsplashShow","getOptions","onGoogleShow","onUploadShow","onLinkShow","events","onPopupClose","destroy","targetContainer","parentNode","popupWindow","popupContainer","toggle","rect","pos","close","Panel","ErrorManager","hideSupportLink","click","showLinkField","sendAnalytic","parent","addCustomEvent","edit","isEditorSaved","removeCustomEvent","value","contexts","CONTEXT_TYPE_STYLE","CONTEXT_TYPE_SETTINGS","contextSection","sendData","c_section","tmpImage","onload","lastValue","clone","currentValue","decodeDataValue","JSON","stringify","img","attrs","height","backgroundSize","preventEvent","removeAttribute","util","getRandomString","innerHTML","join","fireEvent","BaseEvent","compatData","emit","isStringFilled","enable","disable","fileId","parseInt","isNumber","fileId2x","Object","assign","ImageEditor","split","pop","includes","result","document","createElement","imageSrc","add_url_param","reject","isPng","isSvg","checkSize","objectUrl","createObjectURL","revokeObjectURL","maxWidth","maxHeight","allowedSizes","isArrayFilled","setSizes","accept","field","TextField","placeholder","html","BaseButton","textOnly","AiImageButton","method","enctype","submit"],"mappings":"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"}