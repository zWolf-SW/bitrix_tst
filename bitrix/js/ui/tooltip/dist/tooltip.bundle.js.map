{"version":3,"file":"tooltip.bundle.js","sources":["../src/intercept.js","../src/tooltip.js","../src/balloon.js","../src/index.js"],"sourcesContent":["import { Type } from 'main.core';\n\nconst Context = Object.freeze({\n\tB24: 'b24',\n});\n\nexport class Interceptor\n{\n\tstatic try(context: string, userId: ?string, node: HTMLElement): boolean\n\t{\n\t\tif (context !== Context.B24)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (\n\t\t\t!Type.isStringFilled(userId)\n\t\t\t|| !Type.isNumber(Number(userId)))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (BX.Intranet?.User?.UserMiniProfileManager)\n\t\t{\n\t\t\tBX.Intranet.User.UserMiniProfileManager.create({\n\t\t\t\tid: userId,\n\t\t\t\tuserId: Number(userId),\n\t\t\t\tbindElement: node,\n\t\t\t});\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n}\n","export class Tooltip\n{\n\tstatic disabled = false;\n\tstatic tooltipsList = {};\n\n\tstatic disable()\n\t{\n\t\tthis.disabled = true;\n\t}\n\n\tstatic enable()\n\t{\n\t\tthis.disabled = false;\n\t}\n\n\tstatic getDisabledStatus()\n\t{\n\t\treturn this.disabled;\n\t}\n\n\tstatic getLoader()\n\t{\n\t\treturn '/bitrix/tools/tooltip.php';\n\t}\n\n\tstatic getIdPrefix()\n\t{\n\t\treturn 'bx-ui-tooltip-';\n\t}\n}\n","import { Type, ajax, Loc, Event } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\n\nimport { Tooltip } from './tooltip';\n\nexport class TooltipBalloon\n{\n\tconstructor(params)\n\t{\n\t\tthis.node = null;\n\t\tthis.userId = null;\n\t\tthis.loader = null;\n\t\tthis.version = null;\n\t\tthis.tracking = false;\n\t\tthis.active = false;\n\t\tthis.width = 364; // 393\n\t\tthis.height = 215; // 302\n\t\tthis.realAnchor = null;\n\t\tthis.coordsLeft = 0;\n\t\tthis.coordsTop = 0;\n\t\tthis.anchorRight = 0;\n\t\tthis.anchorTop = 0;\n\t\tthis.hMirror = false;\n\t\tthis.vMirror = false;\n\t\tthis.rootClassName = '';\n\t\tthis.INFO = null;\n\t\tthis.DIV = null;\n\t\tthis.ROOT_DIV = null;\n\t\tthis.params = {};\n\t\tthis.trackMouseHandle = this.trackMouse.bind(this);\n\n\t\tthis.init(params);\n\t\tthis.create();\n\t\treturn this;\n\t}\n\n\tinit(params)\n\t{\n\t\tthis.node = params.node;\n\t\tthis.userId = params.userId;\n\t\tthis.loader = (Type.isStringFilled(params.loader) ? params.loader : '');\n\n\t\tthis.version = (\n\t\t\t!Type.isUndefined(params.version)\n\t\t\t&& parseInt(params.version) > 0\n\t\t\t\t? parseInt(params.version)\n\t\t\t\t: (Type.isStringFilled(this.loader) ? 2 : 3)\n\t\t);\n\n\t\tthis.rootClassName = this.node.getAttribute('bx-tooltip-classname');\n\n\t\tconst paramsString = this.node.getAttribute('bx-tooltip-params');\n\n\t\tlet anchorParams = {};\n\t\tif (Type.isStringFilled(paramsString))\n\t\t{\n\t\t\tanchorParams = JSON.parse(paramsString);\n\t\t\tif (!Type.isPlainObject(anchorParams))\n\t\t\t{\n\t\t\t\tanchorParams = {};\n\t\t\t}\n\t\t}\n\n\t\tthis.params = anchorParams;\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onOpen', this.onSliderOpen.bind(this));\n\t}\n\n\tcreate()\n\t{\n\t\tif (!Tooltip.getDisabledStatus())\n\t\t{\n\t\t\tthis.startTrackMouse();\n\t\t}\n\n\t\tEvent.bind(this.node, 'mouseout', this.stopTrackMouse.bind(this));\n\t}\n\n\tonSliderOpen()\n\t{\n\t\tif (this.tracking)\n\t\t{\n\t\t\tthis.stopTrackMouse();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideTooltip();\n\t\t}\n\t}\n\n\tstartTrackMouse()\n\t{\n\t\tif (this.tracking)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.elCoords = BX.pos(this.node);\n\t\tthis.realAnchor = this.node;\n\n\t\tthis.coordsLeft = (\n\t\t\tthis.elCoords.width < 40\n\t\t\t\t? (this.elCoords.left - 35)\n\t\t\t\t: (this.elCoords.left + 0)\n\t\t);\n\t\tthis.coordsTop = this.elCoords.top - 245; // 325\n\t\tthis.anchorRight = this.elCoords.right;\n\t\tthis.anchorTop = this.elCoords.top;\n\n\t\tthis.tracking = true;\n\n\t\tdocument.addEventListener('mousemove', this.trackMouseHandle);\n\n\t\tsetTimeout(() => {\n\t\t\tthis.tickTimer();\n\t\t}, 500);\n\n\t\tthis.node.addEventListener('mouseout', this.stopTrackMouse.bind(this));\n\t\tthis.node.removeEventListener('click', this.handleClick);\n\t\tthis.node.addEventListener('click', this.handleClick);\n\t}\n\n\thandleClick = () => {\n\t\tthis.hideTooltip();\n\t\tthis.stopTrackMouse();\n\t};\n\n\tstopTrackMouse()\n\t{\n\t\tif (!this.tracking)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tdocument.removeEventListener('mousemove', this.trackMouseHandle);\n\n\t\tthis.active = false;\n\t\tsetTimeout(() => {\n\t\t\tthis.hideTooltip()\n\t\t}, 100);\n\t\tthis.tracking = false;\n\t}\n\n\ttrackMouse(e)\n\t{\n\t\tif (!this.tracking)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst current = (\n\t\t\te && e.pageX\n\t\t\t\t? {\n\t\t\t\t\tx: e.pageX,\n\t\t\t\t\ty: e.pageY,\n\t\t\t\t}\n\t\t\t\t: {\n\t\t\t\t\tx: e.clientX + document.body.scrollLeft,\n\t\t\t\t\ty: e.clientY + document.body.scrollTop,\n\t\t\t\t}\n\t\t);\n\n\t\tif (current.x < 0)\n\t\t{\n\t\t\tcurrent.x = 0;\n\t\t}\n\n\t\tif (current.y < 0)\n\t\t{\n\t\t\tcurrent.y = 0;\n\t\t}\n\n\t\tcurrent.time = this.tracking;\n\n\t\tif (!this.active)\n\t\t{\n\t\t\tthis.active = current;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.active.x >= (current.x - 1) && this.active.x <= (current.x + 1)\n\t\t\t\t&& this.active.y >= (current.y - 1) && this.active.y <= (current.y + 1)\n\t\t\t)\n\t\t\t{\n\t\t\t\tif ((this.active.time + 20/*2sec*/) <= current.time)\n\t\t\t\t{\n\t\t\t\t\tthis.showTooltip();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.active = current;\n\t\t\t}\n\t\t}\n\t}\n\n\ttickTimer()\n\t{\n\t\tif (!this.tracking)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.tracking++;\n\t\tif (this.active)\n\t\t{\n\t\t\tif ((this.active.time + 3/*0.3sec*/) <= this.tracking)\n\t\t\t{\n\t\t\t\tthis.showTooltip();\n\t\t\t}\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\tthis.tickTimer();\n\t\t}, 100);\n\t}\n\n\thideTooltip()\n\t{\n\t\tif (this.tracking)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.showOpacityEffect(1);\n\t}\n\n\tshowOpacityEffect(bFade)\n\t{\n\t\tconst steps = 3;\n\t\tconst period = 1;\n\t\tconst delta = 1 / steps;\n\t\tlet i = 0;\n\n\t\tconst intId = setInterval(() => {\n\t\t\ti++;\n\t\t\tif (i > steps)\n\t\t\t{\n\t\t\t\tclearInterval(intId);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst op = (\n\t\t\t\tbFade\n\t\t\t\t\t? 1 - i * delta\n\t\t\t\t\t: i * delta\n\t\t\t);\n\n\t\t\tif (this.DIV != null)\n\t\t\t{\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\tthis.DIV.style.opacity = op;\n\t\t\t\t}\n\t\t\t\tcatch(e)\n\t\t\t\t{\n\t\t\t\t}\n\t\t\t\tfinally\n\t\t\t\t{\n\t\t\t\t\tif (\n\t\t\t\t\t\t!bFade\n\t\t\t\t\t\t&& i == 1\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.DIV.classList.add('ui-tooltip-info-shadow-show');\n\t\t\t\t\t\tthis.DIV.style.display = 'block';\n\t\t\t\t\t}\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tbFade\n\t\t\t\t\t\t&& i == steps\n\t\t\t\t\t\t&& this.DIV\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.DIV.classList.remove('ui-tooltip-info-shadow-show');\n\t\t\t\t\t\tthis.DIV.classList.add('ui-tooltip-info-shadow-hide');\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tthis.DIV.style.display = 'none';\n\t\t\t\t\t\t}, 500);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (bFade)\n\t\t\t\t\t{\n\t\t\t\t\t\tEventEmitter.emit('onTooltipHide', new BaseEvent({\n\t\t\t\t\t\t\tcompatData: [ this ],\n\t\t\t\t\t\t}));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}, period);\n\t}\n\n\tshowTooltip()\n\t{\n\t\tconst old = document.getElementById(`${Tooltip.getIdPrefix()}${this.userId}`);\n\n\t\tif (\n\t\t\tTooltip.getDisabledStatus()\n\t\t\t|| (\n\t\t\t\told\n\t\t\t\t&& old.classList.contains('ui-tooltip-info-shadow-show')\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\tnull == this.DIV\n\t\t\t&& null == this.ROOT_DIV\n\t\t)\n\t\t{\n\t\t\tthis.ROOT_DIV = document.body.appendChild(document.createElement('DIV'));\n\t\t\tthis.ROOT_DIV.style.position = 'absolute';\n\n\t\t\tBX.ZIndexManager.register(this.ROOT_DIV);\n\n\t\t\tthis.DIV = this.ROOT_DIV.appendChild(document.createElement('DIV'));\n\t\t\tthis.DIV.className = 'bx-ui-tooltip-info-shadow';\n\n\t\t\tthis.DIV.style.width = `${this.width}px`;\n\t\t}\n\n\t\tlet left = this.coordsLeft;\n\t\tconst top = this.coordsTop + 30;\n\t\tconst arScroll = BX.GetWindowScrollPos();\n\t\tconst body = document.body;\n\n\t\tthis.hMirror = false;\n\t\tthis.vMirror = ((top - arScroll.scrollTop - 50) < 0);\n\n\t\tif ((body.clientWidth + arScroll.scrollLeft) < (left + this.width))\n\t\t{\n\t\t\tleft = this.anchorRight - this.width;\n\t\t\tthis.hMirror = true;\n\t\t}\n\n\t\tthis.ROOT_DIV.style.left = `${parseInt(left)}px`;\n\t\tthis.ROOT_DIV.style.top = `${parseInt(top)}px`;\n\n\t\tBX.ZIndexManager.bringToFront(this.ROOT_DIV);\n\n\t\tthis.ROOT_DIV.addEventListener('click', (e) => { e.stopPropagation(); });\n\n\t\tif (Type.isStringFilled(this.rootClassName))\n\t\t{\n\t\t\tthis.ROOT_DIV.className = this.rootClassName;\n\t\t}\n\n\t\tconst loader = (\n\t\t\tType.isStringFilled(this.loader)\n\t\t\t\t? this.loader\n\t\t\t\t: Tooltip.getLoader()\n\t\t);\n\n\t\t// create stub\n\t\tlet stubCreated = false;\n\n\t\tif ('' == this.DIV.innerHTML)\n\t\t{\n\t\t\tstubCreated = true;\n\n\t\t\tif (this.version >= 3)\n\t\t\t{\n\t\t\t\tajax.runComponentAction('bitrix:ui.tooltip', 'getData', {\n\t\t\t\t\tmode: 'ajax',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tuserId: this.userId,\n\t\t\t\t\t\tparams: (!Type.isUndefined(this.params) ? this.params : {}),\n\t\t\t\t\t}\n\t\t\t\t}).then((response) => {\n\n\t\t\t\t\tconst detailUrl = (Type.isStringFilled(response.data.user.detailUrl) ? response.data.user.detailUrl : '');\n\t\t\t\t\tlet cardUserName = '';\n\n\t\t\t\t\tif (Type.isStringFilled(response.data.user.nameFormatted))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst {nameFormatted = ''} = response.data.user;\n\n\t\t\t\t\t\tif (Type.isStringFilled(detailUrl))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcardUserName = `\n\t\t\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"bx-ui-tooltip-user-name\"\n\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"${nameFormatted}\"\n\t\t\t\t\t\t\t\t\t\t\t\thref=\"${detailUrl}\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t${response.data.user.nameFormatted}\n\t\t\t\t\t\t\t\t\t\t\t</a>`\n\t\t\t\t\t\t\t;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcardUserName = `\n\t\t\t\t\t\t\t\t\t\t\t<span \n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"bx-ui-tooltip-user-name\"\n\t\t\t\t\t\t\t\t\t\t\t\ttitle=\"${nameFormatted}\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\tresponse.data.user.nameFormatted\n\t\t\t\t\t\t\t\t\t\t\t</span>`\n\t\t\t\t\t\t\t;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tlet cardFields = '<div class=\"bx-ui-tooltip-info-data-info\">';\n\t\t\t\t\tObject.keys(response.data.user.cardFields).forEach((fieldCode) => {\n\t\t\t\t\t\tcardFields += `<span class=\"bx-ui-tooltip-field-row bx-ui-tooltip-field-row-${fieldCode.toLowerCase()}\"><span class=\"bx-ui-tooltip-field-name\">${response.data.user.cardFields[fieldCode].name}</span>: <span class=\"bx-ui-tooltip-field-value\">${response.data.user.cardFields[fieldCode].value}</span></span>`;\n\t\t\t\t\t});\n\t\t\t\t\tcardFields += '</div>';\n\n\t\t\t\t\tconst cardFieldsClassName = (\n\t\t\t\t\t\tparseInt(Loc.getMessage('USER_ID')) > 0\n\t\t\t\t\t\t&& response.data.currentUserPerms.operations.videocall\n\t\t\t\t\t\t\t? 'bx-ui-tooltip-info-data-cont-video'\n\t\t\t\t\t\t\t: 'bx-ui-tooltip-info-data-cont'\n\t\t\t\t\t);\n\t\t\t\t\tcardFields = `<div id=\"bx_user_info_data_cont_${response.data.user.id}\" class=\"${cardFieldsClassName}\">${cardFields}</div>`;\n\n\t\t\t\t\tlet photo = '';\n\t\t\t\t\tlet photoClassName = 'bx-ui-tooltip-info-data-photo no-photo';\n\n\t\t\t\t\tif (Type.isStringFilled(response.data.user.photo))\n\t\t\t\t\t{\n\t\t\t\t\t\tphoto = response.data.user.photo;\n\t\t\t\t\t\tphotoClassName = 'bx-ui-tooltip-info-data-photo';\n\t\t\t\t\t}\n\n\t\t\t\t\tphoto = (\n\t\t\t\t\t\tType.isStringFilled(detailUrl)\n\t\t\t\t\t\t\t? `<a href=\"${detailUrl}\" class=\"${photoClassName}\">${photo}</a>`\n\t\t\t\t\t\t\t: `<span class=\"${photoClassName}\">${photo}</span>`\n\t\t\t\t\t);\n\n\t\t\t\t\tlet toolbar = '';\n\t\t\t\t\tlet toolbar2 = '';\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tparseInt(Loc.getMessage('USER_ID')) > 0\n\t\t\t\t\t\t&& response.data.user.active\n\t\t\t\t\t\t&& response.data.user.id != Loc.getMessage('USER_ID')\n\t\t\t\t\t\t&& response.data.currentUserPerms.operations.message\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\ttoolbar2 += `<li class=\"bx-icon bx-icon-message\"><span onclick=\"return BX.Messenger.Public.openChat(${response.data.user.id});\">${Loc.getMessage('MAIN_UL_TOOLBAR_MESSAGES_CHAT')}</span></li>`;\n\t\t\t\t\t\ttoolbar2 += `<li id=\"im-video-call-button${response.data.user.id}\" class=\"bx-icon bx-icon-video\"><span onclick=\"return BX.tooltip.openCallTo(${response.data.user.id});\">${Loc.getMessage('MAIN_UL_TOOLBAR_VIDEO_CALL')}</span></li>`;\n\t\t\t\t\t\ttoolbar2 += `<script>Event.ready(() => { BX.tooltip.checkCallTo(\"im-video-call-button${response.data.user.id}\"); };</script>`;\n\t\t\t\t\t}\n\n\t\t\t\t\ttoolbar2 = (Type.isStringFilled(toolbar2) ? `<div class=\"bx-ui-tooltip-info-data-separator\"></div><ul>${toolbar2}</ul>` : '');\n\n\t\t\t\t\tif (response.data.user.hasBirthday)\n\t\t\t\t\t{\n\t\t\t\t\t\ttoolbar += `<li class=\"bx-icon bx-icon-birth\">${Loc.getMessage('MAIN_UL_TOOLBAR_BIRTHDAY')}</li>`;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (response.data.user.hasHonour)\n\t\t\t\t\t{\n\t\t\t\t\t\ttoolbar += `<li class=\"bx-icon bx-icon-featured\">${Loc.getMessage('MAIN_UL_TOOLBAR_HONORED')}</li>`;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (response.data.user.hasAbsence)\n\t\t\t\t\t{\n\t\t\t\t\t\ttoolbar += `<li class=\"bx-icon bx-icon-away\">${Loc.getMessage('MAIN_UL_TOOLBAR_ABSENT')}</li>`;\n\t\t\t\t\t}\n\n\t\t\t\t\ttoolbar = (Type.isStringFilled(toolbar) ? `<ul>${toolbar}</ul>` : '');\n\n\t\t\t\t\tthis.insertData({\n\t\t\t\t\t\tRESULT: {\n\t\t\t\t\t\t\tName: cardUserName,\n\t\t\t\t\t\t\tPosition: (Type.isStringFilled(response.data.user.position) ? response.data.user.position : ''),\n\t\t\t\t\t\t\tCard: cardFields,\n\t\t\t\t\t\t\tPhoto: photo,\n\t\t\t\t\t\t\tToolbar: toolbar,\n\t\t\t\t\t\t\tToolbar2: toolbar2,\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\tthis.adjustPosition();\n\n\t\t\t\t}, () => {});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst url = loader +\n\t\t\t\t\t(loader.indexOf('?') >= 0 ? '&' : '?') +\n\t\t\t\t\t`MODE=UI&MUL_MODE=INFO&USER_ID=${this.userId}` +\n\t\t\t\t\t`&site=${(Loc.getMessage('SITE_ID') || '')}` +\n\t\t\t\t\t`&version=${this.version}` +\n\t\t\t\t\t(\n\t\t\t\t\t\t!Type.isUndefined(this.params)\n\t\t\t\t\t\t&& !Type.isUndefined(this.params.entityType)\n\t\t\t\t\t\t&& Type.isStringFilled(this.params.entityType)\n\t\t\t\t\t\t\t? `&entityType=${this.params.entityType}`\n\t\t\t\t\t\t\t: ''\n\t\t\t\t\t) +\n\t\t\t\t\t(\n\t\t\t\t\t\t!Type.isUndefined(this.params)\n\t\t\t\t\t\t&& !Type.isUndefined(this.params.entityId)\n\t\t\t\t\t\t&& parseInt(this.params.entityId) > 0\n\t\t\t\t\t\t\t? `&entityId=${parseInt(this.params.entityId)}`\n\t\t\t\t\t\t\t: ''\n\t\t\t\t\t);\n\n\t\t\t\tajax.get(url, (data) => {\n\t\t\t\t\tthis.insertData(data);\n\t\t\t\t\tthis.adjustPosition();\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.DIV.id = `${Tooltip.getIdPrefix()}${this.userId}`;\n\n\t\t\tthis.DIV.innerHTML = '<div class=\"bx-ui-tooltip-info-wrap\">'\n\t\t\t\t+ '<div class=\"bx-ui-tooltip-info-leftcolumn\">'\n\t\t\t\t+ `<div class=\"bx-ui-tooltip-photo\" id=\"${Tooltip.getIdPrefix()}photo-${this.userId}\"><div class=\"bx-ui-tooltip-info-data-loading\">${Loc.getMessage('JS_CORE_LOADING')}</div></div>`\n\t\t\t\t+ '</div>'\n\t\t\t\t+ '<div class=\"bx-ui-tooltip-info-data\">'\n\t\t\t\t+ `<div id=\"${Tooltip.getIdPrefix()}data-card-${this.userId}\"></div>`\n\t\t\t\t+ '<div class=\"bx-ui-tooltip-info-data-tools\">'\n\t\t\t\t+ `<div class=\"bx-ui-tooltip-tb-control bx-ui-tooltip-tb-control-left\" id=\"${Tooltip.getIdPrefix()}toolbar-${this.userId}\"></div>`\n\t\t\t\t+ `<div class=\"bx-ui-tooltip-tb-control bx-ui-tooltip-tb-control-right\" id=\"${Tooltip.getIdPrefix()}toolbar2-${this.userId}\"></div>`\n\t\t\t\t+ '<div class=\"bx-ui-tooltip-info-data-clear\"></div>'\n\t\t\t\t+ '</div>'\n\t\t\t\t+ '</div>'\n\t\t\t\t+ '</div><div class=\"bx-ui-tooltip-info-bottomarea\"></div>';\n\t\t}\n\n\t\tthis.DIV.className = 'bx-ui-tooltip-info-shadow';\n\t\tthis.classNameAnim = 'bx-ui-tooltip-info-shadow-anim';\n\t\tthis.classNameFixed = 'bx-ui-tooltip-info-shadow';\n\n\t\tif (this.hMirror && this.vMirror)\n\t\t{\n\t\t\tthis.DIV.className = 'bx-ui-tooltip-info-shadow-hv';\n\t\t\tthis.classNameAnim = 'bx-ui-tooltip-info-shadow-hv-anim';\n\t\t\tthis.classNameFixed = 'bx-ui-tooltip-info-shadow-hv';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.hMirror)\n\t\t\t{\n\t\t\t\tthis.DIV.className = 'bx-ui-tooltip-info-shadow-h';\n\t\t\t\tthis.classNameAnim = 'bx-ui-tooltip-info-shadow-h-anim';\n\t\t\t\tthis.classNameFixed = 'bx-ui-tooltip-info-shadow-h';\n\t\t\t}\n\n\t\t\tif (this.vMirror)\n\t\t\t{\n\t\t\t\tthis.DIV.className = 'bx-ui-tooltip-info-shadow-v';\n\t\t\t\tthis.classNameAnim = 'bx-ui-tooltip-info-shadow-v-anim';\n\t\t\t\tthis.classNameFixed = 'bx-ui-tooltip-info-shadow-v';\n\t\t\t}\n\t\t}\n\n\t\tthis.DIV.style.display = 'block';\n\n\t\tif (!stubCreated)\n\t\t{\n\t\t\tthis.adjustPosition();\n\t\t}\n\n\t\tthis.showOpacityEffect(0);\n\n\t\tdocument.getElementById(`${Tooltip.getIdPrefix()}${this.userId}`).onmouseover = () => {\n\t\t\tthis.startTrackMouse(this);\n\t\t};\n\n\t\tdocument.getElementById(`${Tooltip.getIdPrefix()}${this.userId}`).onmouseout = () => {\n\t\t\tthis.stopTrackMouse(this);\n\t\t};\n\n\t\tEventEmitter.emit('onTooltipShow', new BaseEvent({\n\t\t\tcompatData: [ this ],\n\t\t}));\n\t}\n\n\tadjustPosition()\n\t{\n\t\tconst tooltipCoords = BX.pos(this.DIV);\n\n\t\tif (this.vMirror)\n\t\t{\n\t\t\tthis.ROOT_DIV.style.top = `${parseInt(this.anchorTop + this.elCoords.height)}px`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.ROOT_DIV.style.top = `${parseInt(this.anchorTop - tooltipCoords.height - 13 + 12)}px`; // 12 - bottom block\n\t\t}\n\t}\n\n\tinsertData(data)\n\t{\n\t\tif (\n\t\t\tnull != data\n\t\t\t&& (\n\t\t\t\tthis.version >= 3\n\t\t\t\t|| data.length > 0\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\tif (this.version >= 3)\n\t\t\t{\n\t\t\t\tthis.INFO = data;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\teval(`this.INFO = ${data}`);\n\t\t\t}\n\n\t\t\tconst cardEl = document.getElementById(`${Tooltip.getIdPrefix()}data-card-${this.userId}`);\n\t\t\tcardEl.innerHTML = '';\n\t\t\tif (Type.isStringFilled(this.INFO.RESULT.Name))\n\t\t\t{\n\t\t\t\tcardEl.innerHTML += `<div class=\"bx-ui-tooltip-user-name-block\">${this.INFO.RESULT.Name}</div>`;\n\t\t\t}\n\t\t\tif (Type.isStringFilled(this.INFO.RESULT.Position))\n\t\t\t{\n\t\t\t\tcardEl.innerHTML += `<div class=\"bx-ui-tooltip-user-position\">${this.INFO.RESULT.Position}</div>`;\n\t\t\t}\n\t\t\tcardEl.innerHTML += this.INFO.RESULT.Card;\n\n\t\t\tconst photoEl = document.getElementById(`${Tooltip.getIdPrefix()}photo-${this.userId}`);\n\t\t\tphotoEl.innerHTML = this.INFO.RESULT.Photo;\n\n\t\t\tconst toolbarEl = document.getElementById(`${Tooltip.getIdPrefix()}toolbar-${this.userId}`);\n\t\t\ttoolbarEl.innerHTML = this.INFO.RESULT.Toolbar;\n\n\t\t\tconst toolbar2El = document.getElementById(`${Tooltip.getIdPrefix()}toolbar2-${this.userId}`);\n\t\t\ttoolbar2El.innerHTML = this.INFO.RESULT.Toolbar2;\n\n\t\t\tif (Type.isArray(this.INFO.RESULT.Scripts))\n\t\t\t{\n\t\t\t\tthis.INFO.RESULT.Scripts.forEach((script) => {\n\t\t\t\t\teval(script);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tEventEmitter.emit('onTooltipInsertData', new BaseEvent({\n\t\t\t\tcompatData: [ this ],\n\t\t\t}));\n\t\t}\n\t}\n}\n","import { Browser, Event, Type } from 'main.core';\nimport { Interceptor } from './intercept';\n\nimport { Tooltip } from './tooltip.js';\nimport { TooltipBalloon } from './balloon.js';\n\nimport './css/style.css';\n\nEvent.ready(() => {\n\tif (\n\t\tBrowser.isAndroid()\n\t\t|| Browser.isIOS()\n\t)\n\t{\n\t\treturn;\n\t}\n\n\tEvent.bind(document, 'mouseover', (e) => {\n\t\tconst node = e.target;\n\t\tif (!Type.isElementNode(node))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst userId = node.getAttribute('bx-tooltip-user-id');\n\t\tconst loader = node.getAttribute('bx-tooltip-loader');\n\t\tconst context = node.getAttribute('bx-tooltip-context');\n\n\t\tif (\n\t\t\tType.isStringFilled(context)\n\t\t\t&& Interceptor.try(context, userId, node)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet tooltipId = userId; // don't use integer value!\n\n\t\tif (Type.isStringFilled(loader))\n\t\t{\n\t\t\tlet loaderHash = 0;\n\n\t\t\t[...loader].forEach((c, i) => {\n\t\t\t\tloaderHash = (31 * loaderHash + loader.charCodeAt(i)) << 0;\n\t\t\t});\n\n\t\t\ttooltipId = loaderHash + userId;\n\t\t}\n\n\t\tif (Type.isStringFilled(userId))\n\t\t{\n\t\t\tif (null == Tooltip.tooltipsList[tooltipId])\n\t\t\t{\n\t\t\t\tTooltip.tooltipsList[tooltipId] = new TooltipBalloon({\n\t\t\t\t\tuserId: userId,\n\t\t\t\t\tnode: node,\n\t\t\t\t\tloader: loader,\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tTooltip.tooltipsList[tooltipId].node = node;\n\t\t\t\tTooltip.tooltipsList[tooltipId].create();\n\t\t\t}\n\n\t\t\te.preventDefault();\n\t\t}\n\t});\n});\n\nexport {\n\tTooltip,\n\tTooltipBalloon,\n};\n"],"names":["Context","Object","freeze","B24","Interceptor","try","context","userId","node","Type","isStringFilled","isNumber","Number","BX","Intranet","User","UserMiniProfileManager","create","id","bindElement","Tooltip","disable","disabled","enable","getDisabledStatus","getLoader","getIdPrefix","tooltipsList","TooltipBalloon","constructor","params","handleClick","hideTooltip","stopTrackMouse","loader","version","tracking","active","width","height","realAnchor","coordsLeft","coordsTop","anchorRight","anchorTop","hMirror","vMirror","rootClassName","INFO","DIV","ROOT_DIV","trackMouseHandle","trackMouse","bind","init","isUndefined","parseInt","getAttribute","paramsString","anchorParams","JSON","parse","isPlainObject","EventEmitter","subscribe","onSliderOpen","startTrackMouse","Event","elCoords","pos","left","top","right","document","addEventListener","setTimeout","tickTimer","removeEventListener","e","current","pageX","x","y","pageY","clientX","body","scrollLeft","clientY","scrollTop","time","showTooltip","showOpacityEffect","bFade","steps","period","delta","i","intId","setInterval","clearInterval","op","style","opacity","classList","add","display","remove","emit","BaseEvent","compatData","old","getElementById","contains","appendChild","createElement","position","ZIndexManager","register","className","arScroll","GetWindowScrollPos","clientWidth","bringToFront","stopPropagation","stubCreated","innerHTML","ajax","runComponentAction","mode","data","then","response","detailUrl","user","cardUserName","nameFormatted","cardFields","keys","forEach","fieldCode","toLowerCase","name","value","cardFieldsClassName","Loc","getMessage","currentUserPerms","operations","videocall","photo","photoClassName","toolbar","toolbar2","message","hasBirthday","hasHonour","hasAbsence","insertData","RESULT","Name","Position","Card","Photo","Toolbar","Toolbar2","adjustPosition","url","indexOf","entityType","entityId","get","classNameAnim","classNameFixed","onmouseover","onmouseout","tooltipCoords","length","eval","cardEl","photoEl","toolbarEl","toolbar2El","isArray","Scripts","script","ready","Browser","isAndroid","isIOS","target","isElementNode","tooltipId","loaderHash","c","charCodeAt","preventDefault"],"mappings":"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"}