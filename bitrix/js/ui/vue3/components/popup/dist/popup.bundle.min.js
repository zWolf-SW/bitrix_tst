this.BX=this.BX||{};this.BX.UI=this.BX.UI||{};this.BX.UI.Vue3=this.BX.UI.Vue3||{};(function(e,t,i){"use strict";class s{constructor(e){this.popup=null;this.sliders=new Set;this.popup=e;this.getPopup().subscribe("onShow",this.onPopupShow.bind(this));this.getPopup().subscribe("onClose",this.onPopupClose.bind(this));this.getPopup().subscribe("onDestroy",this.onPopupClose.bind(this));this.handleSliderOpen=this.handleSliderOpen.bind(this);this.handleSliderClose=this.handleSliderClose.bind(this);this.handleSliderDestroy=this.handleSliderDestroy.bind(this)}bindEvents(){this.unbindEvents();if(top.BX){top.BX.Event.EventEmitter.subscribe("SidePanel.Slider:onOpen",this.handleSliderOpen);top.BX.Event.EventEmitter.subscribe("SidePanel.Slider:onCloseComplete",this.handleSliderClose);top.BX.Event.EventEmitter.subscribe("SidePanel.Slider:onDestroy",this.handleSliderDestroy)}}unbindEvents(){if(top.BX){top.BX.Event.EventEmitter.unsubscribe("SidePanel.Slider:onOpen",this.handleSliderOpen);top.BX.Event.EventEmitter.unsubscribe("SidePanel.Slider:onCloseComplete",this.handleSliderClose);top.BX.Event.EventEmitter.unsubscribe("SidePanel.Slider:onDestroy",this.handleSliderDestroy)}}onPopupShow(){this.bindEvents()}onPopupClose(){this.unbindEvents();this.sliders.clear();this.popup.unfreeze()}handleSliderOpen(e){const[t]=e.getData();const i=t.getSlider();if(!this.isPopupInSlider(i)){this.sliders.add(i);this.popup.freeze()}}handleSliderClose(e){const[t]=e.getData();const i=t.getSlider();this.sliders.delete(i);if(this.sliders.size===0){this.popup.unfreeze()}}handleSliderDestroy(e){const[t]=e.getData();const i=t.getSlider();if(this.isPopupInSlider(i)){this.unbindEvents();this.getPopup().destroy()}else{this.sliders.delete(i);if(this.sliders.size===0){this.popup.unfreeze()}}}isPopupInSlider(e){if(e.getFrameWindow()){return e.getFrameWindow().document.contains(this.getPopup().getPopupContainer())}return e.getContainer().contains(this.getPopup().getPopupContainer())}getPopup(){return this.popup.getPopupInstance()}}const n={props:{id:{type:String,default:()=>`ui-vue3-popup-${t.Text.getRandom()}`},options:{type:Object,default:null}},emits:["close"],computed:{popupContainer(){return`#${this.popupOptions.id}`},container(){return this.getPopupInstance().getPopupContainer()},popupOptions(){return{...this.defaultOptions,...this.options}},defaultOptions(){return{id:this.id,cacheable:false,autoHide:true,autoHideHandler:this.autoHideHandler,closeByEsc:true,animation:"fading",bindOptions:{forceBindPosition:true},events:{onPopupClose:this.closePopup,onPopupDestroy:this.closePopup}}}},created(){new s(this)},beforeMount(){this.getPopupInstance().show()},mounted(){this.adjustPosition();this.getPopupInstance().getContentContainer().remove()},beforeUnmount(){var e;this.popupHTML=(e=this.instance.getPopupContainer())==null?void 0:e.innerHTML},unmounted(){var e;if(this.popupHTML){this.instance.getPopupContainer().innerHTML=this.popupHTML}(e=this.instance)==null?void 0:e.close()},methods:{contains(e){var t;return(t=this.container.contains(e))!=null?t:false},adjustPosition(){this.getPopupInstance().adjustPosition(this.popupOptions.bindOptions)},freeze(){this.getPopupInstance().setAutoHide(false);this.getPopupInstance().setClosingByEsc(false)},unfreeze(){this.getPopupInstance().setAutoHide(this.popupOptions.autoHide);this.getPopupInstance().setClosingByEsc(this.popupOptions.closeByEsc)},getPopupInstance(){if(!this.instance){var e;(e=i.PopupManager.getPopupById(this.popupOptions.id))==null?void 0:e.destroy();this.instance=new i.Popup(this.popupOptions)}return this.instance},autoHideHandler({target:e}){const t=e!==this.container&&!this.container.contains(e);const i=e.closest(".popup-window-ui-tour");return t&&!i},closePopup(){this.$emit("close")}},template:`\n\t\t<Teleport :to="popupContainer">\n\t\t\t<slot :adjustPosition="adjustPosition" :freeze="freeze" :unfreeze="unfreeze"></slot>\n\t\t</Teleport>\n\t`};e.Popup=n})(this.BX.UI.Vue3.Components=this.BX.UI.Vue3.Components||{},BX,BX.Main);
//# sourceMappingURL=popup.bundle.map.js