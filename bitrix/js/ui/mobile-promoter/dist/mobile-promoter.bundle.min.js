this.BX=this.BX||{};(function(t,e,i,o,s){"use strict";let n=t=>t,r,a,l,p,h,c;class d{constructor(t){this.target=e.Type.isElementNode(t.target)?t.target:window;this.qrContent=e.Type.isString(t.qrContent)?t.qrContent:"";this.position=e.Type.isObject(t.position)?t.position:null;this.className=e.Type.isString(t.className)?t.className:null;this.node={content:null,phoneBg:null,qr:null,qrOverlay:null};this.title=e.Type.isString(t.title)?t.title:e.Loc.getMessage("UI_MOBILE_PROMOTER_TITLE");this.content=e.Type.isElementNode(t.content)?t.content:null;this.analytic=e.Type.isObject(t.analytic)?t.analytic:null;this.analyticParameters={tool:"intranet",category:"activation"};this.init()}getPopup(){if(!this.popup){this.popup=new i.Popup({bindElement:this.target,borderRadius:"32px 32px 32px 32px",padding:0,contentPadding:0,closeIcon:{top:"19px",right:"19px"},content:this.getContent(),className:`ui-mobile-promoter__popup ${this.className} --qr-hide`,animation:"fading-slide",maxWidth:550,minHeight:330,autoHide:true,overlay:{backgroundColor:"black",opacity:15},events:{onPopupShow:()=>{},onAfterShow:()=>{this.setAnalyticParameters({event:"qrcode_view"});this.sendAnalytics()},onPopupClose:()=>{e.Dom.removeClass(this.getQrBg(),"--qr-animation")},onAfterClose:()=>{this.setAnalyticParameters({event:"qrcode_close"});this.sendAnalytics()}}})}return this.popup}getAnimation(){if(!this.lottieAnim){this.lottieAnim=s.Lottie.loadAnimation({autoplay:false,container:this.getPhoneBg(),renderer:"svg",path:"/bitrix/js/ui/mobile-promoter/animation/invitation.json",loop:false,name:"invitation-anim"})}return this.lottieAnim}getQrBg(){if(!this.node.qr){this.node.qr=e.Tag.render(r||(r=n`
				<div class="ui-mobile-promoter__popup-qr"></div>
			`))}return this.node.qr}getPhoneBg(){if(!this.node.phoneBg){this.node.phoneBg=e.Tag.render(a||(a=n`
				<div class="ui-mobile-promoter__popup-phone"></div>
			`))}return this.node.phoneBg}getDefaultContent(){return e.Tag.render(l||(l=n`
			<ul class="ui-mobile-promoter__popup-list">
				<li class="ui-mobile-promoter__popup-list-item">${0}</li>
				<li class="ui-mobile-promoter__popup-list-item">${0}</li>
				<li class="ui-mobile-promoter__popup-list-item">${0}</li>
			</ul>
			<div class="ui-mobile-promoter__popup-list-afterlist">
				<div class="ui-mobile-promoter__popup-desc">${0}</div>
				<div class="ui-mobile-promoter__popup-info">${0}</div>
			</div>
		`),e.Loc.getMessage("UI_MOBILE_PROMOTER_LIST_ITEM_1"),e.Loc.getMessage("UI_MOBILE_PROMOTER_LIST_ITEM_2"),e.Loc.getMessage("UI_MOBILE_PROMOTER_LIST_ITEM_3"),e.Loc.getMessage("UI_MOBILE_PROMOTER_DESC"),e.Loc.getMessage("UI_MOBILE_PROMOTER_INFO"))}showQrCode(){e.Dom.removeClass(this.getContent(),"--qr-hide");e.Dom.addClass(this.getQrOverlay(),"--hide");e.Dom.addClass(this.getQrBg(),"--qr-animation")}getQrOverlay(){if(!this.node.qrOverlay){const t=e.Tag.render(p||(p=n`
				<span class="ui-btn --air ui-btn-no-caps --style-tinted ui-btn-xs">
					<span class="ui-btn-text">
						<span class="ui-btn-text-inner">${0}</span>
					</span>
				</span>
			`),e.Loc.getMessage("UI_MOBILE_PROMOTER_SHOW_QR"));e.Event.bind(t,"click",(()=>this.showQrCode()));this.node.qrOverlay=e.Tag.render(h||(h=n`
				<div class="ui-mobile-promoter__popup-qr-overlay">
					<div class="ui-mobile-promoter__popup-qr-overlay-text">
						${0}
					</div>
				</div>
			`),t);e.Event.bind(this.node.qrOverlay,"transitionend",(()=>{e.Dom.remove(this.node.qrOverlay)}))}return this.node.qrOverlay}getContent(){if(!this.node.content){var t;this.node.content=e.Tag.render(c||(c=n`
				<div class="ui-mobile-promoter__popup-wrap --qr-hide">
					<div class="ui-mobile-promoter__popup-phone-box">
						${0}
						${0}
						${0}
					</div>
					<div class="ui-mobile-promoter__popup-content">
						<div class="ui-mobile-promoter__popup-title">${0}</div>
						<div class="ui-mobile-promoter__popup-content">
							${0}
						</div>
					</div>
				</div>
			`),this.getPhoneBg(),this.getQrOverlay(),this.getQrBg(),this.title,(t=this.content)!=null?t:this.getDefaultContent())}return this.node.content}init(){new QRCode(this.getQrBg(),{text:this.qrContent,width:123,height:123,colorDark:"#000000",colorLight:"#ffffff"});if(this.analytic){this.setAnalyticParameters(this.analytic)}if(this.position){this.getPopup().setFixed(true);e.Dom.addClass(this.getPopup().getPopupContainer(),"--right-bottom");Object.entries(this.position).forEach((([t,i])=>{e.Dom.style(this.getPopup().getPopupContainer(),t,`${i}px`)}))}}show(){this.getPopup().show()}close(){this.getPopup().close()}setAnalyticParameters(t){this.analyticParameters={...this.analyticParameters,...t}}sendAnalytics(){o.sendData(this.analyticParameters)}}t.MobilePromoter=d})(this.BX.UI=this.BX.UI||{},BX,BX.Main,BX.UI.Analytics,BX.UI);
//# sourceMappingURL=mobile-promoter.bundle.map.js