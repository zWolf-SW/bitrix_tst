{"version":3,"file":"sidepanel.layout.bundle.js","sources":["../src/index.js"],"sourcesContent":["import 'ui.fonts.opensans';\nimport './css/style.css';\nimport 'sidepanel';\nimport { Dom, Tag, Type, BaseError, Event, Runtime } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { CloseButton, CancelButton, BaseButton } from 'ui.buttons';\nimport { Menu, type MenuOptions, Item as MenuItem } from 'ui.sidepanel.menu';\n\nconst UI = BX.UI;\nconst SidePanel = BX.SidePanel;\n\ntype DesignOptions = {\n\tmargin: ?boolean;\n\tsection: ?boolean;\n\talignButtonsLeft: ?boolean;\n};\n\ntype SidePanelMenuOptions = {\n\t...MenuOptions;\n\tcontentAttribute: ?string;\n};\n\ntype Options = {\n\textensions: ?Array<string>;\n\ttitle: ?string;\n\ttoolbar: ?Function;\n\tcontent: string | Element | Promise | BX.Promise;\n\tbuttons: ?Function;\n\tdesign: ?DesignOptions;\n\tmenu: ?SidePanelMenuOptions;\n};\n\nfunction prepareOptions(options: Options = {}): Options\n{\n\toptions = { ...options };\n\toptions.design = { ...options.design };\n\toptions.design = {\n\t\tmargin: true,\n\t\tsection: true,\n\t\t...options.design,\n\t};\n\n\toptions.extensions = [...(options.extensions || []),\n\t\t'ui.sidepanel.layout',\n\t\t'ui.buttons',\n\t];\n\tif (options.toolbar)\n\t{\n\t\toptions.extensions.push('ui.buttons.icons');\n\t}\n\n\tif (options.design.section)\n\t{\n\t\toptions.extensions.push('ui.sidepanel-content');\n\t}\n\n\tif (options.menu)\n\t{\n\t\toptions.extensions.push('ui.sidepanel.menu');\n\t}\n\n\treturn options;\n}\n\nexport class Layout\n{\n\tstatic createContent(options: Options = {}): Promise<any | HTMLElement>\n\t{\n\t\toptions = prepareOptions(options);\n\n\t\treturn top.BX.Runtime\n\t\t\t.loadExtension(options.extensions)\n\t\t\t.then(() => (new Layout(options)).render())\n\t\t;\n\t}\n\n\tstatic createLayout(options: Options = {}): Promise\n\t{\n\t\toptions = prepareOptions(options);\n\n\t\treturn top.BX.Runtime\n\t\t\t.loadExtension(options.extensions)\n\t\t\t.then(() => new Layout(options))\n\t\t;\n\t}\n\n\t#container;\n\t#containerFooter;\n\t#options;\n\t#menu: Menu;\n\n\tconstructor(options: Options = {})\n\t{\n\t\tthis.#options = prepareOptions(options);\n\t\tconst menuOptions = this.#options.menu;\n\t\tif (menuOptions)\n\t\t{\n\t\t\tthis.#menu = new Menu(Object.assign(menuOptions));\n\t\t\tif (Type.isUndefined(menuOptions.contentAttribute))\n\t\t\t{\n\t\t\t\tmenuOptions.contentAttribute = 'data-menu-item-id';\n\t\t\t}\n\n\t\t\tif (menuOptions.contentAttribute)\n\t\t\t{\n\t\t\t\tthis.#menu.subscribe('click', (event: BaseEvent) => {\n\t\t\t\t\tthis.#onMenuItemClick((event.getData() || {}).item);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\tif (!this.#container)\n\t\t{\n\t\t\tthis.#container = Tag.render`<div class=\"ui-sidepanel-layout\"></div>`;\n\t\t}\n\n\t\treturn this.#container;\n\t}\n\n\tgetMenu(): Menu\n\t{\n\t\treturn this.#menu;\n\t}\n\n\tgetFooterContainer(): HTMLElement\n\t{\n\t\tif (!this.#containerFooter)\n\t\t{\n\t\t\tthis.#containerFooter = Tag.render`<div class=\"ui-sidepanel-layout-footer\"></div>`;\n\t\t}\n\n\t\treturn this.#containerFooter;\n\t}\n\n\trender(content: string = '', promised: boolean = false)\n\t{\n\t\tif (this.#options.content && !promised)\n\t\t{\n\t\t\tcontent = this.#options.content();\n\t\t\tif (\n\t\t\t\tObject.prototype.toString.call(content) === '[object Promise]'\n\t\t\t\t|| (content.toString && content.toString() === '[object BX.Promise]')\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn content.then((content) => this.render(content, true));\n\t\t\t}\n\t\t}\n\n\t\tconst container = this.getContainer();\n\t\tcontainer.innerHTML = '';\n\n\t\t// HEADER\n\t\tif (this.#options.title)\n\t\t{\n\t\t\tconst title = Tag.safe`${this.#options.title}`;\n\t\t\tconst header = Tag.render`\n\t\t\t\t<div class=\"ui-sidepanel-layout-header\">\n\t\t\t\t\t<div class=\"ui-sidepanel-layout-title\">${title}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tif (Type.isFunction(this.#options.toolbar))\n\t\t\t{\n\t\t\t\tconst toolbar = Tag.render`<div class=\"ui-sidepanel-layout-toolbar\"></div>`;\n\t\t\t\tthis.#options.toolbar({ ...UI }).forEach((button) => {\n\t\t\t\t\tif (button instanceof BaseButton)\n\t\t\t\t\t{\n\t\t\t\t\t\tbutton.renderTo(toolbar);\n\t\t\t\t\t}\n\t\t\t\t\telse if (Type.isDomNode(button))\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.append(button, toolbar);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthrow new BaseError(`Wrong button type ${button}`);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tDom.append(toolbar, header);\n\t\t\t}\n\n\t\t\tDom.append(header, container);\n\t\t}\n\n\t\t// CONTENT\n\t\t{\n\t\t\tconst design = this.#options.design;\n\t\t\tconst classes = ['ui-sidepanel-layout-content'];\n\t\t\tconst styles = [];\n\t\t\tif (design.margin)\n\t\t\t{\n\t\t\t\tif (design.margin === true)\n\t\t\t\t{\n\t\t\t\t\tclasses.push('ui-sidepanel-layout-content-margin');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstyles.push(`margin: ${design.margin}`);\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet contentElement = Tag.render`<div class=\"${classes.join(' ')}\" style=\"${styles.join('; ')}\"></div>`;\n\t\t\tDom.append(contentElement, container);\n\n\t\t\tif (this.#menu)\n\t\t\t{\n\t\t\t\tthis.#menu.renderTo(contentElement);\n\t\t\t}\n\t\t\tDom.append(Tag.render`<div class=\"ui-sidepanel-layout-content-inner\"></div>`, contentElement);\n\t\t\tcontentElement = contentElement.lastElementChild;\n\n\t\t\tif (design.section)\n\t\t\t{\n\t\t\t\tDom.append(Tag.render`<div class=\"ui-slider-section ui-sidepanel-layout-content-fill-height\"></div>`, contentElement);\n\t\t\t\tcontentElement = contentElement.firstElementChild;\n\t\t\t}\n\n\t\t\tif (Type.isString(content))\n\t\t\t{\n\t\t\t\tcontentElement.innerHTML = content;\n\t\t\t}\n\t\t\telse if (content instanceof Element)\n\t\t\t{\n\t\t\t\tDom.append(content, contentElement);\n\t\t\t}\n\n\t\t\tif (this.#menu)\n\t\t\t{\n\t\t\t\tthis.#onMenuItemClick(this.#menu.getActiveItem(), contentElement);\n\t\t\t}\n\t\t}\n\n\t\t// FOOTER\n\t\tconst isButtonsUndefined = Type.isUndefined(this.#options.buttons);\n\t\tif (Type.isFunction(this.#options.buttons) || isButtonsUndefined)\n\t\t{\n\t\t\tconst cancelButton = new CancelButton({ onclick: () => SidePanel.Instance.close() });\n\t\t\tconst closeButton = new CloseButton({ onclick: () => SidePanel.Instance.close() });\n\t\t\tconst defaults = {\n\t\t\t\t...UI,\n\t\t\t\tcancelButton,\n\t\t\t\tcloseButton,\n\t\t\t};\n\t\t\tif (isButtonsUndefined)\n\t\t\t{\n\t\t\t\tthis.#options.buttons = () => [closeButton];\n\t\t\t}\n\n\t\t\tconst buttonList = this.#options.buttons(defaults);\n\t\t\tif (buttonList && buttonList.length > 0)\n\t\t\t{\n\t\t\t\tDom.append(Tag.render`<div class=\"ui-sidepanel-layout-footer-anchor\"></div>`, container);\n\n\t\t\t\tconst classes = ['ui-sidepanel-layout-buttons'];\n\t\t\t\tif (this.#options.design.alignButtonsLeft)\n\t\t\t\t{\n\t\t\t\t\tclasses.push('ui-sidepanel-layout-buttons-align-left');\n\t\t\t\t}\n\t\t\t\tconst buttons = Tag.render`<div class=\"${classes.join(' ')}\"></div>`;\n\t\t\t\tDom.append(buttons, this.getFooterContainer());\n\t\t\t\tbuttonList.forEach((button) => {\n\t\t\t\t\tif (button instanceof BaseButton)\n\t\t\t\t\t{\n\t\t\t\t\t\tbutton.renderTo(buttons);\n\t\t\t\t\t}\n\t\t\t\t\telse if (Type.isDomNode(button))\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.append(button, buttons);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthrow new BaseError(`Wrong button type ${button}`);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tDom.append(this.getFooterContainer(), container);\n\t\t\t}\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\tthis.afterRender();\n\t\t});\n\n\t\treturn container;\n\t}\n\n\tafterRender()\n\t{\n\t\tthis.#adjustFooter();\n\n\t\tconst resizeHandler = Runtime.throttle(this.#adjustFooter, 300, this);\n\t\tEvent.bind(window, 'resize', resizeHandler);\n\n\t\tconst topSlider = SidePanel.Instance.getTopSlider();\n\t\tif (topSlider)\n\t\t{\n\t\t\tEventEmitter.subscribeOnce(topSlider, 'SidePanel.Slider:onDestroy', () => {\n\t\t\t\tEvent.unbind(window, 'resize', resizeHandler);\n\t\t\t});\n\t\t}\n\t}\n\n\t#getScrollWidth(): number\n\t{\n\t\tconst div = Tag.render`<div style=\"overflow-y: scroll; width: 50px; height: 50px; opacity: 0; pointer-events: none; position: absolute;\"></div>`;\n\t\tDom.append(div, document.body);\n\t\tconst scrollWidth = div.offsetWidth - div.clientWidth;\n\t\tDom.remove(div);\n\n\t\treturn scrollWidth;\n\t}\n\n\t#adjustFooter()\n\t{\n\t\tconst parentSet = this.getContainer().parentNode;\n\n\t\tif (\n\t\t\tparentSet !== null\n\t\t\t&& parentSet.scrollWidth > parentSet.offsetWidth\n\t\t)\n\t\t{\n\t\t\tDom.style(this.getFooterContainer(), 'bottom', `${this.#getScrollWidth()}px`);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(this.getFooterContainer(), 'bottom', 0);\n\t\t}\n\t}\n\n\t#onMenuItemClick(item: MenuItem, container: HTMLElement = null)\n\t{\n\t\tif (!item)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst id = item.getId();\n\t\tconst attr = this.#options.menu.contentAttribute;\n\t\tif (!attr)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tcontainer = container || this.#container;\n\t\tlet nodes = container.querySelectorAll(`[${attr}]`);\n\t\tnodes = Array.prototype.slice.call(nodes);\n\t\tnodes.forEach((node) => {\n\t\t\tnode.hidden = node.getAttribute(attr) !== id;\n\t\t});\n\t}\n}\n"],"names":["UI","BX","SidePanel","prepareOptions","options","design","margin","section","extensions","toolbar","push","menu","Layout","createContent","top","Runtime","loadExtension","then","render","createLayout","constructor","menuOptions","Menu","Object","assign","Type","isUndefined","contentAttribute","subscribe","event","getData","item","getContainer","Tag","getMenu","getFooterContainer","content","promised","prototype","toString","call","container","innerHTML","title","safe","header","isFunction","forEach","button","BaseButton","renderTo","isDomNode","Dom","append","BaseError","classes","styles","contentElement","join","lastElementChild","firstElementChild","isString","Element","getActiveItem","isButtonsUndefined","buttons","cancelButton","CancelButton","onclick","Instance","close","closeButton","CloseButton","defaults","buttonList","length","alignButtonsLeft","setTimeout","afterRender","resizeHandler","throttle","Event","bind","window","topSlider","getTopSlider","EventEmitter","subscribeOnce","unbind","div","document","body","scrollWidth","offsetWidth","clientWidth","remove","parentSet","parentNode","style","id","getId","attr","nodes","querySelectorAll","Array","slice","node","hidden","getAttribute"],"mappings":"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"}