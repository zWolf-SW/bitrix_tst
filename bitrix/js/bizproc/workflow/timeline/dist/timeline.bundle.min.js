this.BX=this.BX||{};this.BX.Bizproc=this.BX.Bizproc||{};(function(e,s,i,t,a,l,r,o,n){"use strict";let c=e=>e,d,b;var p=babelHelpers.classPrivateFieldLooseKey("errors");class v{constructor(e){Object.defineProperty(this,p,{writable:true,value:[]});if(n.Type.isArrayFilled(e.errors)){babelHelpers.classPrivateFieldLooseBase(this,p)[p]=e.errors}}render(){return n.Tag.render(d||(d=c`
			<div class="bizproc-workflow-timeline_error-wrapper">
				<div class="bizproc-workflow-timeline_error-inner">
					${0}
					<div class="bizproc-workflow-timeline_error-img"></div>
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,p)[p].map((({message:e})=>n.Tag.render(b||(b=c`
						<p class="bizproc-workflow-timeline_error-text">${0}</p>
					`),n.Text.encode(e)))))}renderTo(e){n.Dom.append(this.render(),e)}}var u=babelHelpers.classPrivateFieldLooseKey("data");class L{constructor(e){Object.defineProperty(this,u,{writable:true,value:{}});if(n.Type.isPlainObject(e)){babelHelpers.classPrivateFieldLooseBase(this,u)[u]=e}}canView(){return n.Type.isBoolean(babelHelpers.classPrivateFieldLooseBase(this,u)[u].canView)?babelHelpers.classPrivateFieldLooseBase(this,u)[u].canView:false}get status(){return new o.TaskStatus(babelHelpers.classPrivateFieldLooseBase(this,u)[u].status)}get id(){return n.Type.isInteger(babelHelpers.classPrivateFieldLooseBase(this,u)[u].id)?babelHelpers.classPrivateFieldLooseBase(this,u)[u].id:0}get name(){return n.Type.isString(babelHelpers.classPrivateFieldLooseBase(this,u)[u].name)?babelHelpers.classPrivateFieldLooseBase(this,u)[u].name:""}get modified(){return n.Type.isInteger(babelHelpers.classPrivateFieldLooseBase(this,u)[u].modified)?Math.max(babelHelpers.classPrivateFieldLooseBase(this,u)[u].modified,0):0}get users(){return n.Type.isArray(babelHelpers.classPrivateFieldLooseBase(this,u)[u].users)?babelHelpers.classPrivateFieldLooseBase(this,u)[u].users:[]}get executionTime(){return n.Type.isInteger(babelHelpers.classPrivateFieldLooseBase(this,u)[u].executionTime)?Math.max(babelHelpers.classPrivateFieldLooseBase(this,u)[u].executionTime,0):null}get approveType(){return n.Type.isString(babelHelpers.classPrivateFieldLooseBase(this,u)[u].approveType)?babelHelpers.classPrivateFieldLooseBase(this,u)[u].approveType:""}get url(){return n.Type.isStringFilled(babelHelpers.classPrivateFieldLooseBase(this,u)[u].url)?babelHelpers.classPrivateFieldLooseBase(this,u)[u].url:null}}let P=e=>e,f,h,F,I,m,B,_,O;const E=60*60*24*3;var T=babelHelpers.classPrivateFieldLooseKey("task");var H=babelHelpers.classPrivateFieldLooseKey("userId");var g=babelHelpers.classPrivateFieldLooseKey("taskNumber");var R=babelHelpers.classPrivateFieldLooseKey("dateFormat");var w=babelHelpers.classPrivateFieldLooseKey("dateFormatShort");var y=babelHelpers.classPrivateFieldLooseKey("users");var k=babelHelpers.classPrivateFieldLooseKey("renderContent");var M=babelHelpers.classPrivateFieldLooseKey("renderButton");var S=babelHelpers.classPrivateFieldLooseKey("renderStatus");var N=babelHelpers.classPrivateFieldLooseKey("getStatusName");var W=babelHelpers.classPrivateFieldLooseKey("renderUsers");var K=babelHelpers.classPrivateFieldLooseKey("renderUser");var D=babelHelpers.classPrivateFieldLooseKey("renderExecutionTime");var z=babelHelpers.classPrivateFieldLooseKey("renderAccessDenied");class C{constructor(e){Object.defineProperty(this,z,{value:G});Object.defineProperty(this,D,{value:X});Object.defineProperty(this,K,{value:U});Object.defineProperty(this,W,{value:A});Object.defineProperty(this,N,{value:Z});Object.defineProperty(this,S,{value:x});Object.defineProperty(this,M,{value:j});Object.defineProperty(this,k,{value:$});Object.defineProperty(this,T,{writable:true,value:void 0});Object.defineProperty(this,H,{writable:true,value:0});Object.defineProperty(this,g,{writable:true,value:null});Object.defineProperty(this,R,{writable:true,value:void 0});Object.defineProperty(this,w,{writable:true,value:void 0});Object.defineProperty(this,y,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,T)[T]=e.task;babelHelpers.classPrivateFieldLooseBase(this,R)[R]=e.dateFormat;babelHelpers.classPrivateFieldLooseBase(this,w)[w]=e.dateFormatShort;babelHelpers.classPrivateFieldLooseBase(this,y)[y]=e.users;if(n.Type.isNumber(e.taskNumber)&&e.taskNumber>0){babelHelpers.classPrivateFieldLooseBase(this,g)[g]=e.taskNumber}if(n.Type.isNumber(e.userId)&&e.userId>0){babelHelpers.classPrivateFieldLooseBase(this,H)[H]=e.userId}}renderTo(e){n.Dom.append(this.render(),e)}render(){return babelHelpers.classPrivateFieldLooseBase(this,T)[T].canView()?babelHelpers.classPrivateFieldLooseBase(this,k)[k]():babelHelpers.classPrivateFieldLooseBase(this,z)[z]()}}function $(){const e=babelHelpers.classPrivateFieldLooseBase(this,T)[T].status.isWaiting();return n.Tag.render(f||(f=P`
			<div class="bizproc-workflow-timeline-item ${0}">
				<div class="bizproc-workflow-timeline-item-inner">
					<div>
						<span class="bizproc-workflow-timeline-icon ${0}">
							${0}
						</span>
						<div class="bizproc-workflow-timeline-title">
							<span>${0}</span>
							${0}
						</div>
					</div>
					<div class="bizproc-workflow-timeline-subject">
						${0}
					</div>
					<div class="bizproc-workflow-timeline-content">
						${0}
						${0}
						${0}
					</div>
				</div>
			</div>
		`),e?"--processing":"",e?"--processing":"--success",e?"":babelHelpers.classPrivateFieldLooseBase(this,g)[g]||"",n.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,T)[T].name),babelHelpers.classPrivateFieldLooseBase(this,M)[M](),n.Text.encode(Fe.formatDate(babelHelpers.classPrivateFieldLooseBase(this,T)[T].modified,babelHelpers.classPrivateFieldLooseBase(this,R)[R],babelHelpers.classPrivateFieldLooseBase(this,w)[w])),babelHelpers.classPrivateFieldLooseBase(this,S)[S](),babelHelpers.classPrivateFieldLooseBase(this,W)[W](),babelHelpers.classPrivateFieldLooseBase(this,D)[D]())}function j(){if(babelHelpers.classPrivateFieldLooseBase(this,H)[H]===0||!babelHelpers.classPrivateFieldLooseBase(this,T)[T].url){return null}const e=babelHelpers.classPrivateFieldLooseBase(this,T)[T].users.find((e=>e.id===babelHelpers.classPrivateFieldLooseBase(this,H)[H]));if(n.Type.isUndefined(e)){return null}const s=new o.UserStatus(e.status).isWaiting();return n.Tag.render(h||(h=P`
			<a
				class="
					bizproc-workflow-timeline-task-link
					bizproc-workflow-timeline-task-link-${0}
				"
				href="${0}"
			>
				${0}
			</a>
		`),s?"blue":"gray",n.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,T)[T].url||new n.Uri(`/company/personal/bizproc/${babelHelpers.classPrivateFieldLooseBase(this,T)[T].id}/`).toString()),n.Text.encode(s?n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_BUTTON_PROCEED"):n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_BUTTON_SEE")))}function x(){let e=n.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,N)[N](babelHelpers.classPrivateFieldLooseBase(this,T)[T].status,babelHelpers.classPrivateFieldLooseBase(this,T)[T].approveType,babelHelpers.classPrivateFieldLooseBase(this,T)[T].users.length));if(babelHelpers.classPrivateFieldLooseBase(this,T)[T].status.isWaiting()&&babelHelpers.classPrivateFieldLooseBase(this,T)[T].approveType==="vote"){let s=0;for(const e of babelHelpers.classPrivateFieldLooseBase(this,T)[T].users){if(!new o.TaskStatus(e.status).isWaiting()){s++}}e=n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_VOTED",{"#VOTED#":s,"#TOTAL#":babelHelpers.classPrivateFieldLooseBase(this,T)[T].users.length})}return n.Tag.render(F||(F=P`<div class="bizproc-workflow-timeline-caption">${0}</div>`),e)}function Z(e,s,i){if(e.isYes()||e.isOk()){return n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMED")}if(e.isNo()||e.isCancel()){return n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_DECLINED")}if(e.isWaiting()){if(i===1){return n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMING")}let e="";switch(s){case"all":e=n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMING_ALL");break;case"any":e=n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMING_ANY");break;case"vote":e=n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMING_ALL");break;default:e=n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMING");break}return e}return e.name}function A(){const e=babelHelpers.classPrivateFieldLooseBase(this,T)[T].users.length>1;return n.Tag.render(I||(I=P`
			<div class="bizproc-workflow-timeline-user-list">
				${0}
			</div>
		`),Object.values(babelHelpers.classPrivateFieldLooseBase(this,T)[T].users).map((s=>babelHelpers.classPrivateFieldLooseBase(this,K)[K](s,e))))}function U(e,s){const i=babelHelpers.classPrivateFieldLooseBase(this,y)[y].get(e.id);if(!i){return null}const t=new o.TaskStatus(e.status);let a="";if(s){if(t.isYes()||t.isOk()){a="--voted-up"}if(t.isNo()){a="--voted-down"}}let l="<i></i>";if(n.Type.isString(i.avatarSize100)){l=`<i style="background-image: url('${encodeURI(n.Text.encode(i.avatarSize100))}')"></i>`}return n.Tag.render(m||(m=P`
			<div class="bizproc-workflow-timeline-user ${0}">
				<div class="bizproc-workflow-timeline-userlogo ui-icon ui-icon-common-user">
					${0}
				</div>
				<div class="bizproc-workflow-timeline-user-block">
					<a class="bizproc-workflow-timeline-link" href="${0}">${0}</a>
					<div class="bizproc-workflow-timeline-user-pos" title="${0}">
						${0}
					</div>
				</div>
			</div>
		`),a,l,i.link,n.Text.encode(i.fullName),n.Text.encode(i.workPosition||""),n.Text.encode(i.workPosition||""))}function X(){const e=babelHelpers.classPrivateFieldLooseBase(this,T)[T].executionTime;if(n.Type.isNil(e)){return null}const s=e>=E;const i=n.Tag.render(B||(B=P`
			<span
				data-hint="${0}"
			></span>
		`),n.Text.encode(n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_TIME_LIMIT_EXCEEDED")));const t=n.Tag.render(_||(_=P`
			<div class="bizproc-workflow-timeline-notice">
				<div class="bizproc-workflow-timeline-subject">
					${0}
				</div>
				<span class="bizproc-workflow-timeline-text">
					${0}
				</span>
				${0}
			</div>
		`),n.Text.encode(n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_EXECUTION_TIME")),n.Text.encode(Fe.formatTimeInterval(e,2)),s?i:null);if(s){BX.UI.Hint.init(t)}return t}function G(){return n.Tag.render(O||(O=P`
			<div class="bizproc-workflow-timeline-item --tech">
				<div class="bizproc-workflow-timeline-item-inner">
					<div>
						<span class="bizproc-workflow-timeline-icon"></span>
						<div class="bizproc-workflow-timeline-title">
							${0}
						</div>
					</div>
					<div class="bizproc-workflow-timeline-subject">
						${0}
					</div>
				</div>
			</div>
		`),n.Text.encode(n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_NO_RIGHTS_TO_VIEW")),n.Text.encode(n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_NO_RIGHTS_TO_VIEW_TIP")))}let Y=e=>e,V,q,Q,J,ee,se,ie,te,ae,le,re,oe,ne,ce,de,be,pe,ve,ue,Le;var Pe=babelHelpers.classPrivateFieldLooseKey("limits");var fe=babelHelpers.classPrivateFieldLooseKey("getFormatString");var he=babelHelpers.classPrivateFieldLooseKey("getMultiplierByFormat");class Fe{static formatTimestamp(e){return r.DateTimeFormat.format(babelHelpers.classPrivateFieldLooseBase(this,fe)[fe](Date.now()/1e3-e),e)}static formatTimeInterval(e,s=1){if(n.Type.isNil(e)){return n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_AVERAGE_PROCESS_TIME_UNKNOWN")}if(e===0){return n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_ZERO_SECOND_INTERVAL")}let i="";let t=e;for(let e=0;e<s;e++){const e=babelHelpers.classPrivateFieldLooseBase(this,fe)[fe](t);if(i.length>0&&e==="sdiff"){return i}const s=babelHelpers.classPrivateFieldLooseBase(this,he)[he](e);i+=r.DateTimeFormat.format(e,0,t);i+=" ";if(s>0){t%=s;if(t===0){return i}}}return i}static formatDate(e,s,i){if(i&&r.DateTimeFormat.format("Y",e)===r.DateTimeFormat.format("Y",Date.now()/1e3)){return r.DateTimeFormat.format(i,e)}return r.DateTimeFormat.format(s,e)}}function Ie(e){for(const s of babelHelpers.classPrivateFieldLooseBase(this,Pe)[Pe]){if(e>=s[0]){return s[1]}}return"sdiff"}function me(e){for(const s of babelHelpers.classPrivateFieldLooseBase(this,Pe)[Pe]){if(e===s[1]){return s[0]}}return 0}Object.defineProperty(Fe,he,{value:me});Object.defineProperty(Fe,fe,{value:Ie});Object.defineProperty(Fe,Pe,{writable:true,value:[[3600*24*365,"Ydiff"],[3600*24*31,"mdiff"],[3600*24,"ddiff"],[3600,"Hdiff"],[60,"idiff"]]});var Be=babelHelpers.classPrivateFieldLooseKey("workflowId");var _e=babelHelpers.classPrivateFieldLooseKey("data");var Oe=babelHelpers.classPrivateFieldLooseKey("isLoaded");var Ee=babelHelpers.classPrivateFieldLooseKey("errors");var Te=babelHelpers.classPrivateFieldLooseKey("container");var He=babelHelpers.classPrivateFieldLooseKey("biPopup");var ge=babelHelpers.classPrivateFieldLooseKey("dateFormat");var Re=babelHelpers.classPrivateFieldLooseKey("dateFormatShort");var we=babelHelpers.classPrivateFieldLooseKey("efficiencyPopup");var ye=babelHelpers.classPrivateFieldLooseKey("loadTimeline");var ke=babelHelpers.classPrivateFieldLooseKey("setDataFromResponse");var Me=babelHelpers.classPrivateFieldLooseKey("renderItemTitle");var Se=babelHelpers.classPrivateFieldLooseKey("renderSubject");var Ne=babelHelpers.classPrivateFieldLooseKey("renderProceedTaskButton");var We=babelHelpers.classPrivateFieldLooseKey("renderUser");var Ke=babelHelpers.classPrivateFieldLooseKey("renderDoc");var De=babelHelpers.classPrivateFieldLooseKey("renderCaption");var ze=babelHelpers.classPrivateFieldLooseKey("renderNotice");var Ce=babelHelpers.classPrivateFieldLooseKey("renderStatus");var $e=babelHelpers.classPrivateFieldLooseKey("renderMore");var je=babelHelpers.classPrivateFieldLooseKey("renderContent");var xe=babelHelpers.classPrivateFieldLooseKey("renderItem");var Ze=babelHelpers.classPrivateFieldLooseKey("renderItemsList");var Ae=babelHelpers.classPrivateFieldLooseKey("renderFirstBlock");var Ue=babelHelpers.classPrivateFieldLooseKey("renderContainer");var Xe=babelHelpers.classPrivateFieldLooseKey("textCrop");var Ge=babelHelpers.classPrivateFieldLooseKey("createEfficiencyPopup");var Ye=babelHelpers.classPrivateFieldLooseKey("getEfficiencyData");var Ve=babelHelpers.classPrivateFieldLooseKey("renderEfficiencyInlineContent");var qe=babelHelpers.classPrivateFieldLooseKey("renderEfficiencyPopupContent");var Qe=babelHelpers.classPrivateFieldLooseKey("createBiButton");var Je=babelHelpers.classPrivateFieldLooseKey("createBiPopup");var es=babelHelpers.classPrivateFieldLooseKey("getBiMenuTopOffset");var ss=babelHelpers.classPrivateFieldLooseKey("showBiMenu");var is=babelHelpers.classPrivateFieldLooseKey("renderBiPopupContent");var ts=babelHelpers.classPrivateFieldLooseKey("renderLoadingStub");var as=babelHelpers.classPrivateFieldLooseKey("hasErrors");class ls{constructor(e,s){Object.defineProperty(this,as,{value:Ms});Object.defineProperty(this,ts,{value:ks});Object.defineProperty(this,is,{value:ys});Object.defineProperty(this,ss,{value:ws});Object.defineProperty(this,es,{value:Rs});Object.defineProperty(this,Je,{value:gs});Object.defineProperty(this,Qe,{value:Hs});Object.defineProperty(this,qe,{value:Ts});Object.defineProperty(this,Ve,{value:Es});Object.defineProperty(this,Ye,{value:Os});Object.defineProperty(this,Ge,{value:_s});Object.defineProperty(this,Xe,{value:Bs});Object.defineProperty(this,Ue,{value:ms});Object.defineProperty(this,Ae,{value:Is});Object.defineProperty(this,Ze,{value:Fs});Object.defineProperty(this,xe,{value:hs});Object.defineProperty(this,je,{value:fs});Object.defineProperty(this,$e,{value:Ps});Object.defineProperty(this,Ce,{value:Ls});Object.defineProperty(this,ze,{value:us});Object.defineProperty(this,De,{value:vs});Object.defineProperty(this,Ke,{value:ps});Object.defineProperty(this,We,{value:bs});Object.defineProperty(this,Ne,{value:ds});Object.defineProperty(this,Se,{value:cs});Object.defineProperty(this,Me,{value:ns});Object.defineProperty(this,ke,{value:os});Object.defineProperty(this,ye,{value:rs});Object.defineProperty(this,Be,{writable:true,value:void 0});Object.defineProperty(this,_e,{writable:true,value:void 0});Object.defineProperty(this,Oe,{writable:true,value:void 0});Object.defineProperty(this,Ee,{writable:true,value:[]});Object.defineProperty(this,Te,{writable:true,value:void 0});Object.defineProperty(this,He,{writable:true,value:void 0});Object.defineProperty(this,ge,{writable:true,value:void 0});Object.defineProperty(this,Re,{writable:true,value:void 0});Object.defineProperty(this,we,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,Te)[Te]=babelHelpers.classPrivateFieldLooseBase(this,Ue)[Ue]();setTimeout((()=>{babelHelpers.classPrivateFieldLooseBase(this,Xe)[Xe]()}),500);if(n.Type.isPlainObject(e)){babelHelpers.classPrivateFieldLooseBase(this,Be)[Be]=e.workflowId;babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe]=false;babelHelpers.classPrivateFieldLooseBase(this,ye)[ye]()}if(n.Type.isPlainObject(s)){babelHelpers.classPrivateFieldLooseBase(this,ge)[ge]=`${s.dateFormat||"j F Y"} ${s.timeFormat||"H:i"}`;babelHelpers.classPrivateFieldLooseBase(this,Re)[Re]=`${s.dateFormatShort||"j F"} ${s.timeFormat||"H:i"}`}}static open(e){n.Runtime.loadExtension("sidepanel").then((()=>{BX.SidePanel.Instance.open(n.Uri.addParam("/bitrix/components/bitrix/bizproc.workflow.timeline.slider/index.php",n.Type.isPlainObject(e)?e:{}),{width:950,allowChangeHistory:false,cacheable:false,loader:"/bitrix/js/bizproc/workflow/timeline/img/skeleton.svg",printable:true})})).catch((e=>console.error(e.errors)))}render(){n.Dom.clean(babelHelpers.classPrivateFieldLooseBase(this,Te)[Te]);if(babelHelpers.classPrivateFieldLooseBase(this,as)[as]()){const e=new v({errors:babelHelpers.classPrivateFieldLooseBase(this,Ee)[Ee]});e.renderTo(babelHelpers.classPrivateFieldLooseBase(this,Te)[Te]);return babelHelpers.classPrivateFieldLooseBase(this,Te)[Te]}if(!babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe]){n.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,ts)[ts](),babelHelpers.classPrivateFieldLooseBase(this,Te)[Te])}if(n.Type.isPlainObject(babelHelpers.classPrivateFieldLooseBase(this,_e)[_e])){n.Dom.replace(babelHelpers.classPrivateFieldLooseBase(this,Te)[Te],babelHelpers.classPrivateFieldLooseBase(this,Ue)[Ue]());babelHelpers.classPrivateFieldLooseBase(this,Ge)[Ge]().show();if(babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].biMenu){this.showBiMenus(babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].biMenu)}}return babelHelpers.classPrivateFieldLooseBase(this,Te)[Te]}showBiMenus(e){babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe](e);babelHelpers.classPrivateFieldLooseBase(this,Je)[Je](e).show()}}function rs(){n.ajax.runAction("bizproc.workflow.getTimeline",{data:{workflowId:babelHelpers.classPrivateFieldLooseBase(this,Be)[Be]}}).then((e=>{babelHelpers.classPrivateFieldLooseBase(this,ke)[ke](e);babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe]=true;this.render()})).catch((e=>{babelHelpers.classPrivateFieldLooseBase(this,ke)[ke](e);babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe]=true;this.render()}))}function os(e){if(n.Type.isPlainObject(e)){const i=(e,s="")=>n.Type.isString(e)?e:s;const t=(e,s=[])=>n.Type.isArray(e)?e:s;const a=(e,s=false)=>n.Type.isBoolean(e)?e:s;const l=(e,s=0)=>n.Type.isInteger(e)?e:s;if(n.Type.isPlainObject(e.data)){babelHelpers.classPrivateFieldLooseBase(this,_e)[_e]={document:new s.DocumentId({documentId:t(e.data.documentType),entityName:i(e.data.entityName),documentName:i(e.data.documentName),documentUrl:i(e.data.documentUrl),moduleName:i(e.data.moduleName)}),isWorkflowRunning:a(e.data.isWorkflowRunning),timeToStart:l(e.data.timeToStart,null),executionTime:l(e.data.executionTime,null),started:l(e.data.started,null),startedBy:l(e.data.startedBy),tasks:t(e.data.tasks).map((e=>new L(e))),users:new Map,stats:{averageDuration:l(e.data.stats.averageDuration,null),efficiency:i(e.data.stats.efficiency)},biMenu:t(e.data.biMenu,null)};for(const s of t(e.data.users)){babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].users.set(n.Text.toInteger(s.id),s)}}babelHelpers.classPrivateFieldLooseBase(this,Ee)[Ee]=t(e.errors)}}function ns(e,s,i,t){const a=n.Type.isString(s)?` ${s}`:"";const l=n.Type.isString(i)?i:"";const r=t?' data-crop="crop"':"";return n.Tag.render(V||(V=Y`
			<div>
				<span class="bizproc-workflow-timeline-icon${0}">${0}</span>
				<div class="bizproc-workflow-timeline-title"${0}>${0}</div>
			</div>
		`),a,l,r,n.Text.encode(e))}function cs(e){return n.Tag.render(q||(q=Y`
			<div class="bizproc-workflow-timeline-subject">${0}</div>
		`),n.Text.encode(e))}function ds(e){const s=e.url||new n.Uri(`/company/personal/bizproc/${e.id}/`).toString();return n.Tag.render(Q||(Q=Y`
			<div class="task-button --hidden">
				<a class="ui-btn ui-btn-xs ui-btn-primary ui-btn-round" href="${0}">
					${0}
				</a>
			</div>
		`),n.Text.encode(s),n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_BUTTON_PROCEED"))}function bs(e,s=null,i=null){const t=babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].users.get(e||s.id);let a="";let l=false;if(s){const e=new o.TaskStatus(s.status);if(e.isYes()||e.isOk()){a=" --voted-up"}if(e.isNo()){a=" --voted-down"}if(e.isWaiting()){l=true}}const r=n.Type.isString(t.workPosition)?`<div class="bizproc-workflow-timeline-user-pos">${n.Text.encode(t.workPosition)}</div>`:"";let c="<i></i>";if(n.Type.isString(t.avatarSize100)){c=`<i style="background-image: url('${encodeURI(t.avatarSize100)}')"></i>`}const d=i!=null&&i.id&&l?babelHelpers.classPrivateFieldLooseBase(this,Ne)[Ne](i):"";return n.Tag.render(J||(J=Y`
			<div class="bizproc-workflow-timeline-user${0}">
				<div class="bizproc-workflow-timeline-userlogo ui-icon ui-icon-common-user">
					${0}
				</div>
				<div class="bizproc-workflow-timeline-user-block">
					<a class="bizproc-workflow-timeline-link" href="${0}">${0}</a>
					${0}
				</div>
				${0}
			</div>
		`),a,c,t.link,n.Text.encode(t.fullName),r,d)}function ps(e,s,i,t){return n.Tag.render(ee||(ee=Y`
			<div class="bizproc-workflow-timeline-doc">
				${0}
				<div class="bizproc-workflow-timeline-type">
					<span class="ui-icon-set ${0}"></span>
					<span class="bizproc-workflow-timeline-type-text">${0}</span>
				</div>
				<a class="bizproc-workflow-timeline-link" href="${0}" target="_top">${0}</a>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,De)[De](n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_START_DOC")),t,i,s,n.Text.encode(e))}function vs(e){return n.Tag.render(se||(se=Y`
			<div class="bizproc-workflow-timeline-caption">${0}</div>
		`),e)}function us(e,s){return n.Tag.render(ie||(ie=Y`
			<div class="bizproc-workflow-timeline-notice">
				<div class="bizproc-workflow-timeline-subject">${0}</div>
				<span class="bizproc-workflow-timeline-text">${0}</span>
			</div>
		`),n.Text.encode(e),n.Text.encode(s))}function Ls(e,s){const i=n.Type.isString(s)?` ${s}`:"";return n.Tag.render(te||(te=Y`
			<div class="bizproc-workflow-timeline-status${0}">${0}</div>
		`),i,n.Text.encode(e))}function Ps(){return n.Tag.render(ae||(ae=Y`
			<div class="bizproc-workflow-timeline-item --more">
				<div class="bizproc-workflow-timeline-item-inner">
					<span class="bizproc-workflow-timeline-icon"></span>
					<button class="ui-btn ui-btn-light-border ui-btn-xs" type="button" onclick="expandMore(event)">
						<span class="ui-btn-text">
							${0}
						</span>
					</button>
					<script type="text/javascript">
						function expandMore(event)
						{
							const moreItemBlock = event.target.closest('.--more');
							const hiddenBlocks = document.querySelectorAll('.bizproc-workflow-timeline-item.--hidden:not(.--efficiency)');
							BX.Dom.addClass(moreItemBlock, '--hidden');
							hiddenBlocks.forEach((hiddenBlock) => BX.Dom.removeClass(hiddenBlock, '--hidden'));
						}
					</script>
				</div>
			</div>
		`),n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_MORE_TASKS"))}function fs(e){return n.Tag.render(le||(le=Y`
			<div class="bizproc-workflow-timeline-content">
				${0}
			</div>
		`),e)}function hs(e,s,i){const t=n.Type.isString(s)?` ${s}`:"";const a=n.Type.isString(i)?` data-efficiency-class="${i}"`:"";return n.Tag.render(re||(re=Y`
			<div class="bizproc-workflow-timeline-item${0}"${0}>
				<div class="bizproc-workflow-timeline-item-inner">
					${0}
				</div>
			</div>
		`),t,a,e)}function Fs(e){return n.Tag.render(oe||(oe=Y`
			<div class="bizproc-workflow-timeline-wrapper">
				<div class="bizproc-workflow-timeline-inner">
					<div class="bizproc-workflow-timeline-list">
						${0}
					</div>
					<script type="text/javascript">
						(function() {
							const buttons = document.querySelectorAll('.task-button.--hidden');
							const showButtons = buttons.length > 1;
							buttons.forEach(function (button) {
								BX.Dom.insertBefore(
									button.closest('.bizproc-workflow-timeline-user'),
									button.closest('.bizproc-workflow-timeline-user-list').firstChild
								);
								if (showButtons)
								{
									BX.Dom.removeClass(button, '--hidden')
								}
							});
						})();
					</script>
				</div>
			</div>
		`),e)}function Is(){const e=[];if(babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].startedBy){e.push(babelHelpers.classPrivateFieldLooseBase(this,De)[De](n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_FROM")),babelHelpers.classPrivateFieldLooseBase(this,We)[We](babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].startedBy))}e.push(babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke](babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].document.name,babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].document.url,babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].document.moduleName,"--file-2"));if(!n.Type.isNil(babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].timeToStart)){e.push(babelHelpers.classPrivateFieldLooseBase(this,ze)[ze](n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_EXECUTION_TIME"),Fe.formatTimeInterval(babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].timeToStart,2)))}return babelHelpers.classPrivateFieldLooseBase(this,xe)[xe]([babelHelpers.classPrivateFieldLooseBase(this,Me)[Me](babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].document.entityName,"--success","1"),babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].started&&babelHelpers.classPrivateFieldLooseBase(this,Se)[Se](Fe.formatDate(babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].started,babelHelpers.classPrivateFieldLooseBase(this,ge)[ge],babelHelpers.classPrivateFieldLooseBase(this,Re)[Re])),babelHelpers.classPrivateFieldLooseBase(this,je)[je](e)],"--selected")}function ms(){const e=[];let s="";let i=false;if(babelHelpers.classPrivateFieldLooseBase(this,_e)[_e]){let t=null;e.push(babelHelpers.classPrivateFieldLooseBase(this,Ae)[Ae]());let a=1;let l=babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].tasks[0]?!babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].tasks[0].status.isWaiting():true;for(const s of Object.keys(babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].tasks)){t=babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].tasks[s];i=t.status.isWaiting();if(!i){++a}const r=new C({task:t,userId:n.Text.toInteger(n.Loc.getMessage("USER_ID")),dateFormat:babelHelpers.classPrivateFieldLooseBase(this,ge)[ge],dateFormatShort:babelHelpers.classPrivateFieldLooseBase(this,Re)[Re],taskNumber:i?null:a,users:babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].users});const o=r.render();if(!i&&l){n.Dom.addClass(o,"--hidden")}if(i&&l){e.push(babelHelpers.classPrivateFieldLooseBase(this,$e)[$e]());l=false}e.push(o)}if(l&&babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].tasks[0]){e.push(babelHelpers.classPrivateFieldLooseBase(this,$e)[$e]())}if(babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].isWorkflowRunning){if(i){e.push(babelHelpers.classPrivateFieldLooseBase(this,xe)[xe]([babelHelpers.classPrivateFieldLooseBase(this,Me)[Me](n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_IN_PROGRESS")),babelHelpers.classPrivateFieldLooseBase(this,Se)[Se](n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_IN_PROGRESS_TIP"))],"--tech --previous-item"))}else{e.push(babelHelpers.classPrivateFieldLooseBase(this,xe)[xe]([babelHelpers.classPrivateFieldLooseBase(this,Me)[Me](n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_IN_PROGRESS_INTERMEDIATE")),babelHelpers.classPrivateFieldLooseBase(this,Se)[Se](n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_IN_PROGRESS_INTERMEDIATE_TIP"))],"--tech --previous-item"))}}else{const i=!t||t.status.isOk()||t.status.isYes();const a=[babelHelpers.classPrivateFieldLooseBase(this,De)[De](n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_PROCESS_FINISHED"))];if(babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].startedBy){a.push(i?babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce](n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_APPROVED_FOR")):babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce](n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_DECLINED"),"--failure"),babelHelpers.classPrivateFieldLooseBase(this,We)[We](babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].startedBy))}a.push(babelHelpers.classPrivateFieldLooseBase(this,ze)[ze](n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_PROCESS_EXECUTED"),Fe.formatTimeInterval(babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].executionTime)));s=i?"--success":"--declined";e.push(babelHelpers.classPrivateFieldLooseBase(this,xe)[xe]([babelHelpers.classPrivateFieldLooseBase(this,Me)[Me](babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].document.entityName,i?"--success":null),babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].started&&babelHelpers.classPrivateFieldLooseBase(this,Se)[Se](Fe.formatDate(babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].started+babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].executionTime,babelHelpers.classPrivateFieldLooseBase(this,ge)[ge],babelHelpers.classPrivateFieldLooseBase(this,Re)[Re])),babelHelpers.classPrivateFieldLooseBase(this,je)[je](a)],i?"--success --previous":"--declined --selected --previous",s),babelHelpers.classPrivateFieldLooseBase(this,Ve)[Ve]())}}return babelHelpers.classPrivateFieldLooseBase(this,Ze)[Ze](e)}function Bs(){const e=document.querySelectorAll('[data-crop="crop"]');for(const s of e){const e=new a.TextCrop({rows:2,target:s});e.init()}}function _s(){babelHelpers.classPrivateFieldLooseBase(this,we)[we]=new l.Popup({width:403,minHeight:345,closeIcon:true,content:babelHelpers.classPrivateFieldLooseBase(this,qe)[qe](),bindElement:{left:555,top:130},padding:26,borderRadius:"18px",className:"--bizproc-timeline-popup",events:{onPopupClose:()=>{let e=document.querySelector(".--previous-item");if(!e){e=document.querySelector(".bizproc-workflow-timeline-item.--processing")}if(!e){return}BX.Dom.addClass(e,"--previous");let s=e.getAttribute("data-efficiency-class");if(!s){s=""}e.after(babelHelpers.classPrivateFieldLooseBase(this,Ve)[Ve](s))}}});return babelHelpers.classPrivateFieldLooseBase(this,we)[we]}function Os(){let e="--first";let s=n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_NO_STATS");switch(babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].stats.efficiency){case"fast":e="--fast";s=n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMED_QUICKLY");break;case"slow":e="--slow";s=n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMED_SLOWLY");break;case"stopped":e="--stopped";s=n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMED_NO_PROGRESS");break;default:break}return[e,s]}function Es(e){const[s,i]=babelHelpers.classPrivateFieldLooseBase(this,Ye)[Ye]();const t=n.Tag.render(ne||(ne=Y`
			<div class="bizproc-workflow-timeline-item --efficiency ${0}">
				<div class="bizproc-workflow-timeline-item-inner">
					<div class="bizproc-workflow-timeline-title">
						${0}
					</div>
					<div class="bizproc-workflow-timeline-content">
						<div class="bizproc-workflow-timeline-eff-icon ${0}"></div>
						<div class="bizproc-workflow-timeline-content-inner">
							<div class="bizproc-workflow-timeline-caption">${0}</div>
							<div class="bizproc-workflow-timeline-notice">
								<div class="bizproc-workflow-timeline-subject">
									${0}
								</div>
								<span class="bizproc-workflow-timeline-text">
									${0}
								</span>
								<span
									data-hint="${0}"
								></span>
							</div>
							<div class="bizproc-workflow-timeline-notice">
								<div class="bizproc-workflow-timeline-subject">
									${0}
								</div>
								<span class="bizproc-workflow-timeline-text">
									${0}
								</span>
							</div>
						</div>
					</div>
				</div>	
			</div>
		`),e,n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_EFFECTIVITY_MARK"),s,i,n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_CURRENT_PROCESS_TIME"),Fe.formatTimeInterval(babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].executionTime),n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_TIME_DIFFERENCE_MSGVER_1"),n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_AVERAGE_PROCESS_TIME"),babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].stats.averageDuration===null?n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_AVERAGE_PROCESS_TIME_UNKNOWN"):Fe.formatTimeInterval(babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].stats.averageDuration));BX.UI.Hint.init(t);return t}function Ts(){const[e,s]=babelHelpers.classPrivateFieldLooseBase(this,Ye)[Ye]();const i=n.Tag.render(ce||(ce=Y`
			<div class="bizproc-timeline-popup">
				<div class="bizproc-timeline-popup-title">
					${0}
				</div>
				<div class="bizproc-timeline-popup-main">
					<div class="bizproc-timeline-popup-status">
						<div class="bizproc-timeline-popup-logo ${0}"></div>
						<div class="bizproc-timeline-popup-notice">${0}</div>
					</div>
					<div class="bizproc-timeline-popup-content">
						<div class="bizproc-timeline-popup-block">
							<span class="bizproc-timeline-popup-val">
								${0}
							</span>
							<span
								data-hint="${0}"
							></span>
							<div class="bizproc-timeline-popup-prop">
								${0}
							</div>
						</div>
						<div class="bizproc-timeline-popup-block">
							<span class="bizproc-timeline-popup-val">
								${0}
							</span>
							<div class="bizproc-timeline-popup-prop">
								${0}
							</div>
						</div>
					</div>
				</div>
				<div class="bizproc-timeline-popup-footer">
					<p class="bizproc-timeline-popup-text">
						${0}
					</p>
					<a class="bizproc-timeline-popup-text" href="javascript:top.BX.Helper.show('redirect=detail&code=18783714')">
						${0}
					</a>
				</div>
			</div>
		`),n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_EFFECTIVITY_MARK"),e,s,Fe.formatTimeInterval(babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].executionTime),n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_TIME_DIFFERENCE_MSGVER_1"),n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_CURRENT_PROCESS_TIME"),Fe.formatTimeInterval(babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].stats.averageDuration),n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_AVERAGE_PROCESS_TIME"),n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMANCE_TUNING_TIP"),n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMANCE_TUNING_LINK"));BX.UI.Hint.init(i);return i}function Hs(e){const s=document.querySelector('[data-role="page-toolbar"]');if(!s){return}if(e.length===1){const i=n.Tag.render(de||(de=Y`
				<a class="ui-btn ui-btn-light-border ui-btn-themes" href="${0}" target="_blank">
					${0}
				</a>
			`),n.Text.encode(e[0].URL),n.Text.encode(n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_BI_ANALYTICS_BUTTON")));n.Dom.prepend(i,s);return}const i=babelHelpers.classPrivateFieldLooseBase(this,ss)[ss].bind(this,e);const t=n.Tag.render(be||(be=Y`
			<button class="ui-btn ui-btn-light-border ui-btn-themes ui-btn-dropdown" onclick="${0}">
				${0}
			</button>
		`),i,n.Text.encode(n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_BI_ANALYTICS_BUTTON")));n.Dom.prepend(t,s)}function gs(e){babelHelpers.classPrivateFieldLooseBase(this,He)[He]=new l.Popup({width:403,minHeight:183,closeIcon:true,content:babelHelpers.classPrivateFieldLooseBase(this,is)[is](e),bindElement:{left:555,top:babelHelpers.classPrivateFieldLooseBase(this,es)[es]()},padding:17,borderRadius:"18px",className:"--bizproc-timeline-popup --bi"});return babelHelpers.classPrivateFieldLooseBase(this,He)[He]}function Rs(){var e,s,i,t;const a=(e=babelHelpers.classPrivateFieldLooseBase(this,we)[we])==null?void 0:(s=e.getPopupContainer())==null?void 0:s.offsetHeight;const l=(i=babelHelpers.classPrivateFieldLooseBase(this,we)[we])==null?void 0:(t=i.bindElementPos)==null?void 0:t.top;if(a&&l){return a+l+20}return 522}function ws(e,s){new l.Menu({bindElement:s.target,items:e.map((e=>({text:e.TEXT,href:e.URL,target:"_blank"})))}).show()}function ys(e){let s=null;if(e.length===1){s=n.Tag.render(pe||(pe=Y`
				<a class="ui-btn ui-btn-light-border ui-btn-round ui-btn-xs" href="${0}" target="_blank">
					<span class="ui-btn-text">${0}</span>
				</a>
			`),n.Text.encode(e[0].URL),n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_BI_ANALYTICS_LINK"))}else{const i=babelHelpers.classPrivateFieldLooseBase(this,ss)[ss].bind(this,e);s=n.Tag.render(ve||(ve=Y`
				<a 
					class="ui-btn ui-btn-light-border ui-btn-round ui-btn-xs ui-btn-dropdown"
					onclick="${0}"
				>
					<span class="ui-btn-text">${0}</span>
				</a>
			`),i,n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_BI_ANALYTICS_LINK"))}return n.Tag.render(ue||(ue=Y`
			<div class="bizproc-timeline-popup">
				<div class="bizproc-timeline-popup-title">${0}</div>
				<p class="bizproc-timeline-popup-info">${0}</p>
				${0}
			</div>
		`),n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_BI_ANALYTICS_TITLE"),n.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_BI_ANALYTICS_TIP"),s)}function ks(){return n.Tag.render(Le||(Le=Y`
			<img src="/bitrix/js/bizproc/workflow/timeline/img/skeleton.svg"
				 style="width:100%; margin: 0; padding: 0;"/>
		`))}function Ms(){return babelHelpers.classPrivateFieldLooseBase(this,Ee)[Ee].length>0}e.DurationFormatter=Fe;e.Timeline=ls})(this.BX.Bizproc.Workflow=this.BX.Bizproc.Workflow||{},BX.Bizproc,BX.Bizproc,BX,BX.UI,BX.Main,BX.Main,BX.Bizproc,BX);
//# sourceMappingURL=timeline.bundle.map.js