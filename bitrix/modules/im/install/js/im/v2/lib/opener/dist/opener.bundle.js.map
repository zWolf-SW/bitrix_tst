{"version":3,"file":"opener.bundle.js","sources":["../src/classes/lines-service.js","../src/functions/helpers.js","../src/opener.js"],"sourcesContent":["import { Core } from 'im.v2.application.core';\nimport { RestMethod } from 'im.v2.const';\n\nexport class LinesService\n{\n\tasync getDialogIdByUserCode(userCode: string): Promise<string>\n\t{\n\t\tconst result: RestResult = await Core.getRestClient().callMethod(RestMethod.linesDialogGet, {\n\t\t\tUSER_CODE: userCode,\n\t\t}).catch((errorResult: RestResult) => {\n\t\t\tconsole.error('LinesService: error getting dialog id', errorResult.error());\n\t\t});\n\n\t\tconst { dialog_id: dialogId } = result.data();\n\n\t\treturn dialogId;\n\t}\n}\n","import { Type } from 'main.core';\nimport { SidePanel } from 'main.sidepanel';\n\nimport { GetParameter, NavigationMenuItem, Path } from 'im.v2.const';\nimport { LayoutManager } from 'im.v2.lib.layout';\nimport { Utils } from 'im.v2.lib.utils';\n\nimport type { SliderManager } from 'main.sidepanel';\n\ntype NavigationItem = $Values<typeof NavigationMenuItem>;\ntype GetParameterType = $Values<typeof GetParameter>;\ntype OpenChatConfig = {\n\tnavigationItem: NavigationItem,\n\tdialogId: string,\n\tmessageId?: number,\n}\n\nexport const checkHistoryDialogId = (dialogId: string): boolean => {\n\treturn Utils.dialog.isLinesHistoryId(dialogId) || Utils.dialog.isLinesExternalId(dialogId);\n};\n\nexport const prepareHistorySliderLink = (dialogId: string): string => {\n\tconst getParams = new URLSearchParams({\n\t\t[GetParameter.openHistory]: dialogId,\n\t\t[GetParameter.backgroundType]: 'light',\n\t\t[GetParameter.legacyMode]: 'Y',\n\t});\n\n\treturn `${Path.history}?${getParams.toString()}`;\n};\n\nexport const normalizeEntityId = (entityId: any): string => {\n\tif (Type.isString(entityId))\n\t{\n\t\treturn entityId;\n\t}\n\n\tif (Type.isNumber(entityId))\n\t{\n\t\treturn entityId.toString();\n\t}\n\n\treturn '';\n};\n\nexport const isEmbeddedModeWithActiveSlider = (): boolean => {\n\tconst sidePanelManager: SliderManager = SidePanel.Instance;\n\n\treturn LayoutManager.getInstance().isEmbeddedMode() && sidePanelManager.getOpenSlidersCount() > 0;\n};\n\nexport const openChatInNewTab = ({ navigationItem, dialogId, messageId }: OpenChatConfig): void => {\n\tconst getParams = new URLSearchParams();\n\n\tconst urlParameter = getUrlParameterForNavigation(navigationItem);\n\tif (Type.isStringFilled(dialogId))\n\t{\n\t\tgetParams.append(urlParameter, dialogId);\n\t}\n\n\tif (messageId > 0)\n\t{\n\t\tgetParams.append(GetParameter.openMessage, messageId);\n\t}\n\n\tUtils.browser.openLink(`${Path.online}?${getParams.toString()}`);\n};\n\nconst getUrlParameterForNavigation = (navigationItem: NavigationItem): GetParameterType => {\n\tconst navigationToGetParameterMap = {\n\t\t[NavigationMenuItem.chat]: GetParameter.openChat,\n\t\t[NavigationMenuItem.openlines]: GetParameter.openLines,\n\t};\n\n\treturn navigationToGetParameterMap[navigationItem] ?? GetParameter.openChat;\n};\n","import { EventEmitter } from 'main.core.events';\n\nimport { EventType, GetParameter, Layout, NavigationMenuItem } from 'im.v2.const';\nimport { CallManager } from 'im.v2.lib.call';\nimport { DesktopApi, DesktopFeature } from 'im.v2.lib.desktop-api';\nimport { LayoutManager } from 'im.v2.lib.layout';\nimport { Logger } from 'im.v2.lib.logger';\nimport { PhoneManager } from 'im.v2.lib.phone';\nimport { Utils } from 'im.v2.lib.utils';\nimport { MessengerSlider } from 'im.v2.lib.slider';\nimport { Feature, FeatureManager } from 'im.v2.lib.feature';\nimport { BotContextService } from 'im.v2.provider.service.bot';\nimport { CreateChatManager } from 'im.v2.lib.create-chat';\nimport { type NavigationMenuItemParams, NavigationManager } from 'im.v2.lib.navigation';\n\nimport { LinesService } from './classes/lines-service';\nimport {\n\tcheckHistoryDialogId,\n\tprepareHistorySliderLink,\n\tnormalizeEntityId,\n\tisEmbeddedModeWithActiveSlider,\n\topenChatInNewTab,\n} from './functions/helpers';\n\nimport type { JsonObject } from 'main.core';\nimport type { ForwardedEntityConfig } from 'im.v2.provider.service.sending';\nimport type { CreatableChatType, OpenChatCreationParams } from 'im.v2.component.content.chat-forms.forms';\n\nexport const Opener = {\n\tasync openChat(dialogId: string | number = '', messageId: number = 0): Promise\n\t{\n\t\tconst preparedDialogId = dialogId.toString();\n\t\tif (Utils.dialog.isLinesExternalId(preparedDialogId))\n\t\t{\n\t\t\treturn this.openLines(preparedDialogId);\n\t\t}\n\n\t\tif (isEmbeddedModeWithActiveSlider())\n\t\t{\n\t\t\topenChatInNewTab({\n\t\t\t\tnavigationItem: NavigationMenuItem.chat,\n\t\t\t\tdialogId: preparedDialogId,\n\t\t\t\tmessageId,\n\t\t\t});\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tawait MessengerSlider.getInstance().openSlider();\n\t\tconst layoutParams = {\n\t\t\tname: Layout.chat.name,\n\t\t\tentityId: preparedDialogId,\n\t\t};\n\t\tif (messageId > 0)\n\t\t{\n\t\t\tlayoutParams.contextId = messageId;\n\t\t}\n\t\tawait LayoutManager.getInstance().setLayout(layoutParams);\n\n\t\treturn Promise.resolve();\n\t},\n\n\tasync openChatWithBotContext(dialogId: string | number, context: JsonObject): Promise\n\t{\n\t\tconst preparedDialogId = dialogId.toString();\n\n\t\tconst botContextService = new BotContextService();\n\t\tbotContextService.scheduleContextRequest(preparedDialogId, context);\n\n\t\treturn this.openChat(preparedDialogId);\n\t},\n\n\tasync forwardEntityToChat(dialogId: string, entityConfig: ForwardedEntityConfig): Promise\n\t{\n\t\tconst preparedDialogId = dialogId.toString();\n\t\tawait MessengerSlider.getInstance().openSlider();\n\t\tconst layoutParams = {\n\t\t\tname: Layout.chat.name,\n\t\t\tentityId: preparedDialogId,\n\t\t};\n\t\tawait LayoutManager.getInstance().setLayout(layoutParams);\n\t\tEventEmitter.emit(EventType.textarea.forwardEntity, { dialogId, entityConfig });\n\n\t\treturn Promise.resolve();\n\t},\n\n\tasync openLines(dialogId: string = ''): Promise\n\t{\n\t\tlet preparedDialogId = dialogId.toString();\n\t\tif (Utils.dialog.isLinesExternalId(preparedDialogId))\n\t\t{\n\t\t\tconst linesService = new LinesService();\n\t\t\tpreparedDialogId = await linesService.getDialogIdByUserCode(preparedDialogId);\n\t\t}\n\n\t\tif (isEmbeddedModeWithActiveSlider())\n\t\t{\n\t\t\topenChatInNewTab({\n\t\t\t\tnavigationItem: NavigationMenuItem.openlines,\n\t\t\t\tdialogId: preparedDialogId,\n\t\t\t});\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tawait MessengerSlider.getInstance().openSlider();\n\n\t\tconst optionOpenLinesV2Activated = FeatureManager.isFeatureAvailable(Feature.openLinesV2);\n\n\t\treturn LayoutManager.getInstance().setLayout({\n\t\t\tname: optionOpenLinesV2Activated ? Layout.openlinesV2.name : Layout.openlines.name,\n\t\t\tentityId: preparedDialogId,\n\t\t});\n\t},\n\n\tasync openCopilot(dialogId: string = '', contextId = 0): Promise\n\t{\n\t\tconst preparedDialogId = dialogId.toString();\n\n\t\tawait MessengerSlider.getInstance().openSlider();\n\n\t\treturn LayoutManager.getInstance().setLayout({\n\t\t\tname: Layout.copilot.name,\n\t\t\tentityId: preparedDialogId,\n\t\t\tcontextId,\n\t\t});\n\t},\n\n\tasync openCollab(dialogId: string = ''): Promise\n\t{\n\t\tconst preparedDialogId = dialogId.toString();\n\n\t\tif (!FeatureManager.collab.isAvailable())\n\t\t{\n\t\t\tFeatureManager.collab.openFeatureSlider();\n\n\t\t\treturn null;\n\t\t}\n\n\t\tawait MessengerSlider.getInstance().openSlider();\n\n\t\treturn LayoutManager.getInstance().setLayout({\n\t\t\tname: Layout.collab.name,\n\t\t\tentityId: preparedDialogId,\n\t\t});\n\t},\n\n\topenHistory(dialogId: string | number = ''): Promise\n\t{\n\t\tif (Utils.dialog.isDialogId(dialogId))\n\t\t{\n\t\t\treturn this.openChat(dialogId);\n\t\t}\n\n\t\tif (!checkHistoryDialogId(dialogId))\n\t\t{\n\t\t\treturn Promise.reject();\n\t\t}\n\n\t\tconst sliderLink = prepareHistorySliderLink(dialogId);\n\t\tBX.SidePanel.Instance.open(sliderLink, {\n\t\t\twidth: Utils.dialog.isLinesExternalId(dialogId) ? 700 : 1000,\n\t\t\tallowChangeHistory: false,\n\t\t\tallowChangeTitle: false,\n\t\t\tcacheable: false,\n\t\t});\n\n\t\treturn Promise.resolve();\n\t},\n\n\tasync openNotifications(): Promise\n\t{\n\t\tawait MessengerSlider.getInstance().openSlider();\n\t\tawait LayoutManager.getInstance().setLayout({\n\t\t\tname: Layout.notification.name,\n\t\t});\n\n\t\tEventEmitter.emit(EventType.layout.onOpenNotifications);\n\n\t\treturn Promise.resolve();\n\t},\n\n\tasync openRecentSearch(): Promise\n\t{\n\t\tawait MessengerSlider.getInstance().openSlider();\n\t\tawait LayoutManager.getInstance().setLayout({\n\t\t\tname: Layout.chat.name,\n\t\t});\n\n\t\tEventEmitter.emit(EventType.recent.openSearch);\n\n\t\treturn Promise.resolve();\n\t},\n\n\tasync openSettings(sectionName: string): Promise\n\t{\n\t\tLogger.warn('Slider: openSettings', sectionName);\n\t\tawait MessengerSlider.getInstance().openSlider();\n\n\t\tawait LayoutManager.getInstance().setLayout({\n\t\t\tname: Layout.settings.name,\n\t\t\tentityId: sectionName,\n\t\t});\n\n\t\treturn Promise.resolve();\n\t},\n\n\topenConference(code: string = ''): Promise\n\t{\n\t\tLogger.warn('Slider: openConference', code);\n\n\t\tif (!Utils.conference.isValidCode(code))\n\t\t{\n\t\t\treturn Promise.reject();\n\t\t}\n\n\t\tconst url = Utils.conference.getUrlByCode(code);\n\t\tUtils.browser.openLink(url, Utils.conference.getWindowNameByCode(code));\n\n\t\treturn Promise.resolve();\n\t},\n\n\tasync openChatCreation(\n\t\tchatType: CreatableChatType,\n\t\tparams: OpenChatCreationParams = {},\n\t): Promise\n\t{\n\t\tLogger.warn('Slider: openChatCreation', chatType);\n\n\t\tCreateChatManager.getInstance().setPreselectedMembers(params.preselectedMembers ?? []);\n\t\tCreateChatManager.getInstance().setIncludeCurrentUser(params.includeCurrentUser ?? true);\n\t\tCreateChatManager.getInstance().setOwnerId(params.ownerId ?? null);\n\n\t\tawait MessengerSlider.getInstance().openSlider();\n\t\tconst layoutParams = {\n\t\t\tname: Layout.createChat.name,\n\t\t\tentityId: chatType,\n\t\t};\n\n\t\treturn LayoutManager.getInstance().setLayout(layoutParams);\n\t},\n\n\tstartVideoCall(dialogId: string = '', withVideo: boolean = true): Promise\n\t{\n\t\tLogger.warn('Slider: onStartVideoCall', dialogId, withVideo);\n\t\tif (!Utils.dialog.isDialogId(dialogId))\n\t\t{\n\t\t\tLogger.error('Slider: onStartVideoCall - dialogId is not correct', dialogId);\n\n\t\t\treturn false;\n\t\t}\n\n\t\tCallManager.getInstance().startCall(dialogId, withVideo);\n\n\t\treturn Promise.resolve();\n\t},\n\n\tstartPhoneCall(number: string, params: Object<any, string>): Promise\n\t{\n\t\tLogger.warn('Slider: startPhoneCall', number, params);\n\t\tvoid PhoneManager.getInstance().startCall(number, params);\n\n\t\treturn Promise.resolve();\n\t},\n\n\tstartCallList(callListId: number, params: Object<string, any>): Promise\n\t{\n\t\tLogger.warn('Slider: startCallList', callListId, params);\n\t\tPhoneManager.getInstance().startCallList(callListId, params);\n\n\t\treturn Promise.resolve();\n\t},\n\n\topenNewTab(path)\n\t{\n\t\tif (DesktopApi.isChatTab() && DesktopApi.isFeatureSupported(DesktopFeature.openNewTab.id))\n\t\t{\n\t\t\tDesktopApi.createImTab(`${path}&${GetParameter.desktopChatTabMode}=Y`);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tUtils.browser.openLink(path);\n\t\t}\n\t},\n\n\tasync openNavigationItem(payload: NavigationMenuItemParams): void\n\t{\n\t\tawait MessengerSlider.getInstance().openSlider();\n\n\t\tNavigationManager.open({\n\t\t\tid: payload.id.toString(),\n\t\t\tentityId: normalizeEntityId(payload.entityId),\n\t\t\ttarget: payload.target,\n\t\t});\n\t},\n};\n"],"names":["LinesService","getDialogIdByUserCode","userCode","result","Core","getRestClient","callMethod","RestMethod","linesDialogGet","USER_CODE","catch","errorResult","console","error","dialog_id","dialogId","data","checkHistoryDialogId","Utils","dialog","isLinesHistoryId","isLinesExternalId","prepareHistorySliderLink","getParams","URLSearchParams","GetParameter","openHistory","backgroundType","legacyMode","Path","history","toString","normalizeEntityId","entityId","Type","isString","isNumber","isEmbeddedModeWithActiveSlider","sidePanelManager","SidePanel","Instance","LayoutManager","getInstance","isEmbeddedMode","getOpenSlidersCount","openChatInNewTab","navigationItem","messageId","urlParameter","getUrlParameterForNavigation","isStringFilled","append","openMessage","browser","openLink","online","navigationToGetParameterMap","NavigationMenuItem","chat","openChat","openlines","openLines","Opener","preparedDialogId","Promise","resolve","MessengerSlider","openSlider","layoutParams","name","Layout","contextId","setLayout","openChatWithBotContext","context","botContextService","BotContextService","scheduleContextRequest","forwardEntityToChat","entityConfig","EventEmitter","emit","EventType","textarea","forwardEntity","linesService","optionOpenLinesV2Activated","FeatureManager","isFeatureAvailable","Feature","openLinesV2","openlinesV2","openCopilot","copilot","openCollab","collab","isAvailable","openFeatureSlider","isDialogId","reject","sliderLink","BX","open","width","allowChangeHistory","allowChangeTitle","cacheable","openNotifications","notification","layout","onOpenNotifications","openRecentSearch","recent","openSearch","openSettings","sectionName","Logger","warn","settings","openConference","code","conference","isValidCode","url","getUrlByCode","getWindowNameByCode","openChatCreation","chatType","params","CreateChatManager","setPreselectedMembers","preselectedMembers","setIncludeCurrentUser","includeCurrentUser","setOwnerId","ownerId","createChat","startVideoCall","withVideo","CallManager","startCall","startPhoneCall","number","PhoneManager","startCallList","callListId","openNewTab","path","DesktopApi","isChatTab","isFeatureSupported","DesktopFeature","id","createImTab","desktopChatTabMode","openNavigationItem","payload","NavigationManager","target"],"mappings":"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"}