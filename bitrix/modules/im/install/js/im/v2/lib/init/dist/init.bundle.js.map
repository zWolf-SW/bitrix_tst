{"version":3,"file":"init.bundle.js","sources":["../src/init.js"],"sourcesContent":["import { Core } from 'im.v2.application.core';\nimport { CallManager } from 'im.v2.lib.call';\nimport { PhoneManager } from 'im.v2.lib.phone';\nimport { SmileManager } from 'im.v2.lib.smile-manager';\nimport { UserManager } from 'im.v2.lib.user';\nimport { CounterManager } from 'im.v2.lib.counter';\nimport { Logger } from 'im.v2.lib.logger';\nimport { MessageNotifierManager } from 'im.v2.lib.message-notifier';\nimport { MarketManager } from 'im.v2.lib.market';\nimport { DesktopManager } from 'im.v2.lib.desktop';\nimport { PromoManager } from 'im.v2.lib.promo';\nimport { PermissionManager } from 'im.v2.lib.permission';\nimport { UpdateStateManager } from 'im.v2.lib.update-state.manager';\nimport { Router } from 'im.v2.lib.router';\n\nexport class InitManager\n{\n\tstatic #started: boolean = false;\n\n\tstatic start()\n\t{\n\t\tif (this.#started)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#initLogger();\n\t\tLogger.warn('InitManager: start');\n\t\tthis.#initCurrentUser();\n\t\tthis.#initSettings();\n\t\tthis.#initTariffRestrictions();\n\t\tthis.#initAnchors();\n\t\tthis.#initCallManager();\n\n\t\tCounterManager.init();\n\t\tPermissionManager.init();\n\t\tPromoManager.init();\n\t\tMarketManager.init();\n\t\tPhoneManager.init();\n\t\tSmileManager.init();\n\t\tMessageNotifierManager.init();\n\t\tDesktopManager.init();\n\t\tUpdateStateManager.init();\n\t\tRouter.init();\n\n\t\tthis.#started = true;\n\t}\n\n\tstatic #initCurrentUser()\n\t{\n\t\tconst { currentUser } = Core.getApplicationData();\n\t\tif (!currentUser)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tvoid new UserManager().setUsersToModel([currentUser]);\n\t}\n\n\tstatic #initLogger()\n\t{\n\t\tconst { loggerConfig } = Core.getApplicationData();\n\t\tif (!loggerConfig)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tLogger.setConfig(loggerConfig);\n\t}\n\n\tstatic #initSettings()\n\t{\n\t\tconst { settings } = Core.getApplicationData();\n\t\tif (!settings)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tLogger.warn('InitManager: settings', settings);\n\t\tvoid Core.getStore().dispatch('application/settings/set', settings);\n\t}\n\n\tstatic #initTariffRestrictions()\n\t{\n\t\tconst { tariffRestrictions } = Core.getApplicationData();\n\t\tif (!tariffRestrictions)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tLogger.warn('InitManager: tariffRestrictions', tariffRestrictions);\n\t\tvoid Core.getStore().dispatch('application/tariffRestrictions/set', tariffRestrictions);\n\t}\n\n\tstatic #initCallManager()\n\t{\n\t\tconst { activeCalls } = Core.getApplicationData();\n\t\tCallManager.getInstance().updateRecentCallsList(activeCalls);\n\t}\n\n\tstatic #initAnchors()\n\t{\n\t\tconst { anchors } = Core.getApplicationData();\n\t\tif (!anchors)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tvoid Core.getStore().dispatch('messages/anchors/setAnchors', { anchors });\n\t}\n}\n"],"names":["InitManager","start","Logger","warn","CounterManager","init","PermissionManager","PromoManager","MarketManager","PhoneManager","SmileManager","MessageNotifierManager","DesktopManager","UpdateStateManager","Router","currentUser","Core","getApplicationData","UserManager","setUsersToModel","loggerConfig","setConfig","settings","getStore","dispatch","tariffRestrictions","activeCalls","CallManager","getInstance","updateRecentCallsList","anchors"],"mappings":";;;;;;;CAa0C;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;AAE1C,CAAO,MAAMA,WAAW,CACxB;GAGC,OAAOC,KAAK,GACZ;KACC,4CAAI,IAAI,uBACR;OACC;;KAGD,4CAAI;KACJC,uBAAM,CAACC,IAAI,CAAC,oBAAoB,CAAC;KACjC,4CAAI;KACJ,4CAAI;KACJ,4CAAI;KACJ,4CAAI;KACJ,4CAAI;KAEJC,gCAAc,CAACC,IAAI,EAAE;KACrBC,sCAAiB,CAACD,IAAI,EAAE;KACxBE,4BAAY,CAACF,IAAI,EAAE;KACnBG,8BAAa,CAACH,IAAI,EAAE;KACpBI,4BAAY,CAACJ,IAAI,EAAE;KACnBK,mCAAY,CAACL,IAAI,EAAE;KACnBM,gDAAsB,CAACN,IAAI,EAAE;KAC7BO,gCAAc,CAACP,IAAI,EAAE;KACrBQ,gDAAkB,CAACR,IAAI,EAAE;KACzBS,uBAAM,CAACT,IAAI,EAAE;KAEb,4CAAI,wBAAY,IAAI;;CAiEtB;CAAC,6BA7DA;GACC,MAAM;KAAEU;IAAa,GAAGC,2BAAI,CAACC,kBAAkB,EAAE;GACjD,IAAI,CAACF,WAAW,EAChB;KACC;;GAGD,KAAK,IAAIG,0BAAW,EAAE,CAACC,eAAe,CAAC,CAACJ,WAAW,CAAC,CAAC;CACtD;CAAC,wBAGD;GACC,MAAM;KAAEK;IAAc,GAAGJ,2BAAI,CAACC,kBAAkB,EAAE;GAClD,IAAI,CAACG,YAAY,EACjB;KACC;;GAGDlB,uBAAM,CAACmB,SAAS,CAACD,YAAY,CAAC;CAC/B;CAAC,0BAGD;GACC,MAAM;KAAEE;IAAU,GAAGN,2BAAI,CAACC,kBAAkB,EAAE;GAC9C,IAAI,CAACK,QAAQ,EACb;KACC;;GAGDpB,uBAAM,CAACC,IAAI,CAAC,uBAAuB,EAAEmB,QAAQ,CAAC;GAC9C,KAAKN,2BAAI,CAACO,QAAQ,EAAE,CAACC,QAAQ,CAAC,0BAA0B,EAAEF,QAAQ,CAAC;CACpE;CAAC,oCAGD;GACC,MAAM;KAAEG;IAAoB,GAAGT,2BAAI,CAACC,kBAAkB,EAAE;GACxD,IAAI,CAACQ,kBAAkB,EACvB;KACC;;GAGDvB,uBAAM,CAACC,IAAI,CAAC,iCAAiC,EAAEsB,kBAAkB,CAAC;GAClE,KAAKT,2BAAI,CAACO,QAAQ,EAAE,CAACC,QAAQ,CAAC,oCAAoC,EAAEC,kBAAkB,CAAC;CACxF;CAAC,6BAGD;GACC,MAAM;KAAEC;IAAa,GAAGV,2BAAI,CAACC,kBAAkB,EAAE;GACjDU,0BAAW,CAACC,WAAW,EAAE,CAACC,qBAAqB,CAACH,WAAW,CAAC;CAC7D;CAAC,yBAGD;GACC,MAAM;KAAEI;IAAS,GAAGd,2BAAI,CAACC,kBAAkB,EAAE;GAC7C,IAAI,CAACa,OAAO,EACZ;KACC;;GAGD,KAAKd,2BAAI,CAACO,QAAQ,EAAE,CAACC,QAAQ,CAAC,6BAA6B,EAAE;KAAEM;IAAS,CAAC;CAC1E;CAAC,sBA9FW9B,WAAW;GAAA;CAAA;CAAA,sBAAXA,WAAW;GAAA;CAAA;CAAA,sBAAXA,WAAW;GAAA;CAAA;CAAA,sBAAXA,WAAW;GAAA;CAAA;CAAA,sBAAXA,WAAW;GAAA;CAAA;CAAA,sBAAXA,WAAW;GAAA;CAAA;CAAA,sBAAXA,WAAW;GAAA;GAAA,OAEI;CAAK;;;;;;;;"}