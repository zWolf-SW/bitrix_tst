{"version":3,"file":"popup.bundle.js","sources":["../src/popup.js"],"sourcesContent":["import { Popup, PopupManager, PopupOptions } from 'main.popup';\nimport { Type } from 'main.core';\n\nimport { Logger } from 'im.v2.lib.logger';\n\nconst POPUP_CONTAINER_PREFIX = '#popup-window-content-';\nconst POPUP_BORDER_RADIUS = '10px';\n\n// @vue/component\nexport const MessengerPopup = {\n\tname: 'MessengerPopup',\n\tprops:\n\t{\n\t\tid: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tconfig: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault(): {} {\n\t\t\t\treturn {};\n\t\t\t},\n\t\t},\n\t},\n\temits: ['close'],\n\tcomputed:\n\t{\n\t\tpopupContainer(): string\n\t\t{\n\t\t\treturn `${POPUP_CONTAINER_PREFIX}${this.id}`;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tLogger.warn(`Popup: ${this.id} created`);\n\t\tthis.instance = this.getPopupInstance();\n\t\tthis.instance.show();\n\t},\n\tmounted()\n\t{\n\t\tthis.instance.adjustPosition({\n\t\t\tforceBindPosition: true,\n\t\t\tposition: this.getPopupConfig().bindOptions.position,\n\t\t});\n\t},\n\tbeforeUnmount()\n\t{\n\t\tif (!this.instance)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.closePopup();\n\t},\n\tmethods:\n\t{\n\t\tgetPopupInstance(): Popup\n\t\t{\n\t\t\tif (!this.instance)\n\t\t\t{\n\t\t\t\tPopupManager.getPopupById(this.id)?.destroy();\n\n\t\t\t\tthis.instance = new Popup(this.getPopupConfig());\n\t\t\t}\n\n\t\t\treturn this.instance;\n\t\t},\n\t\tgetDefaultConfig(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: this.id,\n\t\t\t\tbindOptions: {\n\t\t\t\t\tposition: 'bottom',\n\t\t\t\t},\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\tclassName: 'bx-im-messenger__scope',\n\t\t\t\tcacheable: false,\n\t\t\t\tcloseIcon: false,\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tanimation: 'fading',\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: this.closePopup.bind(this),\n\t\t\t\t\tonPopupDestroy: this.closePopup.bind(this),\n\t\t\t\t},\n\t\t\t\tcontentBorderRadius: POPUP_BORDER_RADIUS,\n\t\t\t};\n\t\t},\n\t\tgetPopupConfig(): Object\n\t\t{\n\t\t\tconst defaultConfig = this.getDefaultConfig();\n\t\t\tconst modifiedOptions = {};\n\n\t\t\tconst defaultClassName = defaultConfig.className;\n\t\t\tif (this.config.className)\n\t\t\t{\n\t\t\t\tmodifiedOptions.className = `${defaultClassName} ${this.config.className}`;\n\t\t\t}\n\n\t\t\tconst offsetTop = this.config.offsetTop ?? defaultConfig.offsetTop;\n\t\t\t// adjust for default popup margin for shadow\n\t\t\tif (this.config.bindOptions?.position === 'top' && Type.isNumber(this.config.offsetTop))\n\t\t\t{\n\t\t\t\tmodifiedOptions.offsetTop = offsetTop - 10;\n\t\t\t}\n\n\t\t\treturn { ...defaultConfig, ...this.config, ...modifiedOptions };\n\t\t},\n\t\tclosePopup()\n\t\t{\n\t\t\tLogger.warn(`Popup: ${this.id} closing`);\n\t\t\tthis.$emit('close');\n\t\t\tthis.instance.destroy();\n\t\t\tthis.instance = null;\n\t\t},\n\t\tenableAutoHide()\n\t\t{\n\t\t\tthis.getPopupInstance().setAutoHide(true);\n\t\t},\n\t\tdisableAutoHide()\n\t\t{\n\t\t\tthis.getPopupInstance().setAutoHide(false);\n\t\t},\n\t\tadjustPosition()\n\t\t{\n\t\t\tthis.getPopupInstance().adjustPosition({\n\t\t\t\tforceBindPosition: true,\n\t\t\t\tposition: this.getPopupConfig().bindOptions.position,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Teleport :to=\"popupContainer\">\n\t\t\t<slot\n\t\t\t\t:adjustPosition=\"adjustPosition\"\n\t\t\t\t:enableAutoHide=\"enableAutoHide\"\n\t\t\t\t:disableAutoHide=\"disableAutoHide\"\n\t\t\t></slot>\n\t\t</Teleport>\n\t`,\n};\n"],"names":["POPUP_CONTAINER_PREFIX","POPUP_BORDER_RADIUS","MessengerPopup","name","props","id","type","String","required","config","Object","default","emits","computed","popupContainer","created","Logger","warn","instance","getPopupInstance","show","mounted","adjustPosition","forceBindPosition","position","getPopupConfig","bindOptions","beforeUnmount","closePopup","methods","PopupManager","getPopupById","destroy","Popup","getDefaultConfig","offsetTop","offsetLeft","className","cacheable","closeIcon","autoHide","closeByEsc","animation","events","onPopupClose","bind","onPopupDestroy","contentBorderRadius","defaultConfig","modifiedOptions","defaultClassName","Type","isNumber","$emit","enableAutoHide","setAutoHide","disableAutoHide","template"],"mappings":"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"}