{"version":3,"file":"registry.bundle.js","sources":["../src/elements/add-to-chat-content/add-to-chat-content.js","../src/add-to-chat/add-to-chat.js","../src/add-to-collab/classes/collab-invitation-service.js","../src/add-to-collab/components/copy-invite-link.js","../src/add-to-collab/components/add-guests-tab.js","../src/add-to-collab/components/add-employees-tab.js","../src/add-to-collab/add-to-collab.js","../src/forward-popup/forward-content.js","../src/forward-popup/forward-popup.js"],"sourcesContent":["import { EventEmitter } from 'main.core.events';\nimport { TagSelector } from 'ui.entity-selector';\n\nimport { Analytics } from 'im.v2.lib.analytics';\nimport { ChatType, EventType, UserType } from 'im.v2.const';\nimport { AddToChat } from 'im.v2.component.search';\nimport { ChatButton, ButtonSize, ButtonColor } from 'im.v2.component.elements.button';\nimport { ChannelManager } from 'im.v2.lib.channel';\n\nimport './add-to-chat-content.css';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelChat, ImModelUser } from 'im.v2.model';\n\nconst SEARCH_ENTITY_ID = 'user';\nconst DEFAULT_CONTAINER_HEIGHT = 600;\n\n// @vue/component\nexport const AddToChatContent = {\n\tname: 'AddToChatContent',\n\tcomponents: { AddToChat, ChatButton },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t},\n\t\theight: {\n\t\t\ttype: Number,\n\t\t\tdefault: DEFAULT_CONTAINER_HEIGHT,\n\t\t},\n\t},\n\temits: ['inviteMembers', 'close'],\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tsearchQuery: '',\n\t\t\tshowHistory: true,\n\t\t\tselectedItems: new Set(),\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tisChat(): boolean\n\t\t{\n\t\t\treturn this.dialog.type !== ChatType.user;\n\t\t},\n\t\tisCollab(): boolean\n\t\t{\n\t\t\treturn this.dialog.type === ChatType.collab;\n\t\t},\n\t\tisOpenLines(): boolean\n\t\t{\n\t\t\treturn this.dialog.type === ChatType.lines;\n\t\t},\n\t\tisChannel(): boolean\n\t\t{\n\t\t\treturn ChannelManager.isChannel(this.dialogId);\n\t\t},\n\t\tshowHistoryOption(): boolean\n\t\t{\n\t\t\treturn !this.isCollab && this.isChat && !this.isChannel && !this.isOpenLines;\n\t\t},\n\t\tcontainerStyles(): {height: string}\n\t\t{\n\t\t\treturn {\n\t\t\t\theight: `${this.height}px`,\n\t\t\t};\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.membersSelector = this.getTagSelector();\n\t},\n\tmounted()\n\t{\n\t\tthis.membersSelector.renderTo(this.$refs['tag-selector']);\n\t\tthis.membersSelector.focusTextBox();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tAnalytics.getInstance().userAdd.onClosePopup();\n\t},\n\tactivated()\n\t{\n\t\tthis.membersSelector.hideAddButton();\n\t\tthis.membersSelector.showTextBox();\n\t\tthis.membersSelector.focusTextBox();\n\t},\n\tmethods:\n\t{\n\t\tgetTagSelector(): TagSelector\n\t\t{\n\t\t\tlet timeoutId = null;\n\n\t\t\treturn new TagSelector({\n\t\t\t\tmaxHeight: 111,\n\t\t\t\tshowAddButton: false,\n\t\t\t\tshowTextBox: true,\n\t\t\t\taddButtonCaption: this.loc('IM_ENTITY_SELECTOR_ADD_TO_CHAT_ADD_MSGVER_1'),\n\t\t\t\taddButtonCaptionMore: this.loc('IM_ENTITY_SELECTOR_ADD_TO_CHAT_ADD_MORE'),\n\t\t\t\tshowCreateButton: false,\n\t\t\t\tevents: {\n\t\t\t\t\tonBeforeTagAdd: () => {\n\t\t\t\t\t\tclearTimeout(timeoutId);\n\t\t\t\t\t},\n\t\t\t\t\tonAfterTagAdd: (event) => {\n\t\t\t\t\t\tconst { tag } = event.getData();\n\t\t\t\t\t\tthis.selectedItems.add(tag.id);\n\t\t\t\t\t\tthis.focusSelector();\n\t\t\t\t\t},\n\t\t\t\t\tonKeyUp: (event) => {\n\t\t\t\t\t\tconst { event: keyboardEvent } = event.getData();\n\t\t\t\t\t\tEventEmitter.emit(EventType.search.keyPressed, { keyboardEvent });\n\t\t\t\t\t},\n\t\t\t\t\tonBeforeTagRemove: () => {\n\t\t\t\t\t\tclearTimeout(timeoutId);\n\t\t\t\t\t},\n\t\t\t\t\tonAfterTagRemove: (event) => {\n\t\t\t\t\t\tconst { tag } = event.getData();\n\t\t\t\t\t\tthis.selectedItems.delete(tag.id);\n\t\t\t\t\t\tthis.focusSelector();\n\t\t\t\t\t},\n\t\t\t\t\tonInput: () => {\n\t\t\t\t\t\tAnalytics.getInstance().userAdd.onStartSearch({ dialogId: this.dialogId });\n\t\t\t\t\t\tthis.searchQuery = this.membersSelector.getTextBoxValue().trim().toLowerCase();\n\t\t\t\t\t},\n\t\t\t\t\tonBlur: () => {\n\t\t\t\t\t\tconst inputText = this.membersSelector.getTextBoxValue();\n\t\t\t\t\t\tif (inputText.length > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttimeoutId = setTimeout(() => {\n\t\t\t\t\t\t\tthis.membersSelector.hideTextBox();\n\t\t\t\t\t\t\tthis.membersSelector.showAddButton();\n\t\t\t\t\t\t}, 200);\n\t\t\t\t\t},\n\t\t\t\t\tonContainerClick: () => {\n\t\t\t\t\t\tthis.focusSelector();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tfocusSelector()\n\t\t{\n\t\t\tthis.membersSelector.hideAddButton();\n\t\t\tthis.membersSelector.showTextBox();\n\t\t\tthis.membersSelector.focusTextBox();\n\t\t},\n\t\tonSelectItem(event: {dialogId: string, service: Object, selectedStatus: boolean})\n\t\t{\n\t\t\tconst { dialogId, nativeEvent } = event;\n\t\t\tif (this.selectedItems.has(dialogId))\n\t\t\t{\n\t\t\t\tconst tag = {\n\t\t\t\t\tid: dialogId,\n\t\t\t\t\tentityId: SEARCH_ENTITY_ID,\n\t\t\t\t};\n\n\t\t\t\tthis.membersSelector.removeTag(tag);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst tag = this.getTagByDialogId(dialogId);\n\t\t\t\tthis.membersSelector.addTag(tag);\n\t\t\t}\n\n\t\t\tthis.membersSelector.clearTextBox();\n\t\t\tif (!nativeEvent.altKey)\n\t\t\t{\n\t\t\t\tthis.searchQuery = '';\n\t\t\t}\n\t\t},\n\t\tgetTagByDialogId(dialogId: string): Object\n\t\t{\n\t\t\tconst user: ImModelUser = this.$store.getters['users/get'](dialogId, true);\n\t\t\tconst isExtranet = user.type === UserType.extranet;\n\t\t\tconst entityType = isExtranet ? 'extranet' : 'employee';\n\n\t\t\treturn {\n\t\t\t\tid: dialogId,\n\t\t\t\tentityId: SEARCH_ENTITY_ID,\n\t\t\t\tentityType,\n\t\t\t\ttitle: user.name,\n\t\t\t\tavatar: user.avatar.length > 0 ? user.avatar : null,\n\t\t\t};\n\t\t},\n\t\tonInviteClick()\n\t\t{\n\t\t\tconst members = [...this.selectedItems];\n\t\t\tthis.$emit('inviteMembers', { members, showHistory: this.showHistory });\n\t\t},\n\t\tloc(key: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(key);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-entity-selector-add-to-chat__container\" :style=\"containerStyles\">\n\t\t\t<div class=\"bx-im-entity-selector-add-to-chat__input\" ref=\"tag-selector\"></div>\n\t\t\t<div v-if=\"showHistoryOption\" class=\"bx-im-entity-selector-add-to-chat__show-history\">\n\t\t\t\t<input type=\"checkbox\" id=\"bx-im-entity-selector-add-to-chat-show-history\" v-model=\"showHistory\">\n\t\t\t\t<label for=\"bx-im-entity-selector-add-to-chat-show-history\">\n\t\t\t\t\t{{ loc('IM_ENTITY_SELECTOR_ADD_TO_CHAT_SHOW_HISTORY')}}\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-entity-selector-add-to-chat__search-result-container\">\n\t\t\t\t<AddToChat\n\t\t\t\t\t:query=\"searchQuery\"\n\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t:selectedItems=\"[...selectedItems]\"\n\t\t\t\t\t@clickItem=\"onSelectItem\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-entity-selector-add-to-chat__buttons\">\n\t\t\t\t<ChatButton\n\t\t\t\t\t:size=\"ButtonSize.L\"\n\t\t\t\t\t:color=\"ButtonColor.Primary\"\n\t\t\t\t\t:isRounded=\"true\"\n\t\t\t\t\t:isLoading=\"isLoading\"\n\t\t\t\t\t:text=\"loc('IM_ENTITY_SELECTOR_ADD_TO_CHAT_INVITE_BUTTON')\"\n\t\t\t\t\t:isDisabled=\"selectedItems.size === 0\"\n\t\t\t\t\t@click=\"onInviteClick\"\n\t\t\t\t/>\n\t\t\t\t<ChatButton\n\t\t\t\t\t:size=\"ButtonSize.L\"\n\t\t\t\t\t:color=\"ButtonColor.LightBorder\"\n\t\t\t\t\t:isRounded=\"true\"\n\t\t\t\t\t:text=\"loc('IM_ENTITY_SELECTOR_ADD_TO_CHAT_CANCEL_BUTTON')\"\n\t\t\t\t\t@click=\"$emit('close')\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Messenger } from 'im.public';\nimport { Core } from 'im.v2.application.core';\nimport { ChatType } from 'im.v2.const';\nimport { MessengerPopup } from 'im.v2.component.elements.popup';\nimport { ChatService } from 'im.v2.provider.service.chat';\n\nimport { AddToChatContent } from '../elements/add-to-chat-content/add-to-chat-content';\n\nimport type { JsonObject } from 'main.core';\nimport type { PopupOptions } from 'main.popup';\nimport type { ImModelChat } from 'im.v2.model';\n\nconst POPUP_ID = 'im-add-to-chat-popup';\n\n// @vue/component\nexport const AddToChat = {\n\tname: 'AddToChat',\n\tcomponents: { MessengerPopup, AddToChatContent },\n\tprops:\n\t{\n\t\tbindElement: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tpopupConfig: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['close'],\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisLoading: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tPOPUP_ID: () => POPUP_ID,\n\t\tconfig(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\ttitleBar: this.$Bitrix.Loc.getMessage('IM_ENTITY_SELECTOR_ADD_TO_CHAT_ADD_MEMBERS_TITLE'),\n\t\t\t\tcloseIcon: true,\n\t\t\t\tbindElement: this.bindElement,\n\t\t\t\toffsetTop: this.popupConfig.offsetTop,\n\t\t\t\toffsetLeft: this.popupConfig.offsetLeft,\n\t\t\t\tpadding: 0,\n\t\t\t\tcontentPadding: 0,\n\t\t\t\tcontentBackground: '#fff',\n\t\t\t\tclassName: 'bx-im-entity-selector-add-to-chat__scope',\n\t\t\t};\n\t\t},\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tisChat(): boolean\n\t\t{\n\t\t\treturn this.dialog.type !== ChatType.user;\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.chatService = new ChatService();\n\t},\n\tmethods:\n\t{\n\t\tinviteMembers(event: {members: Array<string | number>, showHistory: boolean})\n\t\t{\n\t\t\tconst { members, showHistory } = event;\n\n\t\t\tif (this.isChat)\n\t\t\t{\n\t\t\t\tthis.extendChat(members, showHistory);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmembers.push(this.dialogId, Core.getUserId());\n\t\t\t\tvoid this.createChat(members);\n\t\t\t}\n\t\t},\n\t\textendChat(members: Array<string | number>, showHistory: boolean)\n\t\t{\n\t\t\tthis.isLoading = true;\n\t\t\tthis.chatService.addToChat({\n\t\t\t\tchatId: this.chatId,\n\t\t\t\tmembers,\n\t\t\t\tshowHistory,\n\t\t\t}).then(() => {\n\t\t\t\tthis.isLoading = false;\n\t\t\t\tthis.$emit('close');\n\t\t\t}).catch(() => {\n\t\t\t\tthis.isLoading = false;\n\t\t\t\tthis.$emit('close');\n\t\t\t});\n\t\t},\n\t\tasync createChat(members: number[])\n\t\t{\n\t\t\tthis.isLoading = true;\n\t\t\tconst { newDialogId } = await this.chatService.createChat({\n\t\t\t\ttitle: null,\n\t\t\t\tdescription: null,\n\t\t\t\tmembers,\n\t\t\t\townerId: Core.getUserId(),\n\t\t\t\tisPrivate: true,\n\t\t\t}).catch(() => {\n\t\t\t\tthis.isLoading = false;\n\t\t\t});\n\t\t\tthis.isLoading = false;\n\t\t\tthis.$emit('close');\n\t\t\tvoid Messenger.openChat(newDialogId);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<MessengerPopup\n\t\t\t:config=\"config\"\n\t\t\t:id=\"POPUP_ID\"\n\t\t\t@close=\"$emit('close')\"\n\t\t>\n\t\t\t<AddToChatContent \n\t\t\t\t:dialogId=\"dialogId\" \n\t\t\t\t:isLoading=\"isLoading\"\n\t\t\t\t@close=\"$emit('close')\"\n\t\t\t\t@inviteMembers=\"inviteMembers\"\n\t\t\t/>\n\t\t</MessengerPopup>\n\t`,\n};\n","import { RestMethod } from 'im.v2.const';\nimport { runAction } from 'im.v2.lib.rest';\nimport { Utils } from 'im.v2.lib.utils';\n\ntype AddEmployeesToCollabRequest = {\n\tdialogId: string,\n\tmembers: number[],\n};\n\nexport class CollabInvitationService\n{\n\taddEmployees({ dialogId, members }: AddEmployeesToCollabRequest): void\n\t{\n\t\tconst payload = {\n\t\t\tdata: {\n\t\t\t\tdialogId,\n\t\t\t\tmembers: Utils.user.prepareSelectorIds(members),\n\t\t\t},\n\t\t};\n\n\t\trunAction(RestMethod.socialnetworkMemberAdd, payload)\n\t\t\t.catch(([error]) => {\n\t\t\t\tconsole.error('CollabInvitationService: add employee error', error);\n\t\t\t});\n\t}\n\n\tcopyLink(collabId: number): Promise<string>\n\t{\n\t\tconst payload = {\n\t\t\tdata: { collabId },\n\t\t};\n\n\t\treturn runAction(RestMethod.intranetInviteGetLinkByCollabId, payload)\n\t\t\t.catch(([error]) => {\n\t\t\t\tconsole.error('CollabInvitationService: getting invite link error', error);\n\t\t\t\tthrow error;\n\t\t\t});\n\t}\n\n\tupdateLink(collabId: number): Promise<null>\n\t{\n\t\tconst payload = {\n\t\t\tdata: { collabId },\n\t\t};\n\n\t\treturn runAction(RestMethod.intranetInviteRegenerateLinkByCollabId, payload)\n\t\t\t.catch(([error]) => {\n\t\t\t\tconsole.error('CollabInvitationService: updating invite link error', error);\n\t\t\t\tthrow error;\n\t\t\t});\n\t}\n}\n","import { hint } from 'ui.vue3.directives.hint';\n\nimport { FeaturePromoter } from 'ui.info-helper';\nimport { Utils } from 'im.v2.lib.utils';\nimport { ActionByRole, SliderCode } from 'im.v2.const';\nimport { PermissionManager } from 'im.v2.lib.permission';\nimport { Feature, FeatureManager } from 'im.v2.lib.feature';\nimport { Notifier } from 'im.v2.lib.notifier';\nimport { ChatButton, ButtonColor, ButtonSize } from 'im.v2.component.elements.button';\n\nimport { CollabInvitationService } from '../classes/collab-invitation-service';\n\nimport type { JsonObject } from 'main.core';\nimport type { PopupOptions } from 'main.popup';\n\n// @vue/component\nexport const CopyInviteLink = {\n\tname: 'CopyInviteLink',\n\tcomponents: { ChatButton },\n\tdirectives: { hint },\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tcollabId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisCopyingInviteLink: false,\n\t\t\tisUpdatingLink: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t\tisInviteLinkAvailable(): boolean\n\t\t{\n\t\t\treturn FeatureManager.isFeatureAvailable(Feature.inviteByLinkAvailable);\n\t\t},\n\t\tisEnabledCollabersInvitation(): boolean\n\t\t{\n\t\t\treturn FeatureManager.isFeatureAvailable(Feature.enabledCollabersInvitation);\n\t\t},\n\t\tupdateLinkHint(): { text: string, popupOptions: PopupOptions }\n\t\t{\n\t\t\treturn {\n\t\t\t\ttext: this.loc('IM_ENTITY_SELECTOR_ADD_TO_COLLAB_LINK_UPDATE_HINT'),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\twidth: 278,\n\t\t\t\t\tbindOptions: {\n\t\t\t\t\t\tposition: 'top',\n\t\t\t\t\t},\n\t\t\t\t\tangle: {\n\t\t\t\t\t\toffset: 36,\n\t\t\t\t\t\tposition: 'top',\n\t\t\t\t\t},\n\t\t\t\t\ttargetContainer: document.body,\n\t\t\t\t\toffsetTop: -8,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tcanUpdateLink(): boolean\n\t\t{\n\t\t\treturn PermissionManager.getInstance().canPerformActionByRole(ActionByRole.updateInviteLink, this.dialogId);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tasync copyInviteLink()\n\t\t{\n\t\t\tif (!this.isEnabledCollabersInvitation)\n\t\t\t{\n\t\t\t\tthis.showHelper();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tthis.isCopyingInviteLink = true;\n\t\t\t\tconst link = await (new CollabInvitationService()).copyLink(this.collabId);\n\t\t\t\tawait Utils.text.copyToClipboard(link);\n\t\t\t\tNotifier.onCopyLinkComplete();\n\t\t\t}\n\t\t\tcatch\n\t\t\t{\n\t\t\t\tNotifier.onCopyLinkError();\n\t\t\t}\n\t\t\tfinally\n\t\t\t{\n\t\t\t\tthis.isCopyingInviteLink = false;\n\t\t\t}\n\t\t},\n\t\tasync updateLink()\n\t\t{\n\t\t\tif (!this.isEnabledCollabersInvitation)\n\t\t\t{\n\t\t\t\tthis.showHelper();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tthis.isUpdatingLink = true;\n\t\t\t\tawait (new CollabInvitationService()).updateLink(this.collabId);\n\t\t\t\tNotifier.collab.onUpdateLinkComplete();\n\t\t\t}\n\t\t\tcatch\n\t\t\t{\n\t\t\t\tNotifier.onDefaultError();\n\t\t\t}\n\t\t\tfinally\n\t\t\t{\n\t\t\t\tthis.isUpdatingLink = false;\n\t\t\t}\n\t\t},\n\t\tloc(phraseCode: string, replacements: {[string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tshowHelper()\n\t\t{\n\t\t\tnew FeaturePromoter({ code: SliderCode.collabInviteOff }).show();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"isInviteLinkAvailable\" class=\"bx-im-add-to-collab__invite-block --link\">\n\t\t\t<span class=\"bx-im-add-to-collab__invite-block-title --ellipsis\">\n\t\t\t\t{{ loc('IM_ENTITY_SELECTOR_ADD_TO_COLLAB_INVITE_BY_LINK') }}\n\t\t\t</span>\n\t\t\t<ChatButton\n\t\t\t\t:size=\"ButtonSize.M\"\n\t\t\t\t:color=\"ButtonColor.Primary\"\n\t\t\t\t:isRounded=\"true\"\n\t\t\t\t:isUppercase=\"false\"\n\t\t\t\t:isLoading=\"isCopyingInviteLink\"\n\t\t\t\t:isDisabled=\"isUpdatingLink\"\n\t\t\t\t:text=\"loc('IM_ENTITY_SELECTOR_ADD_TO_COLLAB_COPY_LINK')\"\n\t\t\t\t@click=\"copyInviteLink\"\n\t\t\t/>\n\t\t\t<button\n\t\t\t\tv-if=\"canUpdateLink\"\n\t\t\t\tv-hint=\"updateLinkHint\"\n\t\t\t\t:class=\"{'--loading': isUpdatingLink}\"\n\t\t\t\tclass=\"bx-im-add-to-collab__update-link_button\"\n\t\t\t\t@click=\"updateLink\"\n\t\t\t>\n\t\t\t\t<span class=\"bx-im-add-to-collab__update-link_icon\"></span>\n\t\t\t</button>\n\t\t</div>\n\t`,\n};\n","import { InvitationInput } from 'intranet.invitation-input';\nimport { EventEmitter } from 'main.core.events';\n\nimport { UserType, SliderCode } from 'im.v2.const';\nimport { Core } from 'im.v2.application.core';\nimport { openHelpdeskArticle } from 'im.v2.lib.helpdesk';\nimport { Feature, FeatureManager } from 'im.v2.lib.feature';\nimport { ScrollWithGradient } from 'im.v2.component.elements.scroll-with-gradient';\nimport { ChatButton, ButtonSize, ButtonColor } from 'im.v2.component.elements.button';\nimport { FeaturePromoter } from 'ui.info-helper';\n\nimport { CopyInviteLink } from './copy-invite-link';\n\nimport type { ImModelChat, ImModelCollabInfo, ImModelUser } from 'im.v2.model';\nimport type { JsonObject } from 'main.core';\n\nconst HELPDESK_SLIDER_CLOSE_EVENT = 'SidePanel.Slider:onClose';\nconst HELPDESK_SLIDER_ID = 'main:helper';\n\n// @vue/component\nexport const AddGuestsTab = {\n\tname: 'AddGuestsTab',\n\tcomponents: { ChatButton, ScrollWithGradient, CopyInviteLink },\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\theight: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t},\n\temits: ['close', 'closeHelpdeskSlider', 'openHelpdeskSlider'],\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisAddButtonDisabled: true,\n\t\t\tisInvitingGuests: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t\tisCurrentUserCollaber(): boolean\n\t\t{\n\t\t\tconst currentUser: ImModelUser = this.$store.getters['users/get'](Core.getUserId(), true);\n\n\t\t\treturn currentUser.type === UserType.collaber;\n\t\t},\n\t\tpreparedDescription(): string\n\t\t{\n\t\t\tif (this.isCurrentUserCollaber)\n\t\t\t{\n\t\t\t\treturn this.loc('IM_ENTITY_SELECTOR_ADD_TO_COLLAB_DESCRIPTION_TEXT_GUEST');\n\t\t\t}\n\n\t\t\treturn this.loc('IM_ENTITY_SELECTOR_ADD_TO_COLLAB_DESCRIPTION_TEXT_EMPLOYEE');\n\t\t},\n\t\tpreparedDescriptionTitle(): string\n\t\t{\n\t\t\tif (this.isCurrentUserCollaber)\n\t\t\t{\n\t\t\t\treturn this.loc('IM_ENTITY_SELECTOR_ADD_TO_COLLAB_DESCRIPTION_TITLE_GUEST');\n\t\t\t}\n\n\t\t\treturn this.loc('IM_ENTITY_SELECTOR_ADD_TO_COLLAB_DESCRIPTION_TITLE_EMPLOYEE');\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\tconst chat: ImModelChat = this.$store.getters['chats/get'](this.dialogId, true);\n\n\t\t\treturn chat.chatId;\n\t\t},\n\t\tcollabId(): number\n\t\t{\n\t\t\tconst collab: ImModelCollabInfo = this.$store.getters['chats/collabs/getByChatId'](this.chatId);\n\n\t\t\treturn collab.collabId;\n\t\t},\n\t\tcontainerStyles(): {height: string}\n\t\t{\n\t\t\treturn {\n\t\t\t\theight: `${this.height}px`,\n\t\t\t};\n\t\t},\n\t\tisPhoneInviteAvailable(): boolean\n\t\t{\n\t\t\treturn FeatureManager.isFeatureAvailable(Feature.inviteByPhoneAvailable);\n\t\t},\n\t\tpreparedInvitationTitle(): string\n\t\t{\n\t\t\tif (this.isPhoneInviteAvailable)\n\t\t\t{\n\t\t\t\treturn this.loc('IM_ENTITY_SELECTOR_ADD_TO_COLLAB_INVITE_BY_PHONE_OR_EMAIL');\n\t\t\t}\n\n\t\t\treturn this.loc('IM_ENTITY_SELECTOR_ADD_TO_COLLAB_INVITE_BY_EMAIL');\n\t\t},\n\t\tisCollaber(): boolean\n\t\t{\n\t\t\tconst currentUser: ImModelUser = this.$store.getters['users/get'](Core.getUserId());\n\n\t\t\treturn currentUser.type === UserType.collaber;\n\t\t},\n\t\tisEnabledCollabersInvitation(): boolean\n\t\t{\n\t\t\treturn FeatureManager.isFeatureAvailable(Feature.enabledCollabersInvitation);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.initInvitationInput();\n\t\tEventEmitter.subscribe(HELPDESK_SLIDER_CLOSE_EVENT, this.onCloseOpenHelpdeskSlider);\n\t},\n\tmounted()\n\t{\n\t\tthis.invitationGuests.renderTo(this.$refs['im-collab-invitation-guests-input']);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.invitationGuests.unsubscribe('readyState', this.onReadySaveInputHandler);\n\t\tthis.invitationGuests.unsubscribe('onUnreadySave', this.onUnreadySaveInputHandler);\n\t\tEventEmitter.unsubscribe(HELPDESK_SLIDER_CLOSE_EVENT, this.onCloseOpenHelpdeskSlider);\n\t},\n\tmethods:\n\t{\n\t\topenHelpdesk()\n\t\t{\n\t\t\tthis.$emit('openHelpdeskSlider');\n\n\t\t\tconst ARTICLE_CODE = '22706836';\n\t\t\topenHelpdeskArticle(ARTICLE_CODE);\n\t\t},\n\t\tinitInvitationInput()\n\t\t{\n\t\t\tthis.invitationGuests = new InvitationInput();\n\t\t\tthis.invitationGuests.subscribe('onReadySave', this.onReadySaveInputHandler);\n\t\t\tthis.invitationGuests.subscribe('onUnreadySave', this.onUnreadySaveInputHandler);\n\t\t},\n\t\tonReadySaveInputHandler()\n\t\t{\n\t\t\tthis.isAddButtonDisabled = false;\n\t\t},\n\t\tonUnreadySaveInputHandler()\n\t\t{\n\t\t\tthis.isAddButtonDisabled = true;\n\t\t\tthis.isInvitingGuests = false;\n\t\t},\n\t\tasync addGuestToCollab()\n\t\t{\n\t\t\tthis.isInvitingGuests = true;\n\t\t\tawait this.invitationGuests.inviteToGroup(this.collabId);\n\t\t\tthis.isInvitingGuests = false;\n\t\t\tthis.$emit('close');\n\t\t},\n\t\tonInvitationGuests()\n\t\t{\n\t\t\tif (!this.isEnabledCollabersInvitation)\n\t\t\t{\n\t\t\t\tthis.showHelper();\n\t\t\t}\n\t\t},\n\t\tshowHelper()\n\t\t{\n\t\t\tnew FeaturePromoter({ code: SliderCode.collabInviteOff }).show();\n\t\t},\n\t\tonCloseOpenHelpdeskSlider({ data })\n\t\t{\n\t\t\tconst [event] = data;\n\n\t\t\tconst sliderId = event.getSlider().getUrl().toString();\n\t\t\tif (sliderId === HELPDESK_SLIDER_ID)\n\t\t\t{\n\t\t\t\tthis.$emit('closeHelpdeskSlider');\n\t\t\t}\n\t\t},\n\t\tloc(phraseCode: string, replacements: {[string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-add-to-collab__container\" :style=\"containerStyles\">\n\t\t\t<div class=\"bx-im-add-to-collab__invite-section\">\n\t\t\t\t<ScrollWithGradient :gradientHeight=\"28\" :withShadow=\"true\">\n\t\t\t\t\t<div class=\"bx-im-add-to-collab__content\">\n\t\t\t\t\t\t<div class=\"bx-im-add-to-collab__description\">\n\t\t\t\t\t\t\t<div class=\"bx-im-add-to-collab__description_icon\"></div>\n\t\t\t\t\t\t\t<div class=\"bx-im-add-to-collab__description_content\">\n\t\t\t\t\t\t\t\t<div class=\"bx-im-add-to-collab__description_title\">{{ preparedDescriptionTitle }}</div>\n\t\t\t\t\t\t\t\t<div class=\"bx-im-add-to-collab__description_text\">{{ preparedDescription }}</div>\n\t\t\t\t\t\t\t\t<a class=\"bx-im-add-to-collab__helpdesk-link\" @click.prevent=\"openHelpdesk\">\n\t\t\t\t\t\t\t\t\t{{ loc('IM_ENTITY_SELECTOR_ADD_TO_COLLAB_HELPDESK_LINK') }}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<CopyInviteLink :collabId=\"collabId\" :dialogId=\"dialogId\" />\n\t\t\t\t\t\t<div class=\"bx-im-add-to-collab__invite-block\">\n\t\t\t\t\t\t\t<span class=\"bx-im-add-to-collab__invite-block-title --ellipsis\">\n\t\t\t\t\t\t\t\t{{ preparedInvitationTitle }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<div \n\t\t\t\t\t\t\t\tref=\"im-collab-invitation-guests-input\" \n\t\t\t\t\t\t\t\tclass=\"bx-im-add-to-collab__invite-block-input\"\n\t\t\t\t\t\t\t\t@click=\"onInvitationGuests\"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</ScrollWithGradient>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-add-to-collab__buttons\">\n\t\t\t\t<ChatButton\n\t\t\t\t\t:size=\"ButtonSize.L\"\n\t\t\t\t\t:color=\"ButtonColor.Collab\"\n\t\t\t\t\t:isRounded=\"true\"\n\t\t\t\t\t:text=\"loc('IM_ENTITY_SELECTOR_ADD_TO_CHAT_INVITE_BUTTON')\"\n\t\t\t\t\t:isDisabled=\"isAddButtonDisabled || isInvitingGuests\"\n\t\t\t\t\t:isLoading=\"isInvitingGuests\"\n\t\t\t\t\t@click=\"addGuestToCollab\"\n\t\t\t\t/>\n\t\t\t\t<ChatButton\n\t\t\t\t\t:size=\"ButtonSize.L\"\n\t\t\t\t\t:color=\"ButtonColor.LightBorder\"\n\t\t\t\t\t:isRounded=\"true\"\n\t\t\t\t\t:text=\"loc('IM_ENTITY_SELECTOR_ADD_TO_CHAT_CANCEL_BUTTON')\"\n\t\t\t\t\t@click=\"$emit('close')\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { AddToChatContent } from '../../elements/add-to-chat-content/add-to-chat-content';\nimport { CollabInvitationService } from '../classes/collab-invitation-service';\n\n// @vue/component\nexport const AddEmployeesTab = {\n\tname: 'AddEmployeesTab',\n\tcomponents: { AddToChatContent },\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\theight: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['close'],\n\tmethods:\n\t{\n\t\tinviteMembers({ members })\n\t\t{\n\t\t\t(new CollabInvitationService()).addEmployees({ dialogId: this.dialogId, members });\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-add-to-collab__employees-tab-container\">\n\t\t\t<AddToChatContent\n\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t:height=\"height\"\n\t\t\t\t@inviteMembers=\"inviteMembers\"\n\t\t\t\t@close=\"$emit('close')\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Loc } from 'main.core';\nimport { PopupOptions } from 'main.popup';\n\nimport { UserType } from 'im.v2.const';\nimport { Core } from 'im.v2.application.core';\nimport { Feature, FeatureManager } from 'im.v2.lib.feature';\nimport { SegmentButton } from 'im.v2.component.elements.button';\nimport { MessengerPopup } from 'im.v2.component.elements.popup';\n\nimport { AddGuestsTab } from './components/add-guests-tab';\nimport { AddEmployeesTab } from './components/add-employees-tab';\n\nimport './css/add-to-collab.css';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelUser } from 'im.v2.model';\nimport type { BitrixVueComponentProps } from 'ui.vue3';\n\nconst TabId = Object.freeze({\n\tguests: 'guests',\n\temployees: 'employees',\n});\n\nconst Tabs: Tab[] = [\n\t{\n\t\tid: TabId.guests,\n\t\ttitle: Loc.getMessage('IM_ENTITY_SELECTOR_GUESTS_TAB'),\n\t},\n\t{\n\t\tid: TabId.employees,\n\t\ttitle: Loc.getMessage('IM_ENTITY_SELECTOR_EMPLOYEES_TAB'),\n\t},\n];\n\nconst POPUP_ID = 'im-add-to-collab-popup';\nconst TAB_CONTENT_HEIGHT = 498;\n\n// @vue/component\nexport const AddToCollab = {\n\tname: 'AddToCollab',\n\tcomponents: { MessengerPopup, SegmentButton, AddGuestsTab, AddEmployeesTab },\n\tprops:\n\t{\n\t\tbindElement: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tpopupConfig: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['close'],\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tactiveTabId: TabId.guests,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tPOPUP_ID: () => POPUP_ID,\n\t\tTabs: () => Tabs,\n\t\tconfig(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\ttitleBar: this.$Bitrix.Loc.getMessage('IM_ENTITY_SELECTOR_ADD_TO_COLLAB_TITLE'),\n\t\t\t\tcloseIcon: true,\n\t\t\t\tbindElement: this.bindElement,\n\t\t\t\toffsetTop: this.popupConfig.offsetTop,\n\t\t\t\toffsetLeft: this.popupConfig.offsetLeft,\n\t\t\t\tpadding: 0,\n\t\t\t\tcontentPadding: 0,\n\t\t\t\tcontentBackground: '#fff',\n\t\t\t\tclassName: 'bx-im-add-to-collab__scope',\n\t\t\t};\n\t\t},\n\t\tisEnabledCollabersInvitation(): boolean\n\t\t{\n\t\t\treturn FeatureManager.isFeatureAvailable(Feature.enabledCollabersInvitation);\n\t\t},\n\t\ttabComponent(): BitrixVueComponentProps\n\t\t{\n\t\t\treturn this.activeTabId === TabId.guests ? AddGuestsTab : AddEmployeesTab;\n\t\t},\n\t\tisCollaber(): boolean\n\t\t{\n\t\t\tconst currentUser: ImModelUser = this.$store.getters['users/get'](Core.getUserId());\n\n\t\t\treturn currentUser.type === UserType.collaber;\n\t\t},\n\t\tisInviteLinkAvailable(): boolean\n\t\t{\n\t\t\treturn FeatureManager.isFeatureAvailable(Feature.inviteByLinkAvailable);\n\t\t},\n\t\tfinalHeight(): number\n\t\t{\n\t\t\tconst inviteLinkBlockHeight = 58 + 12;\n\t\t\tconst tabsBlockHeight = 38;\n\n\t\t\tlet finalHeight = TAB_CONTENT_HEIGHT;\n\t\t\tif (this.isCollaber)\n\t\t\t{\n\t\t\t\tfinalHeight -= tabsBlockHeight;\n\t\t\t}\n\n\t\t\tif (!this.isInviteLinkAvailable)\n\t\t\t{\n\t\t\t\tfinalHeight -= inviteLinkBlockHeight;\n\t\t\t}\n\n\t\t\treturn finalHeight;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.activeTabId = this.isEnabledCollabersInvitation ? TabId.guests : TabId.employees;\n\t},\n\tmethods:\n\t{\n\t\tonTabSwitch(tabId: string)\n\t\t{\n\t\t\tthis.activeTabId = tabId;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<MessengerPopup\n\t\t\t:config=\"config\"\n\t\t\t:id=\"POPUP_ID\"\n\t\t\tv-slot=\"{ enableAutoHide, disableAutoHide }\"\n\t\t\t@close=\"$emit('close')\"\n\t\t>\n\t\t\t<div class=\"bx-im-add-to-collab__tabs\">\n\t\t\t\t<SegmentButton \n\t\t\t\t\t:tabs=\"Tabs\" \n\t\t\t\t\t:activeTabId=\"activeTabId\" \n\t\t\t\t\t@segmentSelected=\"onTabSwitch\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<KeepAlive>\n\t\t\t\t<component\n\t\t\t\t\t:is=\"tabComponent\"\n\t\t\t\t\t:dialogId=\"dialogId\" \n\t\t\t\t\t:height=\"finalHeight\"\n\t\t\t\t\t@close=\"$emit('close')\"\n\t\t\t\t\t@openHelpdeskSlider=\"disableAutoHide\"\n\t\t\t\t\t@closeHelpdeskSlider=\"enableAutoHide\"\n\t\t\t\t/>\n\t\t\t</KeepAlive>\n\t\t</MessengerPopup>\n\t`,\n};\n","import { EventEmitter } from 'main.core.events';\n\nimport { Messenger } from 'im.public';\nimport { EventType } from 'im.v2.const';\nimport { Analytics } from 'im.v2.lib.analytics';\nimport { ForwardSearch, ChatSearchInput } from 'im.v2.component.search';\n\nimport type { JsonObject } from 'main.core';\n\nimport './forward-content.css';\n\n// @vue/component\nexport const ForwardContent = {\n\tname: 'ForwardContent',\n\tcomponents: { ForwardSearch, ChatSearchInput },\n\tprops:\n\t{\n\t\tmessagesIds: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['close'],\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tsearchQuery: '',\n\t\t\tisLoading: false,\n\t\t};\n\t},\n\tbeforeUnmount()\n\t{\n\t\tAnalytics.getInstance().messageForward.onClosePopup();\n\t},\n\tmethods:\n\t{\n\t\tonLoading(value: boolean)\n\t\t{\n\t\t\tthis.isLoading = value;\n\t\t},\n\t\tonUpdateSearch(query: string)\n\t\t{\n\t\t\tAnalytics.getInstance().messageForward.onStartSearch({ dialogId: this.dialogId });\n\t\t\tthis.searchQuery = query.trim().toLowerCase();\n\t\t},\n\t\tasync onSelectItem(event: {dialogId: string, nativeEvent: KeyboardEvent})\n\t\t{\n\t\t\tconst { dialogId } = event;\n\n\t\t\tEventEmitter.emit(EventType.dialog.closeBulkActionsMode, {\n\t\t\t\tdialogId,\n\t\t\t});\n\n\t\t\tawait Messenger.openChat(dialogId);\n\n\t\t\tEventEmitter.emit(EventType.textarea.insertForward, {\n\t\t\t\tmessagesIds: this.messagesIds,\n\t\t\t\tdialogId,\n\t\t\t});\n\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-entity-selector-forward__container\">\n\t\t\t<div class=\"bx-im-entity-selector-forward__input\">\n\t\t\t\t<ChatSearchInput \n\t\t\t\t\t:searchMode=\"true\" \n\t\t\t\t\t:isLoading=\"isLoading\" \n\t\t\t\t\t:withIcon=\"false\" \n\t\t\t\t\t:delayForFocusOnStart=\"1\"\n\t\t\t\t\t@updateSearch=\"onUpdateSearch\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-entity-selector-forward__search-result-container\">\n\t\t\t\t<ForwardSearch\n\t\t\t\t\t:query=\"searchQuery\"\n\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t@clickItem=\"onSelectItem\"\n\t\t\t\t\t@loading=\"onLoading\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { PopupOptions } from 'main.popup';\n\nimport { MessengerPopup } from 'im.v2.component.elements.popup';\n\nimport { ForwardContent } from './forward-content';\n\nconst POPUP_ID = 'im-forward-popup';\n\n// @vue/component\nexport const ForwardPopup = {\n\tname: 'ForwardPopup',\n\tcomponents: { MessengerPopup, ForwardContent },\n\tprops:\n\t{\n\t\tmessagesIds: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['close'],\n\tcomputed:\n\t{\n\t\tPOPUP_ID: () => POPUP_ID,\n\t\tconfig(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\ttitleBar: this.popupTitle,\n\t\t\t\tcloseIcon: true,\n\t\t\t\ttargetContainer: document.body,\n\t\t\t\tfixed: true,\n\t\t\t\tdraggable: true,\n\t\t\t\tpadding: 0,\n\t\t\t\tautoHide: false,\n\t\t\t\tcontentPadding: 0,\n\t\t\t\tcontentBackground: '#fff',\n\t\t\t\toverlay: true,\n\t\t\t\tclassName: 'bx-im-entity-selector-forward__scope',\n\t\t\t};\n\t\t},\n\t\tpopupTitle(): string\n\t\t{\n\t\t\treturn this.messagesIds.length > 1\n\t\t\t\t? this.loc('IM_ENTITY_SELECTOR_ADD_TO_CHAT_FORWARD_TITLE_SEVERAL_MESSAGES')\n\t\t\t\t: this.loc('IM_ENTITY_SELECTOR_ADD_TO_CHAT_FORWARD_TITLE');\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<MessengerPopup\n\t\t\t:id=\"POPUP_ID\"\n\t\t\t:config=\"config\"\n\t\t\t@close=\"$emit('close')\"\n\t\t>\n\t\t\t<ForwardContent\n\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t:messagesIds=\"messagesIds\" \n\t\t\t\t@close=\"$emit('close')\"\n\t\t\t/>\n\t\t</MessengerPopup>\n\t`,\n};\n"],"names":["SEARCH_ENTITY_ID","DEFAULT_CONTAINER_HEIGHT","AddToChatContent","name","components","AddToChat","ChatButton","props","dialogId","type","String","required","isLoading","Boolean","height","Number","default","emits","data","searchQuery","showHistory","selectedItems","Set","computed","ButtonSize","ButtonColor","dialog","$store","getters","isChat","ChatType","user","isCollab","collab","isOpenLines","lines","isChannel","ChannelManager","showHistoryOption","containerStyles","created","membersSelector","getTagSelector","mounted","renderTo","$refs","focusTextBox","beforeUnmount","Analytics","getInstance","userAdd","onClosePopup","activated","hideAddButton","showTextBox","methods","timeoutId","TagSelector","maxHeight","showAddButton","addButtonCaption","loc","addButtonCaptionMore","showCreateButton","events","onBeforeTagAdd","clearTimeout","onAfterTagAdd","event","tag","getData","add","id","focusSelector","onKeyUp","keyboardEvent","EventEmitter","emit","EventType","search","keyPressed","onBeforeTagRemove","onAfterTagRemove","delete","onInput","onStartSearch","getTextBoxValue","trim","toLowerCase","onBlur","inputText","length","setTimeout","hideTextBox","onContainerClick","onSelectItem","nativeEvent","has","entityId","removeTag","getTagByDialogId","addTag","clearTextBox","altKey","isExtranet","UserType","extranet","entityType","title","avatar","onInviteClick","members","$emit","key","$Bitrix","Loc","getMessage","template","POPUP_ID","MessengerPopup","bindElement","Object","popupConfig","config","titleBar","closeIcon","offsetTop","offsetLeft","padding","contentPadding","contentBackground","className","chatId","chatService","ChatService","inviteMembers","extendChat","push","Core","getUserId","createChat","addToChat","then","catch","newDialogId","description","ownerId","isPrivate","Messenger","openChat","CollabInvitationService","addEmployees","payload","Utils","prepareSelectorIds","runAction","RestMethod","socialnetworkMemberAdd","error","console","copyLink","collabId","intranetInviteGetLinkByCollabId","updateLink","intranetInviteRegenerateLinkByCollabId","CopyInviteLink","directives","hint","isCopyingInviteLink","isUpdatingLink","isInviteLinkAvailable","FeatureManager","isFeatureAvailable","Feature","inviteByLinkAvailable","isEnabledCollabersInvitation","enabledCollabersInvitation","updateLinkHint","text","popupOptions","width","bindOptions","position","angle","offset","targetContainer","document","body","canUpdateLink","PermissionManager","canPerformActionByRole","ActionByRole","updateInviteLink","copyInviteLink","showHelper","link","copyToClipboard","Notifier","onCopyLinkComplete","onCopyLinkError","onUpdateLinkComplete","onDefaultError","phraseCode","replacements","FeaturePromoter","code","SliderCode","collabInviteOff","show","HELPDESK_SLIDER_CLOSE_EVENT","HELPDESK_SLIDER_ID","AddGuestsTab","ScrollWithGradient","isAddButtonDisabled","isInvitingGuests","isCurrentUserCollaber","currentUser","collaber","preparedDescription","preparedDescriptionTitle","chat","isPhoneInviteAvailable","inviteByPhoneAvailable","preparedInvitationTitle","isCollaber","initInvitationInput","subscribe","onCloseOpenHelpdeskSlider","invitationGuests","unsubscribe","onReadySaveInputHandler","onUnreadySaveInputHandler","openHelpdesk","ARTICLE_CODE","openHelpdeskArticle","InvitationInput","addGuestToCollab","inviteToGroup","onInvitationGuests","sliderId","getSlider","getUrl","toString","AddEmployeesTab","TabId","freeze","guests","employees","Tabs","TAB_CONTENT_HEIGHT","AddToCollab","SegmentButton","activeTabId","tabComponent","finalHeight","inviteLinkBlockHeight","tabsBlockHeight","onTabSwitch","tabId","ForwardContent","ForwardSearch","ChatSearchInput","messagesIds","Array","messageForward","onLoading","value","onUpdateSearch","query","closeBulkActionsMode","textarea","insertForward","ForwardPopup","popupTitle","fixed","draggable","autoHide","overlay"],"mappings":"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"}