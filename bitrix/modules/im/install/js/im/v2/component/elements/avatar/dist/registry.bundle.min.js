this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};this.BX.Messenger.v2=this.BX.Messenger.v2||{};this.BX.Messenger.v2.Component=this.BX.Messenger.v2.Component||{};(function(t,e,a,r,i,o,s,l,n){"use strict";const u=Object.freeze({XXS:"XXS",XS:"XS",S:"S",M:"M",L:"L",XL:"XL",XXL:"XXL",XXXL:"XXXL"});const p=Object.freeze({[u.XXXL]:94,[u.XXL]:60,[u.XL]:48,[u.L]:42,[u.M]:32,[u.S]:22,[u.XS]:18,[u.XXS]:14});const d={notes:"notes"};const c=Object.freeze({default:"default",squared:"squared",collab:"collab"});const h={name:"MessengerAvatar",props:{dialogId:{type:[String,Number],default:0},customSource:{type:String,default:""},size:{type:String,default:u.M},withAvatarLetters:{type:Boolean,default:true},withSpecialTypes:{type:Boolean,default:true},withSpecialTypeIcon:{type:Boolean,default:true},withTooltip:{type:Boolean,default:true},backgroundColor:{type:String,default:""}},data(){return{imageLoadError:false}},computed:{dialog(){return this.$store.getters["chats/get"](this.dialogId,true)},isChannel(){return r.ChannelManager.isChannel(this.dialogId)},isSpecialType(){const t=[n.ChatType.user,n.ChatType.chat,n.ChatType.open,n.ChatType.lines,n.ChatType.copilot];return!t.includes(this.dialog.type)},containerTitle(){if(!this.withTooltip){return""}return this.dialog.name},containerClasses(){const t=[`--size-${this.size.toLowerCase()}`];if(this.withSpecialTypes&&this.isSpecialType){t.push("--special")}const e=n.ChatType[this.dialog.type]?`--${this.dialog.type}`:"--default";t.push(e);return t},backgroundColorStyle(){if(this.backgroundColor){return{backgroundColor:this.backgroundColor}}return{backgroundColor:this.dialog.color}},avatarText(){if(!this.showAvatarLetters||!this.isEnoughSizeForText){return""}return a.Utils.text.getFirstLetters(this.dialog.name)},showAvatarLetters(){const t=[n.ChatType.openChannel,n.ChatType.channel];if(t.includes(this.dialog.type)){return true}return!this.isSpecialType},showSpecialTypeIcon(){if(!this.withSpecialTypes||!this.withSpecialTypeIcon||this.isChannel){return false}return this.isSpecialType},isEnoughSizeForText(){const t=[u.M,u.L,u.XL,u.XXL,u.XXXL];return t.includes(this.size.toUpperCase())},avatarUrl(){return this.customSource.length>0?this.customSource:this.dialog.avatar},hasImage(){return this.avatarUrl&&!this.imageLoadError}},watch:{avatarUrl(){this.imageLoadError=false}},methods:{onImageLoadError(){this.imageLoadError=true}},template:`\n\t\t<div :title="containerTitle" :class="containerClasses" class="bx-im-avatar__scope bx-im-avatar__container">\n\t\t\t\x3c!-- Avatar --\x3e\n\t\t\t<template v-if="hasImage">\n\t\t\t\t<img :src="avatarUrl" :alt="dialog.name" class="bx-im-avatar__content --image" @error="onImageLoadError" draggable="false"/>\n\t\t\t\t<div v-if="showSpecialTypeIcon" :style="backgroundColorStyle" class="bx-im-avatar__special-type_icon"></div>\n\t\t\t</template>\n\t\t\t<div v-else-if="withAvatarLetters && avatarText" :style="backgroundColorStyle" class="bx-im-avatar__content --text">\n\t\t\t\t{{ avatarText }}\n\t\t\t</div>\n\t\t\t<div v-else :style="backgroundColorStyle" class="bx-im-avatar__content bx-im-avatar__icon"></div>\n\t\t</div>\n\t`};const g={extranet:"extranet",collaber:"collaber",collab:"collab",copilot:"copilot",default:"default"};const v={props:{type:{type:String,required:true,validator(t){return Object.values(g).includes(t)}},size:{type:String,default:u.M},url:{type:String,default:""},title:{type:String,default:""},backgroundColor:{type:String,default:""}},computed:{AvatarSize:()=>u,calculatedSize(){return p[this.size]}},watch:{title(){this.avatar.setTitle(this.title)},url(){this.setAvatarImage()}},created(){const t={extranet:i.AvatarRoundExtranet,collaber:i.AvatarRoundGuest,collab:i.AvatarHexagonGuest,copilot:i.AvatarRoundCopilot,default:i.AvatarBase};const e=t[this.type]||t.default;this.avatar=new e({size:this.calculatedSize,title:this.title});this.setAvatarImage();this.setBackgroundColor()},mounted(){if(this.avatar&&this.$refs.avatarContainer){this.avatar.renderTo(this.$refs.avatarContainer)}},methods:{setAvatarImage(){if(!this.url){return}this.avatar.setUserPic(this.url)},setBackgroundColor(){if(!this.backgroundColor){return}this.avatar.setBaseColor(this.backgroundColor)}},template:`\n\t\t<div class="bx-im-base-ui-avatar__container" ref="avatarContainer"></div>\n\t`};const y={name:"CollabChatAvatar",components:{BaseUiAvatar:v},props:{dialogId:{type:[String,Number],default:0},size:{type:String,default:u.M},withAvatarLetters:{type:Boolean,default:true},customSource:{type:String,default:""},withSpecialTypes:{type:Boolean,default:true},withSpecialTypeIcon:{type:Boolean,default:true},withTooltip:{type:Boolean,default:true}},computed:{AvatarType:()=>g,dialog(){return this.$store.getters["chats/get"](this.dialogId,true)},dialogName(){return this.dialog.name},dialogAvatarUrl(){return this.dialog.avatar},collabBackgroundColor(){return n.Color.collab60}},template:`\n\t\t<BaseUiAvatar\n\t\t\t:type="AvatarType.collab"\n\t\t\t:key="dialogId"\n\t\t\t:title="dialogName" \n\t\t\t:size="size" \n\t\t\t:url="dialogAvatarUrl" \n\t\t\t:backgroundColor="collabBackgroundColor" \n\t\t/>\n\t`};const m={name:"CollaberAvatar",components:{BaseUiAvatar:v},props:{dialogId:{type:[String,Number],default:0},size:{type:String,default:u.M},withAvatarLetters:{type:Boolean,default:true},customSource:{type:String,default:""},withSpecialTypes:{type:Boolean,default:true},withSpecialTypeIcon:{type:Boolean,default:true},withTooltip:{type:Boolean,default:true}},computed:{AvatarType:()=>g,dialog(){return this.$store.getters["chats/get"](this.dialogId,true)},dialogName(){return this.dialog.name},dialogAvatarUrl(){return this.dialog.avatar},collaberBackgroundColor(){return n.Color.collab60}},template:`\n\t\t<BaseUiAvatar\n\t\t\t:type="AvatarType.collaber"\n\t\t\t:key="dialogId"\n\t\t\t:title="dialogName" \n\t\t\t:size="size" \n\t\t\t:url="dialogAvatarUrl"\n\t\t\t:backgroundColor="collaberBackgroundColor" \n\t\t/>\n\t`};const C={name:"ExtranetChatAvatar",components:{Avatar:h},props:{dialogId:{type:[String,Number],default:0},size:{type:String,default:u.M},withAvatarLetters:{type:Boolean,default:true},customSource:{type:String,default:""},withSpecialTypes:{type:Boolean,default:true},withSpecialTypeIcon:{type:Boolean,default:true},withTooltip:{type:Boolean,default:true}},computed:{dialog(){return this.$store.getters["chats/get"](this.dialogId,true)},dialogName(){return this.dialog.name},dialogAvatarUrl(){return this.dialog.avatar},extranetBackgroundColor(){return n.Color.orange50}},template:`\n\t\t<Avatar\n\t\t\t:dialogId="dialogId"\n\t\t\t:title="dialogName" \n\t\t\t:size="size" \n\t\t\t:url="dialogAvatarUrl" \n\t\t\t:backgroundColor="extranetBackgroundColor" \n\t\t/>\n\t`};const f={name:"ExtranetUserAvatar",components:{BaseUiAvatar:v},props:{dialogId:{type:[String,Number],default:0},size:{type:String,default:u.M},withAvatarLetters:{type:Boolean,default:true},customSource:{type:String,default:""},withSpecialTypes:{type:Boolean,default:true},withSpecialTypeIcon:{type:Boolean,default:true},withTooltip:{type:Boolean,default:true}},computed:{AvatarType:()=>g,dialog(){return this.$store.getters["chats/get"](this.dialogId,true)},dialogName(){return this.dialog.name},dialogAvatarUrl(){return this.dialog.avatar}},template:`\n\t\t<BaseUiAvatar\n\t\t\t:type="AvatarType.extranet"\n\t\t\t:title="dialogName"\n\t\t\t:size="size"\n\t\t\t:url="dialogAvatarUrl"\n\t\t/>\n\t`};const S={name:"CopilotAvatar",components:{BaseUiAvatar:v},props:{dialogId:{type:[String,Number],default:0},size:{type:String,default:u.M},customSource:{type:String,default:""}},computed:{AvatarType:()=>g,dialog(){return this.$store.getters["chats/get"](this.dialogId,true)},dialogName(){return this.dialog.name},dialogAvatarUrl(){return this.customSource.length>0?this.customSource:this.dialog.avatar}},template:`\n\t\t<BaseUiAvatar\n\t\t\t:type="AvatarType.copilot"\n\t\t\t:title="dialogName" \n\t\t\t:size="size" \n\t\t\t:url="dialogAvatarUrl" \n\t\t/>\n\t`};const b={name:"NotesAvatar",inheritAttrs:false,props:{size:{type:String,default:u.M}},computed:{sizeStyles(){return{width:`${p[this.size]}px`,height:`${p[this.size]}px`}}},methods:{loc(t){return this.$Bitrix.Loc.getMessage(t)}},template:`\n\t\t<div class="bx-im-notes-avatar__container" :style="sizeStyles" :title="loc('IM_ELEMENTS_CHAT_MY_NOTES')"></div>\n\t`};const A={name:"ChatAvatar",components:{Avatar:h,CollabAvatar:y,CollaberAvatar:m,ExtranetUserAvatar:f,NotesAvatar:b,CopilotAvatar:S},props:{avatarDialogId:{type:[String,Number],default:0},contextDialogId:{type:String,required:true},size:{type:String,default:u.M},withAvatarLetters:{type:Boolean,default:true},withSpecialTypes:{type:Boolean,default:true},withSpecialTypeIcon:{type:Boolean,default:true},withTooltip:{type:Boolean,default:true},customType:{type:String,default:""}},created(){this.copilotManager=new o.CopilotManager},computed:{isUser(){return this.avatarDialog.type===n.ChatType.user},user(){return this.$store.getters["users/get"](this.avatarDialogId,true)},customAvatarUrl(){if(!this.isCopilot){return""}return this.copilotManager.getRoleAvatarUrl({avatarDialogId:this.avatarDialogId,contextDialogId:this.contextDialogId})},avatarDialog(){return this.$store.getters["chats/get"](this.avatarDialogId,true)},isCollabChat(){return this.avatarDialog.type===n.ChatType.collab},isCollaber(){var t;return((t=this.user)==null?void 0:t.type)===n.UserType.collaber},isExtranetChat(){return this.avatarDialog.extranet},isExtranet(){var t;return((t=this.user)==null?void 0:t.type)===n.UserType.extranet},isCopilot(){return this.copilotManager.isCopilotChatOrBot(this.avatarDialogId)},isCopilotChatsInRecentTabEnabled(){return s.FeatureManager.isFeatureAvailable(s.Feature.showCopilotChatsInRecentTab)},avatarComponent(){if(this.customType===d.notes){return b}if(this.isExtranet){return f}if(this.isCollaber){return m}if(this.isCollabChat){return y}if(this.isCopilot&&this.isCopilotChatsInRecentTabEnabled){return S}return this.isExtranetChat?C:h}},template:`\n\t\t<component\n\t\t\t:is="avatarComponent"\n\t\t\t:dialogId="avatarDialogId"\n\t\t\t:customSource="customAvatarUrl"\n\t\t\t:size="size"\n\t\t\t:withAvatarLetters="withAvatarLetters"\n\t\t\t:withSpecialTypes="withSpecialTypes"\n\t\t\t:withSpecialTypeIcon="withSpecialTypeIcon"\n\t\t\t:withTooltip="withTooltip"\n\t\t/>\n\t`};const T={name:"MessageAvatar",components:{Avatar:h,CollaberAvatar:m,CopilotAvatar:S},props:{messageId:{type:[String,Number],default:0},authorId:{type:[String,Number],default:0},size:{type:String,default:u.M},withAvatarLetters:{type:Boolean,default:true},withSpecialTypes:{type:Boolean,default:true},withSpecialTypeIcon:{type:Boolean,default:true},withTooltip:{type:Boolean,default:true}},computed:{customAvatarUrl(){const t=new o.CopilotManager;if(!t.isCopilotMessage(this.messageId)){return""}return t.getMessageRoleAvatar(this.messageId)},user(){return this.$store.getters["users/get"](this.authorId,true)},isCopilotChatsInRecentTabEnabled(){return s.FeatureManager.isFeatureAvailable(s.Feature.showCopilotChatsInRecentTab)},avatarComponent(){var t;const e={[n.UserType.extranet]:f,[n.UserType.collaber]:m};if(this.isCopilotChatsInRecentTabEnabled){e[n.UserType.bot]=this.getBotAvatar()}return(t=e[this.user.type])!=null?t:h}},methods:{getBotAvatar(){const t=new o.CopilotManager;return t.isCopilotChatOrBot(this.authorId)?S:h}},template:`\n\t\t<component\n\t\t\t:is="avatarComponent"\n\t\t\t:dialogId="authorId"\n\t\t\t:customSource="customAvatarUrl"\n\t\t\t:size="size"\n\t\t\t:withAvatarLetters="withAvatarLetters"\n\t\t\t:withSpecialTypes="withSpecialTypes"\n\t\t\t:withSpecialTypeIcon="withSpecialTypeIcon"\n\t\t\t:withTooltip="withTooltip"\n\t\t/>\n\t`};const B="/bitrix/js/im/v2/component/elements/avatar/src/components/base/css/images/camera.png";const I={name:"EmptyAvatar",components:{BaseUiAvatar:v},props:{url:{type:String,default:""},title:{type:String,default:""},type:{type:String,default:c.default},size:{type:String,default:u.M}},data(){return{imageLoadError:false}},computed:{AvatarSize:()=>u,AvatarType:()=>g,Color:()=>n.Color,isSquared(){return this.type===c.squared},isCollabType(){return this.type===c.collab},collabEmptyAvatarUrl(){if(!l.Type.isStringFilled(this.url)){return B}return this.url},containerClasses(){const t=[`--size-${this.size.toLowerCase()}`];if(this.isSquared){t.push("--squared")}return t}},template:`\n\t\t<BaseUiAvatar\n\t\t\tv-if="isCollabType"\n\t\t\t:type="AvatarType.collab"\n\t\t\t:url="collabEmptyAvatarUrl" \n\t\t\t:size="size"\n\t\t\t:title="title"\n\t\t\t:backgroundColor="Color.collab10"\n\t\t/>\n\t\t<div v-else class="bx-im-empty-avatar__container" :class="containerClasses">\n\t\t\t<div v-if="!url" class="bx-im-empty-avatar__avatar --default"></div>\n\t\t\t<img v-else class="bx-im-empty-avatar__avatar --image" :src="url" :alt="title"/>\n\t\t</div>\n\t`};t.AvatarSize=u;t.ChatAvatarType=d;t.EmptyAvatarType=c;t.ChatAvatar=A;t.MessageAvatar=T;t.EmptyAvatar=I})(this.BX.Messenger.v2.Component.Elements=this.BX.Messenger.v2.Component.Elements||{},BX,BX.Messenger.v2.Lib,BX.Messenger.v2.Lib,BX.UI,BX.Messenger.v2.Lib,BX.Messenger.v2.Lib,BX,BX.Messenger.v2.Const);
//# sourceMappingURL=registry.bundle.map.js