{"version":3,"file":"registry.bundle.js","sources":["../src/components/create/group-chat.js","../src/components/create/conference.js","../src/components/create/channel.js","../src/components/create/collab/components/description-banner/description-banner.js","../src/components/create/collab/components/rights-section.js","../src/components/create/collab/collab.js","../src/create-chat-content.js","../src/classes/chat-member-diff-manager.js","../src/helpers/get-collapsed-users-element.js","../src/components/update/group-chat.js","../src/components/update/channel.js","../src/components/update/collab.js","../src/update-chat-content.js"],"sourcesContent":["import { BaseEvent, EventEmitter } from 'main.core.events';\nimport { MenuManager } from 'main.popup';\n\nimport { Messenger } from 'im.public';\nimport { CreateChatManager } from 'im.v2.lib.create-chat';\nimport { PermissionManager } from 'im.v2.lib.permission';\nimport { ChatService } from 'im.v2.provider.service.chat';\nimport { UserRole, PopupType, ChatType, EventType, Layout, type OnLayoutChangeEvent } from 'im.v2.const';\nimport {\n\tTitleInput,\n\tChatAvatar,\n\tChatMembersSelector,\n\tButtonPanel,\n\tCreateChatHeading,\n\tSettingsSection,\n\tRightsSection,\n\tAppearanceSection,\n} from 'im.v2.component.content.chat-forms.elements';\n\nimport type { JsonObject } from 'main.core';\n\ntype UserRoleItem = $Keys<typeof UserRole>;\n\n// @vue/component\nexport const GroupChatCreation = {\n\tname: 'GroupChatCreation',\n\tcomponents: {\n\t\tTitleInput,\n\t\tChatAvatar,\n\t\tChatMembersSelector,\n\t\tSettingsSection,\n\t\tRightsSection,\n\t\tAppearanceSection,\n\t\tButtonPanel,\n\t\tCreateChatHeading,\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisCreating: false,\n\t\t\tavatarFile: null,\n\t\t\tchatTitle: '',\n\t\t\tchatMembers: [],\n\t\t\tundeselectedItems: [],\n\t\t\tsettings: {\n\t\t\t\tisAvailableInSearch: false,\n\t\t\t\tdescription: '',\n\t\t\t\tautoDeleteDelay: 0,\n\t\t\t},\n\t\t\trights: {\n\t\t\t\townerId: 0,\n\t\t\t\tmanagerIds: [],\n\t\t\t\tmanageUsersAdd: '',\n\t\t\t\tmanageUsersDelete: '',\n\t\t\t\tmanageUi: '',\n\t\t\t\tmanageMessages: '',\n\t\t\t},\n\t\t};\n\t},\n\twatch:\n\t{\n\t\tchatTitle(newValue)\n\t\t{\n\t\t\tCreateChatManager.getInstance().setChatTitle(newValue);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tEventEmitter.subscribe(EventType.layout.onLayoutChange, this.onLayoutChange);\n\n\t\tthis.initDefaultRolesForRights();\n\n\t\tthis.undeselectedItems = CreateChatManager.getInstance().getUndeselectedItems();\n\t\tthis.rights.ownerId = CreateChatManager.getInstance().getOwnerId();\n\t\tthis.chatMembers = CreateChatManager.getInstance().getChatMembers();\n\n\t\tthis.restoreFields();\n\t\tCreateChatManager.getInstance().setChatType(ChatType.chat);\n\t\tCreateChatManager.getInstance().setCreationStatus(true);\n\t\tCreateChatManager.getInstance().setChatAvatar(this.avatarFile);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tCreateChatManager.getInstance().clearExternalFields();\n\t\tif (this.exitByCancel || this.exitByChatTypeSwitch || this.exitByCreation)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.saveFields();\n\t},\n\tmethods:\n\t{\n\t\tonMembersChange(currentTags: [string, number | string][])\n\t\t{\n\t\t\tthis.chatMembers = currentTags;\n\t\t},\n\t\tonOwnerChange(ownerId: number)\n\t\t{\n\t\t\tthis.rights.ownerId = ownerId;\n\t\t},\n\t\tonManagersChange(managerIds: number[])\n\t\t{\n\t\t\tthis.rights.managerIds = managerIds;\n\t\t},\n\t\tonChatTypeChange(isAvailableInSearch: boolean)\n\t\t{\n\t\t\tthis.settings.isAvailableInSearch = isAvailableInSearch;\n\t\t},\n\t\tonAutoDeleteChange(delay: number)\n\t\t{\n\t\t\tthis.settings.autoDeleteDelay = delay;\n\t\t},\n\t\tonDescriptionChange(description: string)\n\t\t{\n\t\t\tthis.settings.description = description;\n\t\t},\n\t\tonManageUsersAddChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUsersAdd = newValue;\n\t\t},\n\t\tonManageUsersDeleteChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUsersDelete = newValue;\n\t\t},\n\t\tonManageUiChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUi = newValue;\n\t\t},\n\t\tonManageMessagesChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageMessages = newValue;\n\t\t},\n\t\tasync onCreateClick()\n\t\t{\n\t\t\tthis.isCreating = true;\n\n\t\t\tconst { newDialogId } = await this.getChatService().createChat({\n\t\t\t\ttitle: this.chatTitle,\n\t\t\t\tavatar: this.avatarFile,\n\t\t\t\tmemberEntities: this.chatMembers,\n\t\t\t\townerId: this.rights.ownerId,\n\t\t\t\tmanagers: this.rights.managerIds,\n\t\t\t\tisAvailableInSearch: this.settings.isAvailableInSearch,\n\t\t\t\tdescription: this.settings.description,\n\t\t\t\tmanageUsersAdd: this.rights.manageUsersAdd,\n\t\t\t\tmanageUsersDelete: this.rights.manageUsersDelete,\n\t\t\t\tmanageUi: this.rights.manageUi,\n\t\t\t\tmanageMessages: this.rights.manageMessages,\n\t\t\t\tautoDeleteDelay: this.settings.autoDeleteDelay,\n\t\t\t}).catch(() => {\n\t\t\t\tthis.isCreating = false;\n\t\t\t});\n\n\t\t\tthis.isCreating = false;\n\t\t\tthis.exitByCreation = true;\n\t\t\tCreateChatManager.getInstance().setCreationStatus(false);\n\t\t\tvoid Messenger.openChat(newDialogId);\n\t\t},\n\t\tonCancelClick()\n\t\t{\n\t\t\tthis.exitByCancel = true;\n\t\t\tCreateChatManager.getInstance().setCreationStatus(false);\n\t\t\tMessenger.openChat();\n\t\t},\n\t\tonAvatarChange(newAvatarFile: File)\n\t\t{\n\t\t\tthis.avatarFile = newAvatarFile;\n\t\t\tCreateChatManager.getInstance().setChatAvatar(this.avatarFile);\n\t\t},\n\t\tonScroll()\n\t\t{\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUsersAddMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUsersDeleteMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUiMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageMessagesMenu)?.close();\n\t\t},\n\t\tonLayoutChange(event: BaseEvent<OnLayoutChangeEvent>)\n\t\t{\n\t\t\tconst { to } = event.getData();\n\t\t\tif (to.name === Layout.createChat.name && to.entityId !== ChatType.chat)\n\t\t\t{\n\t\t\t\tthis.exitByChatTypeSwitch = true;\n\t\t\t}\n\t\t},\n\t\tsaveFields()\n\t\t{\n\t\t\tCreateChatManager.getInstance().saveFields({\n\t\t\t\tchatTitle: this.chatTitle,\n\t\t\t\tavatarFile: this.avatarFile,\n\t\t\t\tchatMembers: this.chatMembers,\n\t\t\t\tsettings: this.settings,\n\t\t\t\trights: this.rights,\n\t\t\t});\n\t\t},\n\t\trestoreFields()\n\t\t{\n\t\t\tconst savedFields = CreateChatManager.getInstance().getFields();\n\t\t\tif (!savedFields)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { chatTitle, avatarFile, chatMembers, settings, rights } = savedFields;\n\t\t\tthis.chatTitle = chatTitle;\n\t\t\tthis.avatarFile = avatarFile;\n\t\t\tthis.chatMembers = chatMembers;\n\t\t\tthis.settings = settings;\n\t\t\tthis.rights = rights;\n\t\t},\n\t\tinitDefaultRolesForRights()\n\t\t{\n\t\t\tconst {\n\t\t\t\tmanageUsersAdd,\n\t\t\t\tmanageUsersDelete,\n\t\t\t\tmanageUi,\n\t\t\t\tmanageMessages,\n\t\t\t} = PermissionManager.getInstance().getDefaultRolesForActionGroups();\n\n\t\t\tthis.rights.manageUsersAdd = manageUsersAdd;\n\t\t\tthis.rights.manageUsersDelete = manageUsersDelete;\n\t\t\tthis.rights.manageUi = manageUi;\n\t\t\tthis.rights.manageMessages = manageMessages;\n\t\t},\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-chat-forms__content --chat\" @scroll=\"onScroll\">\n\t\t\t<div class=\"bx-im-content-chat-forms__header\">\n\t\t\t\t<ChatAvatar :avatarFile=\"avatarFile\" :chatTitle=\"chatTitle\" @avatarChange=\"onAvatarChange\" />\n\t\t\t\t<TitleInput v-model=\"chatTitle\" :placeholder=\"loc('IM_CREATE_CHAT_TITLE_PLACEHOLDER')\" />\n\t\t\t</div>\n\t\t\t<CreateChatHeading :text=\"loc('IM_CREATE_CHAT_MEMBERS_TITLE')\" />\n\t\t\t<div class=\"bx-im-content-chat-forms__members_container\">\n\t\t\t\t<ChatMembersSelector \n\t\t\t\t\t:undeselectedItems=\"undeselectedItems\" \n\t\t\t\t\t:chatMembers=\"chatMembers\"\n\t\t\t\t\t:allowTeamsSelect=\"true\"\n\t\t\t\t\t@membersChange=\"onMembersChange\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<SettingsSection\n\t\t\t\t:isAvailableInSearch=\"settings.isAvailableInSearch\"\n\t\t\t\t:description=\"settings.description\"\n\t\t\t\t:autoDeleteDelay=\"settings.autoDeleteDelay\"\n\t\t\t\t@autoDeleteDelayChange=\"onAutoDeleteChange\"\n\t\t\t\t@chatTypeChange=\"onChatTypeChange\"\n\t\t\t\t@descriptionChange=\"onDescriptionChange\"\n\t\t\t/>\n\t\t\t<RightsSection\n\t\t\t\t:ownerId=\"rights.ownerId\"\n\t\t\t\t:managerIds=\"rights.managerIds\"\n\t\t\t\t:manageUsersAdd=\"rights.manageUsersAdd\"\n\t\t\t\t:manageUsersDelete=\"rights.manageUsersDelete\"\n\t\t\t\t:manageUi=\"rights.manageUi\"\n\t\t\t\t:manageMessages=\"rights.manageMessages\"\n\t\t\t\t@ownerChange=\"onOwnerChange\"\n\t\t\t\t@managersChange=\"onManagersChange\"\n\t\t\t\t@manageUsersAddChange=\"onManageUsersAddChange\"\n\t\t\t\t@manageUsersDeleteChange=\"onManageUsersDeleteChange\"\n\t\t\t\t@manageUiChange=\"onManageUiChange\"\n\t\t\t\t@manageMessagesChange=\"onManageMessagesChange\"\n\t\t\t/> \n\t\t</div>\n\t\t<ButtonPanel\n\t\t\t:isCreating=\"isCreating\"\n\t\t\t:createButtonTitle=\"loc('IM_CREATE_CHAT_CONFIRM')\"\n\t\t\t@create=\"onCreateClick\"\n\t\t\t@cancel=\"onCancelClick\"\n\t\t/>\n\t`,\n};\n","import { BaseEvent, EventEmitter } from 'main.core.events';\nimport { MenuManager } from 'main.popup';\n\nimport { Messenger } from 'im.public';\nimport { Core } from 'im.v2.application.core';\nimport { EmptyAvatarType } from 'im.v2.component.elements.avatar';\nimport { CreateChatManager } from 'im.v2.lib.create-chat';\nimport { PermissionManager } from 'im.v2.lib.permission';\nimport { Notifier } from 'im.v2.lib.notifier';\nimport { ChatService } from 'im.v2.provider.service.chat';\nimport { UserRole, PopupType, ChatType, EventType, Layout } from 'im.v2.const';\nimport {\n\tTitleInput,\n\tChatAvatar,\n\tChatMembersSelector,\n\tButtonPanel,\n\tCreateChatHeading,\n\tSettingsSection,\n\tRightsSection,\n\tAppearanceSection,\n\tConferenceSection,\n} from 'im.v2.component.content.chat-forms.elements';\n\nimport type { JsonObject } from 'main.core';\nimport type { OnLayoutChangeEvent } from 'im.v2.const';\n\ntype UserRoleItem = $Keys<typeof UserRole>;\n\n// @vue/component\nexport const ConferenceCreation = {\n\tname: 'ConferenceCreation',\n\tcomponents: {\n\t\tTitleInput,\n\t\tChatAvatar,\n\t\tChatMembersSelector,\n\t\tSettingsSection,\n\t\tRightsSection,\n\t\tAppearanceSection,\n\t\tConferenceSection,\n\t\tButtonPanel,\n\t\tCreateChatHeading,\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisCreating: false,\n\t\t\tavatarFile: null,\n\t\t\tchatTitle: '',\n\t\t\tchatMembers: [['user', Core.getUserId()]],\n\t\t\tconference: {\n\t\t\t\tpasswordNeeded: false,\n\t\t\t\tpassword: '',\n\t\t\t},\n\t\t\tsettings: {\n\t\t\t\tdescription: '',\n\t\t\t},\n\t\t\trights: {\n\t\t\t\townerId: 0,\n\t\t\t\tmanagerIds: [],\n\t\t\t\tmanageUsersAdd: '',\n\t\t\t\tmanageUsersDelete: '',\n\t\t\t\tmanageUi: '',\n\t\t\t\tmanageMessages: '',\n\t\t\t},\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tEmptyAvatarType: () => EmptyAvatarType,\n\t},\n\twatch:\n\t{\n\t\tchatTitle(newValue)\n\t\t{\n\t\t\tCreateChatManager.getInstance().setChatTitle(newValue);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tEventEmitter.subscribe(EventType.layout.onLayoutChange, this.onLayoutChange);\n\n\t\tthis.rights.ownerId = Core.getUserId();\n\t\tthis.initDefaultRolesForRights();\n\n\t\tthis.restoreFields();\n\t\tCreateChatManager.getInstance().setChatType(ChatType.videoconf);\n\t\tCreateChatManager.getInstance().setCreationStatus(true);\n\t\tCreateChatManager.getInstance().setChatAvatar(this.avatarFile);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tif (this.exitByCancel || this.exitByChatTypeSwitch)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.saveFields();\n\t},\n\tmethods:\n\t{\n\t\tonMembersChange(currentTags: [string, number | string][])\n\t\t{\n\t\t\tthis.chatMembers = currentTags;\n\t\t},\n\t\tonOwnerChange(ownerId: number)\n\t\t{\n\t\t\tthis.rights.ownerId = ownerId;\n\t\t},\n\t\tonManagersChange(managerIds: number[])\n\t\t{\n\t\t\tthis.rights.managerIds = managerIds;\n\t\t},\n\t\tonDescriptionChange(description: string)\n\t\t{\n\t\t\tthis.settings.description = description;\n\t\t},\n\t\tonManageUsersAddChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUsersAdd = newValue;\n\t\t},\n\t\tonManageUsersDeleteChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUsersDelete = newValue;\n\t\t},\n\t\tonManageUiChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUi = newValue;\n\t\t},\n\t\tonManageMessagesChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageMessages = newValue;\n\t\t},\n\t\tonAvatarChange(newAvatarFile: File)\n\t\t{\n\t\t\tthis.avatarFile = newAvatarFile;\n\t\t\tCreateChatManager.getInstance().setChatAvatar(this.avatarFile);\n\t\t},\n\t\tonPasswordNeededChange(passwordNeeded: boolean)\n\t\t{\n\t\t\tthis.conference.passwordNeeded = passwordNeeded;\n\t\t},\n\t\tonPasswordChange(newPassword: string)\n\t\t{\n\t\t\tthis.conference.password = newPassword;\n\t\t},\n\t\tasync onCreateClick()\n\t\t{\n\t\t\tif (!this.checkPassword())\n\t\t\t{\n\t\t\t\tNotifier.conference.onPasswordError();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isCreating = true;\n\n\t\t\tconst { newDialogId } = await this.getChatService().createChat({\n\t\t\t\tentityType: ChatType.videoconf,\n\t\t\t\ttitle: this.chatTitle,\n\t\t\t\tavatar: this.avatarFile,\n\t\t\t\tmemberEntities: this.chatMembers,\n\t\t\t\townerId: this.rights.ownerId,\n\t\t\t\tmanagers: this.rights.managerIds,\n\t\t\t\tdescription: this.settings.description,\n\t\t\t\tmanageUsersAdd: this.rights.manageUsersAdd,\n\t\t\t\tmanageUsersDelete: this.rights.manageUsersDelete,\n\t\t\t\tmanageUi: this.rights.manageUi,\n\t\t\t\tmanageMessages: this.rights.manageMessages,\n\t\t\t\tconferencePassword: this.conference.passwordNeeded ? this.conference.password : '',\n\t\t\t}).catch(() => {\n\t\t\t\tthis.isCreating = false;\n\t\t\t});\n\n\t\t\tthis.isCreating = false;\n\t\t\tCreateChatManager.getInstance().setCreationStatus(false);\n\t\t\tvoid Messenger.openChat(newDialogId);\n\t\t},\n\t\tonCancelClick()\n\t\t{\n\t\t\tthis.exitByCancel = true;\n\t\t\tCreateChatManager.getInstance().setCreationStatus(false);\n\t\t\tMessenger.openChat();\n\t\t},\n\t\tonScroll()\n\t\t{\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUsersAddMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUsersDeleteMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUiMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageMessagesMenu)?.close();\n\t\t},\n\t\tonLayoutChange(event: BaseEvent<OnLayoutChangeEvent>)\n\t\t{\n\t\t\tconst { to } = event.getData();\n\t\t\tif (to.name === Layout.createChat.name && to.entityId !== ChatType.videoconf)\n\t\t\t{\n\t\t\t\tthis.exitByChatTypeSwitch = true;\n\t\t\t}\n\t\t},\n\t\tsaveFields()\n\t\t{\n\t\t\tCreateChatManager.getInstance().saveFields({\n\t\t\t\tchatTitle: this.chatTitle,\n\t\t\t\tavatarFile: this.avatarFile,\n\t\t\t\tchatMembers: this.chatMembers,\n\t\t\t\tsettings: this.settings,\n\t\t\t\trights: this.rights,\n\t\t\t\tconference: this.conference,\n\t\t\t});\n\t\t},\n\t\trestoreFields()\n\t\t{\n\t\t\tconst savedFields = CreateChatManager.getInstance().getFields();\n\t\t\tif (!savedFields)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { chatTitle, avatarFile, chatMembers, conference, settings, rights } = savedFields;\n\t\t\tthis.chatTitle = chatTitle;\n\t\t\tthis.avatarFile = avatarFile;\n\t\t\tthis.chatMembers = chatMembers;\n\t\t\tthis.conference = conference;\n\t\t\tthis.settings = settings;\n\t\t\tthis.rights = rights;\n\t\t},\n\t\tinitDefaultRolesForRights()\n\t\t{\n\t\t\tconst {\n\t\t\t\tmanageUsersAdd,\n\t\t\t\tmanageUsersDelete,\n\t\t\t\tmanageUi,\n\t\t\t\tmanageMessages,\n\t\t\t} = PermissionManager.getInstance().getDefaultRolesForActionGroups();\n\n\t\t\tthis.rights.manageUsersAdd = manageUsersAdd;\n\t\t\tthis.rights.manageUsersDelete = manageUsersDelete;\n\t\t\tthis.rights.manageUi = manageUi;\n\t\t\tthis.rights.manageMessages = manageMessages;\n\t\t},\n\t\tcheckPassword(): boolean\n\t\t{\n\t\t\tconst PASSWORD_MIN_LENGTH = 3;\n\t\t\tif (!this.conference.passwordNeeded)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tconst password = this.conference.password.trim();\n\n\t\t\treturn password !== '' && password.length >= PASSWORD_MIN_LENGTH;\n\t\t},\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-chat-forms__content --conference\" @scroll=\"onScroll\">\n\t\t\t<div class=\"bx-im-content-chat-forms__header\">\n\t\t\t\t<ChatAvatar \n\t\t\t\t\t:avatarFile=\"avatarFile\" \n\t\t\t\t\t:chatTitle=\"chatTitle\"\n\t\t\t\t\t:type=\"EmptyAvatarType.squared\"\t\n\t\t\t\t\t@avatarChange=\"onAvatarChange\" \n\t\t\t\t/>\n\t\t\t\t<TitleInput v-model=\"chatTitle\" :placeholder=\"loc('IM_CREATE_CONFERENCE_TITLE_PLACEHOLDER')\" />\n\t\t\t</div>\n\t\t\t<CreateChatHeading :text=\"loc('IM_CREATE_CHAT_MEMBERS_TITLE')\" />\n\t\t\t<div class=\"bx-im-content-chat-forms__members_container\">\n\t\t\t\t<ChatMembersSelector :chatMembers=\"chatMembers\" @membersChange=\"onMembersChange\" />\n\t\t\t</div>\n\t\t\t<ConferenceSection\n\t\t\t\t:passwordNeeded=\"conference.passwordNeeded\"\n\t\t\t\t:password=\"conference.password\"\n\t\t\t\t@passwordNeededChange=\"onPasswordNeededChange\"\n\t\t\t\t@passwordChange=\"onPasswordChange\"\n\t\t\t/>\n\t\t\t<SettingsSection\n\t\t\t\t:withSearchOption=\"false\"\n\t\t\t\t:withAutoDeleteOption=\"false\"\n\t\t\t\t:description=\"settings.description\"\n\t\t\t\t@descriptionChange=\"onDescriptionChange\"\n\t\t\t/>\n\t\t\t<RightsSection\n\t\t\t\t:ownerId=\"rights.ownerId\"\n\t\t\t\t:managerIds=\"rights.managerIds\"\n\t\t\t\t:manageUsersAdd=\"rights.manageUsersAdd\"\n\t\t\t\t:manageUsersDelete=\"rights.manageUsersDelete\"\n\t\t\t\t:manageUi=\"rights.manageUi\"\n\t\t\t\t:manageMessages=\"rights.manageMessages\"\n\t\t\t\t@ownerChange=\"onOwnerChange\"\n\t\t\t\t@managersChange=\"onManagersChange\"\n\t\t\t\t@manageUsersAddChange=\"onManageUsersAddChange\"\n\t\t\t\t@manageUsersDeleteChange=\"onManageUsersDeleteChange\"\n\t\t\t\t@manageUiChange=\"onManageUiChange\"\n\t\t\t\t@manageMessagesChange=\"onManageMessagesChange\"\n\t\t\t/>\n\t\t</div>\n\t\t<ButtonPanel\n\t\t\t:isCreating=\"isCreating\"\n\t\t\t:createButtonTitle=\"loc('IM_CREATE_CONFERENCE_CONFIRM')\"\n\t\t\t@create=\"onCreateClick\"\n\t\t\t@cancel=\"onCancelClick\"\n\t\t/>\n\t`,\n};\n","import { BaseEvent, EventEmitter } from 'main.core.events';\nimport { MenuManager } from 'main.popup';\n\nimport { Messenger } from 'im.public';\nimport { CreateChatManager } from 'im.v2.lib.create-chat';\nimport { PermissionManager } from 'im.v2.lib.permission';\nimport { EmptyAvatarType } from 'im.v2.component.elements.avatar';\nimport { ChatService } from 'im.v2.provider.service.chat';\nimport { UserRole, PopupType, ChatType, EventType, Layout, type OnLayoutChangeEvent } from 'im.v2.const';\nimport {\n\tTitleInput,\n\tChatAvatar,\n\tChatMembersSelector,\n\tButtonPanel,\n\tTextareaInput,\n\tCreateChatHeading,\n\tRightsSection,\n\tAppearanceSection,\n\tPrivacySection,\n} from 'im.v2.component.content.chat-forms.elements';\n\nimport type { JsonObject } from 'main.core';\n\ntype UserRoleItem = $Keys<typeof UserRole>;\n\n// @vue/component\nexport const ChannelCreation = {\n\tname: 'ChannelCreation',\n\tcomponents: {\n\t\tTitleInput,\n\t\tChatAvatar,\n\t\tChatMembersSelector,\n\t\tRightsSection,\n\t\tAppearanceSection,\n\t\tPrivacySection,\n\t\tButtonPanel,\n\t\tTextareaInput,\n\t\tCreateChatHeading,\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisCreating: false,\n\t\t\tavatarFile: null,\n\t\t\tchatTitle: '',\n\t\t\tchatMembers: [],\n\t\t\tundeselectedItems: [],\n\t\t\tsettings: {\n\t\t\t\tisAvailableInSearch: false,\n\t\t\t\tdescription: '',\n\t\t\t},\n\t\t\trights: {\n\t\t\t\townerId: 0,\n\t\t\t\tmanagerIds: [],\n\t\t\t\tmanageUsersAdd: '',\n\t\t\t\tmanageUsersDelete: '',\n\t\t\t\tmanageUi: '',\n\t\t\t\tmanageMessages: '',\n\t\t\t},\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tChatType: () => ChatType,\n\t\tEmptyAvatarType: () => EmptyAvatarType,\n\t},\n\twatch:\n\t{\n\t\tchatTitle(newValue)\n\t\t{\n\t\t\tCreateChatManager.getInstance().setChatTitle(newValue);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tEventEmitter.subscribe(EventType.layout.onLayoutChange, this.onLayoutChange);\n\n\t\tthis.initDefaultRolesForRights();\n\n\t\tthis.undeselectedItems = CreateChatManager.getInstance().getUndeselectedItems();\n\t\tthis.rights.ownerId = CreateChatManager.getInstance().getOwnerId();\n\t\tthis.chatMembers = CreateChatManager.getInstance().getChatMembers();\n\n\t\tthis.restoreFields();\n\t\tCreateChatManager.getInstance().setChatType(ChatType.channel);\n\t\tCreateChatManager.getInstance().setCreationStatus(true);\n\t\tCreateChatManager.getInstance().setChatAvatar(this.avatarFile);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tCreateChatManager.getInstance().clearExternalFields();\n\t\tEventEmitter.unsubscribe(EventType.layout.onLayoutChange, this.onLayoutChange);\n\n\t\tif (this.exitByCancel || this.exitByChatTypeSwitch || this.exitByCreation)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.saveFields();\n\t},\n\tmethods:\n\t{\n\t\tonMembersChange(currentTags: [string, number | string][])\n\t\t{\n\t\t\tthis.chatMembers = currentTags;\n\t\t},\n\t\tonOwnerChange(ownerId: number)\n\t\t{\n\t\t\tthis.rights.ownerId = ownerId;\n\t\t},\n\t\tonManagersChange(managerIds: number[])\n\t\t{\n\t\t\tthis.rights.managerIds = managerIds;\n\t\t},\n\t\tonChatTypeChange(isAvailableInSearch: boolean)\n\t\t{\n\t\t\tthis.settings.isAvailableInSearch = isAvailableInSearch;\n\t\t},\n\t\tonDescriptionChange(description: string)\n\t\t{\n\t\t\tthis.settings.description = description;\n\t\t},\n\t\tonManageUsersAddChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUsersAdd = newValue;\n\t\t},\n\t\tonManageUsersDeleteChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUsersDelete = newValue;\n\t\t},\n\t\tonManageUiChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUi = newValue;\n\t\t},\n\t\tonManageMessagesChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageMessages = newValue;\n\t\t},\n\t\tasync onCreateClick()\n\t\t{\n\t\t\tthis.isCreating = true;\n\n\t\t\tconst { newDialogId } = await this.getChatService().createChat({\n\t\t\t\ttype: ChatType.channel,\n\t\t\t\ttitle: this.chatTitle,\n\t\t\t\tavatar: this.avatarFile,\n\t\t\t\tmemberEntities: this.chatMembers,\n\t\t\t\townerId: this.rights.ownerId,\n\t\t\t\tmanagers: this.rights.managerIds,\n\t\t\t\tisAvailableInSearch: this.settings.isAvailableInSearch,\n\t\t\t\tdescription: this.settings.description,\n\t\t\t\tmanageUsersAdd: this.rights.manageUsersAdd,\n\t\t\t\tmanageUsersDelete: this.rights.manageUsersDelete,\n\t\t\t\tmanageUi: this.rights.manageUi,\n\t\t\t\tmanageMessages: this.rights.manageMessages,\n\t\t\t}).catch(() => {\n\t\t\t\tthis.isCreating = false;\n\t\t\t});\n\n\t\t\tthis.isCreating = false;\n\t\t\tthis.exitByCreation = true;\n\t\t\tCreateChatManager.getInstance().setCreationStatus(false);\n\t\t\tCreateChatManager.getInstance().setPreselectedMembers([]);\n\t\t\tvoid Messenger.openChat(newDialogId);\n\t\t},\n\t\tonCancelClick()\n\t\t{\n\t\t\tthis.exitByCancel = true;\n\t\t\tCreateChatManager.getInstance().setCreationStatus(false);\n\t\t\tCreateChatManager.getInstance().setPreselectedMembers([]);\n\t\t\tMessenger.openChat();\n\t\t},\n\t\tonAvatarChange(newAvatarFile: File)\n\t\t{\n\t\t\tthis.avatarFile = newAvatarFile;\n\t\t\tCreateChatManager.getInstance().setChatAvatar(this.avatarFile);\n\t\t},\n\t\tonScroll()\n\t\t{\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUsersAddMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUsersDeleteMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUiMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageMessagesMenu)?.close();\n\t\t},\n\t\tonLayoutChange(event: BaseEvent<OnLayoutChangeEvent>)\n\t\t{\n\t\t\tconst { to } = event.getData();\n\t\t\tif (to.name === Layout.createChat.name && to.entityId !== ChatType.channel)\n\t\t\t{\n\t\t\t\tthis.exitByChatTypeSwitch = true;\n\t\t\t}\n\t\t},\n\t\tsaveFields()\n\t\t{\n\t\t\tCreateChatManager.getInstance().saveFields({\n\t\t\t\tchatTitle: this.chatTitle,\n\t\t\t\tavatarFile: this.avatarFile,\n\t\t\t\tchatMembers: this.chatMembers,\n\t\t\t\tsettings: this.settings,\n\t\t\t\trights: this.rights,\n\t\t\t});\n\t\t},\n\t\trestoreFields()\n\t\t{\n\t\t\tconst savedFields = CreateChatManager.getInstance().getFields();\n\t\t\tif (!savedFields)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { chatTitle, avatarFile, chatMembers, settings, rights } = savedFields;\n\t\t\tthis.chatTitle = chatTitle;\n\t\t\tthis.avatarFile = avatarFile;\n\t\t\tthis.chatMembers = chatMembers;\n\t\t\tthis.settings = settings;\n\t\t\tthis.rights = rights;\n\t\t},\n\t\tinitDefaultRolesForRights()\n\t\t{\n\t\t\tconst {\n\t\t\t\tmanageUsersAdd,\n\t\t\t\tmanageUsersDelete,\n\t\t\t\tmanageUi,\n\t\t\t\tmanageMessages,\n\t\t\t} = PermissionManager.getInstance().getDefaultRolesForActionGroups(ChatType.channel);\n\n\t\t\tthis.rights.manageUsersAdd = manageUsersAdd;\n\t\t\tthis.rights.manageUsersDelete = manageUsersDelete;\n\t\t\tthis.rights.manageUi = manageUi;\n\t\t\tthis.rights.manageMessages = manageMessages;\n\t\t},\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\tloc(phraseCode: string, replacements: {[string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-chat-forms__content --channel\" @scroll=\"onScroll\">\n\t\t\t<div class=\"bx-im-content-chat-forms__header\">\n\t\t\t\t<ChatAvatar \n\t\t\t\t\t:avatarFile=\"avatarFile\" \n\t\t\t\t\t:chatTitle=\"chatTitle\" \n\t\t\t\t\t:type=\"EmptyAvatarType.squared\"\n\t\t\t\t\t@avatarChange=\"onAvatarChange\" \n\t\t\t\t/>\n\t\t\t\t<TitleInput v-model=\"chatTitle\" :placeholder=\"loc('IM_CREATE_CHANNEL_TITLE_PLACEHOLDER_V2')\" />\n\t\t\t</div>\n\t\t\t<CreateChatHeading :text=\"loc('IM_CREATE_CHANNEL_DESCRIPTION_TITLE')\" />\n\t\t\t<div class=\"bx-im-content-chat-forms__description_container\">\n\t\t\t\t<TextareaInput\n\t\t\t\t\t:value=\"settings.description\"\n\t\t\t\t\t:placeholder=\"loc('IM_CREATE_CHANNEL_DESCRIPTION_PLACEHOLDER_V3')\"\n\t\t\t\t\t:border=\"false\"\n\t\t\t\t\t@input=\"onDescriptionChange\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<PrivacySection\n\t\t\t\t:isAvailableInSearch=\"settings.isAvailableInSearch\"\n\t\t\t\t@chatTypeChange=\"onChatTypeChange\"\n\t\t\t/>\n\t\t\t<CreateChatHeading\n\t\t\t\t:text=\"loc('IM_CREATE_CHANNEL_MEMBERS_TITLE')\"\n\t\t\t\t:hintText=\"loc('IM_CREATE_CHANNEL_MEMBERS_HINT')\"\n\t\t\t/>\n\t\t\t<div class=\"bx-im-content-chat-forms__members_container\">\n\t\t\t\t<ChatMembersSelector \n\t\t\t\t\t:chatMembers=\"chatMembers\"\n\t\t\t\t\t:undeselectedItems=\"undeselectedItems\"\n\t\t\t\t\t:allowTeamsSelect=\"true\"\n\t\t\t\t\t@membersChange=\"onMembersChange\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<RightsSection\n\t\t\t\t:chatType=\"ChatType.channel\"\n\t\t\t\t:ownerId=\"rights.ownerId\"\n\t\t\t\t:managerIds=\"rights.managerIds\"\n\t\t\t\t:manageUsersAdd=\"rights.manageUsersAdd\"\n\t\t\t\t:manageUsersDelete=\"rights.manageUsersDelete\"\n\t\t\t\t:manageUi=\"rights.manageUi\"\n\t\t\t\t:manageMessages=\"rights.manageMessages\"\n\t\t\t\t@ownerChange=\"onOwnerChange\"\n\t\t\t\t@managersChange=\"onManagersChange\"\n\t\t\t\t@manageUsersAddChange=\"onManageUsersAddChange\"\n\t\t\t\t@manageUsersDeleteChange=\"onManageUsersDeleteChange\"\n\t\t\t\t@manageUiChange=\"onManageUiChange\"\n\t\t\t\t@manageMessagesChange=\"onManageMessagesChange\"\n\t\t\t/>\n\t\t</div>\n\t\t<ButtonPanel\n\t\t\t:isCreating=\"isCreating\"\n\t\t\t:createButtonTitle=\"loc('IM_CREATE_CHANNEL_CONFIRM')\"\n\t\t\t@create=\"onCreateClick\"\n\t\t\t@cancel=\"onCancelClick\"\n\t\t/>\n\t`,\n};\n","import { Loc, Dom } from 'main.core';\n\nimport { openHelpdeskArticle } from 'im.v2.lib.helpdesk';\n\nimport './css/description-banner.css';\n\nconst LINK_CSS_CLASS = 'bx-im-create-collab-description-banner__link';\nconst TITLE_LINK_MODIFIER = '--title';\nconst INVITE_LINK_MODIFIER = '--invite';\n\n// @vue/component\nexport const DescriptionBanner = {\n\tname: 'DescriptionBanner',\n\tcomputed:\n\t{\n\t\tpreparedTitle(): string\n\t\t{\n\t\t\treturn Loc.getMessage('IM_CREATE_COLLAB_BANNER_TITLE', {\n\t\t\t\t'[learn-more]': `<span class=\"${LINK_CSS_CLASS} ${TITLE_LINK_MODIFIER} --solid\">`,\n\t\t\t\t'[/learn-more]': '</span>',\n\t\t\t});\n\t\t},\n\t\tpreparedInviteText(): string\n\t\t{\n\t\t\treturn Loc.getMessage('IM_CREATE_COLLAB_BANNER_TEXT_2', {\n\t\t\t\t'[learn-more]': `<span class=\"${LINK_CSS_CLASS} ${INVITE_LINK_MODIFIER} --dashed\">`,\n\t\t\t\t'[/learn-more]': '</span>',\n\t\t\t});\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonTitleClick(event: PointerEvent)\n\t\t{\n\t\t\tif (!Dom.hasClass(event.target, TITLE_LINK_MODIFIER))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst ARTICLE_CODE = '22706764';\n\t\t\topenHelpdeskArticle(ARTICLE_CODE);\n\t\t},\n\t\tonInviteClick(event: PointerEvent)\n\t\t{\n\t\t\tif (!Dom.hasClass(event.target, INVITE_LINK_MODIFIER))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst ARTICLE_CODE = '22706836';\n\t\t\topenHelpdeskArticle(ARTICLE_CODE);\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-create-collab-description-banner__container\" ref=\"container\">\n\t\t\t<div class=\"bx-im-create-collab-description-banner__icon\"></div>\n\t\t\t<div class=\"bx-im-create-collab-description-banner__content\">\n\t\t\t\t<div class=\"bx-im-create-collab-description-banner__title\" v-html=\"preparedTitle\" @click=\"onTitleClick\"></div>\n\t\t\t\t<div class=\"bx-im-create-collab-description-banner__text\">\n\t\t\t\t\t{{ loc('IM_CREATE_COLLAB_BANNER_TEXT_1') }}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-create-collab-description-banner__text\" v-html=\"preparedInviteText\" @click=\"onInviteClick\"></div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { EventEmitter, BaseEvent } from 'main.core.events';\nimport { AccessRights } from 'socialnetwork.collab.access-rights';\n\nimport { CreateChatExternalSection } from 'im.v2.component.content.chat-forms.elements';\n\nimport type { JsonObject } from 'main.core';\n\nexport type AccessRightsFormResult = {\n\tmoderators: number[],\n\townerId: number,\n\toptions: JsonObject,\n\tpermissions: JsonObject\n};\n\n// @vue/component\nexport const RightsSection = {\n\tname: 'RightsSection',\n\tcomponents: { CreateChatExternalSection },\n\tprops:\n\t{\n\t\tcollabId: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t},\n\temits: ['change'],\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tformResult: null,\n\t\t};\n\t},\n\tmethods:\n\t{\n\t\tasync onClick()\n\t\t{\n\t\t\tconst sliderParams = {};\n\t\t\tif (this.collabId > 0)\n\t\t\t{\n\t\t\t\tsliderParams.collabId = this.collabId;\n\t\t\t}\n\n\t\t\tif (this.formResult)\n\t\t\t{\n\t\t\t\tsliderParams.formData = this.formResult;\n\t\t\t}\n\t\t\tthis.form = await AccessRights.openForm(sliderParams);\n\t\t\tthis.bindEvents();\n\t\t},\n\t\tbindEvents()\n\t\t{\n\t\t\tEventEmitter.subscribe(this.form, 'save', this.onSave);\n\t\t\tEventEmitter.subscribe(this.form, 'cancel', this.onCancel);\n\t\t},\n\t\tunbindEvents()\n\t\t{\n\t\t\tEventEmitter.unsubscribe(this.form, 'save', this.onSave);\n\t\t\tEventEmitter.unsubscribe(this.form, 'cancel', this.onCancel);\n\t\t},\n\t\tonSave(event: BaseEvent<AccessRightsFormResult>)\n\t\t{\n\t\t\tthis.formResult = event.getData();\n\t\t\tthis.$emit('change', this.formResult);\n\t\t\tthis.unbindEvents();\n\t\t},\n\t\tonCancel()\n\t\t{\n\t\t\tthis.unbindEvents();\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<CreateChatExternalSection\n\t\t\t:title=\"loc('IM_CREATE_CHAT_RIGHTS_SECTION')\"\n\t\t\t@click=\"onClick\"\n\t\t\tname=\"rights\"\n\t\t/>\n\t`,\n};\n","import { BaseEvent, EventEmitter } from 'main.core.events';\n\nimport { Core } from 'im.v2.application.core';\nimport { Messenger } from 'im.public';\nimport { ChatService } from 'im.v2.provider.service.chat';\nimport { EmptyAvatarType } from 'im.v2.component.elements.avatar';\nimport { ChatType, EventType, Layout, Color } from 'im.v2.const';\nimport { CreateChatManager } from 'im.v2.lib.create-chat';\nimport { TitleInput, ChatAvatar, CreateChatHeading, TextareaInput, ButtonPanel, AutoDelete } from 'im.v2.component.content.chat-forms.elements';\n\nimport { DescriptionBanner } from './components/description-banner/description-banner';\nimport { RightsSection } from './components/rights-section';\n\nimport type { JsonObject } from 'main.core';\nimport type { CustomColorScheme } from 'im.v2.component.elements.button';\nimport type { OnLayoutChangeEvent } from 'im.v2.const';\nimport type { AccessRightsFormResult } from './components/rights-section';\n\nexport const CollabCreation = {\n\tname: 'CollabCreation',\n\tcomponents: {\n\t\tTitleInput,\n\t\tChatAvatar,\n\t\tDescriptionBanner,\n\t\tCreateChatHeading,\n\t\tTextareaInput,\n\t\tButtonPanel,\n\t\tRightsSection,\n\t\tAutoDelete,\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisCreating: false,\n\t\t\tavatarFile: null,\n\t\t\tchatTitle: '',\n\t\t\tdescription: '',\n\t\t\tgroupSettings: {\n\t\t\t\townerId: Core.getUserId(),\n\t\t\t\tmoderatorMembers: [],\n\t\t\t\toptions: {},\n\t\t\t\tpermissions: null,\n\t\t\t},\n\t\t\tautoDeleteDelay: 0,\n\t\t};\n\t},\n\twatch:\n\t{\n\t\tchatTitle(newValue: string): void\n\t\t{\n\t\t\tCreateChatManager.getInstance().setChatTitle(newValue);\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tEmptyAvatarType: () => EmptyAvatarType,\n\t\tcreateButtonColorScheme(): CustomColorScheme\n\t\t{\n\t\t\treturn {\n\t\t\t\tborderColor: Color.transparent,\n\t\t\t\tbackgroundColor: Color.collab60,\n\t\t\t\ticonColor: Color.white,\n\t\t\t\ttextColor: Color.white,\n\t\t\t\thoverColor: Color.collab50,\n\t\t\t};\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tEventEmitter.subscribe(EventType.layout.onLayoutChange, this.onLayoutChange);\n\n\t\tthis.restoreFields();\n\t\tCreateChatManager.getInstance().setChatType(ChatType.collab);\n\t\tCreateChatManager.getInstance().setCreationStatus(true);\n\t\tCreateChatManager.getInstance().setChatAvatar(this.avatarFile);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tEventEmitter.unsubscribe(EventType.layout.onLayoutChange, this.onLayoutChange);\n\n\t\tif (this.exitByCancel || this.exitByChatTypeSwitch || this.exitByCreation)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.saveFields();\n\t},\n\tmethods:\n\t{\n\t\trestoreFields(): void\n\t\t{\n\t\t\tconst savedFields = CreateChatManager.getInstance().getFields();\n\t\t\tif (!savedFields)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { chatTitle, avatarFile, description, autoDeleteDelay } = savedFields;\n\t\t\tthis.chatTitle = chatTitle;\n\t\t\tthis.avatarFile = avatarFile;\n\t\t\tthis.description = description;\n\t\t\tthis.autoDeleteDelay = autoDeleteDelay;\n\t\t},\n\t\tsaveFields()\n\t\t{\n\t\t\tCreateChatManager.getInstance().saveFields({\n\t\t\t\tchatTitle: this.chatTitle,\n\t\t\t\tavatarFile: this.avatarFile,\n\t\t\t\tdescription: this.description,\n\t\t\t\tautoDeleteDelay: this.autoDeleteDelay,\n\t\t\t});\n\t\t},\n\t\tonLayoutChange(event: BaseEvent<OnLayoutChangeEvent>): void\n\t\t{\n\t\t\tconst { to } = event.getData();\n\t\t\tif (to.name === Layout.createChat.name && to.entityId !== ChatType.collab)\n\t\t\t{\n\t\t\t\tthis.exitByChatTypeSwitch = true;\n\t\t\t}\n\t\t},\n\t\tasync onCreateClick(): void\n\t\t{\n\t\t\tthis.isCreating = true;\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tconst { newDialogId } = await this.getChatService().createCollab({\n\t\t\t\t\ttitle: this.chatTitle,\n\t\t\t\t\tavatar: this.avatarFile,\n\t\t\t\t\tdescription: this.description,\n\t\t\t\t\townerId: this.groupSettings.ownerId,\n\t\t\t\t\tmoderatorMembers: this.groupSettings.moderatorMembers,\n\t\t\t\t\toptions: this.groupSettings.options,\n\t\t\t\t\tpermissions: this.groupSettings.permissions,\n\t\t\t\t\tautoDeleteDelay: this.autoDeleteDelay,\n\t\t\t\t});\n\n\t\t\t\tthis.isCreating = false;\n\t\t\t\tthis.exitByCreation = true;\n\t\t\t\tCreateChatManager.getInstance().setCreationStatus(false);\n\t\t\t\tawait Messenger.openChat(newDialogId);\n\t\t\t\tEventEmitter.emit(EventType.header.openAddToChatPopup);\n\t\t\t}\n\t\t\tcatch\n\t\t\t{\n\t\t\t\tthis.isCreating = false;\n\t\t\t}\n\t\t},\n\t\tonCancelClick()\n\t\t{\n\t\t\tthis.exitByCancel = true;\n\t\t\tCreateChatManager.getInstance().setCreationStatus(false);\n\t\t\tMessenger.openChat();\n\t\t},\n\t\tonAvatarChange(newAvatarFile: File)\n\t\t{\n\t\t\tthis.avatarFile = newAvatarFile;\n\t\t\tCreateChatManager.getInstance().setChatAvatar(this.avatarFile);\n\t\t},\n\t\tonDescriptionChange(description: string)\n\t\t{\n\t\t\tthis.description = description;\n\t\t},\n\t\tonRightsChange(rights: AccessRightsFormResult)\n\t\t{\n\t\t\tconst { ownerId, moderators, permissions, options } = rights;\n\t\t\tthis.groupSettings.ownerId = ownerId;\n\t\t\tthis.groupSettings.moderatorMembers = moderators;\n\t\t\tthis.groupSettings.permissions = permissions;\n\t\t\tthis.groupSettings.options = options;\n\t\t},\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\tonAutoDeleteDelayChange(delay: number): void\n\t\t{\n\t\t\tthis.autoDeleteDelay = delay;\n\t\t},\n\t\tloc(phraseCode: string, replacements: {[string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-chat-forms__content --collab\">\n\t\t\t<div class=\"bx-im-content-chat-forms__header\">\n\t\t\t\t<ChatAvatar \n\t\t\t\t\t:avatarFile=\"avatarFile\" \n\t\t\t\t\t:chatTitle=\"chatTitle\" \n\t\t\t\t\t:type=\"EmptyAvatarType.collab\" \n\t\t\t\t\t@avatarChange=\"onAvatarChange\" \n\t\t\t\t/>\n\t\t\t\t<TitleInput v-model=\"chatTitle\" :placeholder=\"loc('IM_CREATE_COLLAB_TITLE_PLACEHOLDER')\" />\n\t\t\t</div>\n\t\t\t<DescriptionBanner />\n\t\t\t<CreateChatHeading :text=\"loc('IM_CREATE_COLLAB_DESCRIPTION_TITLE')\" />\n\t\t\t<div class=\"bx-im-content-chat-forms__description_container\">\n\t\t\t\t<TextareaInput\n\t\t\t\t\t:value=\"description\"\n\t\t\t\t\t:placeholder=\"loc('IM_CREATE_COLLAB_DESCRIPTION_PLACEHOLDER')\"\n\t\t\t\t\t:border=\"false\"\n\t\t\t\t\t@input=\"onDescriptionChange\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<RightsSection @change=\"onRightsChange\" />\n\t\t\t<AutoDelete \n\t\t\t\t:initialDelay=\"autoDeleteDelay\" \n\t\t\t\t@delayChange=\"onAutoDeleteDelayChange\" \n\t\t\t/>\n\t\t</div>\n\t\t<ButtonPanel\n\t\t\t:isCreating=\"isCreating\"\n\t\t\t:createButtonTitle=\"loc('IM_CREATE_COLLAB_CONFIRM')\"\n\t\t\t:createButtonColorScheme=\"createButtonColorScheme\"\n\t\t\t@create=\"onCreateClick\"\n\t\t\t@cancel=\"onCancelClick\"\n\t\t/>\n\t`,\n};\n","import { ChatType } from 'im.v2.const';\n\nimport { GroupChatCreation } from './components/create/group-chat';\nimport { ConferenceCreation } from './components/create/conference';\nimport { ChannelCreation } from './components/create/channel';\nimport { CollabCreation } from './components/create/collab/collab';\n\nimport './css/chat-forms-content.css';\n\nimport type { BitrixVueComponentProps } from 'ui.vue3';\n\nexport type CreatableChatType = $Values<typeof CreatableChat>;\n\nexport const CreatableChat = {\n\tchat: 'chat',\n\tvideoconf: 'videoconf',\n\tchannel: 'channel',\n\tcollab: 'collab',\n};\n\nexport type OpenChatCreationParams = {\n\tpreselectedMembers?: PreselectedMemberItem[],\n\townerId?: number,\n\tincludeCurrentUser?: boolean,\n};\n\nexport type PreselectedMemberItem = {\n\ttype: 'user' | 'department',\n\tid: number | string,\n};\n\nconst CreationComponentByChatType = {\n\t[ChatType.chat]: GroupChatCreation,\n\t[ChatType.videoconf]: ConferenceCreation,\n\t[ChatType.channel]: ChannelCreation,\n\t[ChatType.collab]: CollabCreation,\n\tdefault: GroupChatCreation,\n};\n\n// @vue/component\nexport const CreateChatContent = {\n\tname: 'CreateChatContent',\n\tcomponents: { GroupChatCreation, ConferenceCreation, ChannelCreation, CollabCreation },\n\tprops:\n\t{\n\t\tentityId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tChatType: () => ChatType,\n\t\tchatType(): $Values<typeof ChatType>\n\t\t{\n\t\t\treturn this.entityId;\n\t\t},\n\t\tcreationComponent(): BitrixVueComponentProps\n\t\t{\n\t\t\treturn CreationComponentByChatType[this.chatType] ?? CreationComponentByChatType.default;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-chat-forms__container\">\n\t\t\t<component :is=\"creationComponent\" />\n\t\t</div>\n\t`,\n};\n","type MemberElement = [string, number | string];\n\nexport class ChatMemberDiffManager\n{\n\t#initialManagers: number[] = [];\n\t#initialMembers: MemberElement[] = [];\n\n\tsetInitialManagers(initialManagers: number[])\n\t{\n\t\tthis.#initialManagers = initialManagers;\n\t}\n\n\tsetInitialChatMembers(initialMembers: MemberElement)\n\t{\n\t\tthis.#initialMembers = initialMembers;\n\t}\n\n\tgetAddedMemberEntities(modifiedEntities: MemberElement[]): MemberElement[]\n\t{\n\t\tconst originalSet = new Set(this.#initialMembers.map((elem) => JSON.stringify(elem)));\n\n\t\treturn modifiedEntities.filter((elem) => !originalSet.has(JSON.stringify(elem)));\n\t}\n\n\tgetDeletedMemberEntities(modifiedEntities: MemberElement[]): MemberElement[]\n\t{\n\t\tconst modifiedSet = new Set(modifiedEntities.map((elem) => JSON.stringify(elem)));\n\n\t\treturn this.#initialMembers.filter((elem) => !modifiedSet.has(JSON.stringify(elem)));\n\t}\n\n\tgetAddedManagers(modifiedArray: number[]): number[]\n\t{\n\t\tconst originalSet = new Set(this.#initialManagers);\n\n\t\treturn modifiedArray.filter((elem) => !originalSet.has(elem));\n\t}\n\n\tgetDeletedManagers(modifiedArray: number[]): number[]\n\t{\n\t\tconst modifiedSet = new Set(modifiedArray);\n\n\t\treturn this.#initialManagers.filter((elem) => !modifiedSet.has(elem));\n\t}\n}\n","const ENTITY_ID = 'imUpdateChatCollapsedUsers';\nconst AVATAR_URL = '/bitrix/js/im/v2/component/content/chat-forms/src/css/images/collapsed-users-avatar.svg';\n\nexport type TagSelectorElement = {\n\tid: number,\n\tentityId: string,\n\tavatar: string,\n\ttitle: {\n\t\ttext: string,\n\t\ttype: 'html',\n\t},\n\tdeselectable: boolean,\n\ttagOptions: {\n\t\tonclick: Function,\n\t},\n};\n\nexport function getCollapsedUsersElement({ title, onclick }): TagSelectorElement\n{\n\tconst textNode = `\n\t\t<div class=\"bx-im-content-chat-forms__collapsed-users\">\n\t\t\t${title}\n\t\t\t<div class=\"bx-im-content-chat-forms__collapsed-users-icon\"></div>\n\t\t</div>\n\t`;\n\n\treturn {\n\t\tid: 0,\n\t\tentityId: ENTITY_ID,\n\t\tavatar: AVATAR_URL,\n\t\ttitle: {\n\t\t\ttext: textNode,\n\t\t\ttype: 'html',\n\t\t},\n\t\tdeselectable: false,\n\t\ttagOptions: { onclick },\n\t};\n}\n","import { EventEmitter } from 'main.core.events';\nimport { MenuManager } from 'main.popup';\n\nimport { Messenger } from 'im.public';\nimport { Analytics } from 'im.v2.lib.analytics';\nimport { ChatService } from 'im.v2.provider.service.chat';\nimport { ChatType, EventType, PopupType, SidebarDetailBlock, UserRole } from 'im.v2.const';\nimport { showExitUpdateChatConfirm } from 'im.v2.lib.confirm';\nimport {\n\tTitleInput,\n\tChatAvatar,\n\tChatMembersSelector,\n\tButtonPanel,\n\tCreateChatHeading,\n\tSettingsSection,\n\tRightsSection,\n} from 'im.v2.component.content.chat-forms.elements';\n\nimport { ChatMemberDiffManager } from '../../classes/chat-member-diff-manager';\nimport { getCollapsedUsersElement, type TagSelectorElement } from '../../helpers/get-collapsed-users-element';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelChat } from 'im.v2.model';\n\ntype UserRoleItem = $Keys<typeof UserRole>;\n\n// @vue/component\nexport const GroupChatUpdating = {\n\tname: 'GroupChatUpdating',\n\tcomponents: {\n\t\tTitleInput,\n\t\tChatAvatar,\n\t\tButtonPanel,\n\t\tCreateChatHeading,\n\t\tChatMembersSelector,\n\t\tSettingsSection,\n\t\tRightsSection,\n\t},\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisLoading: true,\n\t\t\tisUpdating: false,\n\t\t\tareUsersCollapsed: false,\n\t\t\tcollapsedUsersCount: 0,\n\t\t\tavatarFile: null,\n\t\t\tavatarUrl: '',\n\t\t\tchatTitle: '',\n\t\t\tchatMembers: [],\n\t\t\tsettings: {\n\t\t\t\tisAvailableInSearch: false,\n\t\t\t\tdescription: '',\n\t\t\t},\n\t\t\trights: {\n\t\t\t\townerId: 0,\n\t\t\t\tmanagerIds: [],\n\t\t\t\tmanageUsersAdd: '',\n\t\t\t\tmanageUsersDelete: '',\n\t\t\t\tmanageUi: '',\n\t\t\t\tmanageMessages: '',\n\t\t\t},\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t\tChatType: () => ChatType,\n\t\tcollapsedUsers(): TagSelectorElement[]\n\t\t{\n\t\t\tif (!this.areUsersCollapsed)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tconst title = this.loc('IM_UPDATE_GROUP_CHAT_COLLAPSED_ELEMENT', {\n\t\t\t\t'#COUNT#': this.collapsedUsersCount,\n\t\t\t});\n\n\t\t\tconst element = getCollapsedUsersElement({\n\t\t\t\ttitle,\n\t\t\t\tonclick: this.onCollapsedUsersClick,\n\t\t\t});\n\n\t\t\treturn [element];\n\t\t},\n\t\tcanChangeSearchAvailability(): boolean\n\t\t{\n\t\t\treturn [ChatType.open, ChatType.chat].includes(this.dialog.type);\n\t\t},\n\t\tchangedChatType(): $Values<typeof ChatType>\n\t\t{\n\t\t\tif (!this.canChangeSearchAvailability)\n\t\t\t{\n\t\t\t\treturn this.dialog.type;\n\t\t\t}\n\n\t\t\treturn this.settings.isAvailableInSearch ? ChatType.open : ChatType.chat;\n\t\t},\n\t},\n\tasync created()\n\t{\n\t\tawait this.fillForm();\n\t\tthis.memberDiffManager = new ChatMemberDiffManager();\n\t\tthis.memberDiffManager.setInitialChatMembers(this.chatMembers);\n\t\tthis.memberDiffManager.setInitialManagers(this.rights.managerIds);\n\n\t\tthis.isLoading = false;\n\t},\n\tmethods:\n\t{\n\t\tonMembersChange(currentTags: [string, number | string][])\n\t\t{\n\t\t\tthis.chatMembers = currentTags;\n\t\t},\n\t\tonChatTypeChange(isAvailableInSearch: boolean)\n\t\t{\n\t\t\tthis.settings.isAvailableInSearch = isAvailableInSearch;\n\t\t},\n\t\tonOwnerChange(ownerId: number)\n\t\t{\n\t\t\tthis.rights.ownerId = ownerId;\n\t\t},\n\t\tonManagersChange(managerIds: number[])\n\t\t{\n\t\t\tthis.rights.managerIds = managerIds;\n\t\t},\n\t\tonManageUsersAddChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUsersAdd = newValue;\n\t\t},\n\t\tonManageUsersDeleteChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUsersDelete = newValue;\n\t\t},\n\t\tonManageUiChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUi = newValue;\n\t\t},\n\t\tonManageMessagesChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageMessages = newValue;\n\t\t},\n\t\tonDescriptionChange(description: string)\n\t\t{\n\t\t\tthis.settings.description = description;\n\t\t},\n\t\tasync fillForm()\n\t\t{\n\t\t\tthis.chatTitle = this.dialog.name;\n\t\t\tthis.avatarUrl = this.dialog.avatar;\n\t\t\tthis.settings.description = this.dialog.description;\n\t\t\tthis.chatMembers = await this.getMemberEntities();\n\t\t\tthis.rights.ownerId = this.dialog.ownerId;\n\t\t\tthis.rights.manageMessages = this.dialog.permissions.manageMessages;\n\t\t\tthis.rights.managerIds = this.dialog.managerList;\n\t\t\tthis.rights.manageUi = this.dialog.permissions.manageUi;\n\t\t\tthis.rights.manageUsersAdd = this.dialog.permissions.manageUsersAdd;\n\t\t\tthis.rights.manageUsersDelete = this.dialog.permissions.manageUsersDelete;\n\t\t\tthis.settings.isAvailableInSearch = this.dialog.type === ChatType.open;\n\t\t},\n\t\tasync getMemberEntities(): Promise<[string, number][]>\n\t\t{\n\t\t\tconst {\n\t\t\t\tmemberEntities,\n\t\t\t\tareUsersCollapsed,\n\t\t\t\tuserCount,\n\t\t\t} = await this.getChatService().getMemberEntities(this.chatId);\n\n\t\t\tif (areUsersCollapsed)\n\t\t\t{\n\t\t\t\tthis.areUsersCollapsed = true;\n\t\t\t\tthis.collapsedUsersCount = userCount;\n\n\t\t\t\treturn memberEntities;\n\t\t\t}\n\n\t\t\treturn memberEntities;\n\t\t},\n\t\tasync onUpdateClick(): Promise\n\t\t{\n\t\t\tAnalytics.getInstance().chatEdit.onSubmitForm(this.dialogId);\n\t\t\tAnalytics.getInstance().ignoreNextChatOpen(this.dialogId);\n\n\t\t\tthis.isUpdating = true;\n\n\t\t\tawait this.getChatService().updateChat(this.chatId, {\n\t\t\t\ttitle: this.chatTitle,\n\t\t\t\tavatar: this.avatarFile,\n\t\t\t\ttype: this.changedChatType,\n\t\t\t\taddedMemberEntities: this.memberDiffManager.getAddedMemberEntities(this.chatMembers),\n\t\t\t\tdeletedMemberEntities: this.memberDiffManager.getDeletedMemberEntities(this.chatMembers),\n\t\t\t\taddedManagers: this.memberDiffManager.getAddedManagers(this.rights.managerIds),\n\t\t\t\tdeletedManagers: this.memberDiffManager.getDeletedManagers(this.rights.managerIds),\n\t\t\t\townerId: this.rights.ownerId,\n\t\t\t\tisAvailableInSearch: this.settings.isAvailableInSearch,\n\t\t\t\tdescription: this.settings.description,\n\t\t\t\tmanageUsersAdd: this.rights.manageUsersAdd,\n\t\t\t\tmanageUsersDelete: this.rights.manageUsersDelete,\n\t\t\t\tmanageUi: this.rights.manageUi,\n\t\t\t\tmanageMessages: this.rights.manageMessages,\n\t\t\t}).catch(() => {\n\t\t\t\tthis.isUpdating = false;\n\t\t\t});\n\n\t\t\tthis.isUpdating = false;\n\n\t\t\treturn Messenger.openChat(this.dialogId);\n\t\t},\n\t\tonCancelClick()\n\t\t{\n\t\t\tAnalytics.getInstance().ignoreNextChatOpen(this.dialogId);\n\t\t\tvoid Messenger.openChat(this.dialogId);\n\t\t},\n\t\tonAvatarChange(newAvatarFile: File)\n\t\t{\n\t\t\tthis.avatarFile = newAvatarFile;\n\t\t\tthis.avatarUrl = '';\n\t\t},\n\t\tonScroll()\n\t\t{\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUsersAddMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUsersDeleteMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUiMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageMessagesMenu)?.close();\n\t\t},\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\tloc(phraseCode: string, replacements: {[string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tasync onCollapsedUsersClick()\n\t\t{\n\t\t\tconst confirmResult = await showExitUpdateChatConfirm(this.dialogId);\n\t\t\tif (!confirmResult)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tawait this.onUpdateClick();\n\n\t\t\tEventEmitter.emit(EventType.sidebar.open, {\n\t\t\t\tpanel: SidebarDetailBlock.members,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"isLoading\" class=\"bx-im-content-chat-forms__skeleton\"></div>\n\t\t<div v-else class=\"bx-im-content-chat-forms__content --chat\" @scroll=\"onScroll\">\n\t\t\t<div class=\"bx-im-content-chat-forms__header\">\n\t\t\t\t<ChatAvatar\n\t\t\t\t\t:avatarFile=\"avatarFile\" \n\t\t\t\t\t:existingAvatarUrl=\"avatarUrl\" \n\t\t\t\t\t:chatTitle=\"chatTitle\" \n\t\t\t\t\t@avatarChange=\"onAvatarChange\" \n\t\t\t\t/>\n\t\t\t\t<TitleInput v-model=\"chatTitle\" :placeholder=\"loc('IM_CREATE_CHAT_TITLE_PLACEHOLDER')\" />\n\t\t\t</div>\n\t\t\t<CreateChatHeading :text=\"loc('IM_CREATE_CHAT_MEMBERS_TITLE')\" />\n\t\t\t<div class=\"bx-im-content-chat-forms__members_container\">\n\t\t\t\t<ChatMembersSelector \n\t\t\t\t\t:customElements=\"collapsedUsers\"\n\t\t\t\t\t:chatMembers=\"chatMembers\"\n\t\t\t\t\t:allowTeamsSelect=\"dialog.type !== ChatType.videoconf\"\n\t\t\t\t\t@membersChange=\"onMembersChange\" \n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<SettingsSection\n\t\t\t\t:isAvailableInSearch=\"settings.isAvailableInSearch\"\n\t\t\t\t:description=\"settings.description\"\n\t\t\t\t:withSearchOption=\"canChangeSearchAvailability\"\n\t\t\t\t:withAutoDeleteOption=\"false\"\n\t\t\t\t@chatTypeChange=\"onChatTypeChange\"\n\t\t\t\t@descriptionChange=\"onDescriptionChange\"\n\t\t\t/>\n\t\t\t<RightsSection\n\t\t\t\t:ownerId=\"rights.ownerId\"\n\t\t\t\t:managerIds=\"rights.managerIds\"\n\t\t\t\t:manageUsersAdd=\"rights.manageUsersAdd\"\n\t\t\t\t:manageUsersDelete=\"rights.manageUsersDelete\"\n\t\t\t\t:manageUi=\"rights.manageUi\"\n\t\t\t\t:manageMessages=\"rights.manageMessages\"\n\t\t\t\t@ownerChange=\"onOwnerChange\"\n\t\t\t\t@managersChange=\"onManagersChange\"\n\t\t\t\t@manageUsersAddChange=\"onManageUsersAddChange\"\n\t\t\t\t@manageUsersDeleteChange=\"onManageUsersDeleteChange\"\n\t\t\t\t@manageUiChange=\"onManageUiChange\"\n\t\t\t\t@manageMessagesChange=\"onManageMessagesChange\"\n\t\t\t/>\n\t\t</div>\n\t\t<ButtonPanel\n\t\t\t:isCreating=\"isUpdating || isLoading\"\n\t\t\t:createButtonTitle=\"loc('IM_UPDATE_CONFIRM')\"\n\t\t\t@create=\"onUpdateClick\"\n\t\t\t@cancel=\"onCancelClick\"\n\t\t/>\n\t`,\n};\n","import { EventEmitter } from 'main.core.events';\nimport { MenuManager } from 'main.popup';\n\nimport { Messenger } from 'im.public';\nimport { Analytics } from 'im.v2.lib.analytics';\nimport { ChatService } from 'im.v2.provider.service.chat';\nimport { EmptyAvatarType } from 'im.v2.component.elements.avatar';\nimport { UserRole, PopupType, ChatType, EventType, SidebarDetailBlock } from 'im.v2.const';\nimport { showExitUpdateChatConfirm } from 'im.v2.lib.confirm';\nimport {\n\tTitleInput,\n\tChatAvatar,\n\tChatMembersSelector,\n\tButtonPanel,\n\tTextareaInput,\n\tCreateChatHeading,\n\tRightsSection,\n\tAppearanceSection,\n\tPrivacySection,\n} from 'im.v2.component.content.chat-forms.elements';\n\nimport { ChatMemberDiffManager } from '../../classes/chat-member-diff-manager';\nimport { getCollapsedUsersElement, type TagSelectorElement } from '../../helpers/get-collapsed-users-element';\n\nimport type { ImModelChat } from 'im.v2.model';\nimport type { JsonObject } from 'main.core';\n\ntype UserRoleItem = $Keys<typeof UserRole>;\n\n// @vue/component\nexport const ChannelUpdating = {\n\tname: 'ChannelUpdating',\n\tcomponents: {\n\t\tTitleInput,\n\t\tChatAvatar,\n\t\tChatMembersSelector,\n\t\tRightsSection,\n\t\tAppearanceSection,\n\t\tPrivacySection,\n\t\tButtonPanel,\n\t\tTextareaInput,\n\t\tCreateChatHeading,\n\t},\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisLoading: true,\n\t\t\tisUpdating: false,\n\t\t\tareUsersCollapsed: false,\n\t\t\tcollapsedUsersCount: 0,\n\t\t\tavatarFile: null,\n\t\t\tavatarUrl: '',\n\t\t\tchatTitle: '',\n\t\t\tchatMembers: [],\n\t\t\tsettings: {\n\t\t\t\tisAvailableInSearch: true,\n\t\t\t\tdescription: '',\n\t\t\t},\n\t\t\trights: {\n\t\t\t\townerId: 0,\n\t\t\t\tmanagerIds: [],\n\t\t\t\tmanageUsersAdd: '',\n\t\t\t\tmanageUsersDelete: '',\n\t\t\t\tmanageUi: '',\n\t\t\t\tmanageMessages: '',\n\t\t\t},\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tChatType: () => ChatType,\n\t\tEmptyAvatarType: () => EmptyAvatarType,\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t\tchatType(): $Values<typeof ChatType>\n\t\t{\n\t\t\treturn this.dialog.type;\n\t\t},\n\t\tcollapsedUsers(): TagSelectorElement[]\n\t\t{\n\t\t\tif (!this.areUsersCollapsed)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tconst title = this.loc('IM_UPDATE_CHANNEL_COLLAPSED_ELEMENT', {\n\t\t\t\t'#COUNT#': this.collapsedUsersCount,\n\t\t\t});\n\n\t\t\tconst element = getCollapsedUsersElement({\n\t\t\t\ttitle,\n\t\t\t\tonclick: this.onCollapsedUsersClick,\n\t\t\t});\n\n\t\t\treturn [element];\n\t\t},\n\t\tchangedChatType(): $Values<typeof ChatType>\n\t\t{\n\t\t\treturn this.settings.isAvailableInSearch ? ChatType.openChannel : ChatType.channel;\n\t\t},\n\t},\n\tasync created()\n\t{\n\t\tawait this.fillForm();\n\t\tthis.memberDiffManager = new ChatMemberDiffManager();\n\t\tthis.memberDiffManager.setInitialChatMembers(this.chatMembers);\n\t\tthis.memberDiffManager.setInitialManagers(this.rights.managerIds);\n\n\t\tthis.isLoading = false;\n\t},\n\tmethods:\n\t{\n\t\tonMembersChange(currentTags: [string, number | string][])\n\t\t{\n\t\t\tthis.chatMembers = currentTags;\n\t\t},\n\t\tonOwnerChange(ownerId: number)\n\t\t{\n\t\t\tthis.rights.ownerId = ownerId;\n\t\t},\n\t\tonManagersChange(managerIds: number[])\n\t\t{\n\t\t\tthis.rights.managerIds = managerIds;\n\t\t},\n\t\tonDescriptionChange(description: string)\n\t\t{\n\t\t\tthis.settings.description = description;\n\t\t},\n\t\tonManageUsersAddChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUsersAdd = newValue;\n\t\t},\n\t\tonManageUsersDeleteChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUsersDelete = newValue;\n\t\t},\n\t\tonManageUiChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUi = newValue;\n\t\t},\n\t\tonManageMessagesChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageMessages = newValue;\n\t\t},\n\t\tonChatTypeChange(isAvailableInSearch: boolean)\n\t\t{\n\t\t\tthis.settings.isAvailableInSearch = isAvailableInSearch;\n\t\t},\n\t\tasync onUpdateClick(): Promise\n\t\t{\n\t\t\tAnalytics.getInstance().chatEdit.onSubmitForm(this.dialogId);\n\t\t\tAnalytics.getInstance().ignoreNextChatOpen(this.dialogId);\n\n\t\t\tthis.isUpdating = true;\n\n\t\t\tawait this.getChatService().updateChat(this.chatId, {\n\t\t\t\ttitle: this.chatTitle,\n\t\t\t\tavatar: this.avatarFile,\n\t\t\t\ttype: this.changedChatType,\n\t\t\t\taddedMemberEntities: this.memberDiffManager.getAddedMemberEntities(this.chatMembers),\n\t\t\t\tdeletedMemberEntities: this.memberDiffManager.getDeletedMemberEntities(this.chatMembers),\n\t\t\t\taddedManagers: this.memberDiffManager.getAddedManagers(this.rights.managerIds),\n\t\t\t\tdeletedManagers: this.memberDiffManager.getDeletedManagers(this.rights.managerIds),\n\t\t\t\townerId: this.rights.ownerId,\n\t\t\t\tisAvailableInSearch: this.settings.isAvailableInSearch,\n\t\t\t\tdescription: this.settings.description,\n\t\t\t\tmanageUsersAdd: this.rights.manageUsersAdd,\n\t\t\t\tmanageUsersDelete: this.rights.manageUsersDelete,\n\t\t\t\tmanageUi: this.rights.manageUi,\n\t\t\t\tmanageMessages: this.rights.manageMessages,\n\t\t\t}).catch(() => {\n\t\t\t\tthis.isUpdating = false;\n\t\t\t});\n\n\t\t\tthis.isUpdating = false;\n\n\t\t\treturn Messenger.openChat(this.dialogId);\n\t\t},\n\t\tonCancelClick()\n\t\t{\n\t\t\tAnalytics.getInstance().ignoreNextChatOpen(this.dialogId);\n\t\t\tvoid Messenger.openChat(this.dialogId);\n\t\t},\n\t\tonAvatarChange(newAvatarFile: File)\n\t\t{\n\t\t\tthis.avatarFile = newAvatarFile;\n\t\t\tthis.avatarUrl = '';\n\t\t},\n\t\tonScroll()\n\t\t{\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUsersAddMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUsersDeleteMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUiMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageMessagesMenu)?.close();\n\t\t},\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\tasync fillForm()\n\t\t{\n\t\t\tthis.chatTitle = this.dialog.name;\n\t\t\tthis.avatarUrl = this.dialog.avatar;\n\t\t\tthis.settings.description = this.dialog.description;\n\t\t\tthis.chatMembers = await this.getMemberEntities();\n\t\t\tthis.rights.ownerId = this.dialog.ownerId;\n\t\t\tthis.rights.manageMessages = this.dialog.permissions.manageMessages;\n\t\t\tthis.rights.managerIds = this.dialog.managerList;\n\t\t\tthis.rights.manageUi = this.dialog.permissions.manageUi;\n\t\t\tthis.rights.manageUsersAdd = this.dialog.permissions.manageUsersAdd;\n\t\t\tthis.rights.manageUsersDelete = this.dialog.permissions.manageUsersDelete;\n\t\t\tthis.settings.isAvailableInSearch = this.dialog.type === ChatType.openChannel;\n\t\t},\n\t\tasync getMemberEntities(): Promise<[string, number][]>\n\t\t{\n\t\t\tconst {\n\t\t\t\tmemberEntities,\n\t\t\t\tareUsersCollapsed,\n\t\t\t\tuserCount,\n\t\t\t} = await this.getChatService().getMemberEntities(this.chatId);\n\n\t\t\tif (areUsersCollapsed)\n\t\t\t{\n\t\t\t\tthis.areUsersCollapsed = true;\n\t\t\t\tthis.collapsedUsersCount = userCount;\n\n\t\t\t\treturn memberEntities;\n\t\t\t}\n\n\t\t\treturn memberEntities;\n\t\t},\n\t\tloc(phraseCode: string, replacements: {[string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tasync onCollapsedUsersClick()\n\t\t{\n\t\t\tconst confirmResult = await showExitUpdateChatConfirm(this.dialogId);\n\t\t\tif (!confirmResult)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tawait this.onUpdateClick();\n\n\t\t\tEventEmitter.emit(EventType.sidebar.open, {\n\t\t\t\tpanel: SidebarDetailBlock.members,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"isLoading\" class=\"bx-im-content-chat-forms__skeleton\"></div>\n\t\t<div v-else class=\"bx-im-content-chat-forms__content --channel\" @scroll=\"onScroll\">\n\t\t\t<div class=\"bx-im-content-chat-forms__header\">\n\t\t\t\t<ChatAvatar\n\t\t\t\t\t:avatarFile=\"avatarFile\"\n\t\t\t\t\t:chatTitle=\"chatTitle\"\n\t\t\t\t\t:existingAvatarUrl=\"avatarUrl\"\n\t\t\t\t\t:type=\"EmptyAvatarType.squared\"\n\t\t\t\t\t@avatarChange=\"onAvatarChange\"\n\t\t\t\t/>\n\t\t\t\t<TitleInput v-model=\"chatTitle\" :placeholder=\"loc('IM_CREATE_CHANNEL_TITLE_PLACEHOLDER_V2')\" />\n\t\t\t</div>\n\t\t\t<CreateChatHeading :text=\"loc('IM_CREATE_CHANNEL_DESCRIPTION_TITLE')\" />\n\t\t\t<div class=\"bx-im-content-chat-forms__description_container\">\n\t\t\t\t<TextareaInput\n\t\t\t\t\t:value=\"settings.description\"\n\t\t\t\t\t:placeholder=\"loc('IM_CREATE_CHANNEL_DESCRIPTION_PLACEHOLDER_V3')\"\n\t\t\t\t\t:border=\"false\"\n\t\t\t\t\t@input=\"onDescriptionChange\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<PrivacySection\n\t\t\t\t:isAvailableInSearch=\"settings.isAvailableInSearch\"\n\t\t\t\t@chatTypeChange=\"onChatTypeChange\"\n\t\t\t/>\n\t\t\t<CreateChatHeading\n\t\t\t\t:text=\"loc('IM_CREATE_CHANNEL_MEMBERS_TITLE')\"\n\t\t\t\t:hintText=\"loc('IM_CREATE_CHANNEL_MEMBERS_HINT')\"\n\t\t\t/>\n\t\t\t<div class=\"bx-im-content-chat-forms__members_container\">\n\t\t\t\t<ChatMembersSelector\n\t\t\t\t\t:customElements=\"collapsedUsers\"\n\t\t\t\t\t:chatMembers=\"chatMembers\"\n\t\t\t\t\t:allowTeamsSelect=\"true\"\n\t\t\t\t\t@membersChange=\"onMembersChange\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<RightsSection\n\t\t\t\t:chatType=\"ChatType.channel\"\n\t\t\t\t:ownerId=\"rights.ownerId\"\n\t\t\t\t:managerIds=\"rights.managerIds\"\n\t\t\t\t:manageUsersAdd=\"rights.manageUsersAdd\"\n\t\t\t\t:manageUsersDelete=\"rights.manageUsersDelete\"\n\t\t\t\t:manageUi=\"rights.manageUi\"\n\t\t\t\t:manageMessages=\"rights.manageMessages\"\n\t\t\t\t@ownerChange=\"onOwnerChange\"\n\t\t\t\t@managersChange=\"onManagersChange\"\n\t\t\t\t@manageUsersAddChange=\"onManageUsersAddChange\"\n\t\t\t\t@manageUsersDeleteChange=\"onManageUsersDeleteChange\"\n\t\t\t\t@manageUiChange=\"onManageUiChange\"\n\t\t\t\t@manageMessagesChange=\"onManageMessagesChange\"\n\t\t\t/>\n\t\t</div>\n\t\t<ButtonPanel\n\t\t\t:isCreating=\"isLoading || isUpdating\"\n\t\t\t:createButtonTitle=\"loc('IM_UPDATE_CONFIRM')\"\n\t\t\t@create=\"onUpdateClick\"\n\t\t\t@cancel=\"onCancelClick\"\n\t\t/>\n\t`,\n};\n","import { Core } from 'im.v2.application.core';\nimport { Messenger } from 'im.public';\nimport { Analytics } from 'im.v2.lib.analytics';\nimport { ChatService } from 'im.v2.provider.service.chat';\nimport { EmptyAvatarType } from 'im.v2.component.elements.avatar';\nimport { Color } from 'im.v2.const';\nimport {\n\tTitleInput,\n\tChatAvatar,\n\tButtonPanel,\n\tCreateChatHeading,\n\tTextareaInput,\n} from 'im.v2.component.content.chat-forms.elements';\n\nimport { RightsSection } from '../create/collab/components/rights-section';\nimport { ChatMemberDiffManager } from '../../classes/chat-member-diff-manager';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelChat, ImModelCollabInfo } from 'im.v2.model';\nimport type { CustomColorScheme } from 'im.v2.component.elements.button';\n\nimport type { AccessRightsFormResult } from '../create/collab/components/rights-section';\n\n// @vue/component\nexport const CollabUpdating = {\n\tname: 'CollabUpdating',\n\tcomponents:\n\t{\n\t\tTitleInput,\n\t\tChatAvatar,\n\t\tTextareaInput,\n\t\tButtonPanel,\n\t\tCreateChatHeading,\n\t\tRightsSection,\n\t},\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisUpdating: false,\n\t\t\tavatarFile: null,\n\t\t\tavatarUrl: '',\n\t\t\tchatTitle: '',\n\t\t\tdescription: '',\n\t\t\tgroupSettings: {\n\t\t\t\townerId: Core.getUserId(),\n\t\t\t\tmoderatorMembers: [],\n\t\t\t\toptions: null,\n\t\t\t\tpermissions: null,\n\t\t\t\tisModified: false,\n\t\t\t},\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tEmptyAvatarType: () => EmptyAvatarType,\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t\tcollabId(): number\n\t\t{\n\t\t\tconst { collabId }: ImModelCollabInfo = this.$store.getters['chats/collabs/getByChatId'](this.chatId);\n\n\t\t\treturn collabId;\n\t\t},\n\t\tupdateButtonColorScheme(): CustomColorScheme\n\t\t{\n\t\t\treturn {\n\t\t\t\tborderColor: Color.transparent,\n\t\t\t\tbackgroundColor: Color.collab60,\n\t\t\t\ticonColor: Color.white,\n\t\t\t\ttextColor: Color.white,\n\t\t\t\thoverColor: Color.collab50,\n\t\t\t};\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.fillForm();\n\t\tthis.initDiffManager();\n\t},\n\tmethods:\n\t{\n\t\tinitDiffManager()\n\t\t{\n\t\t\tthis.memberDiffManager = new ChatMemberDiffManager();\n\t\t\tconst managersWithoutOwner = this.dialog.managerList.filter((managerId) => {\n\t\t\t\treturn managerId !== Core.getUserId();\n\t\t\t});\n\t\t\tthis.memberDiffManager.setInitialManagers(managersWithoutOwner);\n\t\t},\n\t\tasync fillForm()\n\t\t{\n\t\t\tthis.chatTitle = this.dialog.name;\n\t\t\tthis.avatarUrl = this.dialog.avatar;\n\t\t\tthis.description = this.dialog.description;\n\t\t},\n\t\tonAvatarChange(newAvatarFile: File)\n\t\t{\n\t\t\tthis.avatarFile = newAvatarFile;\n\t\t\tthis.avatarUrl = '';\n\t\t},\n\t\tonDescriptionChange(description: string)\n\t\t{\n\t\t\tthis.description = description;\n\t\t},\n\t\tonRightsChange(rights: AccessRightsFormResult)\n\t\t{\n\t\t\tconst { ownerId, moderators, permissions, options } = rights;\n\t\t\tthis.groupSettings.ownerId = ownerId;\n\t\t\tthis.groupSettings.moderatorMembers = moderators;\n\t\t\tthis.groupSettings.permissions = permissions;\n\t\t\tthis.groupSettings.options = options;\n\n\t\t\tthis.groupSettings.isModified = true;\n\t\t},\n\t\tasync onUpdateClick(): Promise\n\t\t{\n\t\t\tAnalytics.getInstance().chatEdit.onSubmitForm(this.dialogId);\n\t\t\tAnalytics.getInstance().ignoreNextChatOpen(this.dialogId);\n\n\t\t\tthis.isUpdating = true;\n\n\t\t\tlet payload = {\n\t\t\t\ttitle: this.chatTitle,\n\t\t\t\tavatar: this.avatarFile,\n\t\t\t\tdescription: this.description,\n\t\t\t};\n\n\t\t\tif (this.groupSettings.isModified)\n\t\t\t{\n\t\t\t\tconst groupSettings = {\n\t\t\t\t\townerId: this.groupSettings.ownerId,\n\t\t\t\t\toptions: this.groupSettings.options,\n\t\t\t\t\tpermissions: this.groupSettings.permissions,\n\t\t\t\t\taddModeratorMembers: this.memberDiffManager.getAddedManagers(this.groupSettings.moderatorMembers),\n\t\t\t\t\tdeleteModeratorMembers: this.memberDiffManager.getDeletedManagers(this.groupSettings.moderatorMembers),\n\t\t\t\t};\n\n\t\t\t\tpayload = {\n\t\t\t\t\t...payload,\n\t\t\t\t\tgroupSettings,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tawait this.getChatService().updateCollab(this.dialogId, payload);\n\t\t\t\tthis.isUpdating = false;\n\t\t\t\tvoid Messenger.openChat(this.dialogId);\n\t\t\t}\n\t\t\tcatch\n\t\t\t{\n\t\t\t\tthis.isUpdating = false;\n\t\t\t}\n\t\t},\n\t\tonCancelClick()\n\t\t{\n\t\t\tAnalytics.getInstance().ignoreNextChatOpen(this.dialogId);\n\t\t\tvoid Messenger.openChat(this.dialogId);\n\t\t},\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\tloc(phraseCode: string, replacements: {[string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-chat-forms__content --collab\">\n\t\t\t<div class=\"bx-im-content-chat-forms__header\">\n\t\t\t\t<ChatAvatar\n\t\t\t\t\t:avatarFile=\"avatarFile\"\n\t\t\t\t\t:existingAvatarUrl=\"avatarUrl\"\n\t\t\t\t\t:chatTitle=\"chatTitle\"\n\t\t\t\t\t:type=\"EmptyAvatarType.collab\"\n\t\t\t\t\t@avatarChange=\"onAvatarChange\"\n\t\t\t\t/>\n\t\t\t\t<TitleInput v-model=\"chatTitle\" :placeholder=\"loc('IM_CREATE_COLLAB_TITLE_PLACEHOLDER')\" />\n\t\t\t</div>\n\t\t\t<CreateChatHeading :text=\"loc('IM_CREATE_COLLAB_DESCRIPTION_TITLE')\" />\n\t\t\t<div class=\"bx-im-content-chat-forms__description_container\">\n\t\t\t\t<TextareaInput\n\t\t\t\t\t:value=\"description\"\n\t\t\t\t\t:placeholder=\"loc('IM_CREATE_COLLAB_DESCRIPTION_PLACEHOLDER')\"\n\t\t\t\t\t:border=\"false\"\n\t\t\t\t\t@input=\"onDescriptionChange\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<RightsSection :collabId=\"collabId\" @change=\"onRightsChange\" />\n\t\t</div>\n\t\t<ButtonPanel\n\t\t\t:isCreating=\"isUpdating\"\n\t\t\t:createButtonTitle=\"loc('IM_UPDATE_CONFIRM')\"\n\t\t\t:createButtonColorScheme=\"updateButtonColorScheme\"\n\t\t\t@create=\"onUpdateClick\"\n\t\t\t@cancel=\"onCancelClick\"\n\t\t/>\n\t`,\n};\n","import { ChatType } from 'im.v2.const';\n\nimport { GroupChatUpdating } from './components/update/group-chat';\nimport { ChannelUpdating } from './components/update/channel';\nimport { CollabUpdating } from './components/update/collab';\n\nimport './css/chat-forms-content.css';\n\n// @vue/component\nexport const UpdateChatContent = {\n\tname: 'UpdateChatContent',\n\tcomponents: { GroupChatUpdating, ChannelUpdating, CollabUpdating },\n\tprops:\n\t{\n\t\tentityId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tChatType: () => ChatType,\n\t\tchatType(): $Values<typeof ChatType>\n\t\t{\n\t\t\tconst chat = this.$store.getters['chats/get'](this.entityId, true);\n\n\t\t\treturn chat.type;\n\t\t},\n\t\tisChannel(): boolean\n\t\t{\n\t\t\tconst editableChannelTypes = new Set([ChatType.channel, ChatType.openChannel]);\n\n\t\t\treturn editableChannelTypes.has(this.chatType);\n\t\t},\n\t\tisChat(): boolean\n\t\t{\n\t\t\tconst editableChatTypes = new Set([ChatType.chat, ChatType.open, ChatType.videoconf]);\n\n\t\t\treturn editableChatTypes.has(this.chatType);\n\t\t},\n\t\tisCollab(): boolean\n\t\t{\n\t\t\treturn this.chatType === ChatType.collab;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-chat-forms__container\">\n\t\t\t<GroupChatUpdating v-if=\"isChat\" :dialogId=\"this.entityId\" />\n\t\t\t<ChannelUpdating v-else-if=\"isChannel\" :dialogId=\"this.entityId\" />\n\t\t\t<CollabUpdating v-else-if=\"isCollab\" :dialogId=\"this.entityId\" />\n\t\t</div>\n\t`,\n};\n"],"names":["GroupChatCreation","name","components","TitleInput","ChatAvatar","ChatMembersSelector","SettingsSection","RightsSection","AppearanceSection","ButtonPanel","CreateChatHeading","data","isCreating","avatarFile","chatTitle","chatMembers","undeselectedItems","settings","isAvailableInSearch","description","autoDeleteDelay","rights","ownerId","managerIds","manageUsersAdd","manageUsersDelete","manageUi","manageMessages","watch","newValue","CreateChatManager","getInstance","setChatTitle","created","EventEmitter","subscribe","EventType","layout","onLayoutChange","initDefaultRolesForRights","getUndeselectedItems","getOwnerId","getChatMembers","restoreFields","setChatType","ChatType","chat","setCreationStatus","setChatAvatar","beforeUnmount","clearExternalFields","exitByCancel","exitByChatTypeSwitch","exitByCreation","saveFields","methods","onMembersChange","currentTags","onOwnerChange","onManagersChange","onChatTypeChange","onAutoDeleteChange","delay","onDescriptionChange","onManageUsersAddChange","onManageUsersDeleteChange","onManageUiChange","onManageMessagesChange","onCreateClick","newDialogId","getChatService","createChat","title","avatar","memberEntities","managers","catch","Messenger","openChat","onCancelClick","onAvatarChange","newAvatarFile","onScroll","MenuManager","getMenuById","PopupType","createChatManageUsersAddMenu","close","createChatManageUsersDeleteMenu","createChatManageUiMenu","createChatManageMessagesMenu","event","to","getData","Layout","entityId","savedFields","getFields","PermissionManager","getDefaultRolesForActionGroups","chatService","ChatService","loc","phraseCode","$Bitrix","Loc","getMessage","template","ConferenceCreation","ConferenceSection","Core","getUserId","conference","passwordNeeded","password","computed","EmptyAvatarType","videoconf","onPasswordNeededChange","onPasswordChange","newPassword","checkPassword","Notifier","onPasswordError","entityType","conferencePassword","PASSWORD_MIN_LENGTH","trim","length","ChannelCreation","PrivacySection","TextareaInput","channel","unsubscribe","type","setPreselectedMembers","replacements","LINK_CSS_CLASS","TITLE_LINK_MODIFIER","INVITE_LINK_MODIFIER","DescriptionBanner","preparedTitle","preparedInviteText","onTitleClick","Dom","hasClass","target","ARTICLE_CODE","openHelpdeskArticle","onInviteClick","CreateChatExternalSection","props","collabId","Number","default","emits","formResult","onClick","sliderParams","formData","form","AccessRights","openForm","bindEvents","onSave","onCancel","unbindEvents","$emit","CollabCreation","AutoDelete","groupSettings","moderatorMembers","options","permissions","createButtonColorScheme","borderColor","Color","transparent","backgroundColor","collab60","iconColor","white","textColor","hoverColor","collab50","collab","createCollab","emit","header","openAddToChatPopup","onRightsChange","moderators","onAutoDeleteDelayChange","CreatableChat","CreationComponentByChatType","CreateChatContent","String","required","chatType","creationComponent","ChatMemberDiffManager","setInitialManagers","initialManagers","setInitialChatMembers","initialMembers","getAddedMemberEntities","modifiedEntities","originalSet","Set","map","elem","JSON","stringify","filter","has","getDeletedMemberEntities","modifiedSet","getAddedManagers","modifiedArray","getDeletedManagers","ENTITY_ID","AVATAR_URL","getCollapsedUsersElement","onclick","textNode","id","text","deselectable","tagOptions","GroupChatUpdating","dialogId","isLoading","isUpdating","areUsersCollapsed","collapsedUsersCount","avatarUrl","dialog","$store","getters","chatId","collapsedUsers","element","onCollapsedUsersClick","canChangeSearchAvailability","open","includes","changedChatType","fillForm","memberDiffManager","getMemberEntities","managerList","userCount","onUpdateClick","Analytics","chatEdit","onSubmitForm","ignoreNextChatOpen","updateChat","addedMemberEntities","deletedMemberEntities","addedManagers","deletedManagers","confirmResult","showExitUpdateChatConfirm","sidebar","panel","SidebarDetailBlock","members","ChannelUpdating","openChannel","CollabUpdating","isModified","updateButtonColorScheme","initDiffManager","managersWithoutOwner","managerId","payload","addModeratorMembers","deleteModeratorMembers","updateCollab","UpdateChatContent","isChannel","editableChannelTypes","isChat","editableChatTypes","isCollab"],"mappings":";;;;;;;;CAuBA;AACA,CAAO,MAAMA,iBAAiB,GAAG;GAChCC,IAAI,EAAE,mBAAmB;GACzBC,UAAU,EAAE;iBACXC,qDAAU;iBACVC,qDAAU;0BACVC,8DAAmB;sBACnBC,0DAAe;oBACfC,wDAAa;wBACbC,4DAAiB;kBACjBC,sDAAW;wBACXC;IACA;GACDC,IAAI,GACJ;KACC,OAAO;OACNC,UAAU,EAAE,KAAK;OACjBC,UAAU,EAAE,IAAI;OAChBC,SAAS,EAAE,EAAE;OACbC,WAAW,EAAE,EAAE;OACfC,iBAAiB,EAAE,EAAE;OACrBC,QAAQ,EAAE;SACTC,mBAAmB,EAAE,KAAK;SAC1BC,WAAW,EAAE,EAAE;SACfC,eAAe,EAAE;QACjB;OACDC,MAAM,EAAE;SACPC,OAAO,EAAE,CAAC;SACVC,UAAU,EAAE,EAAE;SACdC,cAAc,EAAE,EAAE;SAClBC,iBAAiB,EAAE,EAAE;SACrBC,QAAQ,EAAE,EAAE;SACZC,cAAc,EAAE;;MAEjB;IACD;GACDC,KAAK,EACL;KACCd,SAAS,CAACe,QAAQ,EAClB;OACCC,sCAAiB,CAACC,WAAW,EAAE,CAACC,YAAY,CAACH,QAAQ,CAAC;;IAEvD;GACDI,OAAO,GACP;KACCC,6BAAY,CAACC,SAAS,CAACC,qBAAS,CAACC,MAAM,CAACC,cAAc,EAAE,IAAI,CAACA,cAAc,CAAC;KAE5E,IAAI,CAACC,yBAAyB,EAAE;KAEhC,IAAI,CAACvB,iBAAiB,GAAGc,sCAAiB,CAACC,WAAW,EAAE,CAACS,oBAAoB,EAAE;KAC/E,IAAI,CAACnB,MAAM,CAACC,OAAO,GAAGQ,sCAAiB,CAACC,WAAW,EAAE,CAACU,UAAU,EAAE;KAClE,IAAI,CAAC1B,WAAW,GAAGe,sCAAiB,CAACC,WAAW,EAAE,CAACW,cAAc,EAAE;KAEnE,IAAI,CAACC,aAAa,EAAE;KACpBb,sCAAiB,CAACC,WAAW,EAAE,CAACa,WAAW,CAACC,oBAAQ,CAACC,IAAI,CAAC;KAC1DhB,sCAAiB,CAACC,WAAW,EAAE,CAACgB,iBAAiB,CAAC,IAAI,CAAC;KACvDjB,sCAAiB,CAACC,WAAW,EAAE,CAACiB,aAAa,CAAC,IAAI,CAACnC,UAAU,CAAC;IAC9D;GACDoC,aAAa,GACb;KACCnB,sCAAiB,CAACC,WAAW,EAAE,CAACmB,mBAAmB,EAAE;KACrD,IAAI,IAAI,CAACC,YAAY,IAAI,IAAI,CAACC,oBAAoB,IAAI,IAAI,CAACC,cAAc,EACzE;OACC;;KAED,IAAI,CAACC,UAAU,EAAE;IACjB;GACDC,OAAO,EACP;KACCC,eAAe,CAACC,WAAwC,EACxD;OACC,IAAI,CAAC1C,WAAW,GAAG0C,WAAW;MAC9B;KACDC,aAAa,CAACpC,OAAe,EAC7B;OACC,IAAI,CAACD,MAAM,CAACC,OAAO,GAAGA,OAAO;MAC7B;KACDqC,gBAAgB,CAACpC,UAAoB,EACrC;OACC,IAAI,CAACF,MAAM,CAACE,UAAU,GAAGA,UAAU;MACnC;KACDqC,gBAAgB,CAAC1C,mBAA4B,EAC7C;OACC,IAAI,CAACD,QAAQ,CAACC,mBAAmB,GAAGA,mBAAmB;MACvD;KACD2C,kBAAkB,CAACC,KAAa,EAChC;OACC,IAAI,CAAC7C,QAAQ,CAACG,eAAe,GAAG0C,KAAK;MACrC;KACDC,mBAAmB,CAAC5C,WAAmB,EACvC;OACC,IAAI,CAACF,QAAQ,CAACE,WAAW,GAAGA,WAAW;MACvC;KACD6C,sBAAsB,CAACnC,QAAsB,EAC7C;OACC,IAAI,CAACR,MAAM,CAACG,cAAc,GAAGK,QAAQ;MACrC;KACDoC,yBAAyB,CAACpC,QAAsB,EAChD;OACC,IAAI,CAACR,MAAM,CAACI,iBAAiB,GAAGI,QAAQ;MACxC;KACDqC,gBAAgB,CAACrC,QAAsB,EACvC;OACC,IAAI,CAACR,MAAM,CAACK,QAAQ,GAAGG,QAAQ;MAC/B;KACDsC,sBAAsB,CAACtC,QAAsB,EAC7C;OACC,IAAI,CAACR,MAAM,CAACM,cAAc,GAAGE,QAAQ;MACrC;KACD,MAAMuC,aAAa,GACnB;OACC,IAAI,CAACxD,UAAU,GAAG,IAAI;OAEtB,MAAM;SAAEyD;QAAa,GAAG,MAAM,IAAI,CAACC,cAAc,EAAE,CAACC,UAAU,CAAC;SAC9DC,KAAK,EAAE,IAAI,CAAC1D,SAAS;SACrB2D,MAAM,EAAE,IAAI,CAAC5D,UAAU;SACvB6D,cAAc,EAAE,IAAI,CAAC3D,WAAW;SAChCO,OAAO,EAAE,IAAI,CAACD,MAAM,CAACC,OAAO;SAC5BqD,QAAQ,EAAE,IAAI,CAACtD,MAAM,CAACE,UAAU;SAChCL,mBAAmB,EAAE,IAAI,CAACD,QAAQ,CAACC,mBAAmB;SACtDC,WAAW,EAAE,IAAI,CAACF,QAAQ,CAACE,WAAW;SACtCK,cAAc,EAAE,IAAI,CAACH,MAAM,CAACG,cAAc;SAC1CC,iBAAiB,EAAE,IAAI,CAACJ,MAAM,CAACI,iBAAiB;SAChDC,QAAQ,EAAE,IAAI,CAACL,MAAM,CAACK,QAAQ;SAC9BC,cAAc,EAAE,IAAI,CAACN,MAAM,CAACM,cAAc;SAC1CP,eAAe,EAAE,IAAI,CAACH,QAAQ,CAACG;QAC/B,CAAC,CAACwD,KAAK,CAAC,MAAM;SACd,IAAI,CAAChE,UAAU,GAAG,KAAK;QACvB,CAAC;OAEF,IAAI,CAACA,UAAU,GAAG,KAAK;OACvB,IAAI,CAACyC,cAAc,GAAG,IAAI;OAC1BvB,sCAAiB,CAACC,WAAW,EAAE,CAACgB,iBAAiB,CAAC,KAAK,CAAC;OACxD,KAAK8B,mBAAS,CAACC,QAAQ,CAACT,WAAW,CAAC;MACpC;KACDU,aAAa,GACb;OACC,IAAI,CAAC5B,YAAY,GAAG,IAAI;OACxBrB,sCAAiB,CAACC,WAAW,EAAE,CAACgB,iBAAiB,CAAC,KAAK,CAAC;OACxD8B,mBAAS,CAACC,QAAQ,EAAE;MACpB;KACDE,cAAc,CAACC,aAAmB,EAClC;OACC,IAAI,CAACpE,UAAU,GAAGoE,aAAa;OAC/BnD,sCAAiB,CAACC,WAAW,EAAE,CAACiB,aAAa,CAAC,IAAI,CAACnC,UAAU,CAAC;MAC9D;KACDqE,QAAQ,GACR;OAAA;OACC,yBAAAC,sBAAW,CAACC,WAAW,CAACC,qBAAS,CAACC,4BAA4B,CAAC,qBAA/D,sBAAiEC,KAAK,EAAE;OACxE,0BAAAJ,sBAAW,CAACC,WAAW,CAACC,qBAAS,CAACG,+BAA+B,CAAC,qBAAlE,uBAAoED,KAAK,EAAE;OAC3E,0BAAAJ,sBAAW,CAACC,WAAW,CAACC,qBAAS,CAACI,sBAAsB,CAAC,qBAAzD,uBAA2DF,KAAK,EAAE;OAClE,0BAAAJ,sBAAW,CAACC,WAAW,CAACC,qBAAS,CAACK,4BAA4B,CAAC,qBAA/D,uBAAiEH,KAAK,EAAE;MACxE;KACDjD,cAAc,CAACqD,KAAqC,EACpD;OACC,MAAM;SAAEC;QAAI,GAAGD,KAAK,CAACE,OAAO,EAAE;OAC9B,IAAID,EAAE,CAAC3F,IAAI,KAAK6F,kBAAM,CAACvB,UAAU,CAACtE,IAAI,IAAI2F,EAAE,CAACG,QAAQ,KAAKlD,oBAAQ,CAACC,IAAI,EACvE;SACC,IAAI,CAACM,oBAAoB,GAAG,IAAI;;MAEjC;KACDE,UAAU,GACV;OACCxB,sCAAiB,CAACC,WAAW,EAAE,CAACuB,UAAU,CAAC;SAC1CxC,SAAS,EAAE,IAAI,CAACA,SAAS;SACzBD,UAAU,EAAE,IAAI,CAACA,UAAU;SAC3BE,WAAW,EAAE,IAAI,CAACA,WAAW;SAC7BE,QAAQ,EAAE,IAAI,CAACA,QAAQ;SACvBI,MAAM,EAAE,IAAI,CAACA;QACb,CAAC;MACF;KACDsB,aAAa,GACb;OACC,MAAMqD,WAAW,GAAGlE,sCAAiB,CAACC,WAAW,EAAE,CAACkE,SAAS,EAAE;OAC/D,IAAI,CAACD,WAAW,EAChB;SACC;;OAGD,MAAM;SAAElF,SAAS;SAAED,UAAU;SAAEE,WAAW;SAAEE,QAAQ;SAAEI;QAAQ,GAAG2E,WAAW;OAC5E,IAAI,CAAClF,SAAS,GAAGA,SAAS;OAC1B,IAAI,CAACD,UAAU,GAAGA,UAAU;OAC5B,IAAI,CAACE,WAAW,GAAGA,WAAW;OAC9B,IAAI,CAACE,QAAQ,GAAGA,QAAQ;OACxB,IAAI,CAACI,MAAM,GAAGA,MAAM;MACpB;KACDkB,yBAAyB,GACzB;OACC,MAAM;SACLf,cAAc;SACdC,iBAAiB;SACjBC,QAAQ;SACRC;QACA,GAAGuE,sCAAiB,CAACnE,WAAW,EAAE,CAACoE,8BAA8B,EAAE;OAEpE,IAAI,CAAC9E,MAAM,CAACG,cAAc,GAAGA,cAAc;OAC3C,IAAI,CAACH,MAAM,CAACI,iBAAiB,GAAGA,iBAAiB;OACjD,IAAI,CAACJ,MAAM,CAACK,QAAQ,GAAGA,QAAQ;OAC/B,IAAI,CAACL,MAAM,CAACM,cAAc,GAAGA,cAAc;MAC3C;KACD2C,cAAc,GACd;OACC,IAAI,CAAC,IAAI,CAAC8B,WAAW,EACrB;SACC,IAAI,CAACA,WAAW,GAAG,IAAIC,uCAAW,EAAE;;OAGrC,OAAO,IAAI,CAACD,WAAW;MACvB;KACDE,GAAG,CAACC,UAAkB,EACtB;OACC,OAAO,IAAI,CAACC,OAAO,CAACC,GAAG,CAACC,UAAU,CAACH,UAAU,CAAC;;IAE/C;GACDI,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CA6CZ,CAAC;;CC9PD;AACA,CAAO,MAAMC,kBAAkB,GAAG;GACjC3G,IAAI,EAAE,oBAAoB;GAC1BC,UAAU,EAAE;iBACXC,qDAAU;iBACVC,qDAAU;0BACVC,8DAAmB;sBACnBC,0DAAe;oBACfC,wDAAa;wBACbC,4DAAiB;wBACjBqG,4DAAiB;kBACjBpG,sDAAW;wBACXC;IACA;GACDC,IAAI,GACJ;KACC,OAAO;OACNC,UAAU,EAAE,KAAK;OACjBC,UAAU,EAAE,IAAI;OAChBC,SAAS,EAAE,EAAE;OACbC,WAAW,EAAE,CAAC,CAAC,MAAM,EAAE+F,2BAAI,CAACC,SAAS,EAAE,CAAC,CAAC;OACzCC,UAAU,EAAE;SACXC,cAAc,EAAE,KAAK;SACrBC,QAAQ,EAAE;QACV;OACDjG,QAAQ,EAAE;SACTE,WAAW,EAAE;QACb;OACDE,MAAM,EAAE;SACPC,OAAO,EAAE,CAAC;SACVC,UAAU,EAAE,EAAE;SACdC,cAAc,EAAE,EAAE;SAClBC,iBAAiB,EAAE,EAAE;SACrBC,QAAQ,EAAE,EAAE;SACZC,cAAc,EAAE;;MAEjB;IACD;GACDwF,QAAQ,EACR;KACCC,eAAe,EAAE,MAAMA;IACvB;GACDxF,KAAK,EACL;KACCd,SAAS,CAACe,QAAQ,EAClB;OACCC,sCAAiB,CAACC,WAAW,EAAE,CAACC,YAAY,CAACH,QAAQ,CAAC;;IAEvD;GACDI,OAAO,GACP;KACCC,6BAAY,CAACC,SAAS,CAACC,qBAAS,CAACC,MAAM,CAACC,cAAc,EAAE,IAAI,CAACA,cAAc,CAAC;KAE5E,IAAI,CAACjB,MAAM,CAACC,OAAO,GAAGwF,2BAAI,CAACC,SAAS,EAAE;KACtC,IAAI,CAACxE,yBAAyB,EAAE;KAEhC,IAAI,CAACI,aAAa,EAAE;KACpBb,sCAAiB,CAACC,WAAW,EAAE,CAACa,WAAW,CAACC,oBAAQ,CAACwE,SAAS,CAAC;KAC/DvF,sCAAiB,CAACC,WAAW,EAAE,CAACgB,iBAAiB,CAAC,IAAI,CAAC;KACvDjB,sCAAiB,CAACC,WAAW,EAAE,CAACiB,aAAa,CAAC,IAAI,CAACnC,UAAU,CAAC;IAC9D;GACDoC,aAAa,GACb;KACC,IAAI,IAAI,CAACE,YAAY,IAAI,IAAI,CAACC,oBAAoB,EAClD;OACC;;KAED,IAAI,CAACE,UAAU,EAAE;IACjB;GACDC,OAAO,EACP;KACCC,eAAe,CAACC,WAAwC,EACxD;OACC,IAAI,CAAC1C,WAAW,GAAG0C,WAAW;MAC9B;KACDC,aAAa,CAACpC,OAAe,EAC7B;OACC,IAAI,CAACD,MAAM,CAACC,OAAO,GAAGA,OAAO;MAC7B;KACDqC,gBAAgB,CAACpC,UAAoB,EACrC;OACC,IAAI,CAACF,MAAM,CAACE,UAAU,GAAGA,UAAU;MACnC;KACDwC,mBAAmB,CAAC5C,WAAmB,EACvC;OACC,IAAI,CAACF,QAAQ,CAACE,WAAW,GAAGA,WAAW;MACvC;KACD6C,sBAAsB,CAACnC,QAAsB,EAC7C;OACC,IAAI,CAACR,MAAM,CAACG,cAAc,GAAGK,QAAQ;MACrC;KACDoC,yBAAyB,CAACpC,QAAsB,EAChD;OACC,IAAI,CAACR,MAAM,CAACI,iBAAiB,GAAGI,QAAQ;MACxC;KACDqC,gBAAgB,CAACrC,QAAsB,EACvC;OACC,IAAI,CAACR,MAAM,CAACK,QAAQ,GAAGG,QAAQ;MAC/B;KACDsC,sBAAsB,CAACtC,QAAsB,EAC7C;OACC,IAAI,CAACR,MAAM,CAACM,cAAc,GAAGE,QAAQ;MACrC;KACDmD,cAAc,CAACC,aAAmB,EAClC;OACC,IAAI,CAACpE,UAAU,GAAGoE,aAAa;OAC/BnD,sCAAiB,CAACC,WAAW,EAAE,CAACiB,aAAa,CAAC,IAAI,CAACnC,UAAU,CAAC;MAC9D;KACDyG,sBAAsB,CAACL,cAAuB,EAC9C;OACC,IAAI,CAACD,UAAU,CAACC,cAAc,GAAGA,cAAc;MAC/C;KACDM,gBAAgB,CAACC,WAAmB,EACpC;OACC,IAAI,CAACR,UAAU,CAACE,QAAQ,GAAGM,WAAW;MACtC;KACD,MAAMpD,aAAa,GACnB;OACC,IAAI,CAAC,IAAI,CAACqD,aAAa,EAAE,EACzB;SACCC,2BAAQ,CAACV,UAAU,CAACW,eAAe,EAAE;SAErC;;OAGD,IAAI,CAAC/G,UAAU,GAAG,IAAI;OAEtB,MAAM;SAAEyD;QAAa,GAAG,MAAM,IAAI,CAACC,cAAc,EAAE,CAACC,UAAU,CAAC;SAC9DqD,UAAU,EAAE/E,oBAAQ,CAACwE,SAAS;SAC9B7C,KAAK,EAAE,IAAI,CAAC1D,SAAS;SACrB2D,MAAM,EAAE,IAAI,CAAC5D,UAAU;SACvB6D,cAAc,EAAE,IAAI,CAAC3D,WAAW;SAChCO,OAAO,EAAE,IAAI,CAACD,MAAM,CAACC,OAAO;SAC5BqD,QAAQ,EAAE,IAAI,CAACtD,MAAM,CAACE,UAAU;SAChCJ,WAAW,EAAE,IAAI,CAACF,QAAQ,CAACE,WAAW;SACtCK,cAAc,EAAE,IAAI,CAACH,MAAM,CAACG,cAAc;SAC1CC,iBAAiB,EAAE,IAAI,CAACJ,MAAM,CAACI,iBAAiB;SAChDC,QAAQ,EAAE,IAAI,CAACL,MAAM,CAACK,QAAQ;SAC9BC,cAAc,EAAE,IAAI,CAACN,MAAM,CAACM,cAAc;SAC1CkG,kBAAkB,EAAE,IAAI,CAACb,UAAU,CAACC,cAAc,GAAG,IAAI,CAACD,UAAU,CAACE,QAAQ,GAAG;QAChF,CAAC,CAACtC,KAAK,CAAC,MAAM;SACd,IAAI,CAAChE,UAAU,GAAG,KAAK;QACvB,CAAC;OAEF,IAAI,CAACA,UAAU,GAAG,KAAK;OACvBkB,sCAAiB,CAACC,WAAW,EAAE,CAACgB,iBAAiB,CAAC,KAAK,CAAC;OACxD,KAAK8B,mBAAS,CAACC,QAAQ,CAACT,WAAW,CAAC;MACpC;KACDU,aAAa,GACb;OACC,IAAI,CAAC5B,YAAY,GAAG,IAAI;OACxBrB,sCAAiB,CAACC,WAAW,EAAE,CAACgB,iBAAiB,CAAC,KAAK,CAAC;OACxD8B,mBAAS,CAACC,QAAQ,EAAE;MACpB;KACDI,QAAQ,GACR;OAAA;OACC,yBAAAC,sBAAW,CAACC,WAAW,CAACC,qBAAS,CAACC,4BAA4B,CAAC,qBAA/D,sBAAiEC,KAAK,EAAE;OACxE,0BAAAJ,sBAAW,CAACC,WAAW,CAACC,qBAAS,CAACG,+BAA+B,CAAC,qBAAlE,uBAAoED,KAAK,EAAE;OAC3E,0BAAAJ,sBAAW,CAACC,WAAW,CAACC,qBAAS,CAACI,sBAAsB,CAAC,qBAAzD,uBAA2DF,KAAK,EAAE;OAClE,0BAAAJ,sBAAW,CAACC,WAAW,CAACC,qBAAS,CAACK,4BAA4B,CAAC,qBAA/D,uBAAiEH,KAAK,EAAE;MACxE;KACDjD,cAAc,CAACqD,KAAqC,EACpD;OACC,MAAM;SAAEC;QAAI,GAAGD,KAAK,CAACE,OAAO,EAAE;OAC9B,IAAID,EAAE,CAAC3F,IAAI,KAAK6F,kBAAM,CAACvB,UAAU,CAACtE,IAAI,IAAI2F,EAAE,CAACG,QAAQ,KAAKlD,oBAAQ,CAACwE,SAAS,EAC5E;SACC,IAAI,CAACjE,oBAAoB,GAAG,IAAI;;MAEjC;KACDE,UAAU,GACV;OACCxB,sCAAiB,CAACC,WAAW,EAAE,CAACuB,UAAU,CAAC;SAC1CxC,SAAS,EAAE,IAAI,CAACA,SAAS;SACzBD,UAAU,EAAE,IAAI,CAACA,UAAU;SAC3BE,WAAW,EAAE,IAAI,CAACA,WAAW;SAC7BE,QAAQ,EAAE,IAAI,CAACA,QAAQ;SACvBI,MAAM,EAAE,IAAI,CAACA,MAAM;SACnB2F,UAAU,EAAE,IAAI,CAACA;QACjB,CAAC;MACF;KACDrE,aAAa,GACb;OACC,MAAMqD,WAAW,GAAGlE,sCAAiB,CAACC,WAAW,EAAE,CAACkE,SAAS,EAAE;OAC/D,IAAI,CAACD,WAAW,EAChB;SACC;;OAGD,MAAM;SAAElF,SAAS;SAAED,UAAU;SAAEE,WAAW;SAAEiG,UAAU;SAAE/F,QAAQ;SAAEI;QAAQ,GAAG2E,WAAW;OACxF,IAAI,CAAClF,SAAS,GAAGA,SAAS;OAC1B,IAAI,CAACD,UAAU,GAAGA,UAAU;OAC5B,IAAI,CAACE,WAAW,GAAGA,WAAW;OAC9B,IAAI,CAACiG,UAAU,GAAGA,UAAU;OAC5B,IAAI,CAAC/F,QAAQ,GAAGA,QAAQ;OACxB,IAAI,CAACI,MAAM,GAAGA,MAAM;MACpB;KACDkB,yBAAyB,GACzB;OACC,MAAM;SACLf,cAAc;SACdC,iBAAiB;SACjBC,QAAQ;SACRC;QACA,GAAGuE,sCAAiB,CAACnE,WAAW,EAAE,CAACoE,8BAA8B,EAAE;OAEpE,IAAI,CAAC9E,MAAM,CAACG,cAAc,GAAGA,cAAc;OAC3C,IAAI,CAACH,MAAM,CAACI,iBAAiB,GAAGA,iBAAiB;OACjD,IAAI,CAACJ,MAAM,CAACK,QAAQ,GAAGA,QAAQ;OAC/B,IAAI,CAACL,MAAM,CAACM,cAAc,GAAGA,cAAc;MAC3C;KACD8F,aAAa,GACb;OACC,MAAMK,mBAAmB,GAAG,CAAC;OAC7B,IAAI,CAAC,IAAI,CAACd,UAAU,CAACC,cAAc,EACnC;SACC,OAAO,IAAI;;OAEZ,MAAMC,QAAQ,GAAG,IAAI,CAACF,UAAU,CAACE,QAAQ,CAACa,IAAI,EAAE;OAEhD,OAAOb,QAAQ,KAAK,EAAE,IAAIA,QAAQ,CAACc,MAAM,IAAIF,mBAAmB;MAChE;KACDxD,cAAc,GACd;OACC,IAAI,CAAC,IAAI,CAAC8B,WAAW,EACrB;SACC,IAAI,CAACA,WAAW,GAAG,IAAIC,uCAAW,EAAE;;OAGrC,OAAO,IAAI,CAACD,WAAW;MACvB;KACDE,GAAG,CAACC,UAAkB,EACtB;OACC,OAAO,IAAI,CAACC,OAAO,CAACC,GAAG,CAACC,UAAU,CAACH,UAAU,CAAC;;IAE/C;GACDI,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAiDZ,CAAC;;CC/RD;AACA,CAAO,MAAMsB,eAAe,GAAG;GAC9BhI,IAAI,EAAE,iBAAiB;GACvBC,UAAU,EAAE;iBACXC,qDAAU;iBACVC,qDAAU;0BACVC,8DAAmB;oBACnBE,wDAAa;wBACbC,4DAAiB;qBACjB0H,yDAAc;kBACdzH,sDAAW;oBACX0H,wDAAa;wBACbzH;IACA;GACDC,IAAI,GACJ;KACC,OAAO;OACNC,UAAU,EAAE,KAAK;OACjBC,UAAU,EAAE,IAAI;OAChBC,SAAS,EAAE,EAAE;OACbC,WAAW,EAAE,EAAE;OACfC,iBAAiB,EAAE,EAAE;OACrBC,QAAQ,EAAE;SACTC,mBAAmB,EAAE,KAAK;SAC1BC,WAAW,EAAE;QACb;OACDE,MAAM,EAAE;SACPC,OAAO,EAAE,CAAC;SACVC,UAAU,EAAE,EAAE;SACdC,cAAc,EAAE,EAAE;SAClBC,iBAAiB,EAAE,EAAE;SACrBC,QAAQ,EAAE,EAAE;SACZC,cAAc,EAAE;;MAEjB;IACD;GACDwF,QAAQ,EACR;KACCtE,QAAQ,EAAE,MAAMA,oBAAQ;KACxBuE,eAAe,EAAE,MAAMA;IACvB;GACDxF,KAAK,EACL;KACCd,SAAS,CAACe,QAAQ,EAClB;OACCC,sCAAiB,CAACC,WAAW,EAAE,CAACC,YAAY,CAACH,QAAQ,CAAC;;IAEvD;GACDI,OAAO,GACP;KACCC,6BAAY,CAACC,SAAS,CAACC,qBAAS,CAACC,MAAM,CAACC,cAAc,EAAE,IAAI,CAACA,cAAc,CAAC;KAE5E,IAAI,CAACC,yBAAyB,EAAE;KAEhC,IAAI,CAACvB,iBAAiB,GAAGc,sCAAiB,CAACC,WAAW,EAAE,CAACS,oBAAoB,EAAE;KAC/E,IAAI,CAACnB,MAAM,CAACC,OAAO,GAAGQ,sCAAiB,CAACC,WAAW,EAAE,CAACU,UAAU,EAAE;KAClE,IAAI,CAAC1B,WAAW,GAAGe,sCAAiB,CAACC,WAAW,EAAE,CAACW,cAAc,EAAE;KAEnE,IAAI,CAACC,aAAa,EAAE;KACpBb,sCAAiB,CAACC,WAAW,EAAE,CAACa,WAAW,CAACC,oBAAQ,CAACuF,OAAO,CAAC;KAC7DtG,sCAAiB,CAACC,WAAW,EAAE,CAACgB,iBAAiB,CAAC,IAAI,CAAC;KACvDjB,sCAAiB,CAACC,WAAW,EAAE,CAACiB,aAAa,CAAC,IAAI,CAACnC,UAAU,CAAC;IAC9D;GACDoC,aAAa,GACb;KACCnB,sCAAiB,CAACC,WAAW,EAAE,CAACmB,mBAAmB,EAAE;KACrDhB,6BAAY,CAACmG,WAAW,CAACjG,qBAAS,CAACC,MAAM,CAACC,cAAc,EAAE,IAAI,CAACA,cAAc,CAAC;KAE9E,IAAI,IAAI,CAACa,YAAY,IAAI,IAAI,CAACC,oBAAoB,IAAI,IAAI,CAACC,cAAc,EACzE;OACC;;KAED,IAAI,CAACC,UAAU,EAAE;IACjB;GACDC,OAAO,EACP;KACCC,eAAe,CAACC,WAAwC,EACxD;OACC,IAAI,CAAC1C,WAAW,GAAG0C,WAAW;MAC9B;KACDC,aAAa,CAACpC,OAAe,EAC7B;OACC,IAAI,CAACD,MAAM,CAACC,OAAO,GAAGA,OAAO;MAC7B;KACDqC,gBAAgB,CAACpC,UAAoB,EACrC;OACC,IAAI,CAACF,MAAM,CAACE,UAAU,GAAGA,UAAU;MACnC;KACDqC,gBAAgB,CAAC1C,mBAA4B,EAC7C;OACC,IAAI,CAACD,QAAQ,CAACC,mBAAmB,GAAGA,mBAAmB;MACvD;KACD6C,mBAAmB,CAAC5C,WAAmB,EACvC;OACC,IAAI,CAACF,QAAQ,CAACE,WAAW,GAAGA,WAAW;MACvC;KACD6C,sBAAsB,CAACnC,QAAsB,EAC7C;OACC,IAAI,CAACR,MAAM,CAACG,cAAc,GAAGK,QAAQ;MACrC;KACDoC,yBAAyB,CAACpC,QAAsB,EAChD;OACC,IAAI,CAACR,MAAM,CAACI,iBAAiB,GAAGI,QAAQ;MACxC;KACDqC,gBAAgB,CAACrC,QAAsB,EACvC;OACC,IAAI,CAACR,MAAM,CAACK,QAAQ,GAAGG,QAAQ;MAC/B;KACDsC,sBAAsB,CAACtC,QAAsB,EAC7C;OACC,IAAI,CAACR,MAAM,CAACM,cAAc,GAAGE,QAAQ;MACrC;KACD,MAAMuC,aAAa,GACnB;OACC,IAAI,CAACxD,UAAU,GAAG,IAAI;OAEtB,MAAM;SAAEyD;QAAa,GAAG,MAAM,IAAI,CAACC,cAAc,EAAE,CAACC,UAAU,CAAC;SAC9D+D,IAAI,EAAEzF,oBAAQ,CAACuF,OAAO;SACtB5D,KAAK,EAAE,IAAI,CAAC1D,SAAS;SACrB2D,MAAM,EAAE,IAAI,CAAC5D,UAAU;SACvB6D,cAAc,EAAE,IAAI,CAAC3D,WAAW;SAChCO,OAAO,EAAE,IAAI,CAACD,MAAM,CAACC,OAAO;SAC5BqD,QAAQ,EAAE,IAAI,CAACtD,MAAM,CAACE,UAAU;SAChCL,mBAAmB,EAAE,IAAI,CAACD,QAAQ,CAACC,mBAAmB;SACtDC,WAAW,EAAE,IAAI,CAACF,QAAQ,CAACE,WAAW;SACtCK,cAAc,EAAE,IAAI,CAACH,MAAM,CAACG,cAAc;SAC1CC,iBAAiB,EAAE,IAAI,CAACJ,MAAM,CAACI,iBAAiB;SAChDC,QAAQ,EAAE,IAAI,CAACL,MAAM,CAACK,QAAQ;SAC9BC,cAAc,EAAE,IAAI,CAACN,MAAM,CAACM;QAC5B,CAAC,CAACiD,KAAK,CAAC,MAAM;SACd,IAAI,CAAChE,UAAU,GAAG,KAAK;QACvB,CAAC;OAEF,IAAI,CAACA,UAAU,GAAG,KAAK;OACvB,IAAI,CAACyC,cAAc,GAAG,IAAI;OAC1BvB,sCAAiB,CAACC,WAAW,EAAE,CAACgB,iBAAiB,CAAC,KAAK,CAAC;OACxDjB,sCAAiB,CAACC,WAAW,EAAE,CAACwG,qBAAqB,CAAC,EAAE,CAAC;OACzD,KAAK1D,mBAAS,CAACC,QAAQ,CAACT,WAAW,CAAC;MACpC;KACDU,aAAa,GACb;OACC,IAAI,CAAC5B,YAAY,GAAG,IAAI;OACxBrB,sCAAiB,CAACC,WAAW,EAAE,CAACgB,iBAAiB,CAAC,KAAK,CAAC;OACxDjB,sCAAiB,CAACC,WAAW,EAAE,CAACwG,qBAAqB,CAAC,EAAE,CAAC;OACzD1D,mBAAS,CAACC,QAAQ,EAAE;MACpB;KACDE,cAAc,CAACC,aAAmB,EAClC;OACC,IAAI,CAACpE,UAAU,GAAGoE,aAAa;OAC/BnD,sCAAiB,CAACC,WAAW,EAAE,CAACiB,aAAa,CAAC,IAAI,CAACnC,UAAU,CAAC;MAC9D;KACDqE,QAAQ,GACR;OAAA;OACC,yBAAAC,sBAAW,CAACC,WAAW,CAACC,qBAAS,CAACC,4BAA4B,CAAC,qBAA/D,sBAAiEC,KAAK,EAAE;OACxE,0BAAAJ,sBAAW,CAACC,WAAW,CAACC,qBAAS,CAACG,+BAA+B,CAAC,qBAAlE,uBAAoED,KAAK,EAAE;OAC3E,0BAAAJ,sBAAW,CAACC,WAAW,CAACC,qBAAS,CAACI,sBAAsB,CAAC,qBAAzD,uBAA2DF,KAAK,EAAE;OAClE,0BAAAJ,sBAAW,CAACC,WAAW,CAACC,qBAAS,CAACK,4BAA4B,CAAC,qBAA/D,uBAAiEH,KAAK,EAAE;MACxE;KACDjD,cAAc,CAACqD,KAAqC,EACpD;OACC,MAAM;SAAEC;QAAI,GAAGD,KAAK,CAACE,OAAO,EAAE;OAC9B,IAAID,EAAE,CAAC3F,IAAI,KAAK6F,kBAAM,CAACvB,UAAU,CAACtE,IAAI,IAAI2F,EAAE,CAACG,QAAQ,KAAKlD,oBAAQ,CAACuF,OAAO,EAC1E;SACC,IAAI,CAAChF,oBAAoB,GAAG,IAAI;;MAEjC;KACDE,UAAU,GACV;OACCxB,sCAAiB,CAACC,WAAW,EAAE,CAACuB,UAAU,CAAC;SAC1CxC,SAAS,EAAE,IAAI,CAACA,SAAS;SACzBD,UAAU,EAAE,IAAI,CAACA,UAAU;SAC3BE,WAAW,EAAE,IAAI,CAACA,WAAW;SAC7BE,QAAQ,EAAE,IAAI,CAACA,QAAQ;SACvBI,MAAM,EAAE,IAAI,CAACA;QACb,CAAC;MACF;KACDsB,aAAa,GACb;OACC,MAAMqD,WAAW,GAAGlE,sCAAiB,CAACC,WAAW,EAAE,CAACkE,SAAS,EAAE;OAC/D,IAAI,CAACD,WAAW,EAChB;SACC;;OAGD,MAAM;SAAElF,SAAS;SAAED,UAAU;SAAEE,WAAW;SAAEE,QAAQ;SAAEI;QAAQ,GAAG2E,WAAW;OAC5E,IAAI,CAAClF,SAAS,GAAGA,SAAS;OAC1B,IAAI,CAACD,UAAU,GAAGA,UAAU;OAC5B,IAAI,CAACE,WAAW,GAAGA,WAAW;OAC9B,IAAI,CAACE,QAAQ,GAAGA,QAAQ;OACxB,IAAI,CAACI,MAAM,GAAGA,MAAM;MACpB;KACDkB,yBAAyB,GACzB;OACC,MAAM;SACLf,cAAc;SACdC,iBAAiB;SACjBC,QAAQ;SACRC;QACA,GAAGuE,sCAAiB,CAACnE,WAAW,EAAE,CAACoE,8BAA8B,CAACtD,oBAAQ,CAACuF,OAAO,CAAC;OAEpF,IAAI,CAAC/G,MAAM,CAACG,cAAc,GAAGA,cAAc;OAC3C,IAAI,CAACH,MAAM,CAACI,iBAAiB,GAAGA,iBAAiB;OACjD,IAAI,CAACJ,MAAM,CAACK,QAAQ,GAAGA,QAAQ;OAC/B,IAAI,CAACL,MAAM,CAACM,cAAc,GAAGA,cAAc;MAC3C;KACD2C,cAAc,GACd;OACC,IAAI,CAAC,IAAI,CAAC8B,WAAW,EACrB;SACC,IAAI,CAACA,WAAW,GAAG,IAAIC,uCAAW,EAAE;;OAGrC,OAAO,IAAI,CAACD,WAAW;MACvB;KACDE,GAAG,CAACC,UAAkB,EAAEiC,YAAgC,GAAG,EAAE,EAC7D;OACC,OAAO,IAAI,CAAChC,OAAO,CAACC,GAAG,CAACC,UAAU,CAACH,UAAU,EAAEiC,YAAY,CAAC;;IAE7D;GACD7B,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CA2DZ,CAAC;;CCzSD,MAAM8B,cAAc,GAAG,8CAA8C;CACrE,MAAMC,mBAAmB,GAAG,SAAS;CACrC,MAAMC,oBAAoB,GAAG,UAAU;;CAEvC;AACA,CAAO,MAAMC,iBAAiB,GAAG;GAChC3I,IAAI,EAAE,mBAAmB;GACzBkH,QAAQ,EACR;KACC0B,aAAa,GACb;OACC,OAAOpC,aAAG,CAACC,UAAU,CAAC,+BAA+B,EAAE;SACtD,cAAc,EAAG,gBAAe+B,cAAe,IAAGC,mBAAoB,YAAW;SACjF,eAAe,EAAE;QACjB,CAAC;MACF;KACDI,kBAAkB,GAClB;OACC,OAAOrC,aAAG,CAACC,UAAU,CAAC,gCAAgC,EAAE;SACvD,cAAc,EAAG,gBAAe+B,cAAe,IAAGE,oBAAqB,aAAY;SACnF,eAAe,EAAE;QACjB,CAAC;;IAEH;GACDpF,OAAO,EACP;KACCwF,YAAY,CAACpD,KAAmB,EAChC;OACC,IAAI,CAACqD,aAAG,CAACC,QAAQ,CAACtD,KAAK,CAACuD,MAAM,EAAER,mBAAmB,CAAC,EACpD;SACC;;OAGD,MAAMS,YAAY,GAAG,UAAU;OAC/BC,sCAAmB,CAACD,YAAY,CAAC;MACjC;KACDE,aAAa,CAAC1D,KAAmB,EACjC;OACC,IAAI,CAACqD,aAAG,CAACC,QAAQ,CAACtD,KAAK,CAACuD,MAAM,EAAEP,oBAAoB,CAAC,EACrD;SACC;;OAGD,MAAMQ,YAAY,GAAG,UAAU;OAC/BC,sCAAmB,CAACD,YAAY,CAAC;MACjC;KACD7C,GAAG,CAACC,UAAkB,EACtB;OACC,OAAO,IAAI,CAACC,OAAO,CAACC,GAAG,CAACC,UAAU,CAACH,UAAU,CAAC;;IAE/C;GACDI,QAAQ,EAAG;;;;;;;;;;;;CAYZ,CAAC;;CCvDD;AACA,CAAO,MAAMpG,aAAa,GAAG;GAC5BN,IAAI,EAAE,eAAe;GACrBC,UAAU,EAAE;gCAAEoJ;IAA2B;GACzCC,KAAK,EACL;KACCC,QAAQ,EAAE;OACTlB,IAAI,EAAEmB,MAAM;OACZC,OAAO,EAAE;;IAEV;GACDC,KAAK,EAAE,CAAC,QAAQ,CAAC;GACjBhJ,IAAI,GACJ;KACC,OAAO;OACNiJ,UAAU,EAAE;MACZ;IACD;GACDrG,OAAO,EACP;KACC,MAAMsG,OAAO,GACb;OACC,MAAMC,YAAY,GAAG,EAAE;OACvB,IAAI,IAAI,CAACN,QAAQ,GAAG,CAAC,EACrB;SACCM,YAAY,CAACN,QAAQ,GAAG,IAAI,CAACA,QAAQ;;OAGtC,IAAI,IAAI,CAACI,UAAU,EACnB;SACCE,YAAY,CAACC,QAAQ,GAAG,IAAI,CAACH,UAAU;;OAExC,IAAI,CAACI,IAAI,GAAG,MAAMC,8CAAY,CAACC,QAAQ,CAACJ,YAAY,CAAC;OACrD,IAAI,CAACK,UAAU,EAAE;MACjB;KACDA,UAAU,GACV;OACCjI,6BAAY,CAACC,SAAS,CAAC,IAAI,CAAC6H,IAAI,EAAE,MAAM,EAAE,IAAI,CAACI,MAAM,CAAC;OACtDlI,6BAAY,CAACC,SAAS,CAAC,IAAI,CAAC6H,IAAI,EAAE,QAAQ,EAAE,IAAI,CAACK,QAAQ,CAAC;MAC1D;KACDC,YAAY,GACZ;OACCpI,6BAAY,CAACmG,WAAW,CAAC,IAAI,CAAC2B,IAAI,EAAE,MAAM,EAAE,IAAI,CAACI,MAAM,CAAC;OACxDlI,6BAAY,CAACmG,WAAW,CAAC,IAAI,CAAC2B,IAAI,EAAE,QAAQ,EAAE,IAAI,CAACK,QAAQ,CAAC;MAC5D;KACDD,MAAM,CAACzE,KAAwC,EAC/C;OACC,IAAI,CAACiE,UAAU,GAAGjE,KAAK,CAACE,OAAO,EAAE;OACjC,IAAI,CAAC0E,KAAK,CAAC,QAAQ,EAAE,IAAI,CAACX,UAAU,CAAC;OACrC,IAAI,CAACU,YAAY,EAAE;MACnB;KACDD,QAAQ,GACR;OACC,IAAI,CAACC,YAAY,EAAE;MACnB;KACDhE,GAAG,CAACC,UAAkB,EACtB;OACC,OAAO,IAAI,CAACC,OAAO,CAACC,GAAG,CAACC,UAAU,CAACH,UAAU,CAAC;;IAE/C;GACDI,QAAQ,EAAG;;;;;;;CAOZ,CAAC;;CC/DM,MAAM6D,cAAc,GAAG;GAC7BvK,IAAI,EAAE,gBAAgB;GACtBC,UAAU,EAAE;iBACXC,qDAAU;iBACVC,qDAAU;KACVwI,iBAAiB;wBACjBlI,4DAAiB;oBACjByH,wDAAa;kBACb1H,sDAAW;KACXF,aAAa;iBACbkK;IACA;GACD9J,IAAI,GACJ;KACC,OAAO;OACNC,UAAU,EAAE,KAAK;OACjBC,UAAU,EAAE,IAAI;OAChBC,SAAS,EAAE,EAAE;OACbK,WAAW,EAAE,EAAE;OACfuJ,aAAa,EAAE;SACdpJ,OAAO,EAAEwF,2BAAI,CAACC,SAAS,EAAE;SACzB4D,gBAAgB,EAAE,EAAE;SACpBC,OAAO,EAAE,EAAE;SACXC,WAAW,EAAE;QACb;OACDzJ,eAAe,EAAE;MACjB;IACD;GACDQ,KAAK,EACL;KACCd,SAAS,CAACe,QAAgB,EAC1B;OACCC,sCAAiB,CAACC,WAAW,EAAE,CAACC,YAAY,CAACH,QAAQ,CAAC;;IAEvD;GACDsF,QAAQ,EACR;KACCC,eAAe,EAAE,MAAMA,+CAAe;KACtC0D,uBAAuB,GACvB;OACC,OAAO;SACNC,WAAW,EAAEC,iBAAK,CAACC,WAAW;SAC9BC,eAAe,EAAEF,iBAAK,CAACG,QAAQ;SAC/BC,SAAS,EAAEJ,iBAAK,CAACK,KAAK;SACtBC,SAAS,EAAEN,iBAAK,CAACK,KAAK;SACtBE,UAAU,EAAEP,iBAAK,CAACQ;QAClB;;IAEF;GACDvJ,OAAO,GACP;KACCC,6BAAY,CAACC,SAAS,CAACC,qBAAS,CAACC,MAAM,CAACC,cAAc,EAAE,IAAI,CAACA,cAAc,CAAC;KAE5E,IAAI,CAACK,aAAa,EAAE;KACpBb,sCAAiB,CAACC,WAAW,EAAE,CAACa,WAAW,CAACC,oBAAQ,CAAC4I,MAAM,CAAC;KAC5D3J,sCAAiB,CAACC,WAAW,EAAE,CAACgB,iBAAiB,CAAC,IAAI,CAAC;KACvDjB,sCAAiB,CAACC,WAAW,EAAE,CAACiB,aAAa,CAAC,IAAI,CAACnC,UAAU,CAAC;IAC9D;GACDoC,aAAa,GACb;KACCf,6BAAY,CAACmG,WAAW,CAACjG,qBAAS,CAACC,MAAM,CAACC,cAAc,EAAE,IAAI,CAACA,cAAc,CAAC;KAE9E,IAAI,IAAI,CAACa,YAAY,IAAI,IAAI,CAACC,oBAAoB,IAAI,IAAI,CAACC,cAAc,EACzE;OACC;;KAED,IAAI,CAACC,UAAU,EAAE;IACjB;GACDC,OAAO,EACP;KACCZ,aAAa,GACb;OACC,MAAMqD,WAAW,GAAGlE,sCAAiB,CAACC,WAAW,EAAE,CAACkE,SAAS,EAAE;OAC/D,IAAI,CAACD,WAAW,EAChB;SACC;;OAGD,MAAM;SAAElF,SAAS;SAAED,UAAU;SAAEM,WAAW;SAAEC;QAAiB,GAAG4E,WAAW;OAC3E,IAAI,CAAClF,SAAS,GAAGA,SAAS;OAC1B,IAAI,CAACD,UAAU,GAAGA,UAAU;OAC5B,IAAI,CAACM,WAAW,GAAGA,WAAW;OAC9B,IAAI,CAACC,eAAe,GAAGA,eAAe;MACtC;KACDkC,UAAU,GACV;OACCxB,sCAAiB,CAACC,WAAW,EAAE,CAACuB,UAAU,CAAC;SAC1CxC,SAAS,EAAE,IAAI,CAACA,SAAS;SACzBD,UAAU,EAAE,IAAI,CAACA,UAAU;SAC3BM,WAAW,EAAE,IAAI,CAACA,WAAW;SAC7BC,eAAe,EAAE,IAAI,CAACA;QACtB,CAAC;MACF;KACDkB,cAAc,CAACqD,KAAqC,EACpD;OACC,MAAM;SAAEC;QAAI,GAAGD,KAAK,CAACE,OAAO,EAAE;OAC9B,IAAID,EAAE,CAAC3F,IAAI,KAAK6F,kBAAM,CAACvB,UAAU,CAACtE,IAAI,IAAI2F,EAAE,CAACG,QAAQ,KAAKlD,oBAAQ,CAAC4I,MAAM,EACzE;SACC,IAAI,CAACrI,oBAAoB,GAAG,IAAI;;MAEjC;KACD,MAAMgB,aAAa,GACnB;OACC,IAAI,CAACxD,UAAU,GAAG,IAAI;OAEtB,IACA;SACC,MAAM;WAAEyD;UAAa,GAAG,MAAM,IAAI,CAACC,cAAc,EAAE,CAACoH,YAAY,CAAC;WAChElH,KAAK,EAAE,IAAI,CAAC1D,SAAS;WACrB2D,MAAM,EAAE,IAAI,CAAC5D,UAAU;WACvBM,WAAW,EAAE,IAAI,CAACA,WAAW;WAC7BG,OAAO,EAAE,IAAI,CAACoJ,aAAa,CAACpJ,OAAO;WACnCqJ,gBAAgB,EAAE,IAAI,CAACD,aAAa,CAACC,gBAAgB;WACrDC,OAAO,EAAE,IAAI,CAACF,aAAa,CAACE,OAAO;WACnCC,WAAW,EAAE,IAAI,CAACH,aAAa,CAACG,WAAW;WAC3CzJ,eAAe,EAAE,IAAI,CAACA;UACtB,CAAC;SAEF,IAAI,CAACR,UAAU,GAAG,KAAK;SACvB,IAAI,CAACyC,cAAc,GAAG,IAAI;SAC1BvB,sCAAiB,CAACC,WAAW,EAAE,CAACgB,iBAAiB,CAAC,KAAK,CAAC;SACxD,MAAM8B,mBAAS,CAACC,QAAQ,CAACT,WAAW,CAAC;SACrCnC,6BAAY,CAACyJ,IAAI,CAACvJ,qBAAS,CAACwJ,MAAM,CAACC,kBAAkB,CAAC;QACtD,CACD,MACA;SACC,IAAI,CAACjL,UAAU,GAAG,KAAK;;MAExB;KACDmE,aAAa,GACb;OACC,IAAI,CAAC5B,YAAY,GAAG,IAAI;OACxBrB,sCAAiB,CAACC,WAAW,EAAE,CAACgB,iBAAiB,CAAC,KAAK,CAAC;OACxD8B,mBAAS,CAACC,QAAQ,EAAE;MACpB;KACDE,cAAc,CAACC,aAAmB,EAClC;OACC,IAAI,CAACpE,UAAU,GAAGoE,aAAa;OAC/BnD,sCAAiB,CAACC,WAAW,EAAE,CAACiB,aAAa,CAAC,IAAI,CAACnC,UAAU,CAAC;MAC9D;KACDkD,mBAAmB,CAAC5C,WAAmB,EACvC;OACC,IAAI,CAACA,WAAW,GAAGA,WAAW;MAC9B;KACD2K,cAAc,CAACzK,MAA8B,EAC7C;OACC,MAAM;SAAEC,OAAO;SAAEyK,UAAU;SAAElB,WAAW;SAAED;QAAS,GAAGvJ,MAAM;OAC5D,IAAI,CAACqJ,aAAa,CAACpJ,OAAO,GAAGA,OAAO;OACpC,IAAI,CAACoJ,aAAa,CAACC,gBAAgB,GAAGoB,UAAU;OAChD,IAAI,CAACrB,aAAa,CAACG,WAAW,GAAGA,WAAW;OAC5C,IAAI,CAACH,aAAa,CAACE,OAAO,GAAGA,OAAO;MACpC;KACDtG,cAAc,GACd;OACC,IAAI,CAAC,IAAI,CAAC8B,WAAW,EACrB;SACC,IAAI,CAACA,WAAW,GAAG,IAAIC,uCAAW,EAAE;;OAGrC,OAAO,IAAI,CAACD,WAAW;MACvB;KACD4F,uBAAuB,CAAClI,KAAa,EACrC;OACC,IAAI,CAAC1C,eAAe,GAAG0C,KAAK;MAC5B;KACDwC,GAAG,CAACC,UAAkB,EAAEiC,YAAgC,GAAG,EAAE,EAC7D;OACC,OAAO,IAAI,CAAChC,OAAO,CAACC,GAAG,CAACC,UAAU,CAACH,UAAU,EAAEiC,YAAY,CAAC;;IAE7D;GACD7B,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAmCZ,CAAC;;OClNYsF,aAAa,GAAG;GAC5BnJ,IAAI,EAAE,MAAM;GACZuE,SAAS,EAAE,WAAW;GACtBe,OAAO,EAAE,SAAS;GAClBqD,MAAM,EAAE;CACT,CAAC;CAaD,MAAMS,2BAA2B,GAAG;GACnC,CAACrJ,oBAAQ,CAACC,IAAI,GAAG9C,iBAAiB;GAClC,CAAC6C,oBAAQ,CAACwE,SAAS,GAAGT,kBAAkB;GACxC,CAAC/D,oBAAQ,CAACuF,OAAO,GAAGH,eAAe;GACnC,CAACpF,oBAAQ,CAAC4I,MAAM,GAAGjB,cAAc;GACjCd,OAAO,EAAE1J;CACV,CAAC;;CAED;AACA,OAAamM,iBAAiB,GAAG;GAChClM,IAAI,EAAE,mBAAmB;GACzBC,UAAU,EAAE;KAAEF,iBAAiB;KAAE4G,kBAAkB;KAAEqB,eAAe;KAAEuC;IAAgB;GACtFjB,KAAK,EACL;KACCxD,QAAQ,EAAE;OACTuC,IAAI,EAAE8D,MAAM;OACZC,QAAQ,EAAE;;IAEX;GACDlF,QAAQ,EACR;KACCtE,QAAQ,EAAE,MAAMA,oBAAQ;KACxByJ,QAAQ,GACR;OACC,OAAO,IAAI,CAACvG,QAAQ;MACpB;KACDwG,iBAAiB,GACjB;OAAA;OACC,gCAAOL,2BAA2B,CAAC,IAAI,CAACI,QAAQ,CAAC,oCAAIJ,2BAA2B,CAACxC,OAAO;;IAEzF;GACD/C,QAAQ,EAAG;;;;;CAKZ,CAAC;;;;ACjED,CAAO,MAAM6F,qBAAqB,CAClC;GAAA;KAAA;OAAA;OAAA,OAC8B;;KAAE;OAAA;OAAA,OACI;;;GAEnCC,kBAAkB,CAACC,eAAyB,EAC5C;KACC,4CAAI,wCAAoBA,eAAe;;GAGxCC,qBAAqB,CAACC,cAA6B,EACnD;KACC,4CAAI,sCAAmBA,cAAc;;GAGtCC,sBAAsB,CAACC,gBAAiC,EACxD;KACC,MAAMC,WAAW,GAAG,IAAIC,GAAG,CAAC,4CAAI,oCAAiBC,GAAG,CAAEC,IAAI,IAAKC,IAAI,CAACC,SAAS,CAACF,IAAI,CAAC,CAAC,CAAC;KAErF,OAAOJ,gBAAgB,CAACO,MAAM,CAAEH,IAAI,IAAK,CAACH,WAAW,CAACO,GAAG,CAACH,IAAI,CAACC,SAAS,CAACF,IAAI,CAAC,CAAC,CAAC;;GAGjFK,wBAAwB,CAACT,gBAAiC,EAC1D;KACC,MAAMU,WAAW,GAAG,IAAIR,GAAG,CAACF,gBAAgB,CAACG,GAAG,CAAEC,IAAI,IAAKC,IAAI,CAACC,SAAS,CAACF,IAAI,CAAC,CAAC,CAAC;KAEjF,OAAO,4CAAI,oCAAiBG,MAAM,CAAEH,IAAI,IAAK,CAACM,WAAW,CAACF,GAAG,CAACH,IAAI,CAACC,SAAS,CAACF,IAAI,CAAC,CAAC,CAAC;;GAGrFO,gBAAgB,CAACC,aAAuB,EACxC;KACC,MAAMX,WAAW,GAAG,IAAIC,GAAG,yCAAC,IAAI,sCAAkB;KAElD,OAAOU,aAAa,CAACL,MAAM,CAAEH,IAAI,IAAK,CAACH,WAAW,CAACO,GAAG,CAACJ,IAAI,CAAC,CAAC;;GAG9DS,kBAAkB,CAACD,aAAuB,EAC1C;KACC,MAAMF,WAAW,GAAG,IAAIR,GAAG,CAACU,aAAa,CAAC;KAE1C,OAAO,4CAAI,sCAAkBL,MAAM,CAAEH,IAAI,IAAK,CAACM,WAAW,CAACF,GAAG,CAACJ,IAAI,CAAC,CAAC;;CAEvE;;CC5CA,MAAMU,SAAS,GAAG,4BAA4B;CAC9C,MAAMC,UAAU,GAAG,yFAAyF;AAgB5G,CAAO,SAASC,wBAAwB,CAAC;GAAEtJ,KAAK;GAAEuJ;CAAQ,CAAC,EAC3D;GACC,MAAMC,QAAQ,GAAI;;KAEdxJ,KAAM;;;EAGT;GAED,OAAO;KACNyJ,EAAE,EAAE,CAAC;KACLlI,QAAQ,EAAE6H,SAAS;KACnBnJ,MAAM,EAAEoJ,UAAU;KAClBrJ,KAAK,EAAE;OACN0J,IAAI,EAAEF,QAAQ;OACd1F,IAAI,EAAE;MACN;KACD6F,YAAY,EAAE,KAAK;KACnBC,UAAU,EAAE;OAAEL;;IACd;CACF;;CCXA;AACA,CAAO,MAAMM,iBAAiB,GAAG;GAChCpO,IAAI,EAAE,mBAAmB;GACzBC,UAAU,EAAE;iBACXC,qDAAU;iBACVC,qDAAU;kBACVK,sDAAW;wBACXC,4DAAiB;0BACjBL,8DAAmB;sBACnBC,0DAAe;oBACfC;IACA;GACDgJ,KAAK,EACL;KACC+E,QAAQ,EAAE;OACThG,IAAI,EAAE8D,MAAM;OACZC,QAAQ,EAAE;;IAEX;GACD1L,IAAI,GACJ;KACC,OAAO;OACN4N,SAAS,EAAE,IAAI;OACfC,UAAU,EAAE,KAAK;OACjBC,iBAAiB,EAAE,KAAK;OACxBC,mBAAmB,EAAE,CAAC;OACtB7N,UAAU,EAAE,IAAI;OAChB8N,SAAS,EAAE,EAAE;OACb7N,SAAS,EAAE,EAAE;OACbC,WAAW,EAAE,EAAE;OACfE,QAAQ,EAAE;SACTC,mBAAmB,EAAE,KAAK;SAC1BC,WAAW,EAAE;QACb;OACDE,MAAM,EAAE;SACPC,OAAO,EAAE,CAAC;SACVC,UAAU,EAAE,EAAE;SACdC,cAAc,EAAE,EAAE;SAClBC,iBAAiB,EAAE,EAAE;SACrBC,QAAQ,EAAE,EAAE;SACZC,cAAc,EAAE;;MAEjB;IACD;GACDwF,QAAQ,EACR;KACCyH,MAAM,GACN;OACC,OAAO,IAAI,CAACC,MAAM,CAACC,OAAO,CAAC,WAAW,CAAC,CAAC,IAAI,CAACR,QAAQ,EAAE,IAAI,CAAC;MAC5D;KACDS,MAAM,GACN;OACC,OAAO,IAAI,CAACH,MAAM,CAACG,MAAM;MACzB;KACDlM,QAAQ,EAAE,MAAMA,oBAAQ;KACxBmM,cAAc,GACd;OACC,IAAI,CAAC,IAAI,CAACP,iBAAiB,EAC3B;SACC,OAAO,EAAE;;OAGV,MAAMjK,KAAK,GAAG,IAAI,CAAC8B,GAAG,CAAC,wCAAwC,EAAE;SAChE,SAAS,EAAE,IAAI,CAACoI;QAChB,CAAC;OAEF,MAAMO,OAAO,GAAGnB,wBAAwB,CAAC;SACxCtJ,KAAK;SACLuJ,OAAO,EAAE,IAAI,CAACmB;QACd,CAAC;OAEF,OAAO,CAACD,OAAO,CAAC;MAChB;KACDE,2BAA2B,GAC3B;OACC,OAAO,CAACtM,oBAAQ,CAACuM,IAAI,EAAEvM,oBAAQ,CAACC,IAAI,CAAC,CAACuM,QAAQ,CAAC,IAAI,CAACT,MAAM,CAACtG,IAAI,CAAC;MAChE;KACDgH,eAAe,GACf;OACC,IAAI,CAAC,IAAI,CAACH,2BAA2B,EACrC;SACC,OAAO,IAAI,CAACP,MAAM,CAACtG,IAAI;;OAGxB,OAAO,IAAI,CAACrH,QAAQ,CAACC,mBAAmB,GAAG2B,oBAAQ,CAACuM,IAAI,GAAGvM,oBAAQ,CAACC,IAAI;;IAEzE;GACD,MAAMb,OAAO,GACb;KACC,MAAM,IAAI,CAACsN,QAAQ,EAAE;KACrB,IAAI,CAACC,iBAAiB,GAAG,IAAIhD,qBAAqB,EAAE;KACpD,IAAI,CAACgD,iBAAiB,CAAC7C,qBAAqB,CAAC,IAAI,CAAC5L,WAAW,CAAC;KAC9D,IAAI,CAACyO,iBAAiB,CAAC/C,kBAAkB,CAAC,IAAI,CAACpL,MAAM,CAACE,UAAU,CAAC;KAEjE,IAAI,CAACgN,SAAS,GAAG,KAAK;IACtB;GACDhL,OAAO,EACP;KACCC,eAAe,CAACC,WAAwC,EACxD;OACC,IAAI,CAAC1C,WAAW,GAAG0C,WAAW;MAC9B;KACDG,gBAAgB,CAAC1C,mBAA4B,EAC7C;OACC,IAAI,CAACD,QAAQ,CAACC,mBAAmB,GAAGA,mBAAmB;MACvD;KACDwC,aAAa,CAACpC,OAAe,EAC7B;OACC,IAAI,CAACD,MAAM,CAACC,OAAO,GAAGA,OAAO;MAC7B;KACDqC,gBAAgB,CAACpC,UAAoB,EACrC;OACC,IAAI,CAACF,MAAM,CAACE,UAAU,GAAGA,UAAU;MACnC;KACDyC,sBAAsB,CAACnC,QAAsB,EAC7C;OACC,IAAI,CAACR,MAAM,CAACG,cAAc,GAAGK,QAAQ;MACrC;KACDoC,yBAAyB,CAACpC,QAAsB,EAChD;OACC,IAAI,CAACR,MAAM,CAACI,iBAAiB,GAAGI,QAAQ;MACxC;KACDqC,gBAAgB,CAACrC,QAAsB,EACvC;OACC,IAAI,CAACR,MAAM,CAACK,QAAQ,GAAGG,QAAQ;MAC/B;KACDsC,sBAAsB,CAACtC,QAAsB,EAC7C;OACC,IAAI,CAACR,MAAM,CAACM,cAAc,GAAGE,QAAQ;MACrC;KACDkC,mBAAmB,CAAC5C,WAAmB,EACvC;OACC,IAAI,CAACF,QAAQ,CAACE,WAAW,GAAGA,WAAW;MACvC;KACD,MAAMoO,QAAQ,GACd;OACC,IAAI,CAACzO,SAAS,GAAG,IAAI,CAAC8N,MAAM,CAAC3O,IAAI;OACjC,IAAI,CAAC0O,SAAS,GAAG,IAAI,CAACC,MAAM,CAACnK,MAAM;OACnC,IAAI,CAACxD,QAAQ,CAACE,WAAW,GAAG,IAAI,CAACyN,MAAM,CAACzN,WAAW;OACnD,IAAI,CAACJ,WAAW,GAAG,MAAM,IAAI,CAAC0O,iBAAiB,EAAE;OACjD,IAAI,CAACpO,MAAM,CAACC,OAAO,GAAG,IAAI,CAACsN,MAAM,CAACtN,OAAO;OACzC,IAAI,CAACD,MAAM,CAACM,cAAc,GAAG,IAAI,CAACiN,MAAM,CAAC/D,WAAW,CAAClJ,cAAc;OACnE,IAAI,CAACN,MAAM,CAACE,UAAU,GAAG,IAAI,CAACqN,MAAM,CAACc,WAAW;OAChD,IAAI,CAACrO,MAAM,CAACK,QAAQ,GAAG,IAAI,CAACkN,MAAM,CAAC/D,WAAW,CAACnJ,QAAQ;OACvD,IAAI,CAACL,MAAM,CAACG,cAAc,GAAG,IAAI,CAACoN,MAAM,CAAC/D,WAAW,CAACrJ,cAAc;OACnE,IAAI,CAACH,MAAM,CAACI,iBAAiB,GAAG,IAAI,CAACmN,MAAM,CAAC/D,WAAW,CAACpJ,iBAAiB;OACzE,IAAI,CAACR,QAAQ,CAACC,mBAAmB,GAAG,IAAI,CAAC0N,MAAM,CAACtG,IAAI,KAAKzF,oBAAQ,CAACuM,IAAI;MACtE;KACD,MAAMK,iBAAiB,GACvB;OACC,MAAM;SACL/K,cAAc;SACd+J,iBAAiB;SACjBkB;QACA,GAAG,MAAM,IAAI,CAACrL,cAAc,EAAE,CAACmL,iBAAiB,CAAC,IAAI,CAACV,MAAM,CAAC;OAE9D,IAAIN,iBAAiB,EACrB;SACC,IAAI,CAACA,iBAAiB,GAAG,IAAI;SAC7B,IAAI,CAACC,mBAAmB,GAAGiB,SAAS;SAEpC,OAAOjL,cAAc;;OAGtB,OAAOA,cAAc;MACrB;KACD,MAAMkL,aAAa,GACnB;OACCC,6BAAS,CAAC9N,WAAW,EAAE,CAAC+N,QAAQ,CAACC,YAAY,CAAC,IAAI,CAACzB,QAAQ,CAAC;OAC5DuB,6BAAS,CAAC9N,WAAW,EAAE,CAACiO,kBAAkB,CAAC,IAAI,CAAC1B,QAAQ,CAAC;OAEzD,IAAI,CAACE,UAAU,GAAG,IAAI;OAEtB,MAAM,IAAI,CAAClK,cAAc,EAAE,CAAC2L,UAAU,CAAC,IAAI,CAAClB,MAAM,EAAE;SACnDvK,KAAK,EAAE,IAAI,CAAC1D,SAAS;SACrB2D,MAAM,EAAE,IAAI,CAAC5D,UAAU;SACvByH,IAAI,EAAE,IAAI,CAACgH,eAAe;SAC1BY,mBAAmB,EAAE,IAAI,CAACV,iBAAiB,CAAC3C,sBAAsB,CAAC,IAAI,CAAC9L,WAAW,CAAC;SACpFoP,qBAAqB,EAAE,IAAI,CAACX,iBAAiB,CAACjC,wBAAwB,CAAC,IAAI,CAACxM,WAAW,CAAC;SACxFqP,aAAa,EAAE,IAAI,CAACZ,iBAAiB,CAAC/B,gBAAgB,CAAC,IAAI,CAACpM,MAAM,CAACE,UAAU,CAAC;SAC9E8O,eAAe,EAAE,IAAI,CAACb,iBAAiB,CAAC7B,kBAAkB,CAAC,IAAI,CAACtM,MAAM,CAACE,UAAU,CAAC;SAClFD,OAAO,EAAE,IAAI,CAACD,MAAM,CAACC,OAAO;SAC5BJ,mBAAmB,EAAE,IAAI,CAACD,QAAQ,CAACC,mBAAmB;SACtDC,WAAW,EAAE,IAAI,CAACF,QAAQ,CAACE,WAAW;SACtCK,cAAc,EAAE,IAAI,CAACH,MAAM,CAACG,cAAc;SAC1CC,iBAAiB,EAAE,IAAI,CAACJ,MAAM,CAACI,iBAAiB;SAChDC,QAAQ,EAAE,IAAI,CAACL,MAAM,CAACK,QAAQ;SAC9BC,cAAc,EAAE,IAAI,CAACN,MAAM,CAACM;QAC5B,CAAC,CAACiD,KAAK,CAAC,MAAM;SACd,IAAI,CAAC4J,UAAU,GAAG,KAAK;QACvB,CAAC;OAEF,IAAI,CAACA,UAAU,GAAG,KAAK;OAEvB,OAAO3J,mBAAS,CAACC,QAAQ,CAAC,IAAI,CAACwJ,QAAQ,CAAC;MACxC;KACDvJ,aAAa,GACb;OACC8K,6BAAS,CAAC9N,WAAW,EAAE,CAACiO,kBAAkB,CAAC,IAAI,CAAC1B,QAAQ,CAAC;OACzD,KAAKzJ,mBAAS,CAACC,QAAQ,CAAC,IAAI,CAACwJ,QAAQ,CAAC;MACtC;KACDtJ,cAAc,CAACC,aAAmB,EAClC;OACC,IAAI,CAACpE,UAAU,GAAGoE,aAAa;OAC/B,IAAI,CAAC0J,SAAS,GAAG,EAAE;MACnB;KACDzJ,QAAQ,GACR;OAAA;OACC,yBAAAC,sBAAW,CAACC,WAAW,CAACC,qBAAS,CAACC,4BAA4B,CAAC,qBAA/D,sBAAiEC,KAAK,EAAE;OACxE,0BAAAJ,sBAAW,CAACC,WAAW,CAACC,qBAAS,CAACG,+BAA+B,CAAC,qBAAlE,uBAAoED,KAAK,EAAE;OAC3E,0BAAAJ,sBAAW,CAACC,WAAW,CAACC,qBAAS,CAACI,sBAAsB,CAAC,qBAAzD,uBAA2DF,KAAK,EAAE;OAClE,0BAAAJ,sBAAW,CAACC,WAAW,CAACC,qBAAS,CAACK,4BAA4B,CAAC,qBAA/D,uBAAiEH,KAAK,EAAE;MACxE;KACDjB,cAAc,GACd;OACC,IAAI,CAAC,IAAI,CAAC8B,WAAW,EACrB;SACC,IAAI,CAACA,WAAW,GAAG,IAAIC,uCAAW,EAAE;;OAGrC,OAAO,IAAI,CAACD,WAAW;MACvB;KACDE,GAAG,CAACC,UAAkB,EAAEiC,YAAgC,GAAG,EAAE,EAC7D;OACC,OAAO,IAAI,CAAChC,OAAO,CAACC,GAAG,CAACC,UAAU,CAACH,UAAU,EAAEiC,YAAY,CAAC;MAC5D;KACD,MAAM0G,qBAAqB,GAC3B;OACC,MAAMoB,aAAa,GAAG,MAAMC,2CAAyB,CAAC,IAAI,CAACjC,QAAQ,CAAC;OACpE,IAAI,CAACgC,aAAa,EAClB;SACC;;OAGD,MAAM,IAAI,CAACV,aAAa,EAAE;OAE1B1N,6BAAY,CAACyJ,IAAI,CAACvJ,qBAAS,CAACoO,OAAO,CAACpB,IAAI,EAAE;SACzCqB,KAAK,EAAEC,8BAAkB,CAACC,OAAO;SACjCrC,QAAQ,EAAE,IAAI,CAACA;QACf,CAAC;;IAEH;GACD3H,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAmDZ,CAAC;;CClSD;AACA,CAAO,MAAMiK,eAAe,GAAG;GAC9B3Q,IAAI,EAAE,iBAAiB;GACvBC,UAAU,EAAE;iBACXC,qDAAU;iBACVC,qDAAU;0BACVC,8DAAmB;oBACnBE,wDAAa;wBACbC,4DAAiB;qBACjB0H,yDAAc;kBACdzH,sDAAW;oBACX0H,wDAAa;wBACbzH;IACA;GACD6I,KAAK,EAAE;KACN+E,QAAQ,EAAE;OACThG,IAAI,EAAE8D,MAAM;OACZC,QAAQ,EAAE;;IAEX;GACD1L,IAAI,GACJ;KACC,OAAO;OACN4N,SAAS,EAAE,IAAI;OACfC,UAAU,EAAE,KAAK;OACjBC,iBAAiB,EAAE,KAAK;OACxBC,mBAAmB,EAAE,CAAC;OACtB7N,UAAU,EAAE,IAAI;OAChB8N,SAAS,EAAE,EAAE;OACb7N,SAAS,EAAE,EAAE;OACbC,WAAW,EAAE,EAAE;OACfE,QAAQ,EAAE;SACTC,mBAAmB,EAAE,IAAI;SACzBC,WAAW,EAAE;QACb;OACDE,MAAM,EAAE;SACPC,OAAO,EAAE,CAAC;SACVC,UAAU,EAAE,EAAE;SACdC,cAAc,EAAE,EAAE;SAClBC,iBAAiB,EAAE,EAAE;SACrBC,QAAQ,EAAE,EAAE;SACZC,cAAc,EAAE;;MAEjB;IACD;GACDwF,QAAQ,EACR;KACCtE,QAAQ,EAAE,MAAMA,oBAAQ;KACxBuE,eAAe,EAAE,MAAMA,+CAAe;KACtCwH,MAAM,GACN;OACC,OAAO,IAAI,CAACC,MAAM,CAACC,OAAO,CAAC,WAAW,CAAC,CAAC,IAAI,CAACR,QAAQ,EAAE,IAAI,CAAC;MAC5D;KACDS,MAAM,GACN;OACC,OAAO,IAAI,CAACH,MAAM,CAACG,MAAM;MACzB;KACDzC,QAAQ,GACR;OACC,OAAO,IAAI,CAACsC,MAAM,CAACtG,IAAI;MACvB;KACD0G,cAAc,GACd;OACC,IAAI,CAAC,IAAI,CAACP,iBAAiB,EAC3B;SACC,OAAO,EAAE;;OAGV,MAAMjK,KAAK,GAAG,IAAI,CAAC8B,GAAG,CAAC,qCAAqC,EAAE;SAC7D,SAAS,EAAE,IAAI,CAACoI;QAChB,CAAC;OAEF,MAAMO,OAAO,GAAGnB,wBAAwB,CAAC;SACxCtJ,KAAK;SACLuJ,OAAO,EAAE,IAAI,CAACmB;QACd,CAAC;OAEF,OAAO,CAACD,OAAO,CAAC;MAChB;KACDK,eAAe,GACf;OACC,OAAO,IAAI,CAACrO,QAAQ,CAACC,mBAAmB,GAAG2B,oBAAQ,CAACgO,WAAW,GAAGhO,oBAAQ,CAACuF,OAAO;;IAEnF;GACD,MAAMnG,OAAO,GACb;KACC,MAAM,IAAI,CAACsN,QAAQ,EAAE;KACrB,IAAI,CAACC,iBAAiB,GAAG,IAAIhD,qBAAqB,EAAE;KACpD,IAAI,CAACgD,iBAAiB,CAAC7C,qBAAqB,CAAC,IAAI,CAAC5L,WAAW,CAAC;KAC9D,IAAI,CAACyO,iBAAiB,CAAC/C,kBAAkB,CAAC,IAAI,CAACpL,MAAM,CAACE,UAAU,CAAC;KAEjE,IAAI,CAACgN,SAAS,GAAG,KAAK;IACtB;GACDhL,OAAO,EACP;KACCC,eAAe,CAACC,WAAwC,EACxD;OACC,IAAI,CAAC1C,WAAW,GAAG0C,WAAW;MAC9B;KACDC,aAAa,CAACpC,OAAe,EAC7B;OACC,IAAI,CAACD,MAAM,CAACC,OAAO,GAAGA,OAAO;MAC7B;KACDqC,gBAAgB,CAACpC,UAAoB,EACrC;OACC,IAAI,CAACF,MAAM,CAACE,UAAU,GAAGA,UAAU;MACnC;KACDwC,mBAAmB,CAAC5C,WAAmB,EACvC;OACC,IAAI,CAACF,QAAQ,CAACE,WAAW,GAAGA,WAAW;MACvC;KACD6C,sBAAsB,CAACnC,QAAsB,EAC7C;OACC,IAAI,CAACR,MAAM,CAACG,cAAc,GAAGK,QAAQ;MACrC;KACDoC,yBAAyB,CAACpC,QAAsB,EAChD;OACC,IAAI,CAACR,MAAM,CAACI,iBAAiB,GAAGI,QAAQ;MACxC;KACDqC,gBAAgB,CAACrC,QAAsB,EACvC;OACC,IAAI,CAACR,MAAM,CAACK,QAAQ,GAAGG,QAAQ;MAC/B;KACDsC,sBAAsB,CAACtC,QAAsB,EAC7C;OACC,IAAI,CAACR,MAAM,CAACM,cAAc,GAAGE,QAAQ;MACrC;KACD+B,gBAAgB,CAAC1C,mBAA4B,EAC7C;OACC,IAAI,CAACD,QAAQ,CAACC,mBAAmB,GAAGA,mBAAmB;MACvD;KACD,MAAM0O,aAAa,GACnB;OACCC,6BAAS,CAAC9N,WAAW,EAAE,CAAC+N,QAAQ,CAACC,YAAY,CAAC,IAAI,CAACzB,QAAQ,CAAC;OAC5DuB,6BAAS,CAAC9N,WAAW,EAAE,CAACiO,kBAAkB,CAAC,IAAI,CAAC1B,QAAQ,CAAC;OAEzD,IAAI,CAACE,UAAU,GAAG,IAAI;OAEtB,MAAM,IAAI,CAAClK,cAAc,EAAE,CAAC2L,UAAU,CAAC,IAAI,CAAClB,MAAM,EAAE;SACnDvK,KAAK,EAAE,IAAI,CAAC1D,SAAS;SACrB2D,MAAM,EAAE,IAAI,CAAC5D,UAAU;SACvByH,IAAI,EAAE,IAAI,CAACgH,eAAe;SAC1BY,mBAAmB,EAAE,IAAI,CAACV,iBAAiB,CAAC3C,sBAAsB,CAAC,IAAI,CAAC9L,WAAW,CAAC;SACpFoP,qBAAqB,EAAE,IAAI,CAACX,iBAAiB,CAACjC,wBAAwB,CAAC,IAAI,CAACxM,WAAW,CAAC;SACxFqP,aAAa,EAAE,IAAI,CAACZ,iBAAiB,CAAC/B,gBAAgB,CAAC,IAAI,CAACpM,MAAM,CAACE,UAAU,CAAC;SAC9E8O,eAAe,EAAE,IAAI,CAACb,iBAAiB,CAAC7B,kBAAkB,CAAC,IAAI,CAACtM,MAAM,CAACE,UAAU,CAAC;SAClFD,OAAO,EAAE,IAAI,CAACD,MAAM,CAACC,OAAO;SAC5BJ,mBAAmB,EAAE,IAAI,CAACD,QAAQ,CAACC,mBAAmB;SACtDC,WAAW,EAAE,IAAI,CAACF,QAAQ,CAACE,WAAW;SACtCK,cAAc,EAAE,IAAI,CAACH,MAAM,CAACG,cAAc;SAC1CC,iBAAiB,EAAE,IAAI,CAACJ,MAAM,CAACI,iBAAiB;SAChDC,QAAQ,EAAE,IAAI,CAACL,MAAM,CAACK,QAAQ;SAC9BC,cAAc,EAAE,IAAI,CAACN,MAAM,CAACM;QAC5B,CAAC,CAACiD,KAAK,CAAC,MAAM;SACd,IAAI,CAAC4J,UAAU,GAAG,KAAK;QACvB,CAAC;OAEF,IAAI,CAACA,UAAU,GAAG,KAAK;OAEvB,OAAO3J,mBAAS,CAACC,QAAQ,CAAC,IAAI,CAACwJ,QAAQ,CAAC;MACxC;KACDvJ,aAAa,GACb;OACC8K,6BAAS,CAAC9N,WAAW,EAAE,CAACiO,kBAAkB,CAAC,IAAI,CAAC1B,QAAQ,CAAC;OACzD,KAAKzJ,mBAAS,CAACC,QAAQ,CAAC,IAAI,CAACwJ,QAAQ,CAAC;MACtC;KACDtJ,cAAc,CAACC,aAAmB,EAClC;OACC,IAAI,CAACpE,UAAU,GAAGoE,aAAa;OAC/B,IAAI,CAAC0J,SAAS,GAAG,EAAE;MACnB;KACDzJ,QAAQ,GACR;OAAA;OACC,yBAAAC,sBAAW,CAACC,WAAW,CAACC,qBAAS,CAACC,4BAA4B,CAAC,qBAA/D,sBAAiEC,KAAK,EAAE;OACxE,0BAAAJ,sBAAW,CAACC,WAAW,CAACC,qBAAS,CAACG,+BAA+B,CAAC,qBAAlE,uBAAoED,KAAK,EAAE;OAC3E,0BAAAJ,sBAAW,CAACC,WAAW,CAACC,qBAAS,CAACI,sBAAsB,CAAC,qBAAzD,uBAA2DF,KAAK,EAAE;OAClE,0BAAAJ,sBAAW,CAACC,WAAW,CAACC,qBAAS,CAACK,4BAA4B,CAAC,qBAA/D,uBAAiEH,KAAK,EAAE;MACxE;KACDjB,cAAc,GACd;OACC,IAAI,CAAC,IAAI,CAAC8B,WAAW,EACrB;SACC,IAAI,CAACA,WAAW,GAAG,IAAIC,uCAAW,EAAE;;OAGrC,OAAO,IAAI,CAACD,WAAW;MACvB;KACD,MAAMmJ,QAAQ,GACd;OACC,IAAI,CAACzO,SAAS,GAAG,IAAI,CAAC8N,MAAM,CAAC3O,IAAI;OACjC,IAAI,CAAC0O,SAAS,GAAG,IAAI,CAACC,MAAM,CAACnK,MAAM;OACnC,IAAI,CAACxD,QAAQ,CAACE,WAAW,GAAG,IAAI,CAACyN,MAAM,CAACzN,WAAW;OACnD,IAAI,CAACJ,WAAW,GAAG,MAAM,IAAI,CAAC0O,iBAAiB,EAAE;OACjD,IAAI,CAACpO,MAAM,CAACC,OAAO,GAAG,IAAI,CAACsN,MAAM,CAACtN,OAAO;OACzC,IAAI,CAACD,MAAM,CAACM,cAAc,GAAG,IAAI,CAACiN,MAAM,CAAC/D,WAAW,CAAClJ,cAAc;OACnE,IAAI,CAACN,MAAM,CAACE,UAAU,GAAG,IAAI,CAACqN,MAAM,CAACc,WAAW;OAChD,IAAI,CAACrO,MAAM,CAACK,QAAQ,GAAG,IAAI,CAACkN,MAAM,CAAC/D,WAAW,CAACnJ,QAAQ;OACvD,IAAI,CAACL,MAAM,CAACG,cAAc,GAAG,IAAI,CAACoN,MAAM,CAAC/D,WAAW,CAACrJ,cAAc;OACnE,IAAI,CAACH,MAAM,CAACI,iBAAiB,GAAG,IAAI,CAACmN,MAAM,CAAC/D,WAAW,CAACpJ,iBAAiB;OACzE,IAAI,CAACR,QAAQ,CAACC,mBAAmB,GAAG,IAAI,CAAC0N,MAAM,CAACtG,IAAI,KAAKzF,oBAAQ,CAACgO,WAAW;MAC7E;KACD,MAAMpB,iBAAiB,GACvB;OACC,MAAM;SACL/K,cAAc;SACd+J,iBAAiB;SACjBkB;QACA,GAAG,MAAM,IAAI,CAACrL,cAAc,EAAE,CAACmL,iBAAiB,CAAC,IAAI,CAACV,MAAM,CAAC;OAE9D,IAAIN,iBAAiB,EACrB;SACC,IAAI,CAACA,iBAAiB,GAAG,IAAI;SAC7B,IAAI,CAACC,mBAAmB,GAAGiB,SAAS;SAEpC,OAAOjL,cAAc;;OAGtB,OAAOA,cAAc;MACrB;KACD4B,GAAG,CAACC,UAAkB,EAAEiC,YAAgC,GAAG,EAAE,EAC7D;OACC,OAAO,IAAI,CAAChC,OAAO,CAACC,GAAG,CAACC,UAAU,CAACH,UAAU,EAAEiC,YAAY,CAAC;MAC5D;KACD,MAAM0G,qBAAqB,GAC3B;OACC,MAAMoB,aAAa,GAAG,MAAMC,2CAAyB,CAAC,IAAI,CAACjC,QAAQ,CAAC;OACpE,IAAI,CAACgC,aAAa,EAClB;SACC;;OAGD,MAAM,IAAI,CAACV,aAAa,EAAE;OAE1B1N,6BAAY,CAACyJ,IAAI,CAACvJ,qBAAS,CAACoO,OAAO,CAACpB,IAAI,EAAE;SACzCqB,KAAK,EAAEC,8BAAkB,CAACC,OAAO;SACjCrC,QAAQ,EAAE,IAAI,CAACA;QACf,CAAC;;IAEH;GACD3H,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CA6DZ,CAAC;;CClTD;AACA,CAAO,MAAMmK,cAAc,GAAG;GAC7B7Q,IAAI,EAAE,gBAAgB;GACtBC,UAAU,EACV;iBACCC,qDAAU;iBACVC,qDAAU;oBACV+H,wDAAa;kBACb1H,sDAAW;wBACXC,4DAAiB;KACjBH;IACA;GACDgJ,KAAK,EACL;KACC+E,QAAQ,EAAE;OACThG,IAAI,EAAE8D,MAAM;OACZC,QAAQ,EAAE;;IAEX;GACD1L,IAAI,GACJ;KACC,OAAO;OACN6N,UAAU,EAAE,KAAK;OACjB3N,UAAU,EAAE,IAAI;OAChB8N,SAAS,EAAE,EAAE;OACb7N,SAAS,EAAE,EAAE;OACbK,WAAW,EAAE,EAAE;OACfuJ,aAAa,EAAE;SACdpJ,OAAO,EAAEwF,2BAAI,CAACC,SAAS,EAAE;SACzB4D,gBAAgB,EAAE,EAAE;SACpBC,OAAO,EAAE,IAAI;SACbC,WAAW,EAAE,IAAI;SACjBkG,UAAU,EAAE;;MAEb;IACD;GACD5J,QAAQ,EACR;KACCC,eAAe,EAAE,MAAMA,+CAAe;KACtCwH,MAAM,GACN;OACC,OAAO,IAAI,CAACC,MAAM,CAACC,OAAO,CAAC,WAAW,CAAC,CAAC,IAAI,CAACR,QAAQ,EAAE,IAAI,CAAC;MAC5D;KACDS,MAAM,GACN;OACC,OAAO,IAAI,CAACH,MAAM,CAACG,MAAM;MACzB;KACDvF,QAAQ,GACR;OACC,MAAM;SAAEA;QAA6B,GAAG,IAAI,CAACqF,MAAM,CAACC,OAAO,CAAC,2BAA2B,CAAC,CAAC,IAAI,CAACC,MAAM,CAAC;OAErG,OAAOvF,QAAQ;MACf;KACDwH,uBAAuB,GACvB;OACC,OAAO;SACNjG,WAAW,EAAEC,iBAAK,CAACC,WAAW;SAC9BC,eAAe,EAAEF,iBAAK,CAACG,QAAQ;SAC/BC,SAAS,EAAEJ,iBAAK,CAACK,KAAK;SACtBC,SAAS,EAAEN,iBAAK,CAACK,KAAK;SACtBE,UAAU,EAAEP,iBAAK,CAACQ;QAClB;;IAEF;GACDvJ,OAAO,GACP;KACC,IAAI,CAACsN,QAAQ,EAAE;KACf,IAAI,CAAC0B,eAAe,EAAE;IACtB;GACD1N,OAAO,EACP;KACC0N,eAAe,GACf;OACC,IAAI,CAACzB,iBAAiB,GAAG,IAAIhD,qBAAqB,EAAE;OACpD,MAAM0E,oBAAoB,GAAG,IAAI,CAACtC,MAAM,CAACc,WAAW,CAACrC,MAAM,CAAE8D,SAAS,IAAK;SAC1E,OAAOA,SAAS,KAAKrK,2BAAI,CAACC,SAAS,EAAE;QACrC,CAAC;OACF,IAAI,CAACyI,iBAAiB,CAAC/C,kBAAkB,CAACyE,oBAAoB,CAAC;MAC/D;KACD,MAAM3B,QAAQ,GACd;OACC,IAAI,CAACzO,SAAS,GAAG,IAAI,CAAC8N,MAAM,CAAC3O,IAAI;OACjC,IAAI,CAAC0O,SAAS,GAAG,IAAI,CAACC,MAAM,CAACnK,MAAM;OACnC,IAAI,CAACtD,WAAW,GAAG,IAAI,CAACyN,MAAM,CAACzN,WAAW;MAC1C;KACD6D,cAAc,CAACC,aAAmB,EAClC;OACC,IAAI,CAACpE,UAAU,GAAGoE,aAAa;OAC/B,IAAI,CAAC0J,SAAS,GAAG,EAAE;MACnB;KACD5K,mBAAmB,CAAC5C,WAAmB,EACvC;OACC,IAAI,CAACA,WAAW,GAAGA,WAAW;MAC9B;KACD2K,cAAc,CAACzK,MAA8B,EAC7C;OACC,MAAM;SAAEC,OAAO;SAAEyK,UAAU;SAAElB,WAAW;SAAED;QAAS,GAAGvJ,MAAM;OAC5D,IAAI,CAACqJ,aAAa,CAACpJ,OAAO,GAAGA,OAAO;OACpC,IAAI,CAACoJ,aAAa,CAACC,gBAAgB,GAAGoB,UAAU;OAChD,IAAI,CAACrB,aAAa,CAACG,WAAW,GAAGA,WAAW;OAC5C,IAAI,CAACH,aAAa,CAACE,OAAO,GAAGA,OAAO;OAEpC,IAAI,CAACF,aAAa,CAACqG,UAAU,GAAG,IAAI;MACpC;KACD,MAAMnB,aAAa,GACnB;OACCC,6BAAS,CAAC9N,WAAW,EAAE,CAAC+N,QAAQ,CAACC,YAAY,CAAC,IAAI,CAACzB,QAAQ,CAAC;OAC5DuB,6BAAS,CAAC9N,WAAW,EAAE,CAACiO,kBAAkB,CAAC,IAAI,CAAC1B,QAAQ,CAAC;OAEzD,IAAI,CAACE,UAAU,GAAG,IAAI;OAEtB,IAAI4C,OAAO,GAAG;SACb5M,KAAK,EAAE,IAAI,CAAC1D,SAAS;SACrB2D,MAAM,EAAE,IAAI,CAAC5D,UAAU;SACvBM,WAAW,EAAE,IAAI,CAACA;QAClB;OAED,IAAI,IAAI,CAACuJ,aAAa,CAACqG,UAAU,EACjC;SACC,MAAMrG,aAAa,GAAG;WACrBpJ,OAAO,EAAE,IAAI,CAACoJ,aAAa,CAACpJ,OAAO;WACnCsJ,OAAO,EAAE,IAAI,CAACF,aAAa,CAACE,OAAO;WACnCC,WAAW,EAAE,IAAI,CAACH,aAAa,CAACG,WAAW;WAC3CwG,mBAAmB,EAAE,IAAI,CAAC7B,iBAAiB,CAAC/B,gBAAgB,CAAC,IAAI,CAAC/C,aAAa,CAACC,gBAAgB,CAAC;WACjG2G,sBAAsB,EAAE,IAAI,CAAC9B,iBAAiB,CAAC7B,kBAAkB,CAAC,IAAI,CAACjD,aAAa,CAACC,gBAAgB;UACrG;SAEDyG,OAAO,GAAG;WACT,GAAGA,OAAO;WACV1G;UACA;;OAGF,IACA;SACC,MAAM,IAAI,CAACpG,cAAc,EAAE,CAACiN,YAAY,CAAC,IAAI,CAACjD,QAAQ,EAAE8C,OAAO,CAAC;SAChE,IAAI,CAAC5C,UAAU,GAAG,KAAK;SACvB,KAAK3J,mBAAS,CAACC,QAAQ,CAAC,IAAI,CAACwJ,QAAQ,CAAC;QACtC,CACD,MACA;SACC,IAAI,CAACE,UAAU,GAAG,KAAK;;MAExB;KACDzJ,aAAa,GACb;OACC8K,6BAAS,CAAC9N,WAAW,EAAE,CAACiO,kBAAkB,CAAC,IAAI,CAAC1B,QAAQ,CAAC;OACzD,KAAKzJ,mBAAS,CAACC,QAAQ,CAAC,IAAI,CAACwJ,QAAQ,CAAC;MACtC;KACDhK,cAAc,GACd;OACC,IAAI,CAAC,IAAI,CAAC8B,WAAW,EACrB;SACC,IAAI,CAACA,WAAW,GAAG,IAAIC,uCAAW,EAAE;;OAGrC,OAAO,IAAI,CAACD,WAAW;MACvB;KACDE,GAAG,CAACC,UAAkB,EAAEiC,YAAgC,GAAG,EAAE,EAC7D;OACC,OAAO,IAAI,CAAChC,OAAO,CAACC,GAAG,CAACC,UAAU,CAACH,UAAU,EAAEiC,YAAY,CAAC;;IAE7D;GACD7B,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CA+BZ,CAAC;;CCjND;AACA,OAAa6K,iBAAiB,GAAG;GAChCvR,IAAI,EAAE,mBAAmB;GACzBC,UAAU,EAAE;KAAEmO,iBAAiB;KAAEuC,eAAe;KAAEE;IAAgB;GAClEvH,KAAK,EACL;KACCxD,QAAQ,EAAE;OACTuC,IAAI,EAAE8D,MAAM;OACZC,QAAQ,EAAE;;IAEX;GACDlF,QAAQ,EACR;KACCtE,QAAQ,EAAE,MAAMA,oBAAQ;KACxByJ,QAAQ,GACR;OACC,MAAMxJ,IAAI,GAAG,IAAI,CAAC+L,MAAM,CAACC,OAAO,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC/I,QAAQ,EAAE,IAAI,CAAC;OAElE,OAAOjD,IAAI,CAACwF,IAAI;MAChB;KACDmJ,SAAS,GACT;OACC,MAAMC,oBAAoB,GAAG,IAAI1E,GAAG,CAAC,CAACnK,oBAAQ,CAACuF,OAAO,EAAEvF,oBAAQ,CAACgO,WAAW,CAAC,CAAC;OAE9E,OAAOa,oBAAoB,CAACpE,GAAG,CAAC,IAAI,CAAChB,QAAQ,CAAC;MAC9C;KACDqF,MAAM,GACN;OACC,MAAMC,iBAAiB,GAAG,IAAI5E,GAAG,CAAC,CAACnK,oBAAQ,CAACC,IAAI,EAAED,oBAAQ,CAACuM,IAAI,EAAEvM,oBAAQ,CAACwE,SAAS,CAAC,CAAC;OAErF,OAAOuK,iBAAiB,CAACtE,GAAG,CAAC,IAAI,CAAChB,QAAQ,CAAC;MAC3C;KACDuF,QAAQ,GACR;OACC,OAAO,IAAI,CAACvF,QAAQ,KAAKzJ,oBAAQ,CAAC4I,MAAM;;IAEzC;GACD9E,QAAQ,EAAG;;;;;;;CAOZ,CAAC;;;;;;;;;;"}