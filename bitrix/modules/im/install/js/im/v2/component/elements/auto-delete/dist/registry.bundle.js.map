{"version":3,"file":"registry.bundle.js","sources":["../src/auto-delete-dropdown.js","../src/components/radio-group/radio-group.js","../src/auto-delete-popup.js","../src/auto-delete-hint.js"],"sourcesContent":["import 'ui.forms';\nimport { Tag } from 'main.core';\nimport { MenuManager, type Menu } from 'main.popup';\n\nimport { AutoDeleteDelay } from 'im.v2.const';\nimport { AutoDeleteManager } from 'im.v2.lib.auto-delete';\n\nimport './css/auto-delete-dropdown.css';\n\nimport type { JsonObject } from 'main.core';\n\nconst MENU_ID = 'im-auto-delete-delay-dropdown';\n\n// @vue/component\nexport const AutoDeleteDropdown = {\n\tname: 'AutoDeleteDropdown',\n\tprops: {\n\t\tcurrentDelay: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['delayChange'],\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tmenuOpened: false,\n\t\t\tselectedValue: AutoDeleteDelay.Off,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tisEnabled(): boolean\n\t\t{\n\t\t\treturn this.currentDelay !== AutoDeleteDelay.Off;\n\t\t},\n\t\tautoDeleteText(): string\n\t\t{\n\t\t\treturn AutoDeleteManager.getStatusText(this.currentDelay);\n\t\t},\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.menuInstance?.destroy();\n\t},\n\tmethods: {\n\t\ttoggleMenu()\n\t\t{\n\t\t\tif (this.currentDelay === AutoDeleteDelay.Off)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.menuInstance = this.getMenuInstance();\n\t\t\tif (this.menuOpened)\n\t\t\t{\n\t\t\t\tthis.menuInstance.close();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.menuInstance.show();\n\t\t\tthis.menuOpened = true;\n\t\t},\n\t\tgetMenuInstance(): Menu\n\t\t{\n\t\t\treturn MenuManager.create({\n\t\t\t\tid: MENU_ID,\n\t\t\t\tbindOptions: { forceBindPosition: true, position: 'bottom' },\n\t\t\t\toffsetTop: 6,\n\t\t\t\ttargetContainer: document.body,\n\t\t\t\tbindElement: this.$refs.dropdown,\n\t\t\t\tclassName: 'bx-im-messenger__scope bx-im-auto-delete-dropdown__scope',\n\t\t\t\twidth: 193,\n\t\t\t\titems: this.getMenuItems(),\n\t\t\t\tevents: {\n\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\tthis.menuOpened = false;\n\t\t\t\t\t\tthis.menuInstance.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tgetMenuItems(): Array<{ html: HTMLElement, onclick: Function }>\n\t\t{\n\t\t\treturn Object.values(AutoDeleteDelay).map((delay) => {\n\t\t\t\tconst isSelected = delay === this.currentDelay;\n\n\t\t\t\treturn {\n\t\t\t\t\thtml: this.getMenuItemHtml(delay, isSelected),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.$emit('delayChange', delay);\n\t\t\t\t\t\tthis.menuInstance.close();\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t});\n\t\t},\n\t\tgetMenuItemHtml(delay: number, selected: boolean): HTMLElement\n\t\t{\n\t\t\tconst icon = selected ? '<span class=\"bx-im-auto-delete-dropdown__icon\"></span>' : '';\n\n\t\t\treturn Tag.render`\n\t\t\t\t<span class=\"bx-im-auto-delete-dropdown__item\">\n\t\t\t\t\t${AutoDeleteManager.getStatusText(delay)}\n\t\t\t\t\t${icon}\n\t\t\t\t</span>\n\t\t\t`;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tref=\"dropdown\"\n\t\t\tclass=\"bx-im-auto-delete-dropdown__container bx-im-auto-delete-dropdown__scope\"\n\t\t\t:class=\"{'--enabled': isEnabled}\"\n\t\t\t@click=\"toggleMenu\"\n\t\t>\n\t\t\t{{ autoDeleteText }}\n\t\t</div>\n\t`,\n};\n","import './css/radio-group.css';\n\n// @vue/component\nexport const RadioGroup = {\n\tname: 'RadioGroup',\n\tprops:\n\t{\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['change'],\n\tcomputed:\n\t{\n\t\tselectedValue(): number\n\t\t{\n\t\t\treturn this.items.find((option) => option.selected).value;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonInput(value): void\n\t\t{\n\t\t\tthis.$emit('change', value);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-auto-delete-popup-radio__container\">\n\t\t\t<label v-for=\"option in items\" class=\"bx-im-auto-delete-popup-radio__option\">\n\t\t\t\t<input\n\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\tclass=\"bx-im-auto-delete-popup-radio__input\"\n\t\t\t\t\t:value=\"option.value\"\n\t\t\t\t\t:checked=\"option.value === selectedValue\"\n\t\t\t\t\t@change=\"onInput(option.value)\"\n\t\t\t\t/>\n\t\t\t\t<span class=\"bx-im-auto-delete-popup-radio__label\">{{ option.text }}</span>\n\t\t\t</label>\n\t\t</div>\n\t`,\n};\n","import { AutoDeleteDelay } from 'im.v2.const';\nimport { AutoDeleteManager } from 'im.v2.lib.auto-delete';\nimport { MessengerPopup } from 'im.v2.component.elements.popup';\n\nimport { RadioGroup } from './components/radio-group/radio-group';\n\nimport './css/auto-delete-popup.css';\n\nimport type { PopupOptions } from 'main.popup';\n\ntype AutoDeleteDelayOption = {\n\tvalue: number;\n\ttext: string;\n\tselected: boolean;\n};\n\nconst POPUP_ID = 'auto-delete-choose-delay-popup';\n\n// @vue/component\nexport const AutoDeletePopup = {\n\tname: 'AutoDeletePopup',\n\tcomponents: { MessengerPopup, RadioGroup },\n\tprops:\n\t{\n\t\tautoDeleteDelay: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t},\n\temits: ['close', 'autoDeleteDelayChange'],\n\tcomputed:\n\t{\n\t\tPOPUP_ID: () => POPUP_ID,\n\t\tconfig(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\toverlay: true,\n\t\t\t\theight: 342,\n\t\t\t\twidth: 400,\n\t\t\t\ttitleBar: this.loc('IM_ELEMENTS_AUTO_DELETE_POPUP_TITLE'),\n\t\t\t\tcloseIcon: true,\n\t\t\t\ttargetContainer: document.body,\n\t\t\t\tfixed: true,\n\t\t\t\tpadding: 0,\n\t\t\t\tautoHide: true,\n\t\t\t\tcontentPadding: 0,\n\t\t\t\tcontentBackground: '#fff',\n\t\t\t\tclassName: 'bx-im-auto-delete-popup__scope',\n\t\t\t};\n\t\t},\n\t\toptions(): AutoDeleteDelayOption[]\n\t\t{\n\t\t\treturn Object.values(AutoDeleteDelay).map((delayValue) => ({\n\t\t\t\tvalue: delayValue,\n\t\t\t\ttext: AutoDeleteManager.getStatusText(delayValue),\n\t\t\t\tselected: this.autoDeleteDelay === delayValue,\n\t\t\t}));\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonAutoDeleteDelayChange(delay: number): void\n\t\t{\n\t\t\tthis.$emit('autoDeleteDelayChange', delay);\n\t\t\tthis.$emit('close');\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<MessengerPopup\n\t\t\t:config=\"config\"\n\t\t\t:id=\"POPUP_ID\"\n\t\t\t@close=\"$emit('close')\"\n\t\t>\n\t\t\t<div class=\"bx-im-auto-delete-popup__container\">\n\t\t\t\t<div class=\"bx-im-auto-delete-popup__info\">\n\t\t\t\t\t{{ this.loc('IM_ELEMENTS_AUTO_DELETE_POPUP_INFO') }}\n\t\t\t\t</div>\n\t\t\t\t<RadioGroup :items=\"options\" @change=\"onAutoDeleteDelayChange\" />\n\t\t\t</div>\n\t\t</MessengerPopup>\n\t`,\n};\n","import { Loc } from 'main.core';\n\nimport { MessengerPopup } from 'im.v2.component.elements.popup';\nimport { getHelpdeskStringCallback } from 'im.v2.lib.helpdesk';\n\nimport './css/auto-delete-hint.css';\n\nimport type { JsonObject } from 'main.core';\n\nconst POPUP_ID = 'im-auto-delete-hint-popup';\n\n// @vue/component\nexport const AutoDeleteHint = {\n\tname: 'AutoDeleteHint',\n\tcomponents: { MessengerPopup },\n\tprops:\n\t{\n\t\tbindElement: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tconfig: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => {},\n\t\t},\n\t},\n\temits: ['close'],\n\tcomputed:\n\t{\n\t\tPOPUP_ID: () => POPUP_ID,\n\t\tgetConfig(): JsonObject\n\t\t{\n\t\t\treturn {\n\t\t\t\tdarkMode: true,\n\t\t\t\tbindElement: this.bindElement,\n\t\t\t\tangle: true,\n\t\t\t\twidth: 317,\n\t\t\t\tcloseIcon: true,\n\t\t\t\toffsetLeft: 45,\n\t\t\t\tclassName: 'bx-im-auto-delete-hint__scope',\n\t\t\t\tcontentBorderRadius: 0,\n\t\t\t\t...this.config,\n\t\t\t};\n\t\t},\n\t\thintText(): string\n\t\t{\n\t\t\tconst ARTICLE_CODE = '24402288';\n\t\t\tconst articleCallback = getHelpdeskStringCallback(ARTICLE_CODE);\n\n\t\t\treturn Loc.getMessage('IM_ELEMENTS_AUTO_DELETE_NO_PERMISSION', {\n\t\t\t\t'[helpdesklink]': `<a class=\"bx-im-auto-delete-hint__helpdesk-link\" onclick=\"${articleCallback}\">`,\n\t\t\t\t'[/helpdesklink]': '</a>',\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<MessengerPopup\n\t\t\t:config=\"getConfig\"\n\t\t\t:id=\"POPUP_ID\"\n\t\t\t@close=\"$emit('close')\"\n\t\t>\n\t\t\t<div class=\"bx-im-auto-delete-hint__container\">\n\t\t\t\t<div class=\"bx-im-auto-delete-hint__text\" v-html=\"hintText\" />\n\t\t\t</div>\n\t\t</MessengerPopup>\n\t`,\n};\n"],"names":["MENU_ID","AutoDeleteDropdown","name","props","currentDelay","type","Number","required","emits","data","menuOpened","selectedValue","AutoDeleteDelay","Off","computed","isEnabled","autoDeleteText","AutoDeleteManager","getStatusText","beforeUnmount","menuInstance","destroy","methods","toggleMenu","getMenuInstance","close","show","MenuManager","create","id","bindOptions","forceBindPosition","position","offsetTop","targetContainer","document","body","bindElement","$refs","dropdown","className","width","items","getMenuItems","events","onClose","Object","values","map","delay","isSelected","html","getMenuItemHtml","onclick","$emit","selected","icon","Tag","render","template","RadioGroup","Array","find","option","value","onInput","POPUP_ID","AutoDeletePopup","components","MessengerPopup","autoDeleteDelay","default","config","overlay","height","titleBar","loc","closeIcon","fixed","padding","autoHide","contentPadding","contentBackground","options","delayValue","text","onAutoDeleteDelayChange","phraseCode","$Bitrix","Loc","getMessage","AutoDeleteHint","getConfig","darkMode","angle","offsetLeft","contentBorderRadius","hintText","ARTICLE_CODE","articleCallback","getHelpdeskStringCallback"],"mappings":"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"}