{"version":3,"file":"file-message.bundle.js","sources":["../src/components/items/video.js","../src/components/media-content.js","../src/components/media-message.js","../src/classes/base-file-context-menu.js","../src/components/items/base-file.js","../src/components/base-file-message.js","../src/components/items/audio.js","../src/components/audio-message.js","../src/components/file-collection-message.js","../src/file-message.js"],"sourcesContent":["import { Type } from 'main.core';\n\nimport { Utils } from 'im.v2.lib.utils';\nimport { FileViewerContext } from 'im.v2.const';\nimport { VideoPlayer } from\t'im.v2.component.elements.videoplayer';\nimport { ProgressBar } from\t'im.v2.component.elements.progressbar';\n\nimport '../../css/items/video.css';\n\nimport type { ImModelFile, ImModelMessage } from 'im.v2.model';\n\nconst VIDEO_SIZE_TO_AUTOPLAY = 5_000_000;\nconst MAX_WIDTH = 420;\nconst MAX_HEIGHT = 340;\nconst MIN_WIDTH = 200;\nconst MIN_HEIGHT = 100;\nconst DEFAULT_WIDTH = 320;\nconst DEFAULT_HEIGHT = 180;\n\n// @vue/component\nexport const VideoItem = {\n\tname: 'VideoItem',\n\tcomponents: { VideoPlayer, ProgressBar },\n\tprops:\n\t{\n\t\tid: {\n\t\t\ttype: [String, Number],\n\t\t\trequired: true,\n\t\t},\n\t\tmessage: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['cancelClick'],\n\tcomputed:\n\t{\n\t\tmessageItem(): ImModelMessage\n\t\t{\n\t\t\treturn this.message;\n\t\t},\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.$store.getters['files/get'](this.id, true);\n\t\t},\n\t\tautoplay(): boolean\n\t\t{\n\t\t\treturn this.file.size < VIDEO_SIZE_TO_AUTOPLAY;\n\t\t},\n\t\tcanBeOpenedWithViewer(): boolean\n\t\t{\n\t\t\treturn this.file.viewerAttrs && BX.UI?.Viewer;\n\t\t},\n\t\tviewerAttributes(): Object\n\t\t{\n\t\t\treturn Utils.file.getViewerDataAttributes({\n\t\t\t\tviewerAttributes: this.file.viewerAttrs,\n\t\t\t\tpreviewImageSrc: this.file.urlPreview,\n\t\t\t\tcontext: FileViewerContext.dialog,\n\t\t\t});\n\t\t},\n\t\timageSize(): {width: string, height: string, backgroundSize: string}\n\t\t{\n\t\t\tlet newWidth = this.file.image.width;\n\t\t\tlet newHeight = this.file.image.height;\n\n\t\t\tif (!newHeight || !newWidth)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\twidth: `${DEFAULT_WIDTH}px`,\n\t\t\t\t\theight: `${DEFAULT_HEIGHT}px`,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (this.file.image.width > MAX_WIDTH || this.file.image.height > MAX_HEIGHT)\n\t\t\t{\n\t\t\t\tconst aspectRatio = this.file.image.width / this.file.image.height;\n\n\t\t\t\tif (this.file.image.width > MAX_WIDTH)\n\t\t\t\t{\n\t\t\t\t\tnewWidth = MAX_WIDTH;\n\t\t\t\t\tnewHeight = Math.round(MAX_WIDTH / aspectRatio);\n\t\t\t\t}\n\n\t\t\t\tif (newHeight > MAX_HEIGHT)\n\t\t\t\t{\n\t\t\t\t\tnewWidth = Math.round(MAX_HEIGHT * aspectRatio);\n\t\t\t\t\tnewHeight = MAX_HEIGHT;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst sizes = {\n\t\t\t\twidth: Math.max(newWidth, MIN_WIDTH),\n\t\t\t\theight: Math.max(newHeight, MIN_HEIGHT),\n\t\t\t};\n\n\t\t\treturn {\n\t\t\t\twidth: `${sizes.width}px`,\n\t\t\t\theight: `${sizes.height}px`,\n\t\t\t\t'object-fit': (sizes.width < 100 || sizes.height < 100) ? 'cover' : 'contain',\n\t\t\t};\n\t\t},\n\t\tisLoaded(): boolean\n\t\t{\n\t\t\treturn this.file.progress === 100;\n\t\t},\n\t\tisForward(): boolean\n\t\t{\n\t\t\treturn Type.isStringFilled(this.messageItem.forward.id);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tdownload()\n\t\t{\n\t\t\tif (this.file.progress !== 100 || this.canBeOpenedWithViewer)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\twindow.open(this.file.urlDownload, '_blank');\n\t\t},\n\t\tonCancelClick(event)\n\t\t{\n\t\t\tthis.$emit('cancelClick', event);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"bx-im-video-item__container bx-im-video-item__scope\"\n\t\t\t:class=\"{'--with-forward': isForward}\"\n\t\t\t@click=\"download\"\n\t\t>\n\t\t\t<ProgressBar \n\t\t\t\tv-if=\"!isLoaded\" \n\t\t\t\t:item=\"file\" \n\t\t\t\t@cancelClick=\"onCancelClick\"\n\t\t\t/>\n\t\t\t<VideoPlayer\n\t\t\t\t:fileId=\"file.id\"\n\t\t\t\t:src=\"file.urlDownload\"\n\t\t\t\t:previewImageUrl=\"file.urlPreview\"\n\t\t\t\t:elementStyle=\"imageSize\"\n\t\t\t\t:withAutoplay=\"autoplay\"\n\t\t\t\t:withPlayerControls=\"isLoaded\"\n\t\t\t\t:viewerAttributes=\"viewerAttributes\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { MessageStatus } from 'im.v2.component.message.elements';\nimport { MediaGallery } from 'im.v2.component.elements.media-gallery';\nimport { FileType } from 'im.v2.const';\n\nimport { VideoItem } from './items/video';\n\nimport '../css/items/media-content.css';\n\nimport type { ImModelMessage, ImModelFile } from 'im.v2.model';\n\n// @vue/component\nexport const MediaContent = {\n\tname: 'MediaContent',\n\tcomponents: { VideoItem, MessageStatus, MediaGallery },\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['cancelClick'],\n\tcomputed: {\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tfiles(): Array<ImModelFile>\n\t\t{\n\t\t\treturn this.message.files.map((fileId) => {\n\t\t\t\treturn this.$store.getters['files/get'](fileId);\n\t\t\t});\n\t\t},\n\t\tfilesCount(): number\n\t\t{\n\t\t\treturn this.files.length;\n\t\t},\n\t\tfirstFile(): ?ImModelFile\n\t\t{\n\t\t\treturn this.files[0];\n\t\t},\n\t\tfirstFileId(): ?ImModelFile['id']\n\t\t{\n\t\t\treturn this.firstFile?.id;\n\t\t},\n\t\thasText(): boolean\n\t\t{\n\t\t\treturn this.message.text.length > 0;\n\t\t},\n\t\thasAttach(): boolean\n\t\t{\n\t\t\treturn this.message.attach.length > 0;\n\t\t},\n\t\tonlyMedia(): boolean\n\t\t{\n\t\t\treturn !this.hasText && !this.hasAttach;\n\t\t},\n\t\tisSingleVideo(): boolean\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.filesCount === 1\n\t\t\t\t&& this.firstFile.type === FileType.video\n\t\t\t);\n\t\t},\n\t},\n\tmethods: {\n\t\tonCancel(event)\n\t\t{\n\t\t\tthis.$emit('cancelClick', event);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-message-media-content__container\">\n\t\t\t<div v-if=\"isSingleVideo\" class=\"bx-im-message-media-content__single-video\">\n\t\t\t\t<VideoItem\n\t\t\t\t\t:id=\"firstFileId\"\n\t\t\t\t\t:message=\"message\"\n\t\t\t\t\t@cancelClick=\"onCancel\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div v-else class=\"bx-im-message-media-content__gallery\">\n\t\t\t\t<MediaGallery\n\t\t\t\t\t:files=\"files\"\n\t\t\t\t\t:handleLoading=\"true\"\n\t\t\t\t\t@cancelClick=\"onCancel\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div v-if=\"onlyMedia\" class=\"bx-im-message-media-content__status-container\">\n\t\t\t\t<MessageStatus :item=\"message\" :isOverlay=\"true\" />\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\n\nimport {\n\tMessageStatus,\n\tReactionList,\n\tDefaultMessageContent,\n\tMessageHeader,\n\tMessageFooter,\n} from 'im.v2.component.message.elements';\nimport { BaseMessage } from 'im.v2.component.message.base';\nimport { ChatType } from 'im.v2.const';\n\nimport { MediaContent } from './media-content';\n\nimport '../css/media-message.css';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelMessage, ImModelChat } from 'im.v2.model';\n\nconst MAX_GALLERY_WIDTH = 305;\nconst MAX_SINGLE_MEDIA_WIDTH = 488;\nconst MAX_SINGLE_MEDIA_WITH_TEXT_WIDTH = 305;\n\n// @vue/component\nexport const MediaMessage = {\n\tname: 'MediaMessage',\n\tcomponents: {\n\t\tReactionList,\n\t\tBaseMessage,\n\t\tMessageStatus,\n\t\tDefaultMessageContent,\n\t\tMessageHeader,\n\t\tMessageFooter,\n\t\tMediaContent,\n\t},\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\twithTitle: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t},\n\temits: ['cancelClick'],\n\tcomputed:\n\t{\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tfileIds(): number[]\n\t\t{\n\t\t\treturn this.message.files;\n\t\t},\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId);\n\t\t},\n\t\thasText(): boolean\n\t\t{\n\t\t\treturn this.message.text.length > 0;\n\t\t},\n\t\thasAttach(): boolean\n\t\t{\n\t\t\treturn this.message.attach.length > 0;\n\t\t},\n\t\thasReply(): boolean\n\t\t{\n\t\t\treturn this.message.replyId !== 0;\n\t\t},\n\t\thasError(): boolean\n\t\t{\n\t\t\treturn this.message.error;\n\t\t},\n\t\tshowContextMenu(): boolean\n\t\t{\n\t\t\treturn this.onlyImage;\n\t\t},\n\t\tshowBottomContainer(): boolean\n\t\t{\n\t\t\treturn this.hasText || this.hasAttach || this.hasReply;\n\t\t},\n\t\tisForward(): boolean\n\t\t{\n\t\t\treturn Type.isStringFilled(this.message.forward.id);\n\t\t},\n\t\tneedBackground(): boolean\n\t\t{\n\t\t\treturn this.showBottomContainer || this.isChannelPost || this.isForward;\n\t\t},\n\t\tisChannelPost(): boolean\n\t\t{\n\t\t\treturn [ChatType.channel, ChatType.openChannel].includes(this.dialog.type);\n\t\t},\n\t\timageContainerStyles(): JsonObject\n\t\t{\n\t\t\tlet maxWidth = MAX_SINGLE_MEDIA_WIDTH;\n\t\t\tif (this.fileIds.length > 1)\n\t\t\t{\n\t\t\t\tmaxWidth = MAX_GALLERY_WIDTH;\n\t\t\t}\n\n\t\t\tif (this.hasText)\n\t\t\t{\n\t\t\t\tmaxWidth = MAX_SINGLE_MEDIA_WITH_TEXT_WIDTH;\n\n\t\t\t\treturn {\n\t\t\t\t\t'max-width': `${maxWidth}px`,\n\t\t\t\t\t'min-width': `${maxWidth}px`,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn { 'max-width': `${maxWidth}px` };\n\t\t},\n\t},\n\tmethods: {\n\t\tonCancel(event)\n\t\t{\n\t\t\tthis.$emit('cancelClick', event);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BaseMessage \n\t\t\t:item=\"item\" \n\t\t\t:dialogId=\"dialogId\" \n\t\t\t:withBackground=\"needBackground\"\n\t\t>\n\t\t\t<div \n\t\t\t\tclass=\"bx-im-message-image__container\"\n\t\t\t\t:class=\"{\n\t\t\t\t\t'--has-text': hasText,\n\t\t\t\t}\"\n\t\t\t\t:style=\"imageContainerStyles\"\n\t\t\t>\n\t\t\t\t<MessageHeader :withTitle=\"false\" :item=\"item\" class=\"bx-im-message-image__header\" />\n\t\t\t\t<MediaContent \n\t\t\t\t\t:item=\"message\"\n\t\t\t\t\t@cancelClick=\"onCancel\"\n\t\t\t\t/>\n\t\t\t\t<div v-if=\"showBottomContainer\" class=\"bx-im-message-image__bottom-container\">\n\t\t\t\t\t<DefaultMessageContent\n\t\t\t\t\t\t:item=\"item\"\n\t\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t\t:withText=\"hasText\"\n\t\t\t\t\t\t:withAttach=\"hasAttach\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<MessageFooter :item=\"item\" :dialogId=\"dialogId\" />\n\t\t\t</div>\n\t\t\t<template #after-message>\n\t\t\t\t<div v-if=\"!showBottomContainer\" class=\"bx-im-message-image__reaction-list-container\">\n\t\t\t\t\t<ReactionList :messageId=\"message.id\" :contextDialogId=\"dialogId\" />\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</BaseMessage>\n\t`,\n};\n","import { Loc } from 'main.core';\n\nimport { DiskService } from 'im.v2.provider.service.disk';\nimport { BaseMenu } from 'im.v2.lib.menu';\nimport { Utils } from 'im.v2.lib.utils';\nimport { PopupType } from 'im.v2.const';\nimport { Notifier } from 'im.v2.lib.notifier';\n\nimport type { MenuItem } from 'im.v2.lib.menu';\nimport type { ImModelFile, ImModelMessage } from 'im.v2.model';\n\nexport class BaseFileContextMenu extends BaseMenu\n{\n\tcontext: ImModelMessage & {dialogId: string, fileId: number};\n\n\tid: String = PopupType.messageBaseFileMenu;\n\tdiskService: DiskService;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.id = 'bx-im-message-file-context-menu';\n\t\tthis.diskService = new DiskService();\n\t}\n\n\tgetMenuItems(): Array\n\t{\n\t\treturn [\n\t\t\tthis.getDownloadFileItem(),\n\t\t\tthis.getSaveToDiskItem(),\n\t\t];\n\t}\n\n\tgetDownloadFileItem(): ?MenuItem\n\t{\n\t\tconst file = this.#getMessageFile();\n\t\tif (!file)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\thtml: Utils.file.createDownloadLink(\n\t\t\t\tLoc.getMessage('IM_MESSAGE_FILE_MENU_DOWNLOAD_FILE'),\n\t\t\t\tfile.urlDownload,\n\t\t\t\tfile.name,\n\t\t\t),\n\t\t\tonclick: function() {\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this),\n\t\t};\n\t}\n\n\tgetSaveToDiskItem(): ?MenuItem\n\t{\n\t\tconst file = this.#getMessageFile();\n\t\tif (!file)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_MESSAGE_FILE_MENU_SAVE_ON_DISK_MSGVER_1'),\n\t\t\tonclick: async function() {\n\t\t\t\tthis.menuInstance.close();\n\t\t\t\tawait this.diskService.save(this.context.files);\n\t\t\t\tNotifier.file.onDiskSaveComplete();\n\t\t\t}.bind(this),\n\t\t};\n\t}\n\n\t#getMessageFile(): ?ImModelFile\n\t{\n\t\tif (!this.context.fileId)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.store.getters['files/get'](this.context.fileId);\n\t}\n}\n","import 'ui.icons.disk';\nimport { Type } from 'main.core';\n\nimport { FileViewerContext } from 'im.v2.const';\nimport { Utils } from 'im.v2.lib.utils';\nimport { ProgressBar } from\t'im.v2.component.elements.progressbar';\n\nimport { BaseFileContextMenu } from '../../classes/base-file-context-menu';\n\nimport '../../css/items/base-file.css';\n\nimport type { ImModelFile } from 'im.v2.model';\n\n// @vue/component\nexport const BaseFileItem = {\n\tname: 'BaseFileItem',\n\tcomponents: { ProgressBar },\n\tprops:\n\t{\n\t\tid: {\n\t\t\ttype: [String, Number],\n\t\t\trequired: true,\n\t\t},\n\t\tmessageId: {\n\t\t\ttype: [String, Number],\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['cancelClick'],\n\tcomputed:\n\t{\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.$store.getters['files/get'](this.id, true);\n\t\t},\n\t\tfileShortName(): string\n\t\t{\n\t\t\tconst NAME_MAX_LENGTH = 20;\n\n\t\t\treturn Utils.file.getShortFileName(this.file.name, NAME_MAX_LENGTH);\n\t\t},\n\t\tfileSize(): string\n\t\t{\n\t\t\treturn Utils.file.formatFileSize(this.file.size);\n\t\t},\n\t\ticonClass(): string\n\t\t{\n\t\t\tconst iconType = Utils.file.getIconTypeByFilename(this.file.name);\n\n\t\t\treturn `ui-icon-file-${iconType}`;\n\t\t},\n\t\tcanBeOpenedWithViewer(): boolean\n\t\t{\n\t\t\treturn this.file.viewerAttrs && BX.UI?.Viewer;\n\t\t},\n\t\tviewerAttributes(): Object\n\t\t{\n\t\t\treturn Utils.file.getViewerDataAttributes({\n\t\t\t\tviewerAttributes: this.file.viewerAttrs,\n\t\t\t\tpreviewImageSrc: this.file.urlPreview,\n\t\t\t\tcontext: FileViewerContext.dialog,\n\t\t\t});\n\t\t},\n\t\tisLoaded(): boolean\n\t\t{\n\t\t\treturn this.file.progress === 100;\n\t\t},\n\t\timageStyles(): {backgroundImage: string}\n\t\t{\n\t\t\treturn {\n\t\t\t\tbackgroundImage: `url(${this.file.urlPreview})`,\n\t\t\t};\n\t\t},\n\t\thasPreview(): boolean\n\t\t{\n\t\t\treturn Type.isStringFilled(this.file.urlPreview);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.contextMenu = new BaseFileContextMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tdownload()\n\t\t{\n\t\t\tif (this.file.progress !== 100 || this.canBeOpenedWithViewer)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\twindow.open(this.file.urlDownload, '_blank');\n\t\t},\n\t\tloc(phraseCode: string, replacements: {[string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\topenContextMenu(event: PointerEvent)\n\t\t{\n\t\t\tthis.$emit('openContextMenu', {\n\t\t\t\tevent,\n\t\t\t\tfileId: this.id,\n\t\t\t});\n\t\t},\n\t\tonCancelClick(event)\n\t\t{\n\t\t\tthis.$emit('cancelClick', event);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-base-file-item__container\">\n\t\t\t<div class=\"bx-im-base-file-item__viewer-container\" v-bind=\"viewerAttributes\" @click=\"download\">\n\t\t\t\t<div class=\"bx-im-base-file-item__icon-container\" ref=\"loader-icon\">\n\t\t\t\t\t<ProgressBar \n\t\t\t\t\t\tv-if=\"!isLoaded\" \n\t\t\t\t\t\t:item=\"file\"\n\t\t\t\t\t\t:withLabels=\"false\"\n\t\t\t\t\t\t@cancelClick=\"onCancelClick\"\n\t\t\t\t\t/>\n\t\t\t\t<div v-if=\"hasPreview\" :style=\"imageStyles\" class=\"bx-im-base-file-item__image\"></div>\n\t\t\t\t\t<div v-else :class=\"iconClass\" class=\"bx-im-base-file-item__type-icon ui-icon\"><i></i></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-base-file-item__content\">\n\t\t\t\t\t<span :title=\"file.name\" class=\"bx-im-base-file-item__title\">\n\t\t\t\t\t\t{{ fileShortName }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<div class=\"bx-im-base-file-item__size\">{{ fileSize }}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div \n\t\t\t\tclass=\"bx-im-base-file-item__download-icon\"\n\t\t\t\t:class=\"{'--not-active': !isLoaded}\"\n\t\t\t\t@click=\"openContextMenu\"\n\t\t\t></div>\n\t\t</div>\n\t`,\n};\n","import { DefaultMessageContent, MessageHeader, MessageFooter } from 'im.v2.component.message.elements';\nimport { BaseMessage } from 'im.v2.component.message.base';\nimport { FileType } from 'im.v2.const';\n\nimport { BaseFileContextMenu } from '../classes/base-file-context-menu';\nimport { BaseFileItem } from './items/base-file';\n\nimport '../css/base-file-message.css';\n\nimport type { ImModelMessage, ImModelFile } from 'im.v2.model';\n\n// @vue/component\nexport const BaseFileMessage = {\n\tname: 'BaseFileMessage',\n\tcomponents: {\n\t\tBaseMessage,\n\t\tDefaultMessageContent,\n\t\tBaseFileItem,\n\t\tMessageHeader,\n\t\tMessageFooter,\n\t},\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\twithTitle: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t},\n\temits: ['cancelClick'],\n\tcomputed:\n\t{\n\t\tFileType: () => FileType,\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tmessageFile(): ImModelFile\n\t\t{\n\t\t\tconst firstFileId = this.message.files[0];\n\n\t\t\treturn this.$store.getters['files/get'](firstFileId, true);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.contextMenu = new BaseFileContextMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonOpenContextMenu({ event, fileId }: { event: PointerEvent, fileId: number })\n\t\t{\n\t\t\tconst context = { dialogId: this.dialogId, fileId, ...this.message };\n\t\t\tthis.contextMenu.openMenu(context, event.target);\n\t\t},\n\t\tonCancel(event)\n\t\t{\n\t\t\tthis.$emit('cancelClick', event);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BaseMessage :item=\"item\" :dialogId=\"dialogId\">\n\t\t\t<div class=\"bx-im-message-base-file__container\">\n\t\t\t\t<MessageHeader :withTitle=\"withTitle\" :item=\"item\" class=\"bx-im-message-base-file__author-title\" />\n\t\t\t\t<BaseFileItem\n\t\t\t\t\t:key=\"messageFile.id\"\n\t\t\t\t\t:id=\"messageFile.id\"\n\t\t\t\t\t:messageId=\"message.id\"\n\t\t\t\t\t@openContextMenu=\"onOpenContextMenu\"\n\t\t\t\t\t@cancelClick=\"onCancel\"\n\t\t\t\t/>\n\t\t\t\t<DefaultMessageContent :item=\"item\" :dialogId=\"dialogId\" />\n\t\t\t</div>\n\t\t\t<MessageFooter :item=\"item\" :dialogId=\"dialogId\" />\n\t\t</BaseMessage>\n\t`,\n};\n","import { AudioPlayer } from 'im.v2.component.elements.audioplayer';\nimport { ProgressBar } from 'im.v2.component.elements.progressbar';\n\nimport '../../css/items/audio.css';\n\nimport type { ImModelFile } from 'im.v2.model';\n\n// @vue/component\nexport const AudioItem = {\n\tname: 'AudioItem',\n\tcomponents: { AudioPlayer, ProgressBar },\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tmessageType: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tmessageId: {\n\t\t\ttype: [String, Number],\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['cancelClick'],\n\tcomputed: {\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tisLoaded(): boolean\n\t\t{\n\t\t\treturn this.file.progress === 100;\n\t\t},\n\t},\n\tmethods: {\n\t\tonCancelClick(event)\n\t\t{\n\t\t\tthis.$emit('onCancel', event);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-media-audio__container\">\n\t\t\t<ProgressBar \n\t\t\t\tv-if=\"!isLoaded\" \n\t\t\t\t:item=\"file\" \n\t\t\t\t@cancelClick=\"onCancelClick\"\n\t\t\t/>\n\t\t\t<AudioPlayer\n\t\t\t\t:id=\"file.id\"\n\t\t\t\t:messageId=\"messageId\"\n\t\t\t\t:src=\"file.urlDownload\"\n\t\t\t\t:file=\"file\"\n\t\t\t\t:timelineType=\"Math.floor(Math.random() * 5)\"\n\t\t\t\t:authorId=\"file.authorId\"\n\t\t\t\t:withContextMenu=\"false\"\n\t\t\t\t:withAvatar=\"false\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\n\nimport { DefaultMessageContent, MessageHeader, MessageFooter } from 'im.v2.component.message.elements';\nimport { BaseMessage } from 'im.v2.component.message.base';\nimport { FileType, MessageType } from 'im.v2.const';\n\nimport { AudioItem } from './items/audio';\n\nimport '../css/audio-message.css';\n\nimport type { ImModelMessage, ImModelFile } from 'im.v2.model';\n\n// @vue/component\nexport const AudioMessage = {\n\tname: 'AudioMessage',\n\tcomponents: {\n\t\tBaseMessage,\n\t\tMessageHeader,\n\t\tMessageFooter,\n\t\tDefaultMessageContent,\n\t\tAudioItem,\n\t},\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\twithTitle: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['cancelClick'],\n\tcomputed:\n\t{\n\t\tFileType: () => FileType,\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tmessageFile(): ImModelFile\n\t\t{\n\t\t\tconst firstFileId = this.message.files[0];\n\n\t\t\treturn this.$store.getters['files/get'](firstFileId, true);\n\t\t},\n\t\tcanSetReactions(): boolean\n\t\t{\n\t\t\treturn Type.isNumber(this.message.id);\n\t\t},\n\t\tmessageType(): $Values<typeof MessageType>\n\t\t{\n\t\t\treturn this.$store.getters['messages/getMessageType'](this.message.id);\n\t\t},\n\t},\n\tmethods: {\n\t\tonCancel(event)\n\t\t{\n\t\t\tthis.$emit('cancelClick', event);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BaseMessage :item=\"item\" :dialogId=\"dialogId\">\n\t\t\t<div class=\"bx-im-message-audio__container\">\n\t\t\t\t<MessageHeader :withTitle=\"withTitle\" :item=\"item\" class=\"bx-im-message-audio__header\"/>\n\t\t\t\t<AudioItem\n\t\t\t\t\t:key=\"messageFile.id\"\n\t\t\t\t\t:item=\"messageFile\"\n\t\t\t\t\t:messageId=\"message.id\"\n\t\t\t\t\t:messageType=\"messageType\"\n\t\t\t\t\t@cancelClick=\"onCancel\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-message-audio__default-message-container\">\n\t\t\t\t<DefaultMessageContent :item=\"item\" :dialogId=\"dialogId\" />\n\t\t\t</div>\n\t\t\t<MessageFooter :item=\"item\" :dialogId=\"dialogId\" />\n\t\t</BaseMessage>\n\t`,\n};\n","import { DefaultMessageContent, MessageHeader, MessageFooter } from 'im.v2.component.message.elements';\nimport { BaseMessage } from 'im.v2.component.message.base';\nimport { FileType } from 'im.v2.const';\n\nimport { BaseFileContextMenu } from '../classes/base-file-context-menu';\nimport { BaseFileItem } from './items/base-file';\n\nimport '../css/file-collection-message.css';\n\nimport type { ImModelMessage } from 'im.v2.model';\n\nconst FILES_LIMIT = 10;\n\n// @vue/component\nexport const FileCollectionMessage = {\n\tname: 'FileCollectionMessage',\n\tcomponents: {\n\t\tBaseMessage,\n\t\tDefaultMessageContent,\n\t\tBaseFileItem,\n\t\tMessageHeader,\n\t\tMessageFooter,\n\t},\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\twithTitle: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t},\n\temits: ['cancelClick'],\n\tcomputed:\n\t{\n\t\tFileType: () => FileType,\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tmessageId(): string | number\n\t\t{\n\t\t\treturn this.message.id;\n\t\t},\n\t\tfileIds(): number[]\n\t\t{\n\t\t\treturn this.message.files.slice(0, FILES_LIMIT);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.contextMenu = new BaseFileContextMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonOpenContextMenu({ event, fileId }: { event: PointerEvent, fileId: number })\n\t\t{\n\t\t\tconst context = { dialogId: this.dialogId, fileId, ...this.message };\n\t\t\tthis.contextMenu.openMenu(context, event.target);\n\t\t},\n\t\tonCancel(event)\n\t\t{\n\t\t\tthis.$emit('cancelClick', event);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BaseMessage :item=\"item\" :dialogId=\"dialogId\">\n\t\t\t<div class=\"bx-im-message-file-collection__container\">\n\t\t\t\t<MessageHeader :withTitle=\"withTitle\" :item=\"item\" class=\"bx-im-message-file-collection__author-title\" />\n\t\t\t\t<div class=\"bx-im-message-file-collection__items\">\n\t\t\t\t\t<BaseFileItem\n\t\t\t\t\t\tv-for=\"fileId in fileIds\"\n\t\t\t\t\t\t:key=\"fileId\"\n\t\t\t\t\t\t:id=\"fileId\"\n\t\t\t\t\t\t:messageId=\"messageId\"\n\t\t\t\t\t\t@openContextMenu=\"onOpenContextMenu\"\n\t\t\t\t\t\t@cancelClick=\"onCancel\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<DefaultMessageContent \n\t\t\t\t\t:item=\"item\" \n\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\tclass=\"bx-im-message-file-collection__default-content\" \n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<MessageFooter :item=\"item\" :dialogId=\"dialogId\" />\n\t\t</BaseMessage>\n\t`,\n};\n","import { Type } from 'main.core';\nimport { FileType } from 'im.v2.const';\nimport { UnsupportedMessage } from 'im.v2.component.message.unsupported';\nimport { Utils } from 'im.v2.lib.utils';\nimport { UploadingService } from 'im.v2.provider.service.uploading';\nimport { UploaderFile } from 'ui.uploader.core';\n\nimport { MediaMessage } from './components/media-message';\nimport { BaseFileMessage } from './components/base-file-message';\nimport { AudioMessage } from './components/audio-message';\nimport { FileCollectionMessage } from './components/file-collection-message';\nimport { MediaContent } from './components/media-content';\n\nimport type { ImModelMessage, ImModelFile, ImModelChat } from 'im.v2.model';\n\nconst FileMessageType = Object.freeze({\n\tmedia: 'MediaMessage',\n\taudio: 'AudioMessage',\n\tbase: 'BaseFileMessage',\n\tcollection: 'FileCollectionMessage',\n});\n\n// @vue/component\nexport const FileMessage = {\n\tname: 'FileMessage',\n\tcomponents: {\n\t\tBaseFileMessage,\n\t\tMediaMessage,\n\t\tAudioMessage,\n\t\tUnsupportedMessage,\n\t\tFileCollectionMessage,\n\t},\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\twithTitle: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tFileType: () => FileType,\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.$store.getters['messages/getById'](this.item.id);\n\t\t},\n\t\tmessageFiles(): ImModelFile[]\n\t\t{\n\t\t\tconst files = [];\n\n\t\t\tif (this.message.files.length === 0)\n\t\t\t{\n\t\t\t\treturn files;\n\t\t\t}\n\n\t\t\tthis.message.files.forEach((fileId: number) => {\n\t\t\t\tconst file: ImModelFile = this.$store.getters['files/get'](fileId, true);\n\t\t\t\tfiles.push(file);\n\t\t\t});\n\n\t\t\treturn files;\n\t\t},\n\t\tisGallery(): boolean\n\t\t{\n\t\t\tconst allowedGalleryTypes: Set<string> = new Set([FileType.image, FileType.video]);\n\t\t\tconst isMediaOnly: boolean = this.messageFiles.every((file) => {\n\t\t\t\treturn allowedGalleryTypes.has(file.type);\n\t\t\t});\n\t\t\tconst hasImageProp: boolean = this.messageFiles.some((file) => {\n\t\t\t\treturn file.image !== false;\n\t\t\t});\n\n\t\t\treturn isMediaOnly && hasImageProp;\n\t\t},\n\t\tcomponentName(): string\n\t\t{\n\t\t\tif (this.messageFiles.length > 1)\n\t\t\t{\n\t\t\t\treturn this.isGallery ? FileMessageType.media : FileMessageType.collection;\n\t\t\t}\n\n\t\t\tconst file = this.messageFiles[0];\n\t\t\tconst hasPreview = Boolean(file.image);\n\n\t\t\tif (file.type === FileType.image && hasPreview)\n\t\t\t{\n\t\t\t\treturn FileMessageType.media;\n\t\t\t}\n\n\t\t\tif (file.type === FileType.audio)\n\t\t\t{\n\t\t\t\treturn FileMessageType.audio;\n\t\t\t}\n\n\t\t\t// file.type value is empty for mkv files\n\t\t\tconst isVideo = file.type === FileType.video || Utils.file.getFileExtension(file.name) === 'mkv';\n\t\t\tif (isVideo && hasPreview)\n\t\t\t{\n\t\t\t\treturn FileMessageType.media;\n\t\t\t}\n\n\t\t\treturn FileMessageType.base;\n\t\t},\n\t\tisRealMessage(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['messages/isRealMessage'](this.message.id);\n\t\t},\n\t},\n\tmethods: {\n\t\tonCancel(event: { file: ImModelFile })\n\t\t{\n\t\t\tconst canceledFileId: string = event.file.id;\n\t\t\tconst uploadingService: UploadingService = UploadingService.getInstance();\n\t\t\tconst uploaderId: string = uploadingService.getUploaderIdByFileId(canceledFileId);\n\n\t\t\tuploadingService.removeFileFromUploader({\n\t\t\t\tuploaderId,\n\t\t\t\tfilesIds: [canceledFileId],\n\t\t\t\trestartUploading: true,\n\t\t\t});\n\n\t\t\tconst uploaderFiles: Array<UploaderFile> = uploadingService.getFiles(uploaderId);\n\t\t\tif (Type.isArrayFilled(uploaderFiles))\n\t\t\t{\n\t\t\t\tconst actualMessageFiles: Array<string> = uploaderFiles.map((file: UploaderFile) => {\n\t\t\t\t\treturn file.getId();\n\t\t\t\t});\n\n\t\t\t\tvoid this.$store.dispatch('messages/update', {\n\t\t\t\t\tid: this.message.id,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tfiles: actualMessageFiles,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst chatId: number = this.message.chatId;\n\t\t\t\tvoid this.$store.dispatch('messages/delete', { id: this.message.id });\n\n\t\t\t\tconst chat: ImModelChat = this.$store.getters['chats/getByChatId'](chatId);\n\t\t\t\tconst lastMessageId: string | number | null = this.$store.getters['messages/findLastChatMessageId'](chatId);\n\n\t\t\t\tif (Type.isString(lastMessageId) || Type.isNumber(lastMessageId))\n\t\t\t\t{\n\t\t\t\t\tvoid this.$store.dispatch('recent/update', {\n\t\t\t\t\t\tid: chat.dialogId,\n\t\t\t\t\t\tfields: { messageId: lastMessageId },\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tvoid this.$store.dispatch('recent/delete', {\n\t\t\t\t\t\tid: chat.dialogId,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<component \n\t\t\t:is=\"componentName\" \n\t\t\t:item=\"message\" \n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:withTitle=\"withTitle\" \n\t\t\t:withContextMenu=\"isRealMessage\"\n\t\t\t@cancelClick=\"onCancel\"\n\t\t/>\n\t`,\n};\n\nexport { MediaContent };\n"],"names":["VIDEO_SIZE_TO_AUTOPLAY","MAX_WIDTH","MAX_HEIGHT","MIN_WIDTH","MIN_HEIGHT","DEFAULT_WIDTH","DEFAULT_HEIGHT","VideoItem","name","components","VideoPlayer","ProgressBar","props","id","type","String","Number","required","message","Object","emits","computed","messageItem","file","$store","getters","autoplay","size","canBeOpenedWithViewer","viewerAttrs","BX","UI","Viewer","viewerAttributes","Utils","getViewerDataAttributes","previewImageSrc","urlPreview","context","FileViewerContext","dialog","imageSize","newWidth","image","width","newHeight","height","aspectRatio","Math","round","sizes","max","isLoaded","progress","isForward","Type","isStringFilled","forward","methods","download","window","open","urlDownload","onCancelClick","event","$emit","template","MediaContent","MessageStatus","MediaGallery","item","files","map","fileId","filesCount","length","firstFile","firstFileId","hasText","text","hasAttach","attach","onlyMedia","isSingleVideo","FileType","video","onCancel","MAX_GALLERY_WIDTH","MAX_SINGLE_MEDIA_WIDTH","MAX_SINGLE_MEDIA_WITH_TEXT_WIDTH","MediaMessage","ReactionList","BaseMessage","DefaultMessageContent","MessageHeader","MessageFooter","dialogId","withTitle","Boolean","default","fileIds","hasReply","replyId","hasError","error","showContextMenu","onlyImage","showBottomContainer","needBackground","isChannelPost","ChatType","channel","openChannel","includes","imageContainerStyles","maxWidth","BaseFileContextMenu","BaseMenu","constructor","PopupType","messageBaseFileMenu","diskService","DiskService","getMenuItems","getDownloadFileItem","getSaveToDiskItem","html","createDownloadLink","Loc","getMessage","onclick","menuInstance","close","bind","save","Notifier","onDiskSaveComplete","store","BaseFileItem","messageId","fileShortName","NAME_MAX_LENGTH","getShortFileName","fileSize","formatFileSize","iconClass","iconType","getIconTypeByFilename","imageStyles","backgroundImage","hasPreview","created","contextMenu","beforeUnmount","destroy","loc","phraseCode","replacements","$Bitrix","openContextMenu","BaseFileMessage","messageFile","onOpenContextMenu","openMenu","target","AudioItem","AudioPlayer","messageType","AudioMessage","canSetReactions","isNumber","FILES_LIMIT","FileCollectionMessage","slice","FileMessageType","freeze","media","audio","base","collection","FileMessage","UnsupportedMessage","messageFiles","forEach","push","isGallery","allowedGalleryTypes","Set","isMediaOnly","every","has","hasImageProp","some","componentName","isVideo","getFileExtension","isRealMessage","canceledFileId","uploadingService","UploadingService","getInstance","uploaderId","getUploaderIdByFileId","removeFileFromUploader","filesIds","restartUploading","uploaderFiles","getFiles","isArrayFilled","actualMessageFiles","getId","dispatch","fields","chatId","chat","lastMessageId","isString"],"mappings":"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"}