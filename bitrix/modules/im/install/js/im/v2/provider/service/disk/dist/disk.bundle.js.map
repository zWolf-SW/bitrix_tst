{"version":3,"file":"disk.bundle.js","sources":["../src/disk.js"],"sourcesContent":["import { RestClient } from 'rest.client';\n\nimport { runAction } from 'im.v2.lib.rest';\nimport { Core } from 'im.v2.application.core';\nimport { RestMethod } from 'im.v2.const';\n\ntype FileId = number | string;\n\nexport class DiskService\n{\n\t#restClient: RestClient;\n\n\tconstructor()\n\t{\n\t\tthis.#restClient = Core.getRestClient();\n\t}\n\n\tdelete({ chatId, fileId }): Promise\n\t{\n\t\tconst queryParams = { chat_id: chatId, file_id: fileId };\n\n\t\treturn this.#restClient.callMethod(RestMethod.imDiskFileDelete, queryParams)\n\t\t\t.catch((result: RestResult) => {\n\t\t\t\tconsole.error('DiskService: error deleting file', result.error());\n\t\t\t});\n\t}\n\n\tasync save(fileIds: FileId[]): Promise\n\t{\n\t\tconst normalizedIds = fileIds.map((id) => Number.parseInt(id, 10));\n\n\t\treturn runAction(RestMethod.imV2DiskFileSave, {\n\t\t\tdata: { ids: normalizedIds },\n\t\t}).catch(([error]) => {\n\t\t\tconsole.error('DiskService: error saving file on disk', error);\n\t\t\tthrow error;\n\t\t});\n\t}\n}\n"],"names":["DiskService","constructor","Core","getRestClient","delete","chatId","fileId","queryParams","chat_id","file_id","callMethod","RestMethod","imDiskFileDelete","catch","result","console","error","save","fileIds","normalizedIds","map","id","Number","parseInt","runAction","imV2DiskFileSave","data","ids"],"mappings":";;;;;;;CAIyC;AAIzC,CAAO,MAAMA,WAAW,CACxB;GAGCC,WAAW,GACX;KAAA;OAAA;OAAA;;KACC,4CAAI,8BAAeC,2BAAI,CAACC,aAAa,EAAE;;GAGxCC,MAAM,CAAC;KAAEC,MAAM;KAAEC;IAAQ,EACzB;KACC,MAAMC,WAAW,GAAG;OAAEC,OAAO,EAAEH,MAAM;OAAEI,OAAO,EAAEH;MAAQ;KAExD,OAAO,4CAAI,4BAAaI,UAAU,CAACC,sBAAU,CAACC,gBAAgB,EAAEL,WAAW,CAAC,CAC1EM,KAAK,CAAEC,MAAkB,IAAK;OAC9BC,OAAO,CAACC,KAAK,CAAC,kCAAkC,EAAEF,MAAM,CAACE,KAAK,EAAE,CAAC;MACjE,CAAC;;GAGJ,MAAMC,IAAI,CAACC,OAAiB,EAC5B;KACC,MAAMC,aAAa,GAAGD,OAAO,CAACE,GAAG,CAAEC,EAAE,IAAKC,MAAM,CAACC,QAAQ,CAACF,EAAE,EAAE,EAAE,CAAC,CAAC;KAElE,OAAOG,wBAAS,CAACb,sBAAU,CAACc,gBAAgB,EAAE;OAC7CC,IAAI,EAAE;SAAEC,GAAG,EAAER;;MACb,CAAC,CAACN,KAAK,CAAC,CAAC,CAACG,KAAK,CAAC,KAAK;OACrBD,OAAO,CAACC,KAAK,CAAC,wCAAwC,EAAEA,KAAK,CAAC;OAC9D,MAAMA,KAAK;MACX,CAAC;;CAEJ;;;;;;;;"}