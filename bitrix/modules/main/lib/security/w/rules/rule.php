<? namespace Bitrix\Main\Security\W\Rules;$GLOBALS['____539989149']= array(base64_decode('aXNfc3Ry'.'aW5n'),base64_decode('c'.'3Ryd'.'G9s'.'b3dlc'.'g'.'=='),base64_decode(''.'a'.'X'.'N'.'fYXJ'.'yY'.'Xk='),base64_decode('aXNfc'.'3RyaW'.'5n'),base64_decode('Z3pkZW'.'NvZG'.'U='),base64_decode('Y'.'m'.'FzZ'.'TY0X2'.'Rl'.'Y29k'.'ZQ='.'='),base64_decode('d'.'XJ'.'s'.'ZGVjb2R'.'l'),base64_decode('Y'.'XJyY'.'Xlf'.'cmV'.'2ZXJzZQ=='),base64_decode('Z3plbmNvZ'.'G'.'U='),base64_decode('Ym'.'F'.'zZTY0X'.'2VuY29kZQ='.'='),base64_decode('dXJsZW5jb2'.'Rl'),base64_decode('Y'.'mluMmhl'.'eA=='),base64_decode(''.'aXN'.'fY'.'XJy'.'YXk='),base64_decode('c3Ry'.'d'.'G9sb3dlcg='.'='),base64_decode('a'.'XN'.'f'.'YX'.'JyYX'.'k='),base64_decode('am'.'9p'.'bg=='),base64_decode('Zm5tYXRjaA=='),base64_decode('c'.'mF'.'3dXJsZGVjb2R'.'l'),base64_decode(''.'c3'.'V'.'ic3Ry'),base64_decode('c'.'3Vic3Ry'),base64_decode('c3Ry'.'X3JlcG'.'x'.'hY2'.'U='),base64_decode(''.'cHJlZ19xdW90'.'ZQ'.'=='),base64_decode('cHJlZ19'.'tYXRj'.'aA='.'='));if(!function_exists(__NAMESPACE__.'\\___872930531')){function ___872930531($_1659434872){static $_1469357491= false; if($_1469357491 == false) $_1469357491=array('YW'.'N0aW9u','aW'.'50dm'.'F'.'s','cGF0aA==',''.'Y2'.'9udGV'.'4dA='.'=','a2V5cw==',''.'cHJvY2Vzcw'.'==','ZW5jb2Rp'.'b'.'mc=','cH'.'Jl'.'Z19yZXBsYWNl',''.'cG'.'F'.'0a'.'A==',''.'Y29udGV4dA==',''.'a2'.'V'.'5cw='.'=','cHJv'.'Y'.'2Vzc'.'w='.'=','Z'.'W'.'5jb2'.'Rpbmc=',''.'cGF'.'0'.'dG'.'V'.'ybg==','cHJlZ19tY'.'XRja'.'A'.'==',''.'cGF0aA==',''.'Y29u'.'dGV4dA==','a2V5cw==',''.'cHJv'.'Y2Vz'.'cw'.'==','ZW5j'.'b2Rpbm'.'c=','cGF'.'0d'.'GVy'.'bg'.'='.'=','cG'.'9'.'zdF'.'9h'.'Y3Rpb24=',''.'Y2hlY'.'2'.'t'.'f'.'Y3'.'NyZ'.'g'.'==','cGF0aA==',''.'Y29udGV'.'4dA==','a2V5cw==','cHJ'.'v'.'Y2Vzcw==','ZW5jb2'.'R'.'pbmc'.'=','cG'.'F0dGV'.'y'.'bg==','Y'.'WN0'.'a'.'W'.'9u','YWN0'.'aW9'.'u','YWN0aW9u','YWN0a'.'W'.'9u','YWN0'.'a'.'W9'.'u','YWN0aW9u','cG'.'9z'.'dF9hY3'.'R'.'pb24=','ZW5jb2Rpbmc'.'=','ZW5jb2R'.'pbmc=','ZW5j'.'b2Rpbmc=','ZW5jb2Rpbmc'.'=','Z'.'W5jb2Rpbmc=','ZW5'.'jb'.'2Rpb'.'m'.'c=',''.'Z3'.'o=','YmFzZTY0','dX'.'Js','aGV4','Lg='.'=','Lw==','a'.'W5k'.'Z'.'XgucGhw','L'.'2luZGV4'.'Ln'.'B'.'ocA==','U0NS'.'SVBUX0'.'5BT'.'U'.'U'.'=','L2l'.'u'.'ZGV4L'.'nB'.'ocA==',''.'U0NSSVBUX05BTU'.'U=','U0NSS'.'VBUX05BTUU'.'=','U0'.'NSSVBU'.'X0'.'5'.'B'.'TUU=',''.'fg==','fl4'.'=','fg==','X'.'H'.'4=','JH4=');return base64_decode($_1469357491[$_1659434872]);}}; use Bitrix\Main\IO\Path; use Bitrix\Main\Web\Uri; use Bitrix\Main\Security\W\Rules\Results\ModifyResult; abstract class Rule{ protected $_1189480671; protected $_1136399971; protected $_2086810165; protected $_791724176; protected $_603938002; public static function make(array $_1631170413):?static{ $_1631170413= static::prepareRuleParameters($_1631170413); return match($_1631170413[___872930531(0)]){ ___872930531(1) => new IntvalRule( $_1631170413[___872930531(2)], $_1631170413[___872930531(3)], $_1631170413[___872930531(4)], $_1631170413[___872930531(5)], $_1631170413[___872930531(6)]), ___872930531(7) => new PregReplaceRule( $_1631170413[___872930531(8)], $_1631170413[___872930531(9)], $_1631170413[___872930531(10)], $_1631170413[___872930531(11)], $_1631170413[___872930531(12)], $_1631170413[___872930531(13)]), ___872930531(14) => new PregMatchRule( $_1631170413[___872930531(15)], $_1631170413[___872930531(16)], $_1631170413[___872930531(17)], $_1631170413[___872930531(18)], $_1631170413[___872930531(19)], $_1631170413[___872930531(20)], $_1631170413[___872930531(21)]), ___872930531(22) => new CsrfRule( $_1631170413[___872930531(23)], $_1631170413[___872930531(24)], $_1631170413[___872930531(25)], $_1631170413[___872930531(26)], $_1631170413[___872930531(27)], $_1631170413[___872930531(28)],), default => null,};} protected static function prepareRuleParameters(array $_328666293): array{ if($GLOBALS['____539989149'][0]($_328666293[___872930531(29)])){ $_328666293[___872930531(30)]= $GLOBALS['____539989149'][1]($_328666293[___872930531(31)]);} elseif($GLOBALS['____539989149'][2]($_328666293[___872930531(32)])){ $_1560353946= $_328666293[___872930531(33)]; $_328666293[___872930531(34)]= $_1560353946[(152*2-304)]; $_328666293[___872930531(35)]= $_1560353946[round(0+0.5+0.5)];} $_328666293[___872930531(36)]=!empty($_328666293[___872930531(37)])? $_328666293[___872930531(38)]:[]; if($GLOBALS['____539989149'][3]($_328666293[___872930531(39)])){ $_328666293[___872930531(40)]=[$_328666293[___872930531(41)]];} return $_328666293;}  public function __construct($_1189480671, $_1136399971, $_2086810165, $_791724176, $_603938002){ $this->_1189480671= $_1189480671; $this->_1136399971= $this->castContext($_1136399971); $this->_2086810165= $this->castKeys($_2086810165); $this->_791724176= $_791724176; $this->_603938002= $_603938002;} public function evaluateValue($_1371920370){ if(!empty($this->_603938002)){ foreach($this->_603938002 as $_1795287479){ $_1371920370= match($_1795287479){ 'gz' => $GLOBALS['____539989149'][4]($_1371920370), 'base64' => $GLOBALS['____539989149'][5]($_1371920370), 'url' => $GLOBALS['____539989149'][6]($_1371920370), 'hex' => hex2bin($_1371920370)};}} $_207824105= $this->evaluate($_1371920370); if(!empty($this->_603938002) && $_207824105 instanceof ModifyResult){ $_306664926= $_207824105->getCleanValue(); foreach($GLOBALS['____539989149'][7]($this->_603938002) as $_1795287479){ $_306664926= match($_1795287479){ ___872930531(42) => $GLOBALS['____539989149'][8]($_306664926), ___872930531(43) => $GLOBALS['____539989149'][9]($_306664926), ___872930531(44) => $GLOBALS['____539989149'][10]($_306664926), ___872930531(45) => $GLOBALS['____539989149'][11]($_306664926)};} $_207824105= new ModifyResult($_306664926);} return $_207824105;} abstract public function evaluate($_1371920370); protected function castContext($_1136399971){ if(!$GLOBALS['____539989149'][12]($_1136399971)){ $_1136399971=[$_1136399971];} foreach($_1136399971 as $_92618956 => $_219641862){ $_1136399971[$_92618956]= $GLOBALS['____539989149'][13]($_219641862);} return $_1136399971;} protected function castKeys($_2086810165){ if(!$GLOBALS['____539989149'][14]($_2086810165)){ $_2086810165=[$_2086810165];} return $_2086810165;} public function matchKey(array $_1409396107): bool{ $_1409396107= $GLOBALS['____539989149'][15](___872930531(46), $_1409396107); foreach($this->_2086810165 as $_379988914){   if($GLOBALS['____539989149'][16]($_379988914, $_1409396107)){ return true;}} return false;}  public function matchPath($_566848377){ if($this->_1189480671 === '*'){ return true;}  $_622500077= new Uri($_566848377); $_1650982544= $_622500077->getPath(); $_1650982544= $GLOBALS['____539989149'][17]($_1650982544);      if(str_ends_with($_1650982544, ___872930531(47))){ $_1650982544 .= ___872930531(48);} $_1650982544= Path::normalize($_1650982544);  $_194052078[]= $_1650982544; if(str_ends_with($_1650982544, ___872930531(49))){ $_194052078[]= $GLOBALS['____539989149'][18]($_1650982544,(1276/2-638),-round(0+2.25+2.25+2.25+2.25));} elseif(str_ends_with($_SERVER[___872930531(50)], ___872930531(51))){ $_194052078[]= $GLOBALS['____539989149'][19]($_SERVER[___872930531(52)],(1216/2-608),-round(0+4.5+4.5));} if($_1650982544 !== $_SERVER[___872930531(53)]){ $_194052078[]= $_SERVER[___872930531(54)];}  if(str_starts_with($this->_1189480671, ___872930531(55))){ $_429115502= $this->_1189480671;} else{ $_429115502= ___872930531(56). $GLOBALS['____539989149'][20](___872930531(57), ___872930531(58), $GLOBALS['____539989149'][21]($this->_1189480671)). ___872930531(59);} foreach($_194052078 as $_460165547){ if($this->_1189480671 === $_460165547 || $GLOBALS['____539989149'][22]($_429115502, $_460165547)){ return true;}} return false;}  public function getPath(){ return $this->_1189480671;}  public function getContext(){ return $this->_1136399971;}  public function getKeys(){ return $this->_2086810165;}  public function getProcess(){ return $this->_791724176;}}?>