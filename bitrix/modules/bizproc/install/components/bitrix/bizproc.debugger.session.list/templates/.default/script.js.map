{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import { Reflection, ajax, Type, Event } from 'main.core';\nimport { Alert, AlertColor } from 'ui.alerts';\nimport { Manager } from 'bizproc.debugger';\n\nconst namespace = Reflection.namespace('BX.Bizproc.Component');\n\nclass DebuggerSessionList\n{\n\tgridId;\n\tcreateDebuggerSessionButton;\n\terrorsContainerDiv;\n\tdocumentSigned;\n\tsignedParameters;\n\n\tconstructor(options)\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tthis.gridId = options.gridId;\n\t\t\tthis.createDebuggerSessionButton = options.createDebuggerSessionButton;\n\t\t\tthis.errorsContainerDiv = options.errorsContainerDiv;\n\t\t\tthis.documentSigned = options.documentSigned;\n\t\t\tthis.signedParameters = options.signedParameters;\n\t\t}\n\t}\n\n\tinit()\n\t{\n\t\tif (this.createDebuggerSessionButton)\n\t\t{\n\t\t\tEvent.bind(this.createDebuggerSessionButton, 'click', event => this.createSession());\n\t\t}\n\t}\n\n\tcreateSession()\n\t{\n\t\tManager.Instance.openDebuggerStartPage(this.documentSigned, {analyticsStartType: 'session_list'}).then();\n\t}\n\n\tshowSession(sessionId: string): void\n\t{\n\t\tManager.Instance.openSessionLog(sessionId).then();\n\t}\n\n\trenameSession(sessionId: string): void\n\t{\n\t\tconst grid = this.getGrid();\n\t\tif (!grid)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst editButton = grid.getActionsPanel().getButtons()\n\t\t\t.find((button) => {\n\t\t\t\treturn button.id === 'grid_edit_button_control';\n\t\t\t});\n\n\t\tif (editButton)\n\t\t{\n\t\t\tgrid.getRows().getById(sessionId)?.select();\n\t\t\teditButton.click();\n\t\t\tgrid.enableActionsPanel();\n\t\t\tgrid.getPinPanel().pinPanel(true);\n\t\t}\n\t}\n\n\tdeleteChosenSessions(): void\n\t{\n\t\tconst grid = this.getGrid();\n\t\tif (grid)\n\t\t{\n\t\t\tthis.deleteSessions(grid.getRows().getSelectedIds());\n\t\t}\n\t}\n\n\tdeleteSessions(sessionIds: Array<string>): void\n\t{\n\t\tajax.runComponentAction('bitrix:bizproc.debugger.session.list', 'deleteSessions', {\n\t\t\tmode: 'class',\n\t\t\tsignedParameters: this.signedParameters,\n\t\t\tdata: {sessionIds},\n\t\t}).then((response) => {\n\t\t\tthis.reloadGrid();\n\t\t}).catch((response) => {\n\t\t\tthis.showErrors(response.errors);\n\t\t});\n\t}\n\n\tshowErrors(errors: Array<{message: string}>)\n\t{\n\t\tthis.errorsContainerDiv.style.margin = '10px';\n\n\t\terrors.forEach((error) => {\n\t\t\tconst alert = new Alert({\n\t\t\t\ttext: error.message,\n\t\t\t\tcolor: AlertColor.DANGER,\n\t\t\t\tcloseBtn: true,\n\t\t\t\tanimated: true,\n\t\t\t});\n\n\t\t\talert.renderTo(this.errorsContainerDiv);\n\t\t});\n\t}\n\n\treloadGrid()\n\t{\n\t\tconst grid = this.getGrid();\n\t\tif (grid)\n\t\t{\n\t\t\tgrid.reload();\n\t\t}\n\t}\n\n\tgetGrid()\n\t{\n\t\tif (this.gridId)\n\t\t{\n\t\t\treturn BX.Main.gridManager && BX.Main.gridManager.getInstanceById(this.gridId);\n\t\t}\n\t\treturn null;\n\t}\n}\n\nnamespace.DebuggerSessionList = DebuggerSessionList;\n"],"names":["namespace","Reflection","DebuggerSessionList","options","Type","isPlainObject","gridId","createDebuggerSessionButton","errorsContainerDiv","documentSigned","signedParameters","Event","bind","event","createSession","Manager","Instance","openDebuggerStartPage","analyticsStartType","then","sessionId","openSessionLog","grid","getGrid","editButton","getActionsPanel","getButtons","find","button","id","getRows","getById","select","click","enableActionsPanel","getPinPanel","pinPanel","deleteSessions","getSelectedIds","sessionIds","ajax","runComponentAction","mode","data","response","reloadGrid","showErrors","errors","style","margin","forEach","error","alert","Alert","text","message","color","AlertColor","DANGER","closeBtn","animated","renderTo","reload","BX","Main","gridManager","getInstanceById"],"mappings":"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"}