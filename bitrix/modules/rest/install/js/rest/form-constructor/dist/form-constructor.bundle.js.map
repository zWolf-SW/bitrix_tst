{"version":3,"file":"form-constructor.bundle.js","sources":["../src/fields/base-field.js","../src/fields/dropdown-list.js","../src/fields/input.js","../src/form-constructor.js"],"sourcesContent":["import { Type, Text, Dom, Tag } from 'main.core';\nimport type { FieldConfig } from '../types';\nimport { EventEmitter } from 'main.core.events';\n\nexport class BaseField extends EventEmitter\n{\n\toptions: FieldConfig;\n\treadySave: boolean;\n\tvalue: any;\n\t#errorBlock: HTMLElement;\n\n\tconstructor(options: FieldConfig)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Rest.EInvoice.Field');\n\t\tthis.options = options;\n\t\tthis.value = this.options.value ?? null;\n\t\tthis.readySave = !(Type.isNil(this.value) || this.value === '');\n\t\tthis.options.id = Type.isStringFilled(this.options.id) ? this.options.id : Text.getRandom(8);\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.options.id;\n\t}\n\n\tgetName(): string\n\t{\n\t\treturn this.options.name;\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\tconst wrapper = Tag.render`\n\t\t\t<div class=\"container\"></div>\n\t\t`;\n\t\tDom.append(this.renderFieldContainer(), wrapper);\n\t\tDom.append(this.renderErrorsContainer(), wrapper);\n\t\tDom.hide(this.renderErrorsContainer());\n\t\tthis.subscribe('error', (event) => {\n\t\t\tconst messages = event.data.messages;\n\t\t\tthis.renderErrorsContainer().innerHTML = Type.isArray(messages) ? messages.join('<br>') : messages;\n\t\t\tDom.show(this.renderErrorsContainer());\n\n\t\t\tif (!Dom.hasClass(wrapper, 'ui-ctl-warning'))\n\t\t\t{\n\t\t\t\tDom.addClass(wrapper, 'ui-ctl-warning');\n\t\t\t}\n\t\t});\n\n\t\treturn wrapper;\n\t}\n\n\trenderFieldContainer(): HTMLElement\n\t{\n\t\tthrow new Error('Must be implemented in a child class');\n\t}\n\n\tisReadySave(): boolean\n\t{\n\t\treturn this.readySave;\n\t}\n\n\trenderErrorsContainer(): HTMLElement\n\t{\n\t\tif (!this.#errorBlock)\n\t\t{\n\t\t\tthis.#errorBlock = Tag.render`\n\t\t\t\t<div class=\"ui-ctl-bottom bitrix-einvoice-error-block\"></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#errorBlock;\n\t}\n\n\tgetValue(): any\n\t{\n\t\treturn this.value;\n\t}\n}\n","import { Dom, Tag, Type, Event } from 'main.core';\nimport type { FieldConfig } from '../types';\nimport { BaseField } from './base-field';\n\nexport class DropdownList extends BaseField\n{\n\tconstructor(options: FieldConfig)\n\t{\n\t\tsuper(options);\n\t\tthis.readySave = true;\n\t}\n\n\trenderFieldContainer(): HTMLElement\n\t{\n\t\tconst wrapper = Tag.render`\n\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown\">\n\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t</div>\n\t\t`;\n\n\t\tif (Type.isArray(this.options.items))\n\t\t{\n\t\t\tconst itemsWrapper = Tag.render`\n\t\t\t\t<select class=\"ui-ctl-element\" id=\"${this.getId()}\" />\n\t\t\t`;\n\t\t\tthis.options.items.forEach((item) => {\n\t\t\t\tconst itemElement = Tag.render`\n\t\t\t\t\t<option value=\"${item.value}\">${item.name}</option>\n\t\t\t\t`;\n\n\t\t\t\tif (this.options.value === item.value)\n\t\t\t\t{\n\t\t\t\t\tDom.attr(itemElement, {\n\t\t\t\t\t\tselected: true,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tDom.append(itemElement, itemsWrapper);\n\t\t\t});\n\t\t\tDom.append(itemsWrapper, wrapper);\n\n\t\t\tEvent.bind(itemsWrapper, 'change', (event) => {\n\t\t\t\tthis.value = event.target.value;\n\t\t\t\tif (Object.prototype.hasOwnProperty.call(this.options, 'updateForm') && this.options.updateForm)\n\t\t\t\t{\n\t\t\t\t\tthis.emit('onFieldChange', {\n\t\t\t\t\t\ttarget: event.target,\n\t\t\t\t\t\tfield: this,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn wrapper;\n\t}\n}\n","import { Dom, Tag, Event, Type } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport { BaseField } from './base-field';\n\nexport class Input extends BaseField\n{\n\trenderFieldContainer(): HTMLElement\n\t{\n\t\tconst wrapper = Tag.render`\n\t\t\t<div class=\"ui-ctl-container\"/>\n\t\t`;\n\n\t\tif (this.options.label)\n\t\t{\n\t\t\tconst inputTitle = Tag.render`\n\t\t\t\t<div class=\"ui-ctl-top\">\n\t\t\t\t\t<div class=\"ui-ctl-title\">${this.options.label}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t\tDom.append(inputTitle, wrapper);\n\t\t}\n\n\t\tconst input = Tag.render`\n\t\t\t<div class=\"ui-ctl ui-ctl-textbox\">\n\t\t\t\t<input type=\"text\" id=\"${this.getId()}\" class=\"ui-ctl-element\">\n\t\t\t</div>\n\t\t`;\n\t\tconst inputElement = input.querySelector('input');\n\n\t\tif (this.options.placeholder)\n\t\t{\n\t\t\tDom.attr(inputElement, {\n\t\t\t\tplaceholder: this.options.placeholder,\n\t\t\t});\n\t\t}\n\n\t\tif (this.options.value)\n\t\t{\n\t\t\tDom.attr(inputElement, {\n\t\t\t\tvalue: this.options.value,\n\t\t\t});\n\t\t}\n\n\t\tEvent.bind(inputElement, 'paste', (event) => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.#onInput(wrapper, event);\n\t\t\t}, 0);\n\t\t});\n\t\tEvent.bind(inputElement, 'input', (event) => {\n\t\t\tthis.#onInput(wrapper, event);\n\t\t});\n\n\t\tDom.append(input, wrapper);\n\n\t\treturn wrapper;\n\t}\n\n\t#onInput(wrapper: HTMLElement, event: BaseEvent): void\n\t{\n\t\tDom.hide(this.renderErrorsContainer());\n\n\t\tif (Dom.hasClass(wrapper, 'ui-ctl-warning'))\n\t\t{\n\t\t\tDom.removeClass(wrapper, 'ui-ctl-warning');\n\t\t}\n\n\t\tif (Type.isNil(event.target.value) || event.target.value === '')\n\t\t{\n\t\t\tthis.emit('onUnreadySave');\n\t\t\tthis.readySave = false;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('onReadySave');\n\t\t\tthis.readySave = true;\n\t\t}\n\n\t\tthis.value = event.target.value;\n\t}\n}\n","import { Dom, Tag, ajax, Type, Text, Loc } from 'main.core';\nimport { StepByStep } from 'ui.stepbystep';\nimport { DropdownList } from './fields/dropdown-list';\nimport { Input } from './fields/input';\nimport { BaseField } from './fields/base-field';\nimport type { SettingsEInvoiceOptions, StepEInvoiceSettingsConfig } from './types';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\n\nexport class FormConstructor extends EventEmitter\n{\n\t#options: SettingsEInvoiceOptions;\n\t#fields: Array<BaseField>;\n\t#stepByStep: StepByStep;\n\n\tconstructor(options: SettingsEInvoiceOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Rest.EInvoice');\n\t\tif (!Type.isArray(options.steps))\n\t\t{\n\t\t\tthrow new Error('Unexpected property type  \"steps\", expected type array');\n\t\t}\n\t\tthis.#options = options;\n\t\tthis.#fields = [];\n\n\t\tthis.#stepByStep = new StepByStep({\n\t\t\tcontent: this.#getContentConfig(),\n\t\t});\n\t}\n\n\tgetFields()\n\t{\n\t\treturn this.#fields;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn this.#stepByStep.getContentWrapper();\n\t}\n\n\trenderTo(target: HTMLElement)\n\t{\n\t\tthis.#stepByStep.target = target;\n\t\tthis.#stepByStep.init();\n\t}\n\n\t#getContentConfig(): Object\n\t{\n\t\tconst contentConfig = [];\n\n\t\tthis.#options.steps.forEach((item) => {\n\t\t\tconst stepConfig = {\n\t\t\t\thtml: [{\n\t\t\t\t\tbackgroundColor: '#ffffff',\n\t\t\t\t}],\n\t\t\t};\n\n\t\t\tif (item.title)\n\t\t\t{\n\t\t\t\tstepConfig.html[0].header = {\n\t\t\t\t\ttitle: item.title,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tstepConfig.html[0].node = this.#getStepContent(item);\n\t\t\tcontentConfig.push(stepConfig);\n\t\t});\n\n\t\treturn contentConfig;\n\t}\n\n\t#getStepContent(stepConfig: StepEInvoiceSettingsConfig): HTMLElement\n\t{\n\t\tconst wrapper = Tag.render`\n\t\t\t<div class=\"bitrix-einvoice-settings-step__wrapper\"></div>\n\t\t`;\n\n\t\tif (stepConfig.description)\n\t\t{\n\t\t\tconst description = Tag.render`\n\t\t\t\t<div class=\"bitrix-einvoice-settings-step__description\">${stepConfig.description}</div>\n\t\t\t`;\n\t\t\tDom.append(description, wrapper);\n\t\t}\n\n\t\tif (stepConfig.fields)\n\t\t{\n\t\t\tstepConfig.fields.forEach((fieldConfig, index) => {\n\t\t\t\tlet field;\n\n\t\t\t\tswitch (fieldConfig.type)\n\t\t\t\t{\n\t\t\t\t\tcase 'input':\n\t\t\t\t\t\tfield = new Input(fieldConfig);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'dropdown-list':\n\t\t\t\t\t\tfield = new DropdownList(fieldConfig);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthrow new Error('Incorrect field type');\n\t\t\t\t}\n\n\t\t\t\tif (field instanceof BaseField)\n\t\t\t\t{\n\t\t\t\t\tfield.subscribe('onReadySave', () => {\n\t\t\t\t\t\tthis.emit('onReadySave');\n\t\t\t\t\t});\n\t\t\t\t\tfield.subscribe('onUnreadySave', () => {\n\t\t\t\t\t\tthis.emit('onUnreadySave');\n\t\t\t\t\t});\n\t\t\t\t\tfield.subscribe('onFieldChange', (event) => {\n\t\t\t\t\t\tthis.emit('onFieldChange', event);\n\t\t\t\t\t});\n\t\t\t\t\tthis.#fields.push(field);\n\t\t\t\t\tconst fieldContent = field.getContent();\n\t\t\t\t\tDom.append(fieldContent, wrapper);\n\n\t\t\t\t\tif (index > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.style(fieldContent, 'margin-top', '12px');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (stepConfig.link && stepConfig.link.url.startsWith('https://'))\n\t\t{\n\t\t\tconst linkArticle = Tag.render`\n\t\t\t\t<div class=\"bitrix-einvoice-settings-step-wrapper-link\">\n\t\t\t\t\t<a href=\"${stepConfig.link.url}\" class=\"bitrix-einvoice-settings-step__link\">${Text.encode(stepConfig.link.name)}</a>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t\tDom.append(linkArticle, wrapper);\n\t\t}\n\n\t\treturn wrapper;\n\t}\n\n\tgetFormData(): Object\n\t{\n\t\tlet result = {};\n\n\t\tthis.#fields.forEach((field) => {\n\t\t\tif (field.isReadySave())\n\t\t\t{\n\t\t\t\tresult[field.getName()] = field.getValue();\n\t\t\t}\n\t\t});\n\n\t\treturn result\n\t}\n\n\t/*\n\terrors = {\n\t\tfieldName: ['error message']\n\t}\n\t */\n\tshowFieldErrors(errors: Object): void\n\t{\n\t\tfor (const [fieldName, messages] of Object.entries(errors)) {\n\t\t\tthis.#fields.forEach((field) => {\n\t\t\t\tif (field.getName() === fieldName)\n\t\t\t\t{\n\t\t\t\t\tfield.emit('error', new BaseEvent({\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tmessages: messages,\n\t\t\t\t\t\t},\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tshowTextInBalloon(text: string):  void\n\t{\n\t\tBX.UI.Notification.Center.notify({\n\t\t\tid: 'einvoice-error-save-settings',\n\t\t\tcontent: Tag.render`\n\t\t\t\t\t\t<div class=\"bitrix-einvoice-settings-notification-wrapper\">\n\t\t\t\t\t\t\t<span class=\"ui-icon-set --warning\"></span>\n\t\t\t\t\t\t\t${text}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`,\n\t\t\tautoHideDelay: 5000,\n\t\t});\n\t}\n}"],"names":["BaseField","EventEmitter","constructor","options","setEventNamespace","value","readySave","Type","isNil","id","isStringFilled","Text","getRandom","getId","getName","name","getContent","wrapper","Tag","render","Dom","append","renderFieldContainer","renderErrorsContainer","hide","subscribe","event","messages","data","innerHTML","isArray","join","show","hasClass","addClass","Error","isReadySave","getValue","DropdownList","items","itemsWrapper","forEach","item","itemElement","attr","selected","Event","bind","target","Object","prototype","hasOwnProperty","call","updateForm","emit","field","Input","label","inputTitle","input","inputElement","querySelector","placeholder","setTimeout","removeClass","FormConstructor","steps","StepByStep","content","getFields","getContentWrapper","renderTo","init","getFormData","result","showFieldErrors","errors","fieldName","entries","BaseEvent","showTextInBalloon","text","BX","UI","Notification","Center","notify","autoHideDelay","contentConfig","stepConfig","html","backgroundColor","title","header","node","push","description","fields","fieldConfig","index","type","fieldContent","style","link","url","startsWith","linkArticle","encode"],"mappings":"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"}