{"version":3,"file":"script.js","sources":["src/js/landing.pub.disk.file.js","src/js/landing.pub.analytics.js","src/js/landing.pub.pseudolinks.js"],"sourcesContent":["\n\nexport class DiskFile\n{\n\t/**\n\t * Constructor.\n\t */\n\tconstructor()\n\t{\n\t\tdocument.addEventListener('click', this.onClick.bind(this));\n\t}\n\n\t/**\n\t * Click callback.\n\t *\n\t * @return {void}\n\t */\n\tonClick(event)\n\t{\n\t\tlet target = event.target;\n\t\tlet href = target.getAttribute('href') || (target.getAttribute('data-pseudo-url') && JSON.parse(target.getAttribute('data-pseudo-url')).href);\n\t\tif (!href)\n\t\t{\n\t\t\tconst parentNode = target.parentNode;\n\t\t\tif (parentNode.nodeName === 'A')\n\t\t\t{\n\t\t\t\thref = parentNode.getAttribute('href');\n\t\t\t\ttarget = parentNode;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst grandParentNode = parentNode.parentNode;\n\t\t\t\tif (grandParentNode.nodeName === 'A')\n\t\t\t\t{\n\t\t\t\t\thref = grandParentNode.getAttribute('href');\n\t\t\t\t\ttarget = grandParentNode;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (target.getAttribute('data-viewer-type')) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (href && href.indexOf('/bitrix/services/main/ajax.php?action=landing.api.diskFile.download') === 0)\n\t\t{\n\t\t\tBX.ajax.get(href.replace('landing.api.diskFile.download', 'landing.api.diskFile.view'), function(data)\n\t\t\t{\n\t\t\t\tif (typeof data === 'string')\n\t\t\t\t{\n\t\t\t\t\tdata = JSON.parse(data);\n\t\t\t\t}\n\n\t\t\t\tif (!data.data)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tObject.keys(data.data).map(key => {\n\t\t\t\t\ttarget.setAttribute(key, data.data[key]);\n\t\t\t\t});\n\n\t\t\t\ttarget.click();\n\t\t\t});\n\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\t\t\treturn false;\n\t\t}\n\t}\n}","import { Type } from 'main.core';\nimport { Metrika } from 'landing.metrika';\n\nexport class Analytics\n{\n\t/**\n\t * Constructor.\n\t */\n\tconstructor(options)\n\t{\n\t\tthis.isPublished = options.isPublished;\n\n\t\tconst blocks = [].slice.call(document.getElementsByClassName('block-wrapper'));\n\t\tif (Type.isArray(blocks) && blocks.length > 0)\n\t\t{\n\t\t\tblocks.forEach((block) => {\n\t\t\t\tblock.addEventListener('click', this.onClick.bind(this));\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Click callback.\n\t *\n\t * @param {MouseEvent} event\n\t * @return {void}\n\t */\n\tonClick(event: MouseEvent)\n\t{\n\t\tconst target = event.target;\n\t\tif (\n\t\t\t!(\n\t\t\t\ttarget.tagName.toLowerCase() === 'a'\n\t\t\t\t|| (target.parentNode && target.parentNode.tagName.toLowerCase() === 'a')\n\t\t\t\t|| (target.firstElementChild && target.firstElementChild.tagName.toLowerCase() === 'a')\n\t\t\t\t|| target.tagName.toLowerCase() === 'button'\n\t\t\t\t|| target.hasAttribute('data-pseudo-url')\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet widgetId = '';\n\t\tconst blockWrapper = event.currentTarget;\n\t\tblockWrapper.classList.forEach(className => {\n\t\t\tif (className !== 'block-wrapper')\n\t\t\t{\n\t\t\t\twidgetId += className;\n\t\t\t}\n\t\t});\n\t\twidgetId = widgetId.replace('block-', '');\n\n\t\tconst metrika = new Metrika(true);\n\t\tmetrika.sendData({\n\t\t\tcategory: 'vibe',\n\t\t\tevent: 'click_on_button',\n\t\t\tc_section: this.isPublished ? 'active_page' : 'preview_page',\n\t\t\tparams: {\n\t\t\t\t'widget-id': widgetId,\n\t\t\t},\n\t\t});\n\t}\n}","export class Pseudolinks\n{\n\t/**\n\t * Constructor.\n\t */\n\tconstructor()\n\t{\n\t\tconst checkPageLoaded = setInterval(() => {\n\t\t\tif (document.readyState === 'complete')\n\t\t\t{\n\t\t\t\tthis.initPseudoLinks();\n\t\t\t\tclearInterval(checkPageLoaded);\n\t\t\t}\n\t\t}, 500);\n\t}\n\n\t/**\n\t * Click callback.\n\t *\n\t * @return {void}\n\t */\n\tinitPseudoLinks()\n\t{\n\t\tconst pseudoLinks = [].slice.call(document.querySelectorAll('[data-pseudo-url*=\"{\"]'));\n\t\tif (pseudoLinks.length > 0)\n\t\t{\n\t\t\tpseudoLinks.forEach((link) => {\n\t\t\t\tconst linkOptionsJson = link.getAttribute('data-pseudo-url');\n\t\t\t\tconst linkOptions = JSON.parse(linkOptionsJson);\n\t\t\t\tif (\n\t\t\t\t\tlinkOptions.href\n\t\t\t\t\t&& linkOptions.enabled\n\t\t\t\t\t&& linkOptions.href.indexOf('/bitrix/services/main/ajax.php?action=landing.api.diskFile.download') !== 0\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tif (linkOptions.target === '_self' || linkOptions.target === '_blank')\n\t\t\t\t\t{\n\t\t\t\t\t\tlink.addEventListener('click', (event) => {\n\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\tlet url = null;\n\t\t\t\t\t\t\ttry\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\turl = new URL(linkOptions.href);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcatch (error)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tconsole.error(error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (url)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tconst isSameHost = url.hostname === window.location.hostname;\n\t\t\t\t\t\t\t\tconst isIframe = url.searchParams.get('IFRAME') === 'Y';\n\n\t\t\t\t\t\t\t\tif (isSameHost && !isIframe)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tconst isDifferentPath = url.pathname !== window.location.pathname;\n\t\t\t\t\t\t\t\t\tif (isDifferentPath)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tBX.addClass(document.body, 'landing-page-transition');\n\t\t\t\t\t\t\t\t\t\tlinkOptions.href = url.href;\n\t\t\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\t\t\tthis.openPseudoLinks(linkOptions, event);\n\t\t\t\t\t\t\t\t\t\t}, 400);\n\t\t\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\t\t\tBX.removeClass(document.body, 'landing-page-transition');\n\t\t\t\t\t\t\t\t\t\t}, 3000);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tthis.openPseudoLinks(linkOptions, event);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\topenPseudoLinks(linkOptions, event)\n\t{\n\t\tif (linkOptions.href.indexOf('/bitrix/services/main/ajax.php?action=landing.api.diskFile.download') === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (linkOptions.query)\n\t\t{\n\t\t\tlinkOptions.href += (linkOptions.href.indexOf('?') === -1) ? '?' : '&';\n\t\t\tlinkOptions.href += linkOptions.query;\n\t\t}\n\n\t\tif (this.isValidURL(linkOptions.href))\n\t\t{\n\t\t\ttop.open(linkOptions.href, linkOptions.target);\n\t\t}\n\t}\n\n\tisValidURL(url)\n\t{\n\t\ttry\n\t\t{\n\t\t\tnew URL(url);\n\n\t\t\treturn true;\n\t\t}\n\t\tcatch\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t}\n}\n"],"names":["DiskFile","document","addEventListener","onClick","bind","event","target","href","getAttribute","JSON","parse","parentNode","nodeName","grandParentNode","indexOf","BX","ajax","get","replace","data","Object","keys","map","key","setAttribute","click","preventDefault","stopPropagation","Analytics","options","isPublished","blocks","slice","call","getElementsByClassName","Type","isArray","length","forEach","block","tagName","toLowerCase","firstElementChild","hasAttribute","widgetId","blockWrapper","currentTarget","classList","className","metrika","Metrika","sendData","category","c_section","params","Pseudolinks","checkPageLoaded","setInterval","readyState","initPseudoLinks","clearInterval","pseudoLinks","querySelectorAll","link","linkOptionsJson","linkOptions","enabled","url","URL","error","console","isSameHost","hostname","window","location","isIframe","searchParams","isDifferentPath","pathname","addClass","body","setTimeout","openPseudoLinks","removeClass","query","isValidURL","top","open"],"mappings":"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"}