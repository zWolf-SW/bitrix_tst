(function(){"use strict";BX.namespace("BX.Landing.Component.Filter");BX.Landing.Component.Filter.filterId=null;BX.Landing.Component.Filter.canCreateFolder=false;BX.Landing.Component.Filter.createButton=null;BX.Landing.Component.Filter.createFolderButton=null;BX.Landing.Component.Filter.settingsButtons=null;BX.Landing.Component.Filter.ajaxPath=null;BX.Landing.Component.Filter.ajaxSend=false;BX.Landing.Component.Filter=function(e){if(e.filterId!==undefined){BX.Landing.Component.Filter.filterId=e.filterId}if(BX.Type.isBoolean(e.canCreateFolder)){BX.Landing.Component.Filter.canCreateFolder=e.canCreateFolder}const n=BX.UI.ToolbarManager.getDefaultToolbar();if(n&&BX.Type.isString(e.landingCreateButtonId)){BX.Landing.Component.Filter.createButton=n.getButton(e.landingCreateButtonId)}if(n&&BX.Type.isString(e.landingCreateFolderButtonId)){BX.Landing.Component.Filter.createFolderButton=n.getButton(e.landingCreateFolderButtonId)}if(e.landingSettingsButtons!==undefined){BX.Landing.Component.Filter.settingsButtons=e.landingSettingsButtons}if(e.landingAjaxPath!==undefined){BX.Landing.Component.Filter.ajaxPath=e.landingAjaxPath}if(e.landingShowSiteAIPopup!==undefined&&BX.Type.isBoolean(e.landingShowSiteAIPopup)&&BX.Landing.Component.Filter.createButton){BX.Runtime.loadExtension(["ai.copilot-promo-popup","ui.banner-dispatcher"]).then((e=>{const n=BX.Landing.Component.Filter.createButton.button;const{CopilotPromoPopup:t,BannerDispatcher:o}=e;o.normal.toQueue((e=>{const o=t.createByPresetId({presetId:t.Preset.SITE_WITH_COPILOT,targetOptions:n,angleOptions:{position:t.AnglePosition.TOP,offset:n.offsetWidth/2+25}});o.subscribe(t.PromoVideoPopupEvents.HIDE,(()=>e()));o.show();BX.userOptions.save("landing","site-ai-popup","isShow","Y")}))}))}BX.addCustomEvent("BX.Main.Filter:apply",BX.delegate(BX.Landing.Component.Filter.onFilterCallback));BX.addCustomEvent("BX.Landing.Filter:apply",BX.delegate(BX.Landing.Component.Filter.onFilterCallback));if(BX.Landing.Component.Filter.canCreateFolder){BX.Landing.Component.Filter.getFolderCard()}};BX.Landing.Component.Filter.onRecycleBinClick=()=>{if(BX.Landing.Component.Filter.filterId===null){return}const e=BX.Main.filterManager.getById(BX.Landing.Component.Filter.filterId);const n=e.getApi();const t=e.getFilterFieldsValues();if(t.DELETED==="Y"){t.DELETED=""}else{t.DELETED="Y"}n.setFields(t);n.apply()};BX.Landing.Component.Filter.onFilterCallback=(e,n,t)=>{if(BX.Landing.Component.Filter.ajaxPath===null){return}if(BX.Landing.Component.Filter.ajaxSend){return}BX.Landing.Component.Filter.ajaxSend=true;if(t){const e=t.getFilterFieldsValues();if(e.DELETED==="Y"){BX.Landing.Component.Filter.createButton?.setDisabled(true);BX.Landing.Component.Filter.createFolderButton?.setDisabled(true)}else{BX.Landing.Component.Filter.createButton?.setDisabled(false);BX.Landing.Component.Filter.createFolderButton?.setDisabled(false)}}const o=BX("workarea-content")||BX("air-workarea-content");const i=BX.create("div",{attrs:{className:"landing-filter-loading"}});document.body.appendChild(i);const a=new BX.Loader({size:130,color:"#bfc3c8"});a.show(i);BX.ajax({method:"POST",dataType:"html",url:BX.Landing.Component.Filter.ajaxPath,onsuccess:function(e){BX.Landing.Component.Filter.ajaxSend=false;a.hide();i.classList.add("landing-filter-loading-hide");o.innerHTML=e}})};BX.Landing.Component.Filter.onSettingsClick=e=>{if(BX.Landing.Component.Filter.settingsButtons===null){return}const n=top.location.toString();const t={onClose:()=>{if(window["landingSettingsSaved"]===true){top.location=n}if(BX.PopupMenu.getCurrentMenu()){BX.PopupMenu.getCurrentMenu().close()}}};const o=BX.Landing.Component.Filter.settingsButtons;if(o.length===1){const e=o[0];const n=e.dataset&&e.dataset.skipSlider===true;if(!n){BX.SidePanel.Instance.open(e.href,{allowChangeHistory:false,events:t})}}else{for(let e=0,n=o.length;e<n;e++){o[e].onclick=(e,n)=>{const o=n&&n.dataset&&n.dataset.skipSlider===true;if(!o){BX.SidePanel.Instance.open(n.href,{allowChangeHistory:false,events:t});BX.PreventDefault(e)}BX.PopupMenu.getMenuById("landing-menu-settings").close()}}let n=BX.PopupMenu.getMenuById("landing-menu-settings");if(!n){n=BX.Main.MenuManager.create({id:"landing-menu-settings",bindElement:e.button,autoHide:true,zIndex:1200,offsetLeft:20,angle:true,closeByEsc:true,items:o})}if(n){n.show()}}BX.PreventDefault(event)};BX.Landing.Component.Filter.onFolderCreateClick=e=>{if(!BX.Landing.Component.Filter.canCreateFolder){return}const n=e.button;if(!n){return}const t=BX.Landing.Component.Filter.getFolderCard();const o=BX.Landing.Component.Filter.getFolderText();let i=false;function a(){if(i){return}i=true;BX.ajax({url:"/bitrix/tools/landing/ajax.php?"+"action=Site::addFolder&"+"type="+BX.data(n,"type"),method:"POST",data:{data:{siteId:BX.data(n,"siteId"),fields:{TITLE:o.value,PARENT_ID:BX.data(n,"folderId")}},sessid:BX.message("bitrix_sessid")},dataType:"json",onsuccess:function(e){if(typeof e.type!=="undefined"&&typeof e.result!=="undefined"){if(e.type==="error"){var t=BX.Landing.UI.Tool.ActionDialog.getInstance();t.show({content:e.result[0].error_description,confirm:"OK",type:"alert"}).then((function(){i=false;if(e.result[0].error==="FOLDER_IS_NOT_UNIQUE"){o.value="";o.focus()}else{BX.fireEvent(n,"click")}}))}else{window.location.reload()}}},onfailure:function(e){i=false}})}o.addEventListener("keydown",(function(e){if(e.keyCode===13){a()}}));o.addEventListener("blur",(function(){if(o.value.length!==0){a()}}));BX.style(t,"display","block");BX.focus(o)};BX.Landing.Component.Filter.folderCard=null;BX.Landing.Component.Filter.getFolderCard=()=>{if(BX.Landing.Component.Filter.folderCard){return BX.Landing.Component.Filter.folderCard}const e=BX.Landing.Component.Filter.getFolderText();const n=BX.create("div",{props:{className:"landing-item landing-item-folder"},children:[BX.create("div",{props:{className:"landing-title"},children:[BX.create("div",{props:{className:"landing-title-wrap"},children:[BX.create("div",{props:{className:"landing-title-overflow --create-folder-input"},children:[e]})]})]}),BX.create("div",{props:{className:"landing-item-cover"},children:[BX.create("div",{props:{className:"landing-item-preview"}}),BX.create("div",{props:{className:"landing-item-folder-corner"},children:[BX.create("div",{props:{className:"landing-item-folder-dropdown"}})]})]})]});BX.style(n,"display","none");BX.Landing.Component.Filter.folderCard=n;BX.insertAfter(n,document.body.querySelector(".landing-folder-placeholder"));return n};BX.Landing.Component.Filter.folderText=null;BX.Landing.Component.Filter.getFolderText=()=>{if(BX.Landing.Component.Filter.folderText){return BX.Landing.Component.Filter.folderText}const e=BX.create("input",{props:{type:"text"}});BX.Landing.Component.Filter.folderText=e;return e}})();
//# sourceMappingURL=script.map.js