{"version":3,"file":"notification-panel.bundle.js","sources":["../src/notification-panel.js"],"sourcesContent":["import { Type, Dom, Tag, Text } from 'main.core';\nimport { Icon } from 'ui.icon-set.api.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Popup, PopupWindowManager } from 'main.popup';\nimport 'ui.design-tokens';\nimport './style.css';\n\nexport type NotificationPanelOptions = {\n\tid: ?string,\n\tstyleClass: ?string,\n\tcontent: string | HTMLElement,\n\ttextColor: ?string,\n\tcrossColor: ?string,\n\tbackgroundColor: ?string,\n\tleftIcon: ?Icon,\n\trightButtons: ?Array,\n\tshowCloseIcon: ?boolean,\n\tzIndex: ?number,\n\tevents: ?{\n\t\tonShow: ?func,\n\t\tonHide: ?func,\n\t\tonHideByButton: ?func,\n\t},\n};\n\nexport class NotificationPanel extends EventEmitter\n{\n\t#content: ?HTMLElement = null;\n\t#popup: ?Popup = null;\n\t#container: HTMLElement;\n\toptions: NotificationPanelOptions;\n\n\tconstructor(options: NotificationPanelOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('UI:NotificationPanel');\n\t\tthis.options = { ...this.getDefaultOptions(), ...Type.isPlainObject(options) ? options : {} };\n\t\tthis.options.id ??= Text.getRandom();\n\t}\n\n\tgetDefaultOptions(): NotificationPanelOptions\n\t{\n\t\treturn {\n\t\t\tstyleClass: '',\n\t\t\tbackgroundColor: '#F2FEE2',\n\t\t\ttextColor: null,\n\t\t\tcrossColor: null,\n\t\t\tleftIcon: null,\n\t\t\trightButtons: [],\n\t\t\tshowCloseIcon: true,\n\t\t\tzIndex: null,\n\t\t\tevents: {},\n\t\t};\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\tif (this.#container)\n\t\t{\n\t\t\treturn this.#container;\n\t\t}\n\n\t\tthis.#container = Tag.render`\n\t\t\t<div class=\"ui-notification-panel__container\">\n\t\t\t\t${this.getContent()}\n\t\t\t\t${this.getFooter()}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.#container;\n\t}\n\n\tgetButtonsContainer(buttons): HTMLElement\n\t{\n\t\tconst buttonsContainer = Tag.render`<div class=\"ui-notification-panel__buttons-container\"></div>`;\n\n\t\tbuttons.forEach((button) => {\n\t\t\tbutton.renderTo(buttonsContainer);\n\t\t});\n\n\t\treturn buttonsContainer;\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\tif (this.#content)\n\t\t{\n\t\t\treturn this.#content;\n\t\t}\n\n\t\tthis.#content = Tag.render`<div class=\"ui-notification-panel__content\"></div>`;\n\n\t\tif (this.options.leftIcon)\n\t\t{\n\t\t\tthis.options.leftIcon.size = 28;\n\t\t\tthis.options.leftIcon.renderTo(this.#content);\n\t\t\tDom.append(\n\t\t\t\tTag.render`<div class=\"ui-notification-panel__left-icon-divider\"></div>`,\n\t\t\t\tthis.#content,\n\t\t\t);\n\t\t}\n\n\t\tif (Type.isElementNode(this.options.content))\n\t\t{\n\t\t\tDom.append(this.options.content, this.#content);\n\t\t}\n\t\telse if (Type.isString(this.options.content))\n\t\t{\n\t\t\tconst textColor = this.options.textColor;\n\t\t\tDom.append(\n\t\t\t\tTag.render`<div class=\"ui-notification-panel__text\" ${textColor ? `style=\"color: ${textColor}\"` : ''}>${this.options.content}</div>`,\n\t\t\t\tthis.#content,\n\t\t\t);\n\t\t}\n\n\t\tDom.append(this.getFooter(), this.#content);\n\n\t\treturn this.#content;\n\t}\n\n\tgetFooter(): HTMLElement\n\t{\n\t\tconst footer = Tag.render`<div class=\"ui-notification-panel__footer\"></div>`;\n\n\t\tif (this.options.rightButtons)\n\t\t{\n\t\t\tDom.append(this.getButtonsContainer(this.options.rightButtons), footer);\n\t\t}\n\n\t\tif (this.options.showCloseIcon)\n\t\t{\n\t\t\tDom.append(this.getCloseButton(), footer);\n\t\t}\n\n\t\treturn footer;\n\t}\n\n\tgetCloseButton(): HTMLElement\n\t{\n\t\tconst crossColor = this.options.crossColor;\n\n\t\treturn Tag.render`\n\t\t\t<div \n\t\t\t\tclass=\"ui-notification-panel__close-button ui-icon-set --cross-45\"\n\t\t\t\tonclick=\"${this.hideByButton.bind(this)}\"\n\t\t\t\t${crossColor ? `style=\"--ui-icon-set__icon-color: ${crossColor}\"` : ''}\n\t\t\t>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetPopup(): Popup\n\t{\n\t\tthis.#popup ??= PopupWindowManager.create({\n\t\t\tid: this.options.id,\n\t\t\tcontent: this.getContent(),\n\t\t\tbackground: this.options.backgroundColor,\n\t\t\tfixed: true,\n\t\t\tbindElement: {\n\t\t\t\tleft: 0,\n\t\t\t\ttop: 0,\n\t\t\t},\n\t\t\tclassName: `ui-notification-panel__container ${this.options.styleClass}`,\n\t\t\tanimation: {\n\t\t\t\tshowClassName: 'ui-notification-panel__show',\n\t\t\t\tcloseClassName: 'ui-notification-panel__hide',\n\t\t\t\tcloseAnimationType: 'transition',\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tonShow: this.#handlePopupShow.bind(this),\n\t\t\t\tonClose: this.#handlePopupClose.bind(this),\n\t\t\t},\n\t\t});\n\n\t\treturn this.#popup;\n\t}\n\n\tshow(): void\n\t{\n\t\tconst popup = this.getPopup();\n\t\tpopup.show();\n\n\t\tif (this.options.zIndex)\n\t\t{\n\t\t\tpopup.getZIndexComponent().setZIndex(this.options.zIndex);\n\t\t}\n\t}\n\n\thide(): void\n\t{\n\t\tthis.getPopup().close();\n\t}\n\n\thideByButton(): void\n\t{\n\t\tthis.options.events?.onHideByButton?.();\n\t\tthis.emit('onHideByButton');\n\t\tthis.hide();\n\t}\n\n\t#adjustPopupPosition(): void\n\t{\n\t\tconst containerWidth = this.getContent().offsetWidth;\n\t\tconst windowWidth = window.innerWidth;\n\t\tconst offsetLeft = (windowWidth - containerWidth) / 2;\n\n\t\tthis.getPopup().setOffset({\n\t\t\toffsetLeft,\n\t\t\toffsetTop: 0,\n\t\t});\n\t}\n\n\t#handlePopupShow(): void\n\t{\n\t\tthis.#adjustPopupPosition();\n\t\tthis.options.events?.onShow?.();\n\t\tthis.emit('onShow');\n\t}\n\n\t#handlePopupClose(): void\n\t{\n\t\tthis.options.events?.onHide?.();\n\t\tthis.emit('onHide');\n\t}\n}\n"],"names":["NotificationPanel","EventEmitter","constructor","options","setEventNamespace","getDefaultOptions","Type","isPlainObject","id","Text","getRandom","styleClass","backgroundColor","textColor","crossColor","leftIcon","rightButtons","showCloseIcon","zIndex","events","getContainer","Tag","render","getContent","getFooter","getButtonsContainer","buttons","buttonsContainer","forEach","button","renderTo","size","Dom","append","isElementNode","content","isString","footer","getCloseButton","hideByButton","bind","getPopup","PopupWindowManager","create","background","fixed","bindElement","left","top","className","animation","showClassName","closeClassName","closeAnimationType","onShow","onClose","show","popup","getZIndexComponent","setZIndex","hide","close","onHideByButton","emit","containerWidth","offsetWidth","windowWidth","window","innerWidth","offsetLeft","setOffset","offsetTop","onHide"],"mappings":"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"}